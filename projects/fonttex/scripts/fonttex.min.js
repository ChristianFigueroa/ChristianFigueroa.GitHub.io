"use strict";function _templateObject(){var e=_taggedTemplateLiteral(["\n    defmakeatletter{catcode","@=11\relax}\n    defmakeatother{catcode","@=12\relax}\n    makeatletter\n    count10=23\n    count11=9\n    count12=9\n    count13=9\n    countdefinsc@unt=20\n    countdefallocationnumber=21\n    countdefm@ne=22 m@ne=-1\n    countdefcount@=255\n    dimendefdimen@=0\n    dimendefdimen@i=1\n    dimendefdimen@ii=2\n    skipdefskip@=0\n    def\newcount{alloc@0countcountdef}\n    def\newdimen{alloc@1dimendimendef}\n    def\newskip{alloc@2skipskipdef}\n    def\newmuskip{alloc@3muskipmuskipdef}\n    defalloc@#1#2#3#4{\n      advancecount1#1by1\n      allocationnumber=count1#1\n      #3#4=allocationnumber\n    }\n    \newdimenmaxdimen maxdimen=137438953471.99998pt\n    \newskiphideskip hideskip=-1000pt plus 1fil\n    \newskipcentering centering=0pt plus 1000pt minus 1000pt\n    def\newif#1{\n      {lccode","9=","i lccode","8=",void 0,"{\n    mathchardef}=","}\n    mathchardef$=","$\n    mathchardef#=","#\n    mathchardef%=","%\n    mathchardef&=","&\n    mathchardef_=",'_\n    mathchardefaa="700E5\n    mathchardefae="700E6\n    mathchardefaleph="02135\n    mathchardefalpha="703B1\n    mathchardefamalg="22A3F\n    mathchardefangle="02220\n    mathchardefapprox="32248\n    mathchardefarrowvert="023D0\n    mathchardefast="2002A\n    mathchardefasymp="3224D\n    mathchardef\backslash=','\\\n    mathchardef\beta="703B2\n    mathchardef\bigcap="122C2\n    mathchardef\bigcirc="225EF\n    mathchardef\bigcup="122C3\n    mathchardef\bigodot="12A00\n    mathchardef\bigoplus="12A01\n    mathchardef\bigotimes="12A02\n    mathchardef\bigtriangleup="225B3\n    mathchardef\bigtriangledown="225BD\n    mathchardef\bigsqcup="12A06\n    mathchardef\biguplus="12A04\n    mathchardef\bigvee="122C1\n    mathchardef\bigwedge="122C0\n    mathchardef\bot="022A5\n    mathchardef\bracevert="023AA\n    mathchardef\bowtie="322C8\n    mathchardef\bullet="22022\n    mathchardefcap="22229\n    mathchardefcdot="222C5\n    mathchardefcdotp="622C5\n    mathchardefchi="703C7\n    mathchardefcirc="225CB\n    mathchardefclubsuit="02663\n    mathchardefcolon="6003A\n    mathchardefcong="32245\n    mathchardefcoprod="12210\n    mathchardefcup="2222A\n    mathchardefdag="02020\n    mathchardefdagger="22020\n    mathchardefdashv="322A3\n    mathchardefddag="02021\n    mathchardefddagger="22021\n    mathchardefdelta="703B4\n    mathchardefdiamond="222C4\n    mathchardefdiamondsuit="02662\n    mathchardefdiv="200F7\n    mathchardefdoteq="32250\n    mathchardefdownarrow="02193\n    mathchardefell="02113\n    mathchardefemptyset="02205\n    mathchardefepsilon="703F5\n    mathchardefequiv="32261\n    mathchardefeta="703B7\n    mathchardefexists="02203\n    mathchardef\flat="0266D\n    mathchardef\forall="02200\n    mathchardef\frown="32322\n    mathchardefgamma="703B3\n    mathchardefge="32265 letgeq=ge\n    mathchardefgg="3226B\n    mathchardefhbar="70127\n    mathchardefheartsuit="02661\n    mathchardefhookleftarrow="321AA\n    mathchardefhookrightarrow="321A9\n    mathchardefimath="70131\n    mathchardefin="32208\n    mathchardefinfty="0221E\n    mathchardefintop="1222B defint{intop\nolimits}\n    mathchardefiota="703B9\n    mathchardefjmath="70237\n    mathchardefkappa="703BA\n    mathchardefl="00142\n    mathchardeflambda="703BB\n    mathchardeflangle="027E8\n    mathchardeflbrace=','{\n    mathchardeflceil="02308\n    mathchardefldotp="6002E\n    mathchardefle="32264 letleq=le\n    mathchardefleftarrow="32190 letgets=leftarrow\n    mathchardefleftharpoondown="321BD\n    mathchardefleftharpoonup="321BC\n    mathchardefleftrightarrow="32194\n    mathchardeflfloor="0230A\n    mathchardeflgroup="027EE\n    mathchardefll="3226A\n    mathchardeflmoustache="023B0\n    mathchardeflongleftarrow="327F5\n    mathchardeflongleftrightarrow="327F7\n    mathchardeflongmapsto="327FC\n    mathchardeflongrightarrow="327F6\n    mathchardefmapsto="321A6\n    mathchardefmid="32223\n    mathchardefmodels="322A7\n    mathchardefmp="22213\n    mathchardefmu="703BC\n    mathchardef\nabla="02207\n    mathchardef\natural="0266E\n    mathchardef\nearrow="32197\n    mathchardef\neg="000AC letlnot=\neg\n    mathchardef\ne="32260 let\neq=\ne\n    mathchardef\ni="3220B letowns=\ni\n    mathchardef\notin="32209\n    mathchardef\nu="703BD\n    mathchardef\nwarrow="32196\n    mathchardefo="700F8\n    mathchardefodot="22299\n    mathchardefoe="70153\n    mathchardefointop="1222E defoint{ointop\nolimits}\n    mathchardefomega="703C9\n    mathchardefominus="22296\n    mathchardefoplus="22295\n    mathchardefoslash="22298\n    mathchardefotimes="22297\n    mathchardefparallel="32225\n    mathchardefpartial="02202\n    mathchardefperp="322A5\n    mathchardefphi="703D5\n    mathchardefpi="703C0\n    mathchardefpm="200B1\n    mathchardefprec="3227A\n    mathchardefpreceq="3227C\n    mathchardefprime="02032\n    mathchardefprod="1220F\n    mathchardefpropto="3221D\n    mathchardefpsi="703C8\n    mathchardef\rangle="027E9\n    mathchardef\rbrace=',void 0,void 0,void 0," =13\relax}\n    catcode"," =12defspace{ }obeyspaceslet =space\n    catcode"," =10\n    \newcountmscount\n    defmultispan#1{omit mscount#1\relaxloopifnummscount>1sp@n\repeat}\n    defsp@n{spanomitadvancemscount-1}\n    def\two@digits#1{ifnum#1<10 0\fi\the#1}\n    defdospecials{do do\\do{do}do$do&do#do^do^^Kdo_do^^Ado%do~}\n    defmathpalette#1#2{      mathchoice{#1displaystyle{#2}}{#1\textstyle{#2}}{#1scriptstyle{#2}}{#1scriptscriptstyle{#2}}}\n    def\binom#1#2{{{#1}atopwithdelims(){#2}}}\n    def\frac#1#2{{{#1}over{#2}}}\n    defmathrm#1{{\rm#1}}\n    def\textrm#1{{\rm#1}}\n    defmathbf#1{{\bf#1}}\n    def\textbf#1{{\bf#1}}\n    defmathit#1{{it#1}}\n    def\textit#1{{it#1}}\n    defmathsl#1{{sl#1}}\n    def\textsl#1{{sl#1}}\n    def@gobble#1{}\n    def@ifnextchar#1#2#3{\n      let@ifnextchar@charone=#1\n      def@ifnextchar@true{#2}\n      def@ifnextchar@false{#3}\n      \futurelet@ifnextchar@chartwo@ifnextchar@check}\n    def@ifnextchar@check{\n      ifx@ifnextchar@charone@ifnextchar@chartwo@ifnextchar@trueelse@ifnextchar@false\fi}\n    def\newcommand#1{@ifnextchar[{@newcommand#1}{@newcommand#1[0]}}\n    def@newcommand#1[#2]{\n      count0=#2\n      ifnumcount0<0\n        Error{Not Enough Parameters}\n      else\n        ifnumcount0>9\n          Error{TooManyParameters}\n        else\n          @ifnextchar[{ifnumcount0<1\n            Error{ParameterNumberMustBe>0}\n          else\n            @newcommand@optarg#1[#2]\n          \fi}{@newcommand@nooptarg#1[#2]}\n        \fi\n      \fi\n    }\n    def@paramnums#1{\n      ifcase#1\n      or####1\n      or####1####2\n      or####1####2####3\n      or####1####2####3####4\n      or####1####2####3####4####5\n      or####1####2####3####4####5####6\n      or####1####2####3####4####5####6####7\n      or####1####2####3####4####5####6####7####8\n      or####1####2####3####4####5####6####7####8####9\fi}\n    def@paramnums@bracket#1{\n      ifcase#1\n      or[####1]\n      or[####1]####2\n      or[####1]####2####3\n      or[####1]####2####3####4\n      or[####1]####2####3####4####5\n      or[####1]####2####3####4####5####6\n      or[####1]####2####3####4####5####6####7\n      or[####1]####2####3####4####5####6####7####8\n      or[####1]####2####3####4####5####6####7####8####9\fi}\n    def@newcommand@nooptarg#1[#2]#{\n      edef@newcommand@make{def\noexpand#1@paramnums#2}\n      @newcommand@make}\n    def@newcommand@optarg#1[#2][#3]#{\n      def#1{\n        @ifnextchar[{csnamestring#1endcsname}{csnamestring#1endcsname[#3]}}\n      edef@newcommand@make{\n        \noexpandexpandafterdef\n        \noexpandcsname\noexpandstring\noexpand#1endcsname@paramnums@bracket#2}\n      @newcommand@make}\n    \newcommandsqrt[1][]{\root #1of }}\n    makeatother\n  "],["\n    \\def\\makeatletter{\\catcode","\\@=11\\relax}\n    \\def\\makeatother{\\catcode","\\@=12\\relax}\n    \\makeatletter\n    \\count10=23\n    \\count11=9\n    \\count12=9\n    \\count13=9\n    \\countdef\\insc@unt=20\n    \\countdef\\allocationnumber=21\n    \\countdef\\m@ne=22 \\m@ne=-1\n    \\countdef\\count@=255\n    \\dimendef\\dimen@=0\n    \\dimendef\\dimen@i=1\n    \\dimendef\\dimen@ii=2\n    \\skipdef\\skip@=0\n    \\def\\newcount{\\alloc@0\\count\\countdef}\n    \\def\\newdimen{\\alloc@1\\dimen\\dimendef}\n    \\def\\newskip{\\alloc@2\\skip\\skipdef}\n    \\def\\newmuskip{\\alloc@3\\muskip\\muskipdef}\n    \\def\\alloc@#1#2#3#4{\n      \\advance\\count1#1by1\n      \\allocationnumber=\\count1#1\n      #3#4=\\allocationnumber\n    }\n    \\newdimen\\maxdimen \\maxdimen=137438953471.99998pt\n    \\newskip\\hideskip \\hideskip=-1000pt plus 1fil\n    \\newskip\\centering \\centering=0pt plus 1000pt minus 1000pt\n    \\def\\newif#1{\n      {\\lccode","9=","i \\lccode","8=",'f \\lowercase{\\gdef\\@remove@if##198##2{##2}}}\n      \\expandafter\\expandafter\\expandafter\n      \\def\\expandafter\\expandafter\\expandafter\n      \\@if@name\\expandafter\\expandafter\\expandafter{\\expandafter\\@remove@if\\string#1}\n      \\expandafter\\def\\expandafter\\@if@name@bool\\expandafter##\\expandafter1\\expandafter{\\@if@name##1}\n      \\expandafter\\def\\csname\\@if@name@bool{true}\\endcsname{\n        \\let#1=\\iftrue\n      }\n      \\expandafter\\def\\csname\\@if@name@bool{false}\\endcsname{\n        \\let#1=\\iffalse\n      }\n      \\let#1=\\iffalse\n      \\let\\@if@name=\\undefined\n      \\let\\@if@name@bool=\\undefined\n      \\let\\@remove@if=\\undefined\n    }\n    \\newcount\\active \\active=13\n    \\newskip\\smallskipamount \\smallskipamount=3pt plus 1pt minus 1pt\n    \\newskip\\medskipamount \\medskipamount=6pt plus 2pt minus 2pt\n    \\newskip\\bigskipamount \\bigskipamount=12pt plus 4pt minus 4pt\n    \\newskip\\normalbaselineskip \\normalbaselineskip=12pt\n    \\newskip\\normallineskip \\normallineskip=1pt\n    \\newdimen\\normallineskiplimit \\normallineskiplimit=0pt\n    \\newdimen\\jot \\jot=3pt\n    \\newcount\\interdisplaylinepenalty \\interdisplaylinepenalty=100\n    \\newcount\\interfootnotelinepenalty \\interfootnotelinepenalty=100\n    \\mathchardef\\\\="0000A\n    \\mathchardef\\ ="0020\n    \\mathchardef\\{=',"\\{\n    \\mathchardef\\}=","\\}\n    \\mathchardef\\$=","\\$\n    \\mathchardef\\#=","\\#\n    \\mathchardef\\%=","\\%\n    \\mathchardef\\&=","\\&\n    \\mathchardef\\_=",'\\_\n    \\mathchardef\\aa="700E5\n    \\mathchardef\\ae="700E6\n    \\mathchardef\\aleph="02135\n    \\mathchardef\\alpha="703B1\n    \\mathchardef\\amalg="22A3F\n    \\mathchardef\\angle="02220\n    \\mathchardef\\approx="32248\n    \\mathchardef\\arrowvert="023D0\n    \\mathchardef\\ast="2002A\n    \\mathchardef\\asymp="3224D\n    \\mathchardef\\backslash=','\\\\\n    \\mathchardef\\beta="703B2\n    \\mathchardef\\bigcap="122C2\n    \\mathchardef\\bigcirc="225EF\n    \\mathchardef\\bigcup="122C3\n    \\mathchardef\\bigodot="12A00\n    \\mathchardef\\bigoplus="12A01\n    \\mathchardef\\bigotimes="12A02\n    \\mathchardef\\bigtriangleup="225B3\n    \\mathchardef\\bigtriangledown="225BD\n    \\mathchardef\\bigsqcup="12A06\n    \\mathchardef\\biguplus="12A04\n    \\mathchardef\\bigvee="122C1\n    \\mathchardef\\bigwedge="122C0\n    \\mathchardef\\bot="022A5\n    \\mathchardef\\bracevert="023AA\n    \\mathchardef\\bowtie="322C8\n    \\mathchardef\\bullet="22022\n    \\mathchardef\\cap="22229\n    \\mathchardef\\cdot="222C5\n    \\mathchardef\\cdotp="622C5\n    \\mathchardef\\chi="703C7\n    \\mathchardef\\circ="225CB\n    \\mathchardef\\clubsuit="02663\n    \\mathchardef\\colon="6003A\n    \\mathchardef\\cong="32245\n    \\mathchardef\\coprod="12210\n    \\mathchardef\\cup="2222A\n    \\mathchardef\\dag="02020\n    \\mathchardef\\dagger="22020\n    \\mathchardef\\dashv="322A3\n    \\mathchardef\\ddag="02021\n    \\mathchardef\\ddagger="22021\n    \\mathchardef\\delta="703B4\n    \\mathchardef\\diamond="222C4\n    \\mathchardef\\diamondsuit="02662\n    \\mathchardef\\div="200F7\n    \\mathchardef\\doteq="32250\n    \\mathchardef\\downarrow="02193\n    \\mathchardef\\ell="02113\n    \\mathchardef\\emptyset="02205\n    \\mathchardef\\epsilon="703F5\n    \\mathchardef\\equiv="32261\n    \\mathchardef\\eta="703B7\n    \\mathchardef\\exists="02203\n    \\mathchardef\\flat="0266D\n    \\mathchardef\\forall="02200\n    \\mathchardef\\frown="32322\n    \\mathchardef\\gamma="703B3\n    \\mathchardef\\ge="32265 \\let\\geq=\\ge\n    \\mathchardef\\gg="3226B\n    \\mathchardef\\hbar="70127\n    \\mathchardef\\heartsuit="02661\n    \\mathchardef\\hookleftarrow="321AA\n    \\mathchardef\\hookrightarrow="321A9\n    \\mathchardef\\imath="70131\n    \\mathchardef\\in="32208\n    \\mathchardef\\infty="0221E\n    \\mathchardef\\intop="1222B \\def\\int{\\intop\\nolimits}\n    \\mathchardef\\iota="703B9\n    \\mathchardef\\jmath="70237\n    \\mathchardef\\kappa="703BA\n    \\mathchardef\\l="00142\n    \\mathchardef\\lambda="703BB\n    \\mathchardef\\langle="027E8\n    \\mathchardef\\lbrace=','\\{\n    \\mathchardef\\lceil="02308\n    \\mathchardef\\ldotp="6002E\n    \\mathchardef\\le="32264 \\let\\leq=\\le\n    \\mathchardef\\leftarrow="32190 \\let\\gets=\\leftarrow\n    \\mathchardef\\leftharpoondown="321BD\n    \\mathchardef\\leftharpoonup="321BC\n    \\mathchardef\\leftrightarrow="32194\n    \\mathchardef\\lfloor="0230A\n    \\mathchardef\\lgroup="027EE\n    \\mathchardef\\ll="3226A\n    \\mathchardef\\lmoustache="023B0\n    \\mathchardef\\longleftarrow="327F5\n    \\mathchardef\\longleftrightarrow="327F7\n    \\mathchardef\\longmapsto="327FC\n    \\mathchardef\\longrightarrow="327F6\n    \\mathchardef\\mapsto="321A6\n    \\mathchardef\\mid="32223\n    \\mathchardef\\models="322A7\n    \\mathchardef\\mp="22213\n    \\mathchardef\\mu="703BC\n    \\mathchardef\\nabla="02207\n    \\mathchardef\\natural="0266E\n    \\mathchardef\\nearrow="32197\n    \\mathchardef\\neg="000AC \\let\\lnot=\\neg\n    \\mathchardef\\ne="32260 \\let\\neq=\\ne\n    \\mathchardef\\ni="3220B \\let\\owns=\\ni\n    \\mathchardef\\notin="32209\n    \\mathchardef\\nu="703BD\n    \\mathchardef\\nwarrow="32196\n    \\mathchardef\\o="700F8\n    \\mathchardef\\odot="22299\n    \\mathchardef\\oe="70153\n    \\mathchardef\\ointop="1222E \\def\\oint{\\ointop\\nolimits}\n    \\mathchardef\\omega="703C9\n    \\mathchardef\\ominus="22296\n    \\mathchardef\\oplus="22295\n    \\mathchardef\\oslash="22298\n    \\mathchardef\\otimes="22297\n    \\mathchardef\\parallel="32225\n    \\mathchardef\\partial="02202\n    \\mathchardef\\perp="322A5\n    \\mathchardef\\phi="703D5\n    \\mathchardef\\pi="703C0\n    \\mathchardef\\pm="200B1\n    \\mathchardef\\prec="3227A\n    \\mathchardef\\preceq="3227C\n    \\mathchardef\\prime="02032\n    \\mathchardef\\prod="1220F\n    \\mathchardef\\propto="3221D\n    \\mathchardef\\psi="703C8\n    \\mathchardef\\rangle="027E9\n    \\mathchardef\\rbrace=','\\}\n    \\mathchardef\\rceil="02309\n    \\mathchardef\\relbar="3002D\n    \\mathchardef\\rfloor="0230B\n    \\mathchardef\\rgroup="027EF\n    \\mathchardef\\rho="703C1\n    \\mathchardef\\rightarrow="32192 \\let\\to=\\rightarrow\n    \\mathchardef\\rightharpoondown="321C1\n    \\mathchardef\\rightharpoonup="321C0\n    \\mathchardef\\rightleftharpoons="321CC\n    \\mathchardef\\rmoustache="023B1\n    \\mathchardef\\searrow="32198\n    \\mathchardef\\setminus="22216\n    \\mathchardef\\sharp="0266F\n    \\mathchardef\\sim="3223C\n    \\mathchardef\\simeq="32243\n    \\mathchardef\\sigma="703C3\n    \\mathchardef\\smile="32323\n    \\mathchardef\\sqcap="22293\n    \\mathchardef\\sqcup="22294\n    \\mathchardef\\sqsubseteq="32291\n    \\mathchardef\\sqsupseteq="32292\n    \\mathchardef\\ss="000DF\n    \\mathchardef\\star="222C6\n    \\mathchardef\\subset="32282\n    \\mathchardef\\subseteq="32286\n    \\mathchardef\\succ="3227B\n    \\mathchardef\\succeq="3227D\n    \\mathchardef\\sum="12211\n    \\mathchardef\\supset="32283\n    \\mathchardef\\supseteq="32287\n    \\mathchardef\\swarrow="32199\n    \\mathchardef\\tau="703C4\n    \\mathchardef\\theta="703B8\n    \\mathchardef\\times="200D7\n    \\mathchardef\\top="022A4\n    \\mathchardef\\triangle="025B3\n    \\mathchardef\\triangleleft="225C1\n    \\mathchardef\\triangleright="225B7\n    \\mathchardef\\ucup="2228E\n    \\mathchardef\\uparrow="02191\n    \\mathchardef\\updownarrow="02195\n    \\mathchardef\\upsilon="703C5\n    \\mathchardef\\varepsilon="703B5\n    \\mathchardef\\varphi="703C6\n    \\mathchardef\\varpi="703D6\n    \\mathchardef\\varrho="703F1\n    \\mathchardef\\varsigma="703C2\n    \\mathchardef\\vartheta="703D1\n    \\mathchardef\\vdash="322A2\n    \\mathchardef\\vee="22228 \\let\\lor=\\vee\n    \\mathchardef\\vert=','\\|\n    \\mathchardef\\wedge="22227 \\let\\land=\\wedge\n    \\mathchardef\\wp="02118\n    \\mathchardef\\wr="22240\n    \\mathchardef\\xi="703BE\n    \\mathchardef\\zeta="703B6\n    \\mathchardef\\AA="700C5\n    \\mathchardef\\AE="700C6\n    \\mathchardef\\Arrowvert="02225\n    \\mathchardef\\Delta="00394\n    \\mathchardef\\Downarrow="21D3\n    \\mathchardef\\Gamma="00393\n    \\mathchardef\\Im="02111\n    \\mathchardef\\L="00141\n    \\mathchardef\\Lambda="0039B\n    \\mathchardef\\Leftarrow="321D0\n    \\mathchardef\\Leftrightarrow="321D4\n    \\mathchardef\\Longleftarrow="327F8\n    \\mathchardef\\Longleftrightarrow="327FA\n    \\mathchardef\\Longrightarrow="327F9\n    \\mathchardef\\O="700D8\n    \\mathchardef\\OE="70152\n    \\mathchardef\\Omega="003A9\n    \\mathchardef\\Orb="225EF\n    \\mathchardef\\P="000B6\n    \\mathchardef\\Phi="003A6\n    \\mathchardef\\Pi="003A0\n    \\mathchardef\\Psi="003A8\n    \\mathchardef\\Re="0211C\n    \\mathchardef\\Relbar="3003D\n    \\mathchardef\\Rightarrow="321D2\n    \\mathchardef\\S="000A7\n    \\mathchardef\\Sigma="003A3\n    \\mathchardef\\spadesuit="02660\n    \\mathchardef\\Theta="00398\n    \\mathchardef\\Uparrow="021D1\n    \\mathchardef\\Updownarrow="021D5\n    \\mathchardef\\Upsilon="003A5\n    \\mathchardef\\Vert="02016 \\let\\|=\\Vert\n    \\mathchardef\\Xi="0039E\n    \\def\\~{\\accent"02DC }\n    \\def\\,{\\mskip\\thinmuskip}\n    \\def\\>{\\mskip\\medmuskip}\n    \\def\\;{\\mskip\\thickmuskip}\n    \\def\\!{\\mskip-\\thinmuskip}\n    \\def\\"{\\accent"A8 }\n    \\def\\={\\accent"AF }\n    \\def\\^{\\accent"5E }\n    \\def\\.{\\accent"02D9 }\n    \\def\\acute{\\accent"B4 }\n    \\def\\arccos{\\mathop{\\rm arccos}\\nolimits}\n    \\def\\arcsin{\\mathop{\\rm arcsin}\\nolimits}\n    \\def\\arctan{\\mathop{\\rm arctan}\\nolimits}\n    \\def\\arg{\\mathop{\\rm arg}\\nolimits}\n    \\def\\bar{\\accent"AF }\n    \\def\\big#1{{\\n@space\\left#1\\vbox to 1em{}\\right.}}\n    \\def\\bigl{\\mathopen\\big}\n    \\def\\bigm{\\mathrel\\big}\n    \\def\\bigr{\\mathclose\\big}\n    \\def\\bigg#1{{\\n@space\\left#1\\vbox to 1.6em{}\\right.}}\n    \\def\\biggl{\\mathopen\\bigg}\n    \\def\\biggm{\\mathrel\\bigg}\n    \\def\\biggr{\\mathclose\\bigg}\n    \\def\\bmod{\\\n      \\nonscript\\mskip-\\medmuskip\\mkern5mu\\mathbin{\\rm mod}\\mkern5mu\\nonscript\\mskip-\\medmuskip}\n    \\def\\brace{\\atopwithdelims\\{\\}}\n    \\def\\brack{\\atopwithdelims[]}\n    \\def\\breve{\\accent"02D8 }\n    \\def\\buildrel#1\\over#2{\\mathrel{\\mathop{\\kern0pt#2}\\limits^{#1}}}\n    \\def\\cases#1{\n      \\left\\{\\,{\\halign{##\\hfil&\\quad##\\hfil\\cr#1\\crcr}}\\right.}\n    \\def\\cdots{\\mathinner{\\cdotp\\cdotp\\cdotp}}\n    \\def\\check{\\accent"02C7 }\n    \\def\\choose{\\atopwithdelims()}\n    \\def\\cong{\\mathrel{\\tilde=}}\n    \\def\\cos{\\mathop{\\rm cos}\\nolimits}\n    \\def\\cosh{\\mathop{\\rm cosh}\\nolimits}\n    \\def\\cot{\\mathop{\\rm cot}\\nolimits}\n    \\def\\coth{\\mathop{\\rm coth}\\nolimits}\n    \\def\\csc{\\mathop{\\rm csc}\\nolimits}\n    \\def\\ddot{\\accent"A8 }\n    \\def\\ddots{\\mathinner{\\char"22F1}}\n    \\def\\deg{\\mathop{\\rm deg}\\nolimits}\n    \\def\\det{\\mathop{\\rm det}}\n    \\def\\dim{\\mathop{\\rm dim}\\nolimits}\n    \\def\\dot{\\accent"02D9 }\n    \\def\\empty{}\n    \\def\\exp{\\mathop{\\rm exp}\\nolimits}\n    \\def\\gcd{\\mathop{\\rm gcd}}\n    \\def\\grave{\\accent"60 }\n    \\def\\hat{\\accent"5E }\n    \\def\\hom{\\mathop{\\rm hom}\\nolimits}\n    \\def\\hphantom#1{\\vbox to0pt{\\phantom#1}}\n    \\def\\iff{\\;\\Longleftrightarrow\\;}\n    \\def\\inf{\\mathop{\\rm inf}}\n    \\def\\iterate{\\body \\let\\next=\\iterate\\else\\let\\next=\\relax\\fi\\next}\n    \\def\\joinrel{\\mathrel{\\mkern-3mu}}\n    \\def\\ker{\\mathop{\\rm ker}\\nolimits}\n    \\def\\lbrack{[}\n    \\def\\ldots{\\mathinner{\\ldotp\\ldotp\\ldotp}}\n    \\def\\lg{\\mathop{\\rm lg}\\nolimits}\n    \\def\\lim{\\mathop{\\rm lim}}\n    \\def\\liminf{\\mathop{\\rm lim\\,inf}}\n    \\def\\limsup{\\mathop{\\rm lim\\,sup}}\n    \\def\\ln{\\mathop{\\rm ln}\\nolimits}\n    \\def\\log{\\mathop{\\rm log}\\nolimits}\n    \\def\\loop#1\\repeat{\\def\\body{#1}\\iterate}\n    \\def\\lq{','}\n    \\def\\mathstrut{\\vphantom(}\n    \\def\\matrix#1{\\,\\halign{\\hfil##\\hfil&&\\quad\\hfil##\\hfil\\cr#1\\crcr}\\,}\n    \\def\\max{\\mathop{\\rm max}}\n    \\def\\min{\\mathop{\\rm min}}\n    \\def\\n@space{\\nulldelimiterspace=0pt\\relax}\n    \\def\\not{\\@ifnextchar={\\mathchar"32260\\@gobble}{\\hbox to 0pt{/}}}}\n    \\def\\null{\\hbox{}}\n    \\def\\pmatrix#1{\\left(\\matrix{#1}\\right)}\n    \\def\\pmod#1{\\mkern18mu({\\rm mod}\\,\\,#1)}\n    \\def\\rbrack{]}\n    \\def\\rq{\\\'}\n    \\def\\sec{\\mathop{\\rm sec}\\nolimits}\n    \\def\\sin{\\mathop{\\rm sin}\\nolimits}\n    \\def\\sinh{\\mathop{\\rm sinh}\\nolimits}\n    \\def\\skew#1#2#3{{\\muskip0 #1mu\\divide\\muskip0by2 \\mkern\\muskip0%\n      #2{\\mkern-\\muskip0{#3}\\mkern\\muskip0}\\mkern-\\muskip0}{}}\n    \\def\\strut{\\vrule height.708333333emdepth.291666666emwidth0pt\\relax}\n    \\def\\sup{\\mathop{\\rm sup}}\n    \\def\\surd{{\\mathchar"1221A}}\n    \\def\\t{\\accent"0311 }\n    \\def\\tan{\\mathop{\\rm tan}\\nolimits}\n    \\def\\tanh{\\mathop{\\rm tanh}\\nolimits}\n    \\def\\thinspace{\\kern.1667em}\n    \\def\\tilde{\\accent"02DC }\n    \\def\\u{\\accent"02D8 }\n    \\def\\v{\\accent"02C7 }\n    \\def\\vdots{\\mathinner{\\char"22EE}}\n    \\def\\vphantom#1{\\hbox to0pt{\\phantom#1}}\n    \\def\\Big#1{{\\n@space\\left#1\\vbox to 1.3em{}\\right.}}\n    \\def\\Bigl{\\mathopen\\Big}\n    \\def\\Bigm{\\mathrel\\Big}\n    \\def\\Bigr{\\mathclose\\Big}\n    \\def\\Bigg#1{{\\n@space\\left#1\\vbox to 1.9em{}\\right.}}\n    \\def\\Biggl{\\mathopen\\Bigg}\n    \\def\\Biggm{\\mathrel\\Bigg}\n    \\def\\Biggr{\\mathclose\\Bigg}\n    \\def\\H{\\accent"02DD }\n    \\def\\Pr{\\mathop{\\rm Pr}}\n    \\def\\TeX{T\\kern-.1667em{\\lower.5exE}\\kern-.125emX}\n    \\let\\bgroup={\n    \\let\\displaymath=\\[\n    \\let\\enddisplaymath=\\]\n    \\let\\egroup=}\n    \\let\\endline=\\cr\n    \\let\\math=\\(\n    \\let\\endmath=\\)\n    \\let\\sb=^\n    \\let\\sp=_\n    \\let\\repeat=\\fi\n    \\def\\negthinspace{\\kern-.1667em}\n    \\def\\enspace{\\kern.5em}\n    \\def\\enskip{\\hskip.5em\\relax}\n    \\def\\quad{\\hskip1em\\relax}\n    \\def\\qquad{\\hskip2em\\relax}\n    \\def\\smallskip{\\vskip\\smallskipamount}\n    \\def\\medskip{\\vskip\\medskipamount}\n    \\def\\bigskip{\\vskip\\bigskipamount}\n    \\def~{\\char"00A0\\relax}\n    \\def\\obeyspaces{\\catcode',"\\ =13\\relax}\n    \\catcode","\\ =12\\def\\space{ }\\obeyspaces\\let =\\space\n    \\catcode","\\ =10\n    \\newcount\\mscount\n    \\def\\multispan#1{\\omit \\mscount#1\\relax\\loop\\ifnum\\mscount>1\\sp@n\\repeat}\n    \\def\\sp@n{\\span\\omit\\advance\\mscount-1}\n    \\def\\two@digits#1{\\ifnum#1<10 0\\fi\\the#1}\n    \\def\\dospecials{\\do\\ \\do\\\\\\do\\{\\do\\}\\do\\$\\do\\&\\do\\#\\do\\^\\do\\^^K\\do\\_\\do\\^^A\\do\\%\\do\\~}\n    \\def\\mathpalette#1#2{\\\n      \\mathchoice{#1\\displaystyle{#2}}{#1\\textstyle{#2}}{#1\\scriptstyle{#2}}{#1\\scriptscriptstyle{#2}}}\n    \\def\\binom#1#2{{{#1}\\atopwithdelims(){#2}}}\n    \\def\\frac#1#2{{{#1}\\over{#2}}}\n    \\def\\mathrm#1{{\\rm#1}}\n    \\def\\textrm#1{{\\rm#1}}\n    \\def\\mathbf#1{{\\bf#1}}\n    \\def\\textbf#1{{\\bf#1}}\n    \\def\\mathit#1{{\\it#1}}\n    \\def\\textit#1{{\\it#1}}\n    \\def\\mathsl#1{{\\sl#1}}\n    \\def\\textsl#1{{\\sl#1}}\n    \\def\\@gobble#1{}\n    \\def\\@ifnextchar#1#2#3{\n      \\let\\@ifnextchar@charone=#1\n      \\def\\@ifnextchar@true{#2}\n      \\def\\@ifnextchar@false{#3}\n      \\futurelet\\@ifnextchar@chartwo\\@ifnextchar@check}\n    \\def\\@ifnextchar@check{\n      \\ifx\\@ifnextchar@charone\\@ifnextchar@chartwo\\@ifnextchar@true\\else\\@ifnextchar@false\\fi}\n    \\def\\newcommand#1{\\@ifnextchar[{\\@newcommand#1}{\\@newcommand#1[0]}}\n    \\def\\@newcommand#1[#2]{\n      \\count0=#2\n      \\ifnum\\count0<0\n        \\Error{Not Enough Parameters}\n      \\else\n        \\ifnum\\count0>9\n          \\Error{TooManyParameters}\n        \\else\n          \\@ifnextchar[{\\ifnum\\count0<1\n            \\Error{ParameterNumberMustBe>0}\n          \\else\n            \\@newcommand@optarg#1[#2]\n          \\fi}{\\@newcommand@nooptarg#1[#2]}\n        \\fi\n      \\fi\n    }\n    \\def\\@paramnums#1{\n      \\ifcase#1\n      \\or####1\n      \\or####1####2\n      \\or####1####2####3\n      \\or####1####2####3####4\n      \\or####1####2####3####4####5\n      \\or####1####2####3####4####5####6\n      \\or####1####2####3####4####5####6####7\n      \\or####1####2####3####4####5####6####7####8\n      \\or####1####2####3####4####5####6####7####8####9\\fi}\n    \\def\\@paramnums@bracket#1{\n      \\ifcase#1\n      \\or[####1]\n      \\or[####1]####2\n      \\or[####1]####2####3\n      \\or[####1]####2####3####4\n      \\or[####1]####2####3####4####5\n      \\or[####1]####2####3####4####5####6\n      \\or[####1]####2####3####4####5####6####7\n      \\or[####1]####2####3####4####5####6####7####8\n      \\or[####1]####2####3####4####5####6####7####8####9\\fi}\n    \\def\\@newcommand@nooptarg#1[#2]#{\n      \\edef\\@newcommand@make{\\def\\noexpand#1\\@paramnums#2}\n      \\@newcommand@make}\n    \\def\\@newcommand@optarg#1[#2][#3]#{\n      \\def#1{\n        \\@ifnextchar[{\\csname\\string#1\\endcsname}{\\csname\\string#1\\endcsname[#3]}}\n      \\edef\\@newcommand@make{\n        \\noexpand\\expandafter\\def\n        \\noexpand\\csname\\noexpand\\string\\noexpand#1\\endcsname\\@paramnums@bracket#2}\n      \\@newcommand@make}\n    \\newcommand\\sqrt[1][]{\\root #1\\of }}\n    \\makeatother\n  "]);return _templateObject=function(){return e},e}function _taggedTemplateLiteral(e,t){return t=t||e.slice(0),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _typeof(e){function t(e){return i.apply(this,arguments)}var i,a;function s(e){return a.apply(this,arguments)}return(_typeof="function"==typeof Symbol&&"symbol"===_typeof(Symbol.iterator)?(a=function(e){return void 0===e?"undefined":_typeof(e)},s.toString=function(){return a.toString()},s):(i=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof(e)},t.toString=function(){return i.toString()},t))(e)}!function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).uuidv4=t()}(void 0,function(){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),l=new Uint8Array(16);for(var o=[],e=0;e<256;++e)o.push((e+256).toString(16).substr(1));return function(e,t,i){"string"==typeof e&&(t="binary"===e?new Uint8Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||function(){if(!n)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(l)})();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){for(var s=i||0,r=0;r<16;++r)t[s+r]=a[r];return t}return(o[a[0]]+o[a[1]]+o[a[2]]+o[a[3]]+"-"+o[a[4]]+o[a[5]]+"-"+o[a[6]]+o[a[7]]+"-"+o[a[8]]+o[a[9]]+"-"+o[a[10]]+o[a[11]]+o[a[12]]+o[a[13]]+o[a[14]]+o[a[15]]).toLowerCase()}}),window.fontTeX=function(){var We={ESCAPE:0,OPEN:1,CLOSE:2,MATHSHIFT:3,ALIGN:4,ENDOFLINE:5,PARAMETER:6,SUPERSCRIPT:7,SUBSCRIPT:8,IGNORE:9,WHITESPACE:10,LETTER:11,OTHER:12,ACTIVE:13,COMMENT:14,INVALID:15},vi={ORD:0,OP:1,BIN:2,REL:3,OPEN:4,CLOSE:5,PUNCT:6,VARIABLE:7,ACTIVE:8,INNER:"inner",OVER:"over",UNDER:"under",VCENT:"vcent",RAD:"rad",ACC:"acc"},gi=Math.SQRT2,yi=Math.SQRT1_2,bi="".concat(yi,"em"),wi={version:"0.5.1",config:function(e,t){var i=Object.keys(xi);if("string"==typeof e)return e=e.toLowerCase(),i.includes(e)?(1<arguments.length&&("number"!=typeof(t=xi[e][1](t))||isFinite(t)||(t=0),xi[e][0]=t),xi[e][0]):null;for(var a={},s=i.length-1;0<=s;s--){var r,n=i[s];e&&n in e&&("number"!=typeof(r=xi[n][1](e[n]))||isFinite(r)||(r=0),xi[n][0]=r),a[n]=xi[n][0]}return a}},xi={autoupdate:[!0,Boolean],parsehtml:[!0,Boolean],"invalid.color":["red",String],"radical.build":[!0,Boolean],"radical.w":[.5,Number],"radical.t":[.15,Number],"radical.h":[1.25,Number],"radical.verticalthreshold":[2.75,Number],"operator.growamount":[1.75,Number],"operator.growchars":["⅀∏∐∑∫∮⋀⋁⋂⋃⨀⨁⨂⨃⨄⨅⨆⨉⫿",String]};function a(e){return"string"==typeof e?a(document.querySelectorAll(e)):e instanceof HTMLElement?[e]:e instanceof NodeList||e instanceof HTMLCollection?Array.prototype.slice.call(e):Array.isArray(e)?e.filter(function(e){return e instanceof Node}):[]}function n(e){if("string"==typeof e)return n(document.querySelectorAll(e));if(e instanceof HTMLCollection||e instanceof NodeList)return n(Array.prototype.slice.call(e));if(e instanceof HTMLElement)return n([e]);if(e instanceof wi.ParsedFontTeX)return[e];if(Array.isArray(e)){for(var t,i=[],a=S.map(function(e){return e.elem}),s=0,r=e.length;s<r;s++){e[s]instanceof wi.ParsedFontTeX?i.push(e[s]):e[s]instanceof HTMLElement&&(~(t=a.indexOf(e[s]))&&i.push(S[t].parsedTeXInstance))}return i}return S.map(function(e){return e.parsedTeXInstance})}wi.rerender=function(e){for(var t=n(e),i=(t=S.filter(function(e){return t.includes(e.parsedTeXInstance)})).length-1;0<=i;i--)t[i].parsedTeXInstance.renderIn(t[i].elem)},wi.updateStyles=function(e){for(var t=n(e),i=0,a=(t=S.filter(function(e){return t.includes(e.parsedTeXInstance)})).length-1;0<=a;a--)t[a].oldFontFamily==t[a].styles.fontFamily&&t[a].oldFontSize==t[a].styles.fontSize&&t[a].oldColor==t[a].styles.color||(t[a].oldFontFamily=t[a].styles.fontFamily,t[a].oldFontSize=t[a].styles.fontSize,t[a].oldColor=t[a].styles.color,t[a].parsedTeXInstance.renderIn(t[a].elem),i++);return i};var S=[];new MutationObserver(function(){xi.autoupdate[0]&&wi.updateStyles()}).observe(document,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","style"]});var h=console.log.bind(console);wi.parse=function(d){function e(e){var t=d[e]||"",i=_e.cats[t.codePointAt(0)];if(!i)return[{},0];if((i=i.value)!=We.ESCAPE&&i!=We.MATHSHIFT&&i!=We.ACTIVE)return[{},0];if(i==We.ESCAPE){var a=d[e+1],s=d.codePointAt(e+1),r="",n=void 0;if(s in _e.cats&&_e.cats[s].value==We.LETTER){for(var l=e+1,o=d.codePointAt(l);o&&o in _e.cats&&_e.cats[o].value==We.LETTER;o=d.codePointAt(++l))r+=d[l];if(!_e.defs.macros[r])return[{},0];n=_e.defs.macros[r]}else{if(!a||!_e.defs.primitive[a]&&!_e.defs.macros[a])return[{},0];r=a,n=_e.defs.primitive[a]||_e.defs.macros[a]}var c=!1;return n.isLet&&(n=n.original,c=!0),n===_e.defs.primitive["["]?[{type:"command",name:"[",cat:-1},r.length+1]:n===_e.defs.primitive["("]?[{type:"command",name:"(",cat:-1},r.length+1]:c&&n.replacement&&1==n.replacement.length&&n.replacement[0].cat==We.MATHSHIFT?[{char:t,cat:We.MATHSHIFT},r.length+1]:[{},0]}if(i==We.MATHSHIFT)return[{char:t,cat:We.MATHSHIFT},1];if(i==We.ACTIVE&&_e.defs.active[t]){if(_e.defs.active[t].isLet){var h=_e.defs.active[t].original;if(h===_e.defs.primitive["["])return[{type:"command",name:"[",cat:-1},1];if(h===_e.defs.primitive["("])return[{type:"command",name:"(",cat:-1},1];if(h.replacement&&1==h.replacement.length&&h.replacement[0].cat==We.MATHSHIFT)return[{char:t,cat:We.MATHSHIFT},1]}return[{},0]}}for(var t=[],i=d;d;)if(d.codePointAt(0)in _e.cats){var a,s=e(0),r=null,n=0;if(s[0].cat==We.MATHSHIFT?(n+=s[1],(a=e(s[1]))[0].cat==We.MATHSHIFT?(r="display",n+=a[1]):r="inline"):"command"==s[0].type&&"["==s[0].name?(r="display",n+=s[1]):"command"==s[0].type&&"("==s[0].name&&(r="inline",n+=s[1]),"display"==r||"inline"==r){var l=y(d.substring(n),r);if(!l[2]){t.push(d),d="";break}d=l[1],t.push([l[0],"display"==r?"display":"text"])}else"string"==typeof t[t.length-1]?t[t.length-1]+=d[0]:t.push(d[0]),d=d.substring(1)}else"string"==typeof t[t.length-1]?t[t.length-1]+=d[0]:t.push(d[0]),d=d.substring(1);return new wi.ParsedFontTeX(i,t)},wi.render=function(e){for(var t=(e=a(e)).length-1;0<=t;t--){var i=e[t].getAttribute("data-fontTeX-input");null===i&&(i=e[t].getAttribute("use")||e[t].getAttribute("data-use")||e[t].innerHTML),wi.parse(i).renderIn(e[t]),e[t].setAttribute("data-fontTeX-input",i)}};var t=document.getElementsByTagName("font-tex");function e(){for(var e=t.length-1;0<=e;e--)"true"!=t[e].getAttribute("data-fontTeX-is-parsed")&&(wi.render(t[e]),t[e].setAttribute("data-fontTeX-is-parsed","true"))}function y(e,K,t){var s=[],r=e,Fe=[],Q={global:!(Fe.last=function(){return Fe[Fe.length-1]})},Z=[];function ze(i,a){function Ne(t,e){if(e=e||this,!t||"command"!=t.type&&("character"!=t.type||t.cat!=We.ACTIVE))return[t];if(t.invalid){var i=(i=("command"==t.type?t.escapeChar+t.name:t.char).split("")).map(function(e){return{type:"character",cat:We.OTHER,char:e,code:e.codePointAt(0),invalid:!0,recognized:t.recognized}});return[{type:"character",cat:We.OPEN,char:"{",code:"{".codePointAt(0),invalid:!0}].concat(i).concat({type:"character",cat:We.CLOSE,char:"}",code:"}".codePointAt(0),invalid:!0})}if(t.ignore)return[{type:"ignored command",token:t}];var a=Fe[Fe.length-1];if("command"==t.type){if(t.name in a.defs.macros){var s=a.defs.macros[t.name];if(s.proxy&&(s=s.original),"primitive"==s.type){var r=s.function.call(t,{mouth:e,tokens:a.tokens,toggles:Q,catOf:Ve,mathCodeOf:te,scopes:Fe,lastScope:Fe[Fe.length-1],openGroups:ie,contexts:Z,lastContext:Z[context.length-1]||{},Scope:ee,style:K});return t.recognized=!0,Array.isArray(r)?r:[]}t.recognized=!0;var n=Symbol();e.saveState(n);for(var l=[],o=0,c=s.parameters.length;o<c;o++){var h=s.parameters[o];if(h.cat==We.PARAMETER)if(s.parameters[o+1]&&s.parameters[o+1].cat!=We.PARAMETER){var d=s.parameters.map(function(e){return e.cat==We.PARAMETER}).indexOf(!0,o+1),p=s.parameters.slice(o+1,~d?d:1/0);l.push([]);for(var m=0;;){var f=e.eat("argument");if(!f)return t.invalid=!0,e.loadState(n),[t];if(1==f.length){var u=f,v=Symbol(),g=!1;e.saveState(v);for(var y=0;y<p.length&&(u&&(1==u.length||p[y].cat==We.OPEN&&y==p.length-1)&&u[0].type==p[y].type&&u[0].cat==p[y].cat&&u[0].code==p[y].code&&u[0].name==p[y].name);y++){if(y==p.length-1){g=!0;break}u=e.eat("argument")}if(e.loadState(v),g){e.revert();break}}l[l.length-1]=l[l.length-1].concat(f),m++}1==m&&l[l.length-1][0].cat==We.OPEN&&l[l.length-1][l[l.length-1].length-1].cat==We.CLOSE&&(l[l.length-1].shift(),l[l.length-1].pop())}else{var b=e.eat("argument");if(!b)return t.invalid=!0,e.loadState(n),[t];2<b.length&&(b.shift(),b.pop()),l.push(b)}else{var w=e.eat();if(!h||!w||h.type!=w.type||h.cat!=w.cat||h.code!=w.code||h.name!=w.name)return t.invalid=!0,e.loadState(n),[t]}}for(var x,k=[],S=0,D=s.replacement.length;S<D;S++)if(s.replacement[S].cat==We.PARAMETER){s.replacement[S+1].cat==We.PARAMETER?(k.push(s.replacement[S+1]),S++):(x=s.replacement[S+1].char-1)>l.length?k=k.concat({type:"character",cat:We.OTHER,char:s.replacement[S].char,code:macros.replacement[S].code,invalid:!0}):(k=k.concat(l[x]),S++)}else{var C={};for(var E in s.replacement[S])C[E]=s.replacement[S][E];k.push(C)}return k}if(t.name in a.defs.primitive){var A=a.defs.primitive[t.name].function.call(t,{mouth:e,tokens:a.tokens,toggles:Q,catOf:Ve,scopes:Fe,lastScope:Fe[Fe.length-1],openGroups:ie,contexts:Z,lastContext:Z[Z.length-1]||{},Scope:ee,style:K});return t.recognized=!0,Array.isArray(A)?A:[]}return t.name in a.registers.named?[a.registers.named[t.name]]:(t.invalid=!0,[t])}if("character"==t.type){if(t.char in a.defs.active){var T=a.defs.active[t.char];if(T.proxy&&(T=T.original),"primitive"==T.type){var O=T.function.call(t,{mouth:e,tokens:a.tokens,toggles:Q,catOf:Ve,scopes:Fe,lastScope:Fe[Fe.length-1],openGroups:ie,contexts:Z,lastContext:Z[Z.length-1]||{},Scope:ee,style:K});return t.recognized=!0,Array.isArray(O)?O:[]}t.recognized=!0;var L=Symbol();e.saveState(L);for(var M=[],H=0,I=T.parameters.length;H<I;H++){var R=T.parameters[H];if(R.cat==We.PARAMETER)if(T.parameters[H+1]&&T.parameters[H+1].cat!=We.PARAMETER){var q=T.parameters.map(function(e){return e.cat==We.PARAMETER}).indexOf(!0,H+1),P=T.parameters.slice(H+1,~q?q:1/0);M.push([]);for(var B=0;;){var N=e.eat("argument");if(!N)return t.invalid=!0,e.loadState(L),[t];if(1==N.length){var F=N,z=Symbol(),V=!1;e.saveState(z);for(var W=0;W<P.length&&(F&&(1==F.length||P[W].cat==We.OPEN&&W==P.length-1)&&F[0].type==P[W].type&&F[0].cat==P[W].cat&&F[0].code==P[W].code&&F[0].name==P[W].name);W++){if(W==P.length-1){V=!0;break}F=e.eat("argument")}if(e.loadState(z),V){e.revert();break}}M[M.length-1]=M[M.length-1].concat(N),B++}1==B&&M[M.length-1][0].cat==We.OPEN&&M[M.length-1][M[M.length-1].length-1].cat==We.CLOSE&&(M[M.length-1].shift(),M[M.length-1].pop())}else{var U=e.eat("argument");if(!U)return t.invalid=!0,e.loadState(L),[t];2<U.length&&(U.shift(),U.pop()),M.push(U)}else{var j=e.eat();if(!R||!j||R.type!=j.type||R.cat!=j.cat||R.code!=j.code||R.name!=j.name)return t.invalid=!0,e.loadState(L),[t]}}for(var X,G=[],_=0,$=T.replacement.length;_<$;_++)if(T.replacement[_].cat==We.PARAMETER){T.replacement[_+1].cat==We.PARAMETER?(G.push(T.replacement[_+1]),_++):(X=T.replacement[_+1].char-1)>M.length?G=G.concat({type:"character",cat:We.OTHER,char:T.replacement[_].char,code:macros.replacement[_].code,invalid:!0}):(G=G.concat(M[X]),_++)}else{var Y={};for(var J in T.replacement[_])Y[J]=T.replacement[_][J];G.push(Y)}return G}return t.invalid=!0,[t]}}this.queue=(a||s).slice(),this.string="string"==typeof i?i:r,this.history=[],this.savedStates={},this.eat=function(e){var t=void 0,i=void 0,a=void 0,s=void 0,r=void 0,n=void 0,l=void 0,o=void 0,c=void 0,h=void 0,d=void 0,p=void 0,m=void 0,f=void 0,u=void 0,v=void 0,g=void 0,y=void 0,b=void 0,w=void 0,x=void 0,k=void 0;switch(e){case void 0:case"pre space":default:if(this.queue.length)return this.queue[0].cat==We.WHITESPACE&&"pre space"!=e?(this.queue.shift(),this.eat(e)):(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),this.queue.shift());if(0==this.string.length)return null;if(Ve(this.string[0])==We.ESCAPE){if(!this.string[1]||"\n"==this.string[1])return this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),this.string=this.string.substring(2),{type:"command",escapeChar:this.string[0],name:"",nameType:"command"};if(this.string[1]==this.string[2]&&Ve(this.string[1])==We.SUPERSCRIPT&&this.string[4]&&"0123456789abcdef".includes(this.string[3])&&"0123456789abcdef".includes(this.string[4])?this.string=this.string[0]+String.fromCodePoint(parseInt(this.string.substring(3,5),16))+this.string.substring(5):this.string[1]==this.string[2]&&Ve(this.string[1])==We.SUPERSCRIPT&&this.string.codePointAt(3)<128&&(this.string=this.string[0]+String.fromCharCode((this.string.codePointAt(3)+64)%128)+this.string.substring(4)),Ve(this.string[1])==We.LETTER){for(var S="",D=1;;D++)if(Ve(this.string[D])==We.LETTER)S+=this.string[D];else if(this.string[D]==this.string[D+1]&&Ve(this.string[D])==We.SUPERSCRIPT&&"0123456789abcdef".includes(this.string[D+2])&&"0123456789abcdef".includes(this.string[D+3]))this.string=this.string.substring(0,D)+String.fromCodePoint(parseInt(this.string.substring(D+2,D+4),16))+this.string.substring(D+4),D--;else{if(!(this.string[D]==this.string[D+1]&&Ve(this.string[D])==We.SUPERSCRIPT&&this.string.codePointAt(D+2)<128))break;this.string=this.string.substring(0,D)+String.fromCodePoint((this.string.codePointAt(D+2)+64)%128)+this.string.substring(D+3),D--}this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});var C={type:"command",escapeChar:this.string[0],name:S,nameType:"command"};return this.string=this.string.substring(1+S.length),C}this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});var E={type:"command",escapeChar:this.string[0],name:this.string[1],nameType:"symbol"};return this.string=this.string.substring(2),E}if(this.string[0]==this.string[1]&&Ve(this.string[0])==We.SUPERSCRIPT&&"0123456789abcdef".includes(this.string[2])&&"0123456789abcdef".includes(this.string[3]))return this.string=String.fromCodePoint(parseInt(this.string.substring(2,4),16))+this.string.substring(4),this.eat(e);if(this.string[0]==this.string[1]&&Ve(this.string[0])==We.SUPERSCRIPT&&this.string.codePointAt(2)<128)return this.string=String.fromCodePoint((this.string.codePointAt(2)+64)%128)+this.string.substring(3),this.eat(e);if([We.OPEN,We.CLOSE,We.MATHSHIFT,We.ALIGN,We.PARAMETER,We.SUPERSCRIPT,We.SUBSCRIPT,We.LETTER,We.OTHER,We.ACTIVE].includes(Ve(this.string[0]))){this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});var A=this.string[0];return this.string=this.string.substring(1),{type:"character",char:A,code:A.codePointAt(0),cat:Ve(A)}}if(Ve(this.string[0])==We.ENDOFLINE){var T=this.string.indexOf("\n");for(this.string=this.string.substring(~T?T+1:this.string.length);Ve(this.string[0])==We.WHITESPACE;)this.string=this.string.substring(1);return"pre space"==e&&this.queue.unshift({type:"character",char:" ",code:" ".codePointAt(0),cat:We.WHITESPACE}),this.eat(e)}if(Ve(this.string[0])==We.COMMENT){var O=this.string.indexOf("\n");return this.string=this.string.substring(~O?O+1:this.string.length),this.eat(e)}if(Ve(this.string[0])==We.WHITESPACE&&"pre space"!=e||Ve(this.string[0])==We.IGNORE)return this.string=this.string.substring(1),this.eat(e);if(Ve(this.string[0])==We.WHITESPACE&&"pre space"==e){this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});var L=this.string[0];return this.string=this.string.substring(1),{type:"character",char:L,code:L.codePointAt(0),cat:We.WHITESPACE}}if(Ve(this.string[0])!=We.INVALID)break;this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});var M=this.string[0];return this.string=this.string.substring(1),{type:"character",char:M,code:M.codePointAt(0),cat:We.OTHER,invalid:!0};case"argument":t=new ze(this.string,this.queue),i=0,a=[];do{var H=t.eat();if(!H)break;H.cat==We.OPEN?i++:H.cat==We.CLOSE&&i--,a.push(H)}while(0<i);return 0<i||0==a.length?null:(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,a);case"integer":for(t=new ze(this.string,this.queue),r="start",n=0,l=!(s=1),o="pre space";;){var I=t.eat(o);if(!I)break;if("start"==r&&("command"==I.type||"character"==I.type&&I.cat==We.ACTIVE)){var R="command"==I.type?Fe[Fe.length-1].defs.primitive[I.name]||Fe[Fe.length-1].defs.macros[I.name]||Fe[Fe.length-1].registers.named[I.name]:Fe[Fe.length-1].defs.active[I.char];if(R&&R.proxy&&(R=R.original),R&&(R.register||$e.includes(R))){var q=Ne(I,t);if(1==q.length&&q[0]===I&&I.invalid){t.revert();break}t.queue.unshift.apply(t.queue,q);continue}if(R===_e.defs.primitive.relax)break;t.revert();break}if("start"!=r||I.cat!=We.WHITESPACE)if("start"==r&&I.cat==We.OTHER&&"-"==I.char)s*=-1;else{if("start"==r&&I.cat==We.OTHER&&"+"==I.char)continue;if("start"==r&&I.register){"integer"==I.type?(n=I.value,o="pre space"):"dimension"==I.type?n=I.sp.value+12*I.em.value:"mu dimension"==I.type?n=12*I.mu.value/18:"glue"==I.type?n=I.start.sp.value+12*I.start.em.value:"mu glue"==I.type&&(n=12*I.start.mu.value/18),l=!0;break}if("start"!=r){t.revert();break}o="unsigned int",t.revert()}}return l?(n*=s,this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,new Ue(n)):null;case"dimension":for(t=new ze(this.string,this.queue),r="start",s=1,h=c=!(n=" "),p=d=p=d=0,f=!(o="pre space");!h;){var P=t.eat(o);if(!P)break;if("start"==r&&("command"==P.type||"character"==P.type&&P.cat==We.ACTIVE)){var B="command"==P.type?Fe[Fe.length-1].defs.primitive[P.name]||Fe[Fe.length-1].defs.macros[P.name]||Fe[Fe.length-1].registers.named[P.name]:Fe[Fe.length-1].defs.active[P.char];if(B&&B.proxy&&(B.original=B),B&&(B.register||$e.includes(B))){var N=Ne(P,t);if(1==N.length&&N[0]===P&&P.invalid){t.revert();break}t.queue.unshift.apply(t.queue,N);continue}if(B===_e.defs.primitive.relax)break;t.revert();break}if("start"!=r||P.cat!=We.WHITESPACE)if("start"==r&&P.cat==We.OTHER&&"-"==P.char)s*=-1;else{if("start"==r&&P.cat==We.OTHER&&"+"==P.char)continue;if("start"==r&&!c&&P.register){if("integer"==P.type?(n=P.value,"decimal"==P.message&&(n/=65536),n=" "+n,o="pre space",r="unit start"):"dimension"==P.type?(d=P.sp.value,p=P.em.value,h=!0):"mu dimension"==P.type?(p=P.mu.value/18,h=!0):"glue"==P.type?(d=P.start.sp.value,p=P.start.em.value,h=!0):"mu glue"==P.type&&(p=P.start.mu.value/18,h=!0),c=!0,h)break;continue}if(c&&"unit start"==r&&P.cat==We.WHITESPACE)r="unit start";else{if(c&&P.register){n=parseFloat((n+" ").replace(" .",".").replace(". ","")||"0"),"integer"==P.type?d=n*P.value:"dimension"==P.type?(d=n*P.sp.value,p=n*P.em.value):"mu dimension"==P.type?p=n*P.mu.value/18:"glue"==P.type?(d=n*P.start.sp.value,p=n*P.start.em.value):"mu glue"==P.type&&(p=n*P.start.mu.value),h=!0;break}if(c&&!f&&("t"==P.char||"T"==P.char)){var F=t.eat("pre space");if(!F||"r"!=F.char&&"R"!=F.char||F.cat==We.ACTIVE)t.revert(2);else{var z=t.eat("pre space");if(!z||"u"!=z.char&&"U"!=F.char||z.cat==We.ACTIVE)t.revert(3);else{var V=t.eat("pre space");if(V&&("e"==V.char||"E"==V.char)&&V.cat!=We.ACTIVE){f=!0,r="unit start";continue}t.revert(4)}}break}if(!c||f||"e"!=P.char&&"E"!=P.char)if(!c||"p"!=P.char&&"P"!=P.char)if(!c||"i"!=P.char&&"I"!=P.char)if(!c||"b"!=P.char&&"B"!=P.char)if(!c||"c"!=P.char&&"C"!=P.char)if(!c||"m"!=P.char&&"M"!=P.char)if(!c||"d"!=P.char&&"D"!=P.char)if(!c||"s"!=P.char&&"S"!=P.char){if("start"!=r||c){t.revert();break}o="factor",t.revert()}else{var W=t.eat("pre space");if(!W||"p"!=W.char&&"P"!=W.char||W.cat==We.ACTIVE){t.revert(2);break}d=parseFloat((n+" ").replace(" .",".").replace(". ","")||"0"),h=!0}else{var U=t.eat("pre space");if(!U||"d"!=U.char&&"D"!=U.char||U.cat==We.ACTIVE){t.revert(2);break}d=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*1238/1157,h=!0}else{var j=t.eat("pre space");if(!j||"m"!=j.char&&"M"!=j.char||j.cat==We.ACTIVE){t.revert(2);break}d=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*72/2.54/10,h=!0}else{var X=t.eat("pre space");if(!X||"m"!=X.char&&"M"!=X.char||X.cat==We.ACTIVE){if(!X||"c"!=X.char&&"C"!=X.char||X.cat==We.ACTIVE){t.revert(2);break}d=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*1238/1157*12,h=!0}else d=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*72/2.54,h=!0}else{var G=t.eat("pre space");if(!G||"p"!=G.char&&"P"!=G.char||G.cat==We.ACTIVE){t.revert(2);break}d=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0"),h=!0}else{var _=t.eat("pre space");if(!_||"n"!=_.char&&"N"!=_.char||_.cat==We.ACTIVE){t.revert(2);break}d=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*72,h=!0}else{var $=t.eat("pre space");if(!$||"t"!=$.char&&"T"!=$.char||$.cat==We.ACTIVE)if(!$||"c"!=$.char&&"C"!=$.char||$.cat==We.ACTIVE){if(!$||"x"!=$.char&&"X"!=$.char||$.cat==We.ACTIVE){t.revert(2);break}d=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*12/16,h=!0}else d=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*12,h=!0;else d=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0"),h=!0}else{var Y=t.eat("pre space");if(!Y||"m"!=Y.char&&"M"!=Y.char||Y.cat==We.ACTIVE){if(!Y||"x"!=Y.char&&"X"!=Y.char||Y.cat==We.ACTIVE){t.revert(2);break}p=9719*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")/19200*65536}else p=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0");h=!0}}}}return c&&h?(d*=s,p*=s,this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,f?new ki(1e3*d/Fe[Fe.length-1].registers.named.mag.value,1e3*p/Fe[Fe.length-1].registers.named.mag.value):new ki(d,p)):null;case"mu dimension":for(t=new ze(this.string,this.queue),r="start",s=1,h=c=!(n=" "),m=0,f=!(o="pre space");!h;){var J=t.eat(o);if(!J)break;if("start"==r&&("command"==J.type||"character"==J.type&&J.cat==We.ACTIVE)){var K="command"==J.type?Fe[Fe.length-1].defs.primitive[J.name]||Fe[Fe.legnth-1].defs.macros[J.name]||Fe[Fe.length-1].registers.named[J.name]:Fe[Fe.length-1].defs.active[J.char];if(K&&K.proxy&&(K=K.original),K&&(K.register||$e.includes(K))){var Q=Ne(J,t);if(1==Q.length&&Q[0]===J&&J.invalid){t.revert();break}t.queue.unshift.apply(t.queue,Q);continue}if(K===_e.defs.primitive.relax)break;t.revert();break}if("start"!=r||J.cat!=We.WHITESPACE)if("start"==r&&J.cat==We.OTHER&&"-"==J.char)s*=-1;else{if("start"==r&&J.cat==We.OTHER&&"+"==J.char)continue;if("start"==r&&!c&&J.register){if("integer"==J.type?(n=J.value,"decimal"==J.message&&(n/=65536),n=" "+n,o="pre space",r="unit start"):"dimension"==J.type?(m=J.em.value/65536*18,h=!0):"mu dimension"==J.type?(m=J.mu.value/65536,h=!0):"glue"==J.type?(m=J.start.em.value/65536*18,h=!0):"mu glue"==J.type&&(m=J.start.mu.value/65536,h=!0),c=!0,h)break;continue}if(c&&"unit start"==r&&J.cat==We.WHITESPACE)r="unit start";else{if(c&&J.register&&"mu glue"==J.type){m=(n=parseFloat((n+" ").replace(" .",".").replace(". ","")||"0"))*J.start.mu.value/65536,h=!0;break}if(!c||"m"!=J.char&&"M"!=J.char){if("start"!=r||c){t.revert();break}o="factor",t.revert()}else{var Z=t.eat("pre space");if(!Z||"u"!=Z.char&&"U"!=Z.char||Z.cat==We.ACTIVE){t.revert(2);break}m=parseFloat((n+" ").replace(" .",".").replace(". ","")||"0"),h=!0}}}}return c&&h?(m*=s,this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,new je(65536*m)):null;case"glue":for(t=new ze(this.string,this.queue),r="start",o="pre space",y=g=!(v=u=s=1);;){var ee=t.eat(o);if(!ee&&("post start"!=r&&"stretch signs"!=r||"dimension"!=o)&&("post stretch"!=r&&"shrink signs"!=r||"dimension"!=o)){b&&t.loadState(b);break}if(ee||"dimension"!=o){if(("start"==r||"signs"==r||"post start"==r||"stretch signs"==r||"post stretch"==r||"shrink signs"==r)&&("command"==ee.type||"character"==ee.type&&ee.cat==We.ACTIVE)){var te="command"==ee.type?Fe[Fe.length-1].defs.primitive[ee.name]||Fe[Fe.length-1].defs.macros[ee.name]||Fe[Fe.length-1].registers.named[ee.name]:Fe[Fe.length-1].defs.active[ee.char];if(te&&te.proxy&&(te=te.original),te&&(te.register||$e.includes(te))){var ie=Ne(ee,t);if(1==ie.length&&ie[0]===ee&&ee.invalid){t.revert();break}t.queue.unshift.apply(t.queue,ie);continue}if(te===_e.defs.primitive.relax)break;t.revert();break}if(("start"==r||"signs"==r||"post start"==r||"post stretch"==r||"stretch signs"==r||"shrink signs"==r)&&ee.cat==We.WHITESPACE)continue;if("start"!=r&&"signs"!=r||ee.cat!=We.OTHER||"-"!=ee.char)if("start"!=r&&"signs"!=r||ee.cat!=We.OTHER||"+"!=ee.char){if(("start"==r||"signs"==r)&&ee.register&&"glue"==ee.type){w=new ki(ee.start.sp.value*s,ee.start.em.value*s),x=new ki(ee.stretch.sp.value*s,ee.stretch.em.value*s),k=new ki(ee.shrink.sp.value*s,ee.shrink.em.value*s),y=g=!0;break}if("start"!=r&&"signs"!=r||!ee.register||"dimension"!=ee.type)if("start"==r||"signs"==r)o="dimension",t.revert();else{if("post start"==r&&w&&!y&&!g&&"p"==ee.char){var ae=t.eat("pre space");if(ae&&("l"==ae.char||"L"==ae.char)&&ae.cat!=We.ACTIVE){var se=t.eat("pre space");if(se&&("u"==se.char||"U"==se.char)&&se.cat!=We.ACTIVE){var re=t.eat("pre space");if(re&&("s"==re.char||"S"==re.char)&&re.cat!=We.ACTIVE){y=!0;continue}}}t.loadState(b);break}if("post start"==r&&y&&ee.cat==We.OTHER&&"-"==ee.char)u*=-1,r="stretch signs";else if("post start"==r&&y&&ee.cat==We.OTHER&&"+"==ee.char)r="stretch signs";else if(("post start"==r||"stretch signs"==r)&&y&&ee.register&&"dimension"==ee.type)x=new ki(ee.sp.value*u,ee.em.value*v),r="post stretch",o="pre space",t.saveState(b=Symbol());else{if(("post start"==r||"stretch signs"==r)&&y&&ee.register&&"integer"==ee.type){o="pre space";var ne=t.eat();if(ne&&("f"==ne.char||"F"==ne.char)&&ne.cat!=We.ACTIVE){var le=t.eat("pre space");if(le&&("i"==le.char||"I"==le.char)&&le.cat!=We.ACTIVE){var oe=t.eat("pre space");if(oe&&("l"==oe.char||"L"==oe.char)&&oe.cat!=We.ACTIVE){x=!(oe=t.eat("pre space"))||"l"!=oe.char&&"L"!=oe.char||oe.cat==We.ACTIVE?(oe&&t.revert(),new Ge(ee.value*u,1)):!(oe=t.eat("pre space"))||"l"!=oe.char&&"L"!=oe.char||oe.cat==We.ACTIVE?(oe&&t.revert(),new Ge(ee.value*u,2)):new Ge(ee.value*u,3),r="post stretch",t.saveState(b=Symbol());continue}}}t.loadState(b);break}if("post start"!=r&&"stretch signs"!=r||!y){if(("post start"==r&&!y||"post stretch"==r)&&!g&&"m"==ee.char){var ce=t.eat("pre space");if(ce&&("i"==ce.char||"I"==ce.char)&&ce.cat!=We.ACTIVE){var he=t.eat("pre space");if(he&&("n"==he.char||"N"==he.char)&&he.cat!=We.ACTIVE){var de=t.eat("pre space");if(de&&("u"==de.char||"U"==de.char)&&de.cat!=We.ACTIVE){var pe=t.eat("pre space");if(pe&&("s"==pe.char||"S"==pe.char)&&pe.cat!=We.ACTIVE){g=!0;continue}}}}t.loadState(b);break}if("post stretch"==r&&g&&ee.cat==We.OTHER&&"-"==ee.char)v*=-1,r="shrink signs";else if("post stretch"==r&&g&&ee.cat==We.OTHER&&"+"==ee.char)r="shrink signs";else{if(("post stretch"==r||"shrink signs"==r||"post start"==r)&&g&&ee.register&&"dimension"==ee.type){k=new ki(ee.sp.value*v,ee.em.value*v);break}if(("post stretch"==r||"shrink signs"==r||"post start"==r)&&g&&ee.register&&"integer"==ee.type){var me=t.eat();if(me&&("f"==me.char||"F"==me.char)&&me.cat!=We.ACTIVE){var fe=t.eat("pre space");if(fe&&("i"==fe.char||"I"==fe.char)&&fe.cat!=We.ACTIVE){var ue=t.eat("pre space");if(ue&&("l"==ue.char||"L"==ue.char)&&ue.cat!=We.ACTIVE){k=!(ue=t.eat("pre space"))||"l"!=ue.char&&"L"!=ue.char||ue.cat==We.ACTIVE?(ue&&t.revert(),new Ge(ee.value*v,1)):!(ue=t.eat("pre space"))||"l"!=ue.char&&"L"!=ue.char||ue.cat==We.ACTIVE?(ue&&t.revert(),new Ge(ee.value*v,2)):new Ge(ee.value*v,3);break}}}t.loadState(b);break}if("post stretch"!=r&&"shrink signs"!=r&&"post start"!=r||!g){b?t.loadState(b):t.revert();break}o="dimension",t.revert()}}else o="dimension",t.revert()}}else w=new ki(ee.sp.value*s,ee.em.value*s),r="post start",o="pre space",t.saveState(b=Symbol())}else r="signs";else s*=-1,r="signs"}else o="factor"}return w?(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,new Si(w,x,k)):null;case"mu glue":for(t=new ze(this.string,this.queue),r="start",o="pre space",y=g=!(v=u=s=1);;){var ve=t.eat(o);if(!ve&&("post start"!=r&&"stretch signs"!=r||"mu dimension"!=o)&&("post stretch"!=r&&"shrink signs"!=r||"mu dimension"!=o)){b&&t.loadState(b);break}if(ve||"mu dimension"!=o){if(("start"==r||"signs"==r||"post start"==r||"stretch signs"==r||"post stretch"==r||"shrink signs"==r)&&("command"==ve.type||"character"==ve.type&&ve.cat==We.ACTIVE)){var ge="command"==ve.type?Fe[Fe.length-1].defs.primitive[ve.name]||Fe[Fe.length-1].defs.macros[ve.name]||Fe[Fe.length-1].registers.named[ve.name]:Fe[Fe.length-1].defs.active[ve.char];if(ge&&ge.proxy&&(ge=ge.original),ge&&(ge.register||$e.includes(ge))){var ye=Ne(ve,t);if(1==ye.length&&ye[0]===ve&&ve.invalid){t.revert();break}t.queue.unshift.apply(t.queue,ye);continue}if(ge===_e.defs.primitive.relax)break;t.revert();break}if(("start"==r||"signs"==r||"post start"==r||"post stretch"==r||"stretch signs"==r||"shrink signs"==r)&&ve.cat==We.WHITESPACE)continue;if("start"!=r&&"signs"!=r||ve.cat!=We.OTHER||"-"!=ve.char)if("start"!=r&&"signs"!=r||ve.cat!=We.OTHER||"+"!=ve.char){if(("start"==r||"signs"==r)&&ve.register&&"mu glue"==ve.type){w=new je(ve.start.mu.value*s),x=new je(ve.stretch.mu.value*s),k=new je(ve.shrink.mu.value*s),y=g=!0;break}if("start"!=r&&"signs"!=r||!ve.register||"mu dimension"!=ve.type)if("start"==r||"signs"==r)o="mu dimension",t.revert();else{if("post start"==r&&w&&!y&&!g&&"p"==ve.char){var be=t.eat("pre space");if(be&&("l"==be.char||"L"==be.char)&&be.cat!=We.ACTIVE){var we=t.eat("pre space");if(we&&("u"==we.char||"U"==we.char)&&we.cat!=We.ACTIVE){var xe=t.eat("pre space");if(xe&&("s"==xe.char||"S"==xe.char)&&xe.cat!=We.ACTIVE){y=!0;continue}}}t.loadState(b);break}if("post start"==r&&y&&ve.cat==We.OTHER&&"-"==ve.char)u*=-1,r="stretch signs";else if("post start"==r&&y&&ve.cat==We.OTHER&&"+"==ve.char)r="stretch signs";else if(("post start"==r||"stretch signs"==r)&&y&&ve.register&&"mu dimension"==ve.type)x=new je(ve.mu.value*u),r="post stretch",o="pre space",t.saveState(b=Symbol());else{if(("post start"==r||"stretch signs"==r)&&y&&ve.register&&"integer"==ve.type){o="pre space";var ke=t.eat();if(ke&&("f"==ke.char||"F"==ke.char)&&ke.cat!=We.ACTIVE){var Se=t.eat("pre space");if(Se&&("i"==Se.char||"I"==Se.char)&&Se.cat!=We.ACTIVE){var De=t.eat("pre space");if(De&&("l"==De.char||"L"==De.char)&&De.cat!=We.ACTIVE){x=!(De=t.eat("pre space"))||"l"!=De.char&&"L"!=De.char||De.cat==We.ACTIVE?(t.revert(),new Ge(ve.value*u,1)):!(De=t.eat("pre space"))||"l"!=De.char&&"L"!=De.char||De.cat==We.ACTIVE?(t.revert(),new Ge(ve.value*u,2)):new Ge(ve.value*u,3),r="post stretch",t.saveState(b=Symbol());continue}}}t.loadState(b);break}if("post start"!=r&&"stretch signs"!=r||!y){if(("post start"==r&&!y||"post stretch"==r)&&!g&&"m"==ve.char){var Ce=t.eat("pre space");if(Ce&&("i"==Ce.char||"I"==Ce.char)&&Ce.cat!=We.ACTIVE){var Ee=t.eat("pre space");if(Ee&&("n"==Ee.char||"N"==Ee.char)&&Ee.cat!=We.ACTIVE){var Ae=t.eat("pre space");if(Ae&&("u"==Ae.char||"U"==Ae.char)&&Ae.cat!=We.ACTIVE){var Te=t.eat("pre space");if(Te&&("s"==Te.char||"S"==Te.char)&&Te.cat!=We.ACTIVE){g=!0;continue}}}}t.loadState(b);break}if("post stretch"==r&&g&&ve.cat==We.OTHER&&"-"==ve.char)v*=-1,r="shrink signs";else if("post stretch"==r&&g&&ve.cat==We.OTHER&&"+"==ve.char)r="shrink signs";else{if(("post stretch"==r||"shrink signs"==r||"post start"==r)&&g&&ve.register&&"mu dimension"==ve.type){k=new je(ve.mu.value*v);break}if(("post stretch"==r||"shrink signs"==r||"post start"==r)&&g&&ve.register&&"integer"==ve.type){var Oe=t.eat();if(Oe&&("f"==Oe.char||"F"==Oe.char)&&Oe.cat!=We.ACTIVE){var Le=t.eat("pre space");if(Le&&("i"==Le.char||"I"==Le.char)&&Le.cat!=We.ACTIVE){var Me=t.eat("pre space");if(Me&&("l"==Me.char||"L"==Me.char)&&Me.cat!=We.ACTIVE){k=!(Me=t.eat("pre space"))||"l"!=Me.char&&"L"!=Me.char||Me.cat==We.ACTIVE?new Ge(ve.value*v,1):!(Me=t.eat("pre space"))||"l"!=Me.char&&"L"!=Me.char||Me.cat==We.ACTIVE?new Ge(ve.value*v,2):new Ge(ve.value*v,3);break}}}t.loadState(b);break}if("post stretch"!=r&&"shrink signs"!=r&&"post start"!=r||!g){b?t.loadState(b):t.revert();break}o="mu dimension",t.revert()}}else o="mu dimension",t.revert()}}else w=new je(ve.mu.value*s),r="post start",o="pre space",t.saveState(b=Symbol())}else r="signs";else s*=-1,r="signs"}else o="factor"}return w?(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,new Xe(w,x,k)):null;case"unsigned int":for(t=new ze(this.string,this.queue),n=0,l=!(r="start");;){var He=t.eat("pre space");if(!He)break;if("grave"==r){if("command"==He.type&&1==He.name.length)n=He.name.codePointAt(0);else{if("character"!=He.type)return null;n=He.char.codePointAt(0)}l=!0;break}if("start"==r&&("command"==He.type||"character"==He.type&&He.cat==We.ACTIVE)){var Ie="command"==He.type?Fe[Fe.length-1].defs.primitive[He.name]||Fe[Fe.length-1].defs.macros[He.name]||Fe[Fe.length-1].registers.named[He.name]:Fe[Fe.length-1].defs.active[He.char];if(Ie&&Ie.proxy&&(Ie=Ie.original),Ie&&(Ie.register||$e.includes(Ie))){var Re=Ne(He,t);if(1==Re.length&&Re[0]===He&&He.invalid){t.revert();break}t.queue.unshift.apply(t.queue,Re);continue}if(Ie===_e.defs.primitive.relax)break;t.revert();break}if("start"!=r||He.cat!=We.WHITESPACE){if("start"==r&&He.register&&"integer"==He.type){n=He.value,l=!0;break}if(("decimal"==r||"start"==r)&&He.cat==We.OTHER&&47<He.code&&He.code<58)n=10*n+parseInt(He.char,10),r="decimal",l=!0;else if("start"==r&&He.cat==We.OTHER&&"'"==He.char)r="octal";else if("start"==r&&He.cat==We.OTHER&&'"'==He.char)r="hexadecimal";else if("start"==r&&He.cat==We.OTHER&&"`"==He.char)r="grave";else if("octal"==r&&He.cat==We.OTHER&&47<He.code&&He.code<56)n=8*n+parseInt(He.char,8),l=!0;else{if("hexadecimal"!=r||!(He.cat==We.OTHER&&47<He.code&&He.code<58||(He.cat==We.OTHER||He.cat==We.LETTER)&&64<He.code&&He.code<71)){t.revert();break}n=16*n+parseInt(He.char,16),l=!0}}}return l?(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,new Ue(n)):null;case"factor":for(t=new ze(this.string,this.queue),n="",l=!(r="start"),o="pre space";;){var qe=t.eat(o);if(!qe)break;if("start"==r&&("command"==qe.type||"character"==qe.type&&qe.cat==We.ACTIVE)){var Pe="command"==qe.type?Fe[Fe.length-1].defs.primitive[qe.name]||Fe[Fe.length-1].defs.macros[qe.name]||Fe[Fe.length-1].registers.named[qe.name]:Fe[Fe.length-1].defs.active[qe.char];if(Pe&&Pe.proxy&&(Pe=Pe.original),Pe&&(Pe.register||$e.includes(Pe))){var Be=Ne(qe,t);if(1==Be.length&&Be[0]===qe&&qe.invalid){t.revert();break}t.queue.unshift.apply(t.queue,Be);continue}if(Pe===_e.defs.primitive.relax)break;t.revert();break}if("start"!=r||qe.cat!=We.WHITESPACE){if("start"==r&&qe.register&&"integer"==qe.type){n=qe.value.toString(),l=!0;break}if(("pre decimal"==r||"start"==r)&&qe.cat==We.OTHER&&47<qe.code&&qe.code<58)n+=qe.char,r="pre decimal",l=!0;else if("pre decimal"!=r&&"start"!=r||qe.cat!=We.OTHER||"."!=qe.char&&","!=qe.char)if("post decimal"==r&&qe.cat==We.OTHER&&47<qe.code&&qe.code<58)n+=qe.char;else{if("start"!=r){t.revert();break}o="unsigned int",t.revert()}else n+=".",r="post decimal",l=!0}}return l?(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,new Ue(65536*n,null,null,"decimal")):null}},this.preview=function(e){var t=this.eat(e);return t&&this.revert(),t},this.revert=function(e){for(e="number"==typeof e?e:1;0<e;e--){if(0==this.history.length)return;this.string=this.history[this.history.length-1].string;for(var t=0,i=this.history[this.history.length-1].queue.length;t<i;t++)this.queue[t]=this.history[this.history.length-1].queue[t];this.queue.length=this.history[this.history.length-1].queue.length,this.history=this.history[this.history.length-1].history}},this.finalize=function(){for(var e=0,t=this.queue.length;e<t;e++)(a||s)[e]=this.queue[e];(a||s).length=this.queue.length,"string"!=typeof i&&(r=this.string)},this.saveState=function(e){this.savedStates[e]={queue:this.queue.slice(),string:this.string,history:this.history.slice()}},this.loadState=function(e){this.string=this.savedStates[e].string,this.history=this.savedStates[e].history;for(var t=0,i=this.savedStates[e].queue.length;t<i;t++)this.queue[t]=this.savedStates[e].queue[t];this.queue.length=this.savedStates[e].queue.length},this.expand=Ne}function ee(){var e=Fe[Fe.length-1]||_e;for(var t in this.parentScope=e,this.defs={primitive:{},macros:{},active:{}},this.registers={count:{},dimen:{},skip:{},muskip:{},named:{}},this.cats={},this.mathcodes={},this.lc={},this.uc={},this.font={},e.defs.primitive)this.defs.primitive[t]=e.defs.primitive[t];for(var i in e.defs.macros)this.defs.macros[i]=e.defs.macros[i];for(var a in e.defs.active)this.defs.active[a]=e.defs.active[a];for(var s in e.lc)this.lc[s]=new Ue(e.lc[s]);for(var r in e.uc)this.uc[r]=new Ue(e.uc[r]);for(var n in e.font)this.font[n]=e.font[n];for(var l in e.cats)isNaN(l)||(this.cats[l]=new Ue(e.cats[l]));for(var o in e.mathcodes)isNaN(o)||(this.mathcodes[o]=new Ue(e.mathcodes[o]));for(var c in e.registers.count)this.registers.count[c]=new Ue(e.registers.count[c]);for(var h in e.registers.dimen)this.registers.dimen[h]=new ki(e.registers.dimen[h]);for(var d in e.registers.skip)this.registers.skip[d]=new Si(e.registers.skip[d]);for(var p in e.registers.muskip)this.registers.muskip[p]=new Xe(e.registers.muskip[p]);for(var m in e.registers.named){var f=e.registers.named[m],u="integer"==f.type?"count":"dimension"==f.type?"dimen":"glue"==f.type?"skip":"muskip";if(Object.values(e.registers[u]).includes(f))for(var v in e.registers[u])e.registers.named[m]===e.registers[u][v]&&(this.registers.named[m]=this.registers[u][v]);else this.registers.named[m]=new("integer"==f.type?Ue:"dimension"==f.type?ki:"glue"==f.type?Si:Xe)(f)}this.tokens=[],this.split=!1,Fe.push(this)}function Ve(e){return e?(e=e.codePointAt(0))in Fe[Fe.length-1].cats?Fe[Fe.length-1].cats[e].value:We.OTHER:null}function te(e){return e?(e=e.codePointAt(0))in Fe[Fe.length-1].mathcodes?Fe[Fe.length-1].mathcodes[e].value:vi.ORD:null}Object.defineProperty(Z,"last",{get:function(){return this[this.length-1]}});var i=new ze;new ee;for(var ie=[];;){var a=i.eat();if(null===a){if("standalone"==K)break;return[[],e,!1]}var n=Z[Z.length-1]||{},l=Fe[Fe.length-1];if("command"==a.type||"character"==a.type&&a.cat==We.ACTIVE){"mathchoice"==n.type&&n.failed();var o=i.expand(a,i);i.queue.unshift.apply(i.queue,o)}else{if("character"==a.type&&a.cat==We.PARAMETER)"mathchoice"==n.type&&n.failed(),i.queue.unshift({type:"character",cat:We.OTHER,char:a.char,code:a.code,invalid:!0});else if("character"==a.type&&a.cat==We.MATHSHIFT)if("mathchoice"==n.type&&n.failed(),"display"==K){for(var c=new ze(i.string,i.queue),h=!1;;){var d=c.eat();if(!d)break;if("command"!=d.type&&("character"!=d.type||d.cat!=We.ACTIVE)){if("character"!=d.type||d.cat!=We.MATHSHIFT)break;h=!0,c.finalize(),i.string=c.string;break}var p=c.expand(d,c);c.queue.unshift.apply(c.queue,p)}if(h)break;i.queue.unshift({type:"character",cat:We.OTHER,char:a.char,code:a.code,invalid:!0})}else{if("inline"==K)break;i.queue.unshift({type:"character",cat:We.OTHER,char:a.char,code:a.code,invalid:!0})}else if("character"==a.type&&a.cat==We.SUPERSCRIPT){"mathchoice"==n.type&&n.failed();for(var m,f=null,u=l.tokens.length-1;0<=u;u--)if("atom"==l.tokens[u].type&&!l.tokens[u].ignore){f=l.tokens[u];break}f||(f={type:"atom",atomType:vi.ORD,nucleus:null,superscript:null,subscript:null},l.tokens.push(f)),f.superscript?l.tokens.push({type:"atom",atomType:vi.ORD,nucleus:{type:"symbol",char:a.char,code:a.code,invalid:!0},superscript:null,subscript:null}):"superscript"==n.type||"subscript"==n.type?(f[n]=[{type:"atom",atomType:vi.ORD,nucleus:{type:"symbol",char:a.char,code:a.code,invalid:!0},superscript:null,subscript:null}],Z.pop()):(m={type:"atom",atomType:vi.ORD,nucleus:{type:"symbol",char:a.char,code:a.code},superscript:null,subscript:null,ignore:!0},l.tokens.push(m),Z.push({toString:function(){return"superscript"},type:"superscript",token:m}))}else if("character"==a.type&&a.cat==We.SUBSCRIPT){"mathchoice"==n.type&&n.failed();for(var v,g=null,y=l.tokens.length-1;0<=y;y--)if("atom"==l.tokens[y].type&&!l.tokens[y].ignore){g=Fe.last().tokens[y];break}g||(g={type:"atom",atomType:vi.ORD,nucleus:null,superscript:null,subscript:null},l.tokens.push(g)),g.subscript?l.tokens.push({type:"atom",atomType:vi.ORD,nucleus:{type:"symbol",char:a.char,code:a.code,invalid:!0},superscript:null,subscript:null}):"superscript"==n.type||"subscript"==n.type?(g[n]=[{type:"atom",atomType:vi.ORD,nucleus:{type:"symbol",char:a.char,code:a.code,invalid:!0},superscript:null,subscript:null}],Z.pop()):(v={type:"atom",atomType:vi.ORD,nucleus:{type:"symbol",char:a.char,code:a.code},superscript:null,subscript:null,ignore:!0},l.tokens.push(v),Z.push({toString:function(){return"subscript"},type:"subscript",token:v}))}else if("character"==a.type&&a.cat==We.OPEN){var b={type:"atom",atomType:vi.ORD,nucleus:{type:"symbol",char:a.char,code:a.code},superscript:null,subscript:null,ignore:!0};ie.push(b),Z.push({toString:function(){return"scope"},type:"scope"}),new ee,Fe[Fe.length-1].tokens.push(b)}else if("character"==a.type&&a.cat==We.CLOSE)if(1==Fe.length||!ie.length||l.delimited||l.semisimple||l.isHalign||l.isHalignCell||"scope"!=n)i.queue.unshift({type:"character",cat:We.OTHER,char:a.char,code:a.code,invalid:!0});else{ie.pop(),Z.pop(),n=Z[Z.length-1]||{};var w=void 0,w=l.isFrac?[{type:"atom",atomType:vi.INNER,nucleus:[{type:"fraction",numerator:l.fracNumerator,denominator:l.tokens,barWidth:l.barWidth,delims:[l.fracLeftDelim,l.fracRightDelim],nullDelimiterSpace:new ki(l.registers.named.nulldelimiterspace)}],superscript:null,subscript:null}]:l.tokens;if(l.root&&(l.root.invalid=!0),Fe[Fe.length-2]&&Fe[Fe.length-2].noAligned)Fe[Fe.length-3].noAligns.push({type:"atom",atomType:vi.ORD,nucleus:w,superscript:null,subscript:null}),Fe.pop();else if("superscript"==n.type){Fe.pop();for(var x=(l=Fe[Fe.length-1]).tokens.length-1;0<=x;x--)if("atom"==l.tokens[x].type&&!l.tokens[x].ignore){l.tokens[x].superscript=w;break}Z.pop()}else if("subscript"==n.type){Fe.pop();for(var k=(l=Fe[Fe.length-1]).tokens.length-1;0<=k;k--)if("atom"==l.tokens[k].type&&!l.tokens[k].ignore){l.tokens[k].subscript=w;break}Z.pop()}else l.isFrac?(Fe.pop(),Fe[Fe.length-1].tokens.push(w[0])):(Fe.pop(),Fe[Fe.length-1].tokens.push({type:"atom",atomType:vi.ORD,nucleus:w,superscript:null,subscript:null})),"mathchoice"==n.type&&4==++n.current&&n.succeeded()}else if("character"==a.type&&a.cat==We.ALIGN){"mathchoice"==n.type&&n.failed();for(var S=!1,D=Fe.length-1;0<=D;D--)if(Fe[D].isHalignCell){S=Fe[D];break}if(!S){i.queue.unshift({type:"character",cat:We.OTHER,char:a.char,code:a.code,invalid:!0});continue}var C=S.parentScope,E=C.cellData[C.cellData.length-1];if(E[E.length-1].omit&&(a.postPreamble=!0),a.postPreamble&&!l.isHalignCell||"scope"!=n){i.queue.unshift({type:"character",cat:We.OTHER,char:a.char,code:a.code,invalid:!0});continue}if(!a.postPreamble){for(var A=-1,T=0,O=E.length;T<O;T++)A+=E[T].span;var L=void 0;if(C.preamble[A])L=C.preamble[A][1];else{if(!~C.repeatPreambleAt){i.queue.unshift({type:"character",cat:We.OTHER,char:a.char,code:a.code,invalid:!0});continue}var M=C.preamble.slice(C.repeatPreambleAt,C.preamble.length),L=M[(A-C.repeatPreambleAt)%M.length][1]}if(!C.preamble[++A]&&!~C.repeatPreambleAt){i.queue.unshift({type:"character",cat:We.OTHER,char:a.char,code:a.code,invalid:!0});continue}for(var H=[],I=0,R=L.length;I<R;I++){var q={};for(var P in L[I])q[P]=L[I][P];H.push(q)}i.queue.unshift.apply(i.queue,H.concat(a)),a.postPreamble=!0;continue}l.root&&(l.root.invalid=!0),Z.pop(),n=Z[Z.length-1]||{};var B=l.tokens;l.isFrac?(E[E.length-1].content.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:l.fracNumerator,denominator:B,barWidth:l.barWidth,delims:[l.fracLeftDelim,l.fracRightDelim],nullDelimiterSpace:new ki(l.registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),Fe.pop()):(Fe.pop(),E[E.length-1].content=E[E.length-1].content.concat(B)),l=Fe[Fe.length-1];var N=Symbol();for(i.saveState(N),E.push({type:"cell",content:[],omit:!1,span:1});;){var F=i.eat();if(!F){i.loadState(N);break}if("character"==F.type&&F.cat!=We.ACTIVE){i.loadState(N);break}if("command"==F.type||"character"==F.type&&F.cat==We.ACTIVE){if(F.name in l.registers.named){i.loadState(N);break}var z="command"==F.type?l.defs.primitive[F.name]||l.defs.macros[F.name]:l.defs.active[F.char];if(!z){i.loadState(N);break}if(z.proxy&&(z=z.original),Ee.includes(z)){var V=i.expand(F,i);if(1==V.length&&V[0]===F&&F.invalid){i.loadState(N);break}i.queue.unshift.apply(i.queue,V);continue}if(z===_e.defs.primitive.omit){E[E.length-1].omit=!0;break}if("primitive"==z.type){i.loadState(N);break}var W=i.expand(F,i);if(1==W.length&&W[0]==-F&&F.invalid){i.loadState(N);break}i.queue.unshift.apply(i.queue,W)}}if(Z.push({toString:function(){return"scope"},type:"scope"}),new ee,Fe[Fe.length-1].isHalignCell=!0,!E[E.length-1].omit){for(var U,j=-1,X=0,G=E.length;X<G;X++)j+=E[X].span;C.preamble[j]?B=C.preamble[j][0]:~C.repeatPreambleAt&&(B=(U=C.preamble.slice(C.repeatPreambleAt,C.preamble.length))[(j-C.repeatPreambleAt)%U.length][0]);for(var _=[],$=0,Y=B.length;$<Y;$++){var J={};for(var ae in B[$])J[ae]=B[$][ae];_.push(J)}i.queue.unshift.apply(i.queue,_)}}else if("character"==a.type){"mathchoice"==n.type&&n.failed();var se={type:"symbol",char:a.char,code:a.code,invalid:a.invalid},re=a.forcedMathCode+1?a.forcedMathCode:te(se.char);if(a.invalid&&a.recognized&&(re=0),re==We.ACTIVE){if(l.defs.active[a.char]){i.queue.unshift.apply(i.queue,(l.defs.active[a.char].replacement||l.defs.active[a.char].original.replacement).slice());continue}a.invalid=se.invalid=!0,re=0}if("superscript"==n.type){for(var ne=l.tokens.length-1;0<=ne;ne--)if("atom"==l.tokens[ne].type&&!l.tokens[ne].ignore){l.tokens[ne].superscript=[{type:"atom",atomType:re,nucleus:se,superscript:null,subscript:null}];break}Z.pop()}else if("subscript"==n.type){for(var le=l.tokens.length-1;0<=le;le--)if("atom"==l.tokens[le].type&&!l.tokens[le].ignore){l.tokens[le].subscript=[{type:"atom",atomType:re,nucleus:se,superscript:null,subscript:null}];break}Z.pop()}else l.tokens.push({type:"atom",atomType:re,nucleus:se,superscript:null,subscript:null})}else if(a.register){"mathchoice"==n.type&&n.failed();var oe=Symbol();i.saveState(oe);var ce=i.eat();if(!ce||"character"==ce.type&&"="==ce.char&&ce.cat==We.OTHER||i.revert(),"integer"==a.type){var he=i.eat("integer");if(he){if(he.value<a.min||a.max<he.value){i.loadState(oe);continue}var de=a;if(Q.global&&0<=l.registers.named.globaldefs.value||0<l.registers.named.globaldefs.value)for(;a.parent;)(a=a.parent).value=he.value;de.value=he.value,Q.global=!1}else i.loadState(oe)}else if("dimension"==a.type){var pe=i.eat("dimension");if(pe){if(a.sp.value=pe.sp.value,a.em.value=pe.em.value,Q.global&&0<=l.registers.named.globaldefs.value||0<l.registers.named.globaldefs.value)for(;a.parent;)(a=a.parent).sp.value=pe.sp.value,a.em.value=pe.em.value;Q.global=!1}else i.loadState(oe)}else if("mu dimension"==a.type){var me=i.eat("mu dimension");if(me){if(a.mu.value=me.mu.value,Q.global&&0<=l.registers.named.globaldefs.value||0<l.registers.named.globaldefs.value)for(;a.parent;)(a=a.parent).mu.value=integer.mu.value;Q.global=!1}else i.loadState(oe)}else if("glue"==a.type){var fe=i.eat("glue");if(fe){if(a.start.sp.value=fe.start.sp.value,a.start.em.value=fe.start.em.value,"infinite dimension"==fe.stretch.type?a.stretch=new Ge(fe.stretch.number.value,fe.stretch.magnitude.value):a.stretch=new ki(fe.stretch.sp.value,fe.stretch.em.value),"infinite dimension"==fe.shrink.type?a.shrink=new Ge(fe.shrink.number.value,fe.shrink.magnitude.value):a.shrink=new ki(fe.shrink.sp.value,fe.shrink.em.value),Q.global&&0<=l.registers.named.globaldefs.value||0<l.registers.named.globaldefs.value)for(;a.parent;)(a=a.parent).start.sp.value=fe.start.sp.value,a.start.em.value=fe.start.em.value,"infinite dimension"==fe.stretch.type?a.stretch=new Ge(fe.stretch.number.value,fe.stretch.magnitude.value):a.stretch=new ki(fe.stretch.sp.value,fe.stretch.em.value),"infinite dimension"==fe.shrink.type?a.shrink=new Ge(fe.shrink.number.value,fe.shrink.magnitude.value):a.shrink=new ki(fe.shrink.sp.value,fe.shrink.em.value);Q.global=!1}else i.loadState(oe)}else if("mu glue"==a.type){var ue=i.eat("mu glue");if(ue){if(a.start.mu.value=ue.start.mu.value,"infinite dimension"==ue.stretch.type?a.stretch=new Ge(ue.stretch.number.value,ue.stretch.magnitude.value):a.stretch=new je(ue.stretch.mu.value),"infinite dimension"==ue.shrink.type?a.shrink=new Ge(ue.shrink.number.value,ue.shrink.magnitude.value):a.shrink=new je(ue.shrink.mu.value),Q.global&&0<=l.registers.named.globaldefs.value||0<l.registers.named.globaldefs.value)for(;a.parent;)(a=a.parent).start.mu.value=ue.start.mu.value,"infinite dimension"==ue.stretch.type?a.stretch=new Ge(ue.stretch.number.value,ue.stretch.magnitude.value):a.stretch=new je(ue.stretch.mu.value),"infinite dimension"==ue.shrink.type?a.shrink=new Ge(ue.shrink.number.value,ue.shrink.magnitude.value):a.shrink=new je(ue.shrink.mu.value);Q.global=!1}else i.loadState(oe)}}else if("ignored command"==a.type){l.tokens.push(a.token);continue}for(var ve in Q)Q[ve]&&(Q[ve].invalid=!0,Q[ve]=!1)}}var ge,ye=Z[Z.length-1]||{};for("superscript"!=ye&&"subscript"!=ye||(ye.token.invalid=!0,ye.token.ignore=!1);1<Fe.length;){Z.pop();var be=Z[Z.length-1]||{},we=Fe[Fe.length-1],xe=we.tokens;if(we.root&&(we.root.invalid=!0),"superscript"==be.type){Fe.pop();for(var ke=(we=Fe[Fe.length-1]).tokens.length-1;0<=ke;ke--)if("atom"==we.tokens[ke].type&&!we.tokens[ke].ignore){we.tokens[ke].superscript=xe;break}Z.pop(),be=Z[Z.length-1]||{}}else if("subscript"==be.type){Fe.pop();for(var Se=(we=Fe[Fe.length-1]).tokens.length-1;0<=Se;Se--)if("atom"==we.tokens[Se].type&&!we.tokens[Se].ignore){we.tokens[Se].subscript=xe;break}Z.pop(),be=Z[Z.length-1]||{}}else we.isFrac?(Fe[Fe.length-2].tokens.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:we.fracNumerator,denominator:xe,barWidth:we.barWidth,delims:[we.fracLeftDelim,we.fracRightDelim],nullDelimiterSpace:new ki(we.registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),Fe.pop(),we=Fe[Fe.length-1]):(Fe.pop(),(we=Fe[Fe.length-1]).tokens.push({type:"atom",atomType:vi.ORD,nucleus:xe,superscript:null,subscript:null}))}Fe[0].isFrac&&(ge=Fe[0].tokens,Fe[0].tokens=[{type:"atom",atomType:vi.INNER,nucleus:[{type:"fraction",numerator:Fe[0].fracNumerator,denominator:ge,barWidth:Fe[0].barWidth,delims:[Fe[0].fracLeftDelim,Fe[0].fracRightDelim],nullDelimiterSpace:new ki(Fe[0].registers.named.nulldelimiterspace)}],superscript:null,subscript:null}]);for(var De=0,Ce=ie.length;De<Ce;De++)ie[De].invalid=!0;return function l(o){for(var c=0,h=o.length;c<h;c++)!function(t,e){var i;if(o[t]&&o[t].ignore&&"command"==o[t].type)o[t].invalid?(i=(o[t].escapeChar+o[t].name).split("").map(function(e){return{type:"atom",atomType:o[t].recognized?vi.ORD:vi.VARIABLE,nucleus:{type:"symbol",char:e,code:e.codePointAt(0),invalid:!0},superscript:null,subscript:null}}),o.splice(t,1,{type:"atom",atomType:vi.ORD,nucleus:i,superscript:null,subscript:null})):o.splice(t,1),e=o.length,t--;else if(o[t]&&o[t].ignore&&!o[t].invalid)o.splice(t,1),e=o.length,t--;else if(o[t]&&"fraction"==o[t].type)l(o[t].numerator),l(o[t].denominator);else if(o[t]&&"table"==o[t].type){l(o[t].noAligns);for(var a=0,s=o[t].cellData.length;a<s;a++)for(var r=0,n=o[t].cellData[a].length;r<n;r++)l(o[t].cellData[a][r].content)}else o[t]&&"atom"==o[t].type?(Array.isArray(o[t].nucleus)&&l(o[t].nucleus),Array.isArray(o[t].superscript)&&l(o[t].superscript),Array.isArray(o[t].subscript)&&l(o[t].subscript)):o[t]&&"mathchoice"==o[t].type?l(o[t].groups):o[t]&&"box"==o[t].type?l([o[t].content]):o[t]&&"family modifier"==o[t].type&&"rad"==o[t].value&&l(o[t].index);c=t,h=e}(c,h)}(Fe[0].tokens),function e(t){for(var i,a=0,s=t.length;a<s;a++)if(t[a]&&"family modifier"==t[a].type)t[a+1]&&"atom"==t[a+1].type?("phantom"==t[a].value?(t.splice(a,1),t[a].phantom=!0):(t.splice(a,2,{type:"atom",atomType:t[a].value,nucleus:[t[a+1]],superscript:t[a+1].superscript,subscript:t[a+1].subscript,invalid:t[a+1].invalid,index:t[a].index,phantom:t[a+1].phantom}),t[a].nucleus[0].superscript=null,t[a].nucleus[0].subscript=null,a--),s=t.length):(i=("command"==t[a].token.type?t[a].token.escapeChar+t[a].token.name:t[a].token.char).split("").map(function(e){return{type:"atom",atomType:vi.ORD,nucleus:{type:"symbol",char:e,code:e.codePointAt(0),invalid:!0},superscript:null,subscript:null}}),t[a]={type:"atom",atomType:vi.ORD,nucleus:i,superscript:null,subscript:null});else if(t[a]&&"fraction"==t[a].type)e(t[a].numerator),e(t[a].denominator);else if(t[a]&&"table"==t[a].type){e(t[a].noAligns);for(var r=0,n=t[a].cellData.length;r<n;r++)for(var l=0,o=t[a].cellData[r].length;l<o;l++)e(t[a].cellData[r][l].content)}else t[a]&&"atom"==t[a].type?(Array.isArray(t[a].nucleus)&&e(t[a].nucleus),Array.isArray(t[a].superscript)&&e(t[a].superscript),Array.isArray(t[a].subscript)&&e(t[a].subscript),Array.isArray(t[a].index)&&e(t[a].index)):t[a]&&"mathchoice"==t[a].type?e(t[a].groups):t[a]&&"box"==t[a].type&&e([t[a].content])}(Fe[0].tokens),function e(t){for(var i,a=0,s=t.length;a<s;a++)if(t[a]&&"accent modifier"==t[a].type)t[a+1]&&"atom"==t[a+1].type?(t.splice(a,2,{type:"atom",atomType:vi.ACC,nucleus:[t[a+1]],superscript:t[a+1].superscript,subscript:t[a+1].subscript,accChar:t[a].char,accCode:t[a].code,invalid:t[a+1].invalid,phantom:t[a+1].phantom}),t[a].nucleus[0].superscript=null,t[a].nucleus[0].subscript=null,s=t.length,a--):(i=("command"==t[a].token.type?t[a].token.escapeChar+t[a].token.name:t[a].token.char).split("").map(function(e){return{type:"atom",atomType:vi.ORD,nucleus:{type:"symbol",char:e,code:e.codePointAt(0),invalid:!0},superscript:null,subscript:null}}),t[a]={type:"atom",atomType:vi.ORD,nucleus:i,superscript:null,subscript:null});else if(t[a]&&"fraction"==t[a].type)e(t[a].numerator),e(t[a].denominator);else if(t[a]&&"table"==t[a].type){e(t[a].noAligns);for(var r=0,n=t[a].cellData.length;r<n;r++)for(var l=0,o=t[a].cellData[r].length;l<o;l++)e(t[a].cellData[r][l].content)}else t[a]&&"atom"==t[a].type?(Array.isArray(t[a].nucleus)&&e(t[a].nucleus),Array.isArray(t[a].superscript)&&e(t[a].superscript),Array.isArray(t[a].subscript)&&e(t[a].subscript),Array.isArray(t[a].index)&&e(t[a].index)):t[a]&&"mathchoice"==t[a].type?e(t[a].groups):t[a]&&"box"==t[a].type&&e([t[a].content])}(Fe[0].tokens),function e(t){for(var i,a=0,s=t.length;a<s;a++)if(t[a]&&"limit modifier"==t[a].type)t[a-1]&&"atom"==t[a-1].type&&t[a-1].atomType==vi.OP?(t[a-1].limits=t[a].value,t.splice(a,1),s=t.length,a--):(i=("command"==t[a].token.type?t[a].token.escapeChar+t[a].token.name:t[a].token.char).split("").map(function(e){return{type:"atom",atomType:vi.ORD,nucleus:{type:"symbol",char:e,code:e.codePointAt(0),invalid:!0},superscript:null,subscript:null}}),t[a]={type:"atom",atomType:vi.ORD,nucleus:i,superscript:null,subscript:null});else if(t[a]&&"fraction"==t[a].type)e(t[a].numerator),e(t[a].denominator);else if(t[a]&&"table"==t[a].type){e(t[a].noAligns);for(var r=0,n=t[a].cellData.length;r<n;r++)for(var l=0,o=t[a].cellData[r].length;l<o;l++)e(t[a].cellData[r][l].content)}else t[a]&&"atom"==t[a].type?(t[a].atomType==vi.OP&&(t[a].limits="display"),Array.isArray(t[a].nucleus)&&e(t[a].nucleus),Array.isArray(t[a].superscript)&&e(t[a].superscript),Array.isArray(t[a].subscript)&&e(t[a].subscript),Array.isArray(t[a].index)&&e(t[a].index)):t[a]&&"mathchoice"==t[a].type?e(t[a].groups):t[a]&&"box"==t[a].type&&e([t[a].content])}(Fe[0].tokens),function e(t){for(var i,a=0,s=t.length;a<s;a++)if(t[a]&&"box wrapper"==t[a].type)t[a+1]&&"atom"==t[a+1].type?(t.splice(a,2,{type:"box",boxType:t[a].value,to:t[a].to,spread:t[a].spread,content:t[a+1],superscript:null,subscript:null}),s=t.length,a--):(i=("command"==t[a].token.type?t[a].token.escapeChar+t[a].token.name:t[a].token.char).split("").map(function(e){return{type:"atom",atomType:vi.ORD,nucleus:{type:"symbol",char:e,code:e.codePointAt(0),invalid:!0},superscript:null,subscript:null}}),t[a]={type:"atom",atomType:vi.ORD,nucleus:i,superscript:null,subscript:null});else if(t[a]&&"fraction"==t[a].type)e(t[a].numerator),e(t[a].denominator);else if(t[a]&&"table"==t[a].type){e(t[a].noAligns);for(var r=0,n=t[a].cellData.length;r<n;r++)for(var l=0,o=t[a].cellData[r].length;l<o;l++)e(t[a].cellData[r][l].content)}else t[a]&&"atom"==t[a].type?(Array.isArray(t[a].nucleus)&&e(t[a].nucleus),Array.isArray(t[a].superscript)&&e(t[a].superscript),Array.isArray(t[a].subscript)&&e(t[a].subscript),Array.isArray(t[a].index)&&e(t[a].index)):t[a]&&"mathchoice"==t[a].type?e(t[a].groups):t[a]&&"box"==t[a].type&&e([t[a].content])}(Fe[0].tokens),function e(t){for(var i=0,a=t.length;i<a;i++)if(t[i]&&"atom"==t[i].type){if(Array.isArray(t[i].nucleus)&&e(t[i].nucleus),Array.isArray(t[i].superscript)&&e(t[i].superscript),Array.isArray(t[i].subscript)&&e(t[i].subscript),Array.isArray(t[i].index)&&e(t[i].index),Array.isArray(t[i].nucleus)&&1==t[i].nucleus.length&&!t[i].nucleus[0].delimited)if([vi.ORD,vi.BIN,vi.REL,vi.OPEN,vi.CLOSE,vi.PUNCT,vi.INNER].includes(t[i].nucleus[0].atomType)&&![vi.OVER,vi.UNDER,vi.RAD].includes(t[i].atomType)){if(!t[i].nucleus[0].superscript&&!t[i].nucleus[0].subscript){t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].nucleus=t[i].nucleus[0].nucleus,i--;continue}if(!t[i].superscript&&!t[i].subscript){t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].superscript=t[i].nucleus[0].superscript,t[i].subscript=t[i].nucleus[0].subscript,t[i].nucleus=t[i].nucleus[0].nucleus,i--;continue}}else if(t[i].nucleus[0].atomType==vi.VARIABLE&&t[i].atomType==vi.ORD){if(!t[i].nucleus[0].superscript&&!t[i].nucleus[0].subscript){t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].nucleus=t[i].nucleus[0].nucleus,t[i].atomType=vi.VARIABLE,i--;continue}if(!t[i].superscript&&!t[i].subscript){t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].superscript=t[i].nucleus[0].superscript,t[i].subscript=t[i].nucleus[0].subscript,t[i].nucleus=t[i].nucleus[0].nucleus,t[i].atomType=vi.VARIABLE,i--;continue}}else t[i].nucleus[0].atomType!=vi.VARIABLE&&[vi.OVER,vi.UNDER,vi.RAD,vi.ACC].includes(t[i].atomType)&&(t[i].nucleus[0].superscript||t[i].nucleus[0].subscript||(t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].nucleus=t[i].nucleus[0].nucleus))}else if(t[i]&&"fraction"==t[i].type)t[i].numerator&&Array.isArray(t[i].numerator)&&1==t[i].numerator.length&&!t[i].numerator.subscript&&!t[i].numerator.superscript&&Array.isArray(t[i].numerator[0].nucleus)&&(t[i].numerator=t[i].numerator[0].nucleus),t[i].denominator&&Array.isArray(t[i].denominator)&&1==t[i].denominator.length&&!t[i].denominator.subscript&&!t[i].denominator.superscript&&Array.isArray(t[i].denominator[0].nucleus)&&(t[i].denominator=t[i].denominator[0].nucleus),e(t[i].numerator),e(t[i].denominator);else if(t[i]&&"table"==t[i].type){e(t[i].noAligns);for(var s=0,r=t[i].cellData.length;s<r;s++)for(var n=0,l=t[i].cellData[s].length;n<l;n++)e(t[i].cellData[s][n].content)}else t[i]&&"mathchoice"==t[i].type?e(t[i].groups):t[i]&&"box"==t[i].type&&e(t[i].content.nucleus)}(Fe[0].tokens),i.finalize(),t&&t?Fe[0]:[Fe[0].tokens,r,!0]}function D(di,e,M,pi){var t=document.createElement("div");"display"==M?t.style.textAlign="center":t.style.display="inline-block";var mi=parseFloat(pi.fontSize),fi=pi.fontFamily;function ui(e){for(var t=0,i=e.children.length;t<i;t++)ui(e.children[t]);return e.style.flexWrap&&(e.style.flexWrap="nowrap"),e}return function ii(ai,si,ri,ni,e){ai=ai.slice();if(!ai.length){var t=document.createElement("div");return t.style.display="inline-flex",t.displayedStyle=si,t.crampedStyle=ri,t.renderedDepth=0,t.renderedHeight=0,e.renderedHeight=e.renderedHeight||0,e.renderedDepth=e.renderedDepth||0,e.baseline=wi.fontDimen.baselineHeightOf(fi),e.baselineOffset=0,e.appendChild(t),void(t.empty=!0)}var li=null;var oi=document.createElement("div");oi.style.display="inline-flex";oi.style.flexWrap="wrap";oi.style.alignItems="baseline";oi.displayedStyle=si;oi.crampedStyle=ri;oi.style.justifyContent="display"==M?"center":"initial";var i=[document.createElement("div")];i[0].style.display="inline-flex";i[0].style.flexWrap="nowrap";i[0].style.alignItems="baseline";var ci=[];var hi=[];var a=0;var s=function(e){var q=ai[e],t=ai[e+1]||{};ai[e-1];if(["glue","kern","vglue","vkern"].includes(q.type))return q.italicCorrection&&(q.italicCorrection=li||""),"glue"==q.type&&q.isNonScript&&("script"==si||"scriptscript"==si)&&["glue","vglue","kern","vkern"].includes(t.type)?ai.splice(e+1,1):("glue"==q.type&&"mu glue"==q.glue.type?q.glue=new Si(new ki(0,q.glue.start.mu.value/18),"infinite dimension"==q.glue.stretch.type?q.glue.stretch:new ki(0,Math.floor(q.glue.stretch.mu.value/18)),"infinite dimension"==q.glue.shrink.type?q.glue.shrink:new ki(0,~~(q.glue.shrink.mu.value/18))):"kern"==q.type&&"mu dimension"==q.dimen.type?q.dimen=new ki(0,Math.floor(q.dimen.mu.value/18)):"vglue"==q.type&&(q.type="vkern",q.dimen=q.glue.start,delete q.glue),ci.push(q)),"continue";if("font modifier"==q.type)return["displaystyle","textstyle","scriptstyle","scriptscriptstyle"].includes(q.value)?si=q.value.substring(0,q.value.length-5):ni=q.value,"continue";if("mathchoice"==q.type){var i=q.groups[["display","text","script","scriptscript"].indexOf(si)];return ai.splice.apply(ai,[e+1,0].concat("symbol"==i.nucleus.type?[i]:i.nucleus)),"continue"}if("atom"!=q.type||q.atomType!=vi.BIN||hi.length&&![vi.OP,vi.BIN,vi.REL,vi.OPEN,vi.PUNCT].includes(hi[hi.length-1].atomType)||(q.atomType=vi.ORD),"atom"!=q.type||!hi.length||q.atomType!=vi.REL&&q.atomType!=vi.CLOSE&&q.atomType!=vi.PUNCT||hi[hi.length-1].atomType!=vi.BIN||(hi[hi.length-1].atomType=vi.ORD),"atom"==q.type&&q.atomType==vi.OP&&"display"==q.limits&&(q.limits="display"==si),"fraction"==q.type){var a=function(e,t,i,a){var s=void 0,r=void 0,n=void 0,l=void 0,o=void 0,c=void 0,h=void 0,d=void 0,p=void 0,m=void 0;switch(t){case".":default:ci.splice(ci.length-(i?1:0),0,{type:"kern",dimen:q.nullDelimiterSpace});break;case"|":case"/":case"\\":case"‖":case"⎪":case"⏐":case"⟨":case"⟩":s=Math.max(P,wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),e.style.height="".concat(s,"em"),e.style.width="".concat(wi.fontDimen.widthOf(t,fi),"em"),e.style.verticalAlign="middle",e.height=a,e.width=wi.fontDimen.widthOf(t,fi)/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi))*a,(r=e.getContext("2d")).textAlign="center",r.fillStyle=pi.color,r.font="".concat(a/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),"px ").concat(fi),r.fillText(t,e.width/2,a-wi.fontDimen.depthOf(t,fi)*a/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi))),q.div.insertBefore(e,i?q.div.firstElementChild:null);break;case"(":case")":if(s=Math.max(P,wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),e.style.height="".concat(s,"em"),e.style.width="".concat(wi.fontDimen.widthOf(t,fi),"em"),e.style.verticalAlign="middle",Math.floor(Math.floor(a/2*s)-a)<=0)e.height=a,e.width=wi.fontDimen.widthOf(t,fi)/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi))*a,(r=e.getContext("2d")).textAlign="center",r.fillStyle=pi.color,r.font="".concat(a/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),"px ").concat(fi),r.fillText(t,e.width/2,a-wi.fontDimen.depthOf(t,fi)*a/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)));else if(n=wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi),e.height=Math.max(s,1)*a,e.width=wi.fontDimen.widthOf(t,fi)/wi.fontDimen.heightOf(t,fi)*a*(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),(r=e.getContext("2d")).textAlign="center",r.fillStyle=pi.color,r.font="".concat(a/n,"px ").concat(fi),r.fillText(t,e.width/2,a/2-wi.fontDimen.depthOf(t,fi)*a*n),c=r.getImageData(0,0,e.width,a/2),r.clearRect(0,0,e.width,e.height),r.fillText(t,e.width/2,a-wi.fontDimen.depthOf(t,fi)*a/n),r.clearRect(0,a/2,e.width,e.height),r.putImageData(c,0,e.height-a/2),e.height>a){l=r.createImageData(e.width,e.height-a),p=r.getImageData(0,a/2-1,e.width,1).data,m=c.data.slice(0,4*e.width);for(var f=0,u=l.height/2;f<u;f++)for(var v=0,g=e.width;v<g;v++){var y=f*e.width*4+4*v;l.data[y]=p[4*v+0],l.data[1+y]=p[4*v+1],l.data[2+y]=p[4*v+2],l.data[3+y]=p[4*v+3],y=~~(f+l.height/2)*e.width*4+4*v,l.data[y]=m[4*v+0],l.data[1+y]=m[4*v+1],l.data[2+y]=m[4*v+2],l.data[3+y]=m[4*v+3]}r.putImageData(l,0,a/2)}q.div.insertBefore(e,i?q.div.firstElementChild:null);break;case"[":case"]":case"⟮":case"⟯":case"↑":case"↓":case"↕":case"⇑":case"⇓":case"⇕":case"⌈":case"⌉":case"⌊":case"⌋":case"⎰":case"⎱":if(R=wi.fontDimen.heightOf("x",fi)/2,s=Math.max(P,wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),e.style.height="".concat(s,"em"),e.style.width="".concat(wi.fontDimen.widthOf(t,fi),"em"),e.style.verticalAlign="middle",n=wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi),e.height=Math.max(s,1)*a,e.width=wi.fontDimen.widthOf(t,fi)/wi.fontDimen.heightOf(t,fi)*a*(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),(r=e.getContext("2d")).textAlign="center",r.fillStyle=pi.color,r.font="".concat(a/n,"px ").concat(fi),r.fillText(t,e.width/2,a/2-wi.fontDimen.depthOf(t,fi)*a*n),c=r.getImageData(0,0,e.width,a/2),r.clearRect(0,0,e.width,e.height),r.fillText(t,e.width/2,a-wi.fontDimen.depthOf(t,fi)*a/n),r.clearRect(0,a/2,e.width,e.height),r.putImageData(c,0,e.height-a/2),e.height>a){l=r.createImageData(e.width,e.height-a),p=r.getImageData(0,a/2-1,e.width,1).data,m=c.data.slice(0,4*e.width);for(var b=0,w=l.height/2;b<w;b++)for(var x=0,k=e.width;x<k;x++){var S=b*e.width*4+4*x;l.data[S]=p[4*x+0],l.data[1+S]=p[4*x+1],l.data[2+S]=p[4*x+2],l.data[3+S]=p[4*x+3],S=~~(b+l.height/2)*e.width*4+4*x,l.data[S]=m[4*x+0],l.data[1+S]=m[4*x+1],l.data[2+S]=m[4*x+2],l.data[3+S]=m[4*x+3]}r.putImageData(l,0,a/2)}q.div.insertBefore(e,i?q.div.firstElementChild:null);break;case"{":case"}":if(s=Math.max(P,wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),e.style.height="".concat(s,"em"),e.style.width="".concat(wi.fontDimen.widthOf(t,fi),"em"),e.style.verticalAlign="middle",n=a/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),e.height=Math.max(s,1)*a,e.width=wi.fontDimen.widthOf(t,fi)/wi.fontDimen.heightOf(t,fi)*a*(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),(r=e.getContext("2d")).textAlign="center",r.fillStyle=pi.color,r.font="".concat(n,"px ").concat(fi),3<=a&&(r.fillText(t,e.width/2,Math.floor(a/3)-wi.fontDimen.depthOf(t,fi)*n),c=r.getImageData(0,0,e.width,Math.floor(a/3)),r.clearRect(0,0,e.width,e.height),r.fillText(t,e.width/2,a-wi.fontDimen.depthOf(t,fi)*n),o=r.getImageData(0,0,e.width,Math.floor(a/3)),r.clearRect(0,0,e.width,e.height),r.fillText(t,e.width/2,e.height/2+a/2-wi.fontDimen.depthOf(t,fi)*n),r.clearRect(0,0,e.width,Math.floor(e.height/2)-Math.floor(a/2)+Math.floor(a/3)),r.clearRect(0,Math.ceil(e.height/2)+Math.floor(a/2)-Math.floor(a/3),e.width,e.height),r.putImageData(o,0,0),r.putImageData(c,0,e.height-Math.floor(a/3)),e.height>a)){h=r.createImageData(e.width,Math.ceil((e.height-a)/2)),p=o.data.slice((Math.floor(a/3)-1)*e.width*4,Math.floor(a/3)*e.width*4),m=r.getImageData(0,Math.floor(e.height/2)-Math.floor(a/2)+Math.floor(a/3),e.width,1).data;for(var D=0,C=h.height/2;D<C;D++)for(var E=0,A=e.width;E<A;E++){var T=D*e.width*4+4*E;h.data[T]=p[4*E+0],h.data[1+T]=p[4*E+1],h.data[2+T]=p[4*E+2],h.data[3+T]=p[4*E+3],T=~~(D+h.height/2)*e.width*4+4*E,h.data[T]=m[4*E+0],h.data[1+T]=m[4*E+1],h.data[2+T]=m[4*E+2],h.data[3+T]=m[4*E+3]}d=r.createImageData(e.width,Math.floor(e.height/2)-Math.floor(a/2)+1),p=r.getImageData(0,Math.ceil(e.height/2)+Math.floor(a/2)-Math.floor(a/3)-1,e.width,1).data,m=c.data.slice(0,4*e.width);for(var O=0,L=d.height/2;O<L;O++)for(var M=0,H=e.width;M<H;M++){var I=O*e.width*4+4*M;d.data[I]=p[4*M+0],d.data[1+I]=p[4*M+1],d.data[2+I]=p[4*M+2],d.data[3+I]=p[4*M+3],I=~~(O+d.height/2)*e.width*4+4*M,d.data[I]=m[4*M+0],d.data[1+I]=m[4*M+1],d.data[2+I]=m[4*M+2],d.data[3+I]=m[4*M+3]}r.putImageData(h,0,Math.floor(a/3)),r.putImageData(d,0,e.height/2+Math.floor(a/2)-Math.floor(a/3))}q.div.insertBefore(e,i?q.div.firstElementChild:null)}},s={type:"atom",atomType:vi.INNER,nucleus:null,superscript:null,subscript:null,style:si,div:document.createElement("div")};ci.push(s),hi.push(s),q.style=si,q.div=s.div,q.div.style.display="inline-block",q.div.style.whiteSpace="nowrap";var R=wi.fontDimen.heightOf("x",fi)/2+wi.fontDimen.baselineHeightOf(fi),r=document.createElement("div"),n=document.createElement("div");r.style.display=n.style.display="inline-block",r.style.verticalAlign="text-bottom",r.style.position="relative",n.style.verticalAlign="text-bottom",n.style.position="relative";var l="display"==si?"text":"text"==si?"script":"scriptscript";ii(q.numerator,l,ri,ni,r),ii(q.denominator,l,!0,ni,n),r.firstElementChild.style.justifyContent="center",n.firstElementChild.style.justifyContent="center";var o="from font"==q.barWidth?new ki(0,65536*wi.fontDimen.visibleWidthOf("|",fi)):new ki(q.barWidth);o.em.value+=o.sp.value/12*16/mi,o.sp.value=0;var c="text"==si||"script"==si,h=c?yi:1,d="".concat(o.em.value/65536,"em"),p="".concat(o.em.value*h/65536,"em"),m=o.em.value*("script"==si||"scriptscript"==si?yi:1)/65536;di.appendChild(n),di.appendChild(r);var f=r.offsetWidth+1,u=r.offsetHeight/mi,v=f*h,g=n.offsetHeight/mi,y=n.offsetWidth+1,b=g*h,w=y*h;di.removeChild(n),di.removeChild(r),c?(r.style.fontSize=n.style.fontSize=bi,r.style.paddingTop="calc(".concat(R/yi,"em + ").concat(d," / 2)"),r.style.top="calc(".concat(-R/yi,"em - ").concat(d," / 2)"),n.style.top="calc(".concat(g-R/yi,"em + ").concat(d," / 2 - ").concat(g,"em)"),q.div.style.paddingBottom="calc(".concat(b-R,"em + ").concat(p," / 2)")):(r.style.fontSize=n.style.fontSize="",r.style.paddingTop="calc(".concat(R,"em + ").concat(p," / 2)"),r.style.top="calc(".concat(-R,"em - ").concat(p," / 2)"),n.style.top="calc(".concat(g-R,"em + ").concat(p," / 2 - ").concat(g,"em)"),q.div.style.paddingBottom="calc(".concat(g-R,"em + ").concat(p," / 2)")),n.style.height=0;var x=y<f?n:r,k=y<f?r:n,S=document.createElement("div"),D=document.createElement("div"),C=document.createElement("div");S.style.display="inline-block",S.style.position="relative",S.style.verticalAlign="text-bottom",S.style.top="".concat(-R,"em"),S.style.width=".05em",S.style.height=0,D.style.borderTop="".concat(p," solid currentColor"),D.style.padding="0 .05em",D.style.position="relative",D.style.top="calc(".concat(p," / -2)"),D.style.display="inline-block",D.style.height=0,C.style.display="inline-block",C.style.visibility="hidden",S.style.webkitUserSelect=S.style.mozUserSelect=S.style.msUserSelect=S.style.userSelect="none",C.style.width="".concat(Math.max(v,w)/mi,"em"),D.appendChild(C),S.appendChild(D),q.div.appendChild(S);var E=document.createElement("div"),A=document.createElement("div"),T=document.createElement("div"),O=x.firstElementChild;O&&(O.style.width="100%",A.appendChild(O)),E.style.position="relative",E.style.display="inline-block",T.style.display="inline-block",T.style.height="".concat(y<f?g:u,"em"),T.textContent=" ",T.style.width="".concat((Math.max(f,y)+1)/mi,"em"),A.style.position="absolute",x.style.width=0,A.style.left="".concat(-1/mi,"em"),A.style.right="".concat(1/mi,"em"),A.style.top=0,E.appendChild(A),E.appendChild(T),x.appendChild(E),q.div.appendChild(x),q.div.appendChild(k);var L=document.createElement("div");L.style.display="inline-block",L.style.width=".05em",q.div.appendChild(L);var M=document.createElement("canvas"),H=document.createElement("canvas"),P="display"==si?2.416666666:"text"==si?1.416666666:0;M.style.display=H.style.display="inline-block",">"==q.delims[0]&&(q.delims[0]="⟩"),">"==q.delims[1]&&(q.delims[1]="⟩"),"<"==q.delims[0]&&(q.delims[0]="⟨"),"<"==q.delims[1]&&(q.delims[1]="⟨"),a(M,q.delims[0],!0,mi),a(H,q.delims[1],!1,mi);var I={display:{display:1,text:1,script:yi,scriptscript:.5},text:{display:1,text:1,script:yi,scriptscript:.5},script:{display:gi,text:gi,script:1,scriptscript:yi},scriptscript:{display:2,text:2,script:gi,scriptscript:1}}[oi.displayedStyle][si],B=wi.fontDimen.heightOf("x",fi)/2;return q.div.renderedDepth=(b-B+m/2+(n.renderedDepth-n.baseline-n.baselineOffset)*h)*I,q.div.renderedHeight=(B+m/2+(r.baseline+r.baselineOffset+r.renderedHeight)*h)*I,q.div.baseline=n.baseline*I*h,q.div.baselineOffset=(b-B+m/2-n.baseline*h)*I,li=" ","continue"}if("table"==q.type){var N={type:"atom",atomType:vi.INNER,nucleus:null,superscript:null,subscript:null,style:si,div:document.createElement("div")};ci.push(N),hi.push(N),q.style=si,q.div=N.div,q.div.style.display="inline-block",q.div.style.whiteSpace="nowrap";var F=document.createElement("table");F.style.borderCollapse="collapse",F.style.verticalAlign="middle",F.style.display="inline-table";for(var z,V=0,W=q.cellData.length;V<W;V++){q.noAligns[V]&&((z=document.createElement("td")).setAttribute("colspan",q.tabSkips.length-1),z.style.padding=0,ii([q.noAligns[V]],si,!1,ni,z),F.appendChild(z),z.firstElementChild.style.width="100%",z.firstElementChild.style.justifyContent="");for(var U=document.createElement("tr"),j=0,X=q.cellData[V].length;j<X;j++){var G=document.createElement("td");G.setAttribute("colspan",q.cellData[V][j].span),G.style.padding=0,G.style.paddingLeft="".concat(q.tabSkips[j].start.em.value/65536+q.tabSkips[j].start.sp.value/65536/12,"em"),j==q.tabSkips.length-2&&(G.style.paddingRight="".concat(q.tabSkips[j+1].start.em.value/65536+q.tabSkips[j+1].start.sp.value/65536/12,"em")),ii(q.cellData[V][j].content,si,!1,ni,G),U.appendChild(G),G.firstElementChild.style.width="100%",G.firstElementChild.style.justifyContent=""}F.appendChild(U)}return q.div.appendChild(F),di.appendChild(q.div),q.div.renderedHeight=q.div.offsetHeight/mi/2+wi.fontDimen.heightOf("x",fi)/2,q.div.renderedDepth=q.div.offsetHeight/mi/2-wi.fontDimen.heightOf("x",fi)/2,di.removeChild(q.div),"continue"}if("atom"==q.type||"box"==q.type&&"atom"==q.content.type){var _=!1;"box"==q.type&&(q=(_=q).content);var $={display:{display:1,text:1,script:yi,scriptscript:.5},text:{display:1,text:1,script:yi,scriptscript:.5},script:{display:gi,text:gi,script:1,scriptscript:yi},scriptscript:{display:2,text:2,script:gi,scriptscript:1}}[oi.displayedStyle][si];if(([vi.OVER,vi.UNDER,vi.RAD].includes(q.atomType)&&(q.subscript||q.superscript)||q.atomType==vi.RAD&&1!=$)&&(q.nucleus=[{type:"atom",atomType:q.atomType,nucleus:q.nucleus,superscript:null,subscript:null,index:q.index,invalid:q.invalid,phantom:q.phantom}],q.atomType=vi.ORD),ci.push(q),hi.push(q),q.style=si,q.div=document.createElement("div"),q.div.style.display="inline-block",q.div.style.whiteSpace="nowrap",q.div.renderedHeight=0,q.div.renderedDepth=-.5,q.div.baselineOffset=0,q.invalid){if(q.nucleus)if("symbol"==q.nucleus.type)q.nucleus.invalid=!0;else for(var Y=q.nucleus.length-1;0<=Y;Y--)q.nucleus[Y].invalid=!0;q.superscript&&(q.superscript[0].invalid=!0),q.subscript&&(q.subscript[0].invalid=!0)}![vi.ORD,vi.OP,vi.BIN,vi.REL,vi.OPEN,vi.CLOSE,vi.PUNCT,vi.INNER].includes(q.atomType)||!q.nucleus||1!=q.nucleus.length||q.nucleus[0].atomType!=vi.OP||q.nucleus[0].delimited||q.nucleus[0].limits||q.superscript||q.subscript||q.nucleus[0].nucleus&&("symbol"==q.nucleus[0].nucleus.type&&xi["operator.growchars"][0].includes(q.nucleus[0].nucleus.char)||1==q.nucleus[0].nucleus.length&&q.nucleus[0].nucleus[0].atomType==vi.VARIABLE&&xi["operator.growchars"][0].includes(q.nucleus[0].nucleus[0].nucleus[0].char))||(q.superscript=q.nucleus[0].superscript,q.subscript=q.nucleus[0].subscript,q.nucleus=q.nucleus[0].nucleus);var J,K,Q,Z,ee,te,ie,ae,se,re,ne,le,oe,ce,he,de,pe,me,fe,ue,ve,ge,ye,be,we,xe,ke,Se,De,Ce,Ee,Ae,Te,Oe,Le,Me,He,Ie,Re,qe,Pe,Be,Ne,Fe,ze,Ve,We,Ue,je,Xe,Ge,_e,$e,Ye,Je,Ke,Qe,Ze,et,tt,it,at,st,rt,nt,lt,ot,ct,ht,dt,pt,mt,ft,ut,vt=0;q.nucleus&&"symbol"==q.nucleus.type?(10==q.nucleus.code?(q.isLineBreak=!0,q.div.style.width="100%"):(q.div.innerHTML='<div style="white-space:pre;display:inline-block;'.concat(q.nucleus.invalid?"color:".concat(xi["invalid.color"][0],";"):"").concat({nm:q.atomType==vi.VARIABLE?'font-style:italic"><div style="display:inline-block;margin:0 '.concat(wi.fontDimen.italCorrOf(q.nucleus.char,fi),"em 0 ").concat(wi.fontDimen.leftOffsetOf(q.nucleus.char,fi,"it"),"em"):"",rm:"",bf:"font-weight:bold;",it:"font-style:italic;",sl:"font-style:oblique;"}[ni],'">').concat(45==q.nucleus.code?"−":q.nucleus.char,"</div>").concat("nm"==ni&&q.atomType==vi.VARIABLE?"</div>":""),J="nm"==ni?q.atomType==vi.VARIABLE?"it":"nm":ni,q.div.renderedHeight=wi.fontDimen.heightOf(q.nucleus.char,fi,J)*$,q.div.renderedDepth=wi.fontDimen.trueDepthOf(q.nucleus.char,fi,J)*$,q.div.baseline=wi.fontDimen.baselineHeightOf(fi)*$,vt=wi.fontDimen.scriptOffsetOf(q.nucleus.char,fi,"nm"==ni&&q.atomType==vi.VARIABLE?"it":ni)),li=q.nucleus.char):Array.isArray(q.nucleus)&&(li=ii(q.nucleus,si,ri||q.atomType==vi.OVER||q.atomType==vi.RAD,ni,q.div)||li,q.div.renderedHeight*=$,q.div.renderedDepth*=$,q.div.baseline*=$,q.div.baselineOffset*=$,!q.div.firstElementChild.empty||q.superscript||q.subscript||q.delimited||[vi.RAD,vi.ACC,vi.OVER,vi.UNDER].includes(q.atomType)||(q.div.empty=!0)),q.phantom&&(q.div.firstElementChild.style.visibility="hidden"),q.div.style.fontSize="".concat($,"em"),"display"==si&&q.atomType==vi.OP&&q.nucleus&&("symbol"==q.nucleus.type||1==q.nucleus.length&&q.nucleus[0].nucleus&&"symbol"==q.nucleus[0].nucleus.type&&q.nucleus[0].atomType==vi.VARIABLE)&&(K=1,xi["operator.growchars"][0].includes(q.nucleus.char||q.nucleus[0].nucleus.char)&&(K=xi["operator.growamount"][0],q.div.renderedHeight*=K,q.div.renderedDepth*=K,q.div.firstElementChild.style.fontSize="".concat(K,"em"),vt*=K),Q=wi.fontDimen.heightOf("x",fi)/2,Z=(q.div.renderedHeight-Q-q.div.renderedDepth-Q)/2,q.div.firstElementChild.style.top="".concat(Z/K,"em"),q.div.renderedHeight-=Z,q.div.renderedDepth+=Z,q.div.firstElementChild.style.position="relative",q.div.firstElementChild.style.marginTop="".concat(-Z/K,"em"),q.div.firstElementChild.style.marginBottom="".concat(Z/K,"em")),q.delimited&&(ee=function(e,t,i,a){var s=void 0,r=void 0,n=void 0,l=void 0,o=void 0,c=void 0,h=void 0,d=void 0,p=void 0,m=void 0,f=void 0;switch(t){case".":default:ci.splice(ci.length-(i?1:0),0,{type:"kern",dimen:q.nullDelimiterSpace});break;case"|":case"/":case"\\":case"‖":case"⎪":case"⏐":case"⟨":case"⟩":s=wi.fontDimen.heightOf("x",fi)/2,r=2*Math.max(q.div.renderedHeight-s,q.div.renderedDepth+s,(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi))/2),e.style.height="".concat(r,"em"),e.style.width="".concat(wi.fontDimen.visibleWidthOf(t,fi),"em"),e.style.marginLeft="".concat(-wi.fontDimen.leftOffsetOf(t,fi),"em"),e.style.marginRight="".concat(wi.fontDimen.widthOf(t,fi)-wi.fontDimen.visibleWidthOf(t,fi)+wi.fontDimen.leftOffsetOf(t,fi),"em"),e.style.verticalAlign="middle",q.div.renderedHeight=Math.max(r/2+s,q.div.renderedHeight),q.div.renderedDepth=Math.max(r/2-s,q.div.renderedDepth),e.height=a,e.width=wi.fontDimen.visibleWidthOf(t,fi)/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi))*a,(n=e.getContext("2d")).fillStyle=pi.color,n.font="".concat(a/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),"px ").concat(fi),n.fillText(t,wi.fontDimen.leftOffsetOf(t,fi)*a,a-wi.fontDimen.depthOf(t,fi)*a/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi))),q.div.insertBefore(e,i?q.div.firstElementChild:null);break;case"(":case")":if(s=wi.fontDimen.heightOf("x",fi)/2,r=2*Math.max(q.div.renderedHeight-s,q.div.renderedDepth+s,(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi))/2),e.style.height="".concat(r,"em"),e.style.width="".concat(wi.fontDimen.widthOf(t,fi),"em"),e.style.verticalAlign="middle",q.div.renderedHeight=Math.max(r/2+s,q.div.renderedHeight),q.div.renderedDepth=Math.max(r/2-s,q.div.renderedDepth),Math.floor(Math.floor(a/2*r)-a)<=0)e.height=a,e.width=wi.fontDimen.widthOf(t,fi)/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi))*a,(n=e.getContext("2d")).textAlign="center",n.fillStyle=pi.color,n.font="".concat(a/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),"px ").concat(fi),n.fillText(t,e.width/2,a-wi.fontDimen.depthOf(t,fi)*a/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)));else{l=wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi),e.height=a/2*r,e.width=wi.fontDimen.widthOf(t,fi)/wi.fontDimen.heightOf(t,fi)*a*(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),(n=e.getContext("2d")).textAlign="center",n.fillStyle=pi.color,n.font="".concat(a/l,"px ").concat(fi),n.fillText(t,e.width/2,a/2-wi.fontDimen.depthOf(t,fi)*a/l),p=n.getImageData(0,0,e.width,a/2),n.clearRect(0,0,e.width,e.height),n.fillText(t,e.width/2,a-wi.fontDimen.depthOf(t,fi)*a/l),n.clearRect(0,a/2,e.width,e.height),n.putImageData(p,0,e.height-a/2),o=n.createImageData(e.width,e.height-a),m=n.getImageData(0,a/2-1,e.width,1).data,f=p.data.slice(0,4*e.width);for(var u=0,v=o.height/2;u<v;u++)for(var g=0,y=e.width;g<y;g++){var b=u*e.width*4+4*g;o.data[b]=m[4*g+0],o.data[1+b]=m[4*g+1],o.data[2+b]=m[4*g+2],o.data[3+b]=m[4*g+3],b=~~(u+o.height/2)*e.width*4+4*g,o.data[b]=f[4*g+0],o.data[1+b]=f[4*g+1],o.data[2+b]=f[4*g+2],o.data[3+b]=f[4*g+3]}n.putImageData(o,0,a/2)}q.div.insertBefore(e,i?q.div.firstElementChild:null);break;case"[":case"]":case"⟮":case"⟯":case"↑":case"↓":case"↕":case"⇑":case"⇓":case"⇕":case"⌈":case"⌉":case"⌊":case"⌋":case"⎰":case"⎱":if(s=wi.fontDimen.heightOf("x",fi)/2,r=2*Math.max(q.div.renderedHeight-s,q.div.renderedDepth+s,(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi))/2),e.style.height="".concat(r,"em"),e.style.width="".concat(wi.fontDimen.widthOf(t,fi),"em"),e.style.verticalAlign="middle",q.div.renderedHeight=Math.max(r/2+s,q.div.renderedHeight),q.div.renderedDepth=Math.max(r/2-s,q.div.renderedDepth),l=wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi),e.height=a*r,e.width=wi.fontDimen.widthOf(t,fi)/wi.fontDimen.heightOf(t,fi)*a*(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),(n=e.getContext("2d")).textAlign="center",n.fillStyle=pi.color,n.font="".concat(a/l,"px ").concat(fi),n.fillText(t,e.width/2,a/2-wi.fontDimen.depthOf(t,fi)*a/l),p=n.getImageData(0,0,e.width,a/2),n.clearRect(0,0,e.width,e.height),n.fillText(t,e.width/2,a-wi.fontDimen.depthOf(t,fi)*a/l),n.clearRect(0,a/2,e.width,e.height),n.putImageData(p,0,e.height-a/2),e.height>a){o=n.createImageData(e.width,e.height-a),m=n.getImageData(0,a/2-1,e.width,1).data,f=p.data.slice(0,4*e.width);for(var w=0,x=o.height/2;w<x;w++)for(var k=0,S=e.width;k<S;k++){var D=w*e.width*4+4*k;o.data[D]=m[4*k+0],o.data[1+D]=m[4*k+1],o.data[2+D]=m[4*k+2],o.data[3+D]=m[4*k+3],D=~~(w+o.height/2)*e.width*4+4*k,o.data[D]=f[4*k+0],o.data[1+D]=f[4*k+1],o.data[2+D]=f[4*k+2],o.data[3+D]=f[4*k+3]}n.putImageData(o,0,a/2)}q.div.insertBefore(e,i?q.div.firstElementChild:null);break;case"{":case"}":if(s=wi.fontDimen.heightOf("x",fi)/2,r=2*Math.max(q.div.renderedHeight-s,q.div.renderedDepth+s,(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi))/2),e.style.height="".concat(r,"em"),e.style.width="".concat(wi.fontDimen.widthOf(t,fi),"em"),e.style.verticalAlign="middle",l=a/(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),e.height=Math.max(r,1)*a,e.width=wi.fontDimen.widthOf(t,fi)/wi.fontDimen.heightOf(t,fi)*a*(wi.fontDimen.heightOf(t,fi)+wi.fontDimen.depthOf(t,fi)),(n=e.getContext("2d")).textAlign="center",n.fillStyle=pi.color,n.font="".concat(l,"px ").concat(fi),q.div.renderedHeight=Math.max(r/2+s,q.div.renderedHeight),q.div.renderedDepth=Math.max(r/2-s,q.div.renderedDepth),3<=a&&(n.fillText(t,e.width/2,Math.floor(a/3)-wi.fontDimen.depthOf(t,fi)*l),p=n.getImageData(0,0,e.width,Math.floor(a/3)),n.clearRect(0,0,e.width,e.height),n.fillText(t,e.width/2,a-wi.fontDimen.depthOf(t,fi)*l),d=n.getImageData(0,0,e.width,Math.floor(a/3)),n.clearRect(0,0,e.width,e.height),n.fillText(t,e.width/2,e.height/2+a/2-wi.fontDimen.depthOf(t,fi)*l),n.clearRect(0,0,e.width,Math.floor(e.height/2)-Math.floor(a/2)+Math.floor(a/3)),n.clearRect(0,Math.ceil(e.height/2)+Math.floor(a/2)-Math.floor(a/3),e.width,e.height),n.putImageData(d,0,0),n.putImageData(p,0,e.height-Math.floor(a/3)),e.height>a)){c=n.createImageData(e.width,Math.ceil((e.height-a)/2)),m=d.data.slice((Math.floor(a/3)-1)*e.width*4,Math.floor(a/3)*e.width*4),f=n.getImageData(0,Math.floor(e.height/2)-Math.floor(a/2)+Math.floor(a/3),e.width,1).data;for(var C=0,E=c.height/2;C<E;C++)for(var A=0,T=e.width;A<T;A++){var O=C*e.width*4+4*A;c.data[O]=m[4*A+0],c.data[1+O]=m[4*A+1],c.data[2+O]=m[4*A+2],c.data[3+O]=m[4*A+3],O=~~(C+c.height/2)*e.width*4+4*A,c.data[O]=f[4*A+0],c.data[1+O]=f[4*A+1],c.data[2+O]=f[4*A+2],c.data[3+O]=f[4*A+3]}h=n.createImageData(e.width,Math.floor(e.height/2)-Math.floor(a/2)+1),m=n.getImageData(0,Math.ceil(e.height/2)+Math.floor(a/2)-Math.floor(a/3)-1,e.width,1).data,f=p.data.slice(0,4*e.width);for(var L=0,M=h.height/2;L<M;L++)for(var H=0,I=e.width;H<I;H++){var R=L*e.width*4+4*H;h.data[R]=m[4*H+0],h.data[1+R]=m[4*H+1],h.data[2+R]=m[4*H+2],h.data[3+R]=m[4*H+3],R=~~(L+h.height/2)*e.width*4+4*H,h.data[R]=f[4*H+0],h.data[1+R]=f[4*H+1],h.data[2+R]=f[4*H+2],h.data[3+R]=f[4*H+3]}n.putImageData(c,0,Math.floor(a/3)),n.putImageData(h,0,e.height/2+Math.floor(a/2)-Math.floor(a/3))}q.div.insertBefore(e,i?q.div.firstElementChild:null)}},te=document.createElement("canvas"),ie=document.createElement("canvas"),te.style.display=ie.style.display="inline-block",">"==q.delims[0]&&(q.delims[0]="⟩"),">"==q.delims[1]&&(q.delims[1]="⟩"),"<"==q.delims[0]&&(q.delims[0]="⟨"),"<"==q.delims[1]&&(q.delims[1]="⟨"),ee(te,q.delims[0],!0,mi),ee(ie,q.delims[1],!1,mi)),(q.superscript||q.subscript)&&(q.atomType==vi.OP&&q.limits?(ae=q.div.firstElementChild,di.appendChild(q.div),se=q.div.offsetWidth+1,di.removeChild(q.div),q.subscript&&!q.superscript?(q.div.renderedDepth=Math.max(q.div.renderedDepth,0),(re=document.createElement("div")).style.display="inline-block",re.style.verticalAlign="text-bottom",re.style.position="relative",(ne=document.createElement("div")).innerText=" ",ne.style.verticalAlign="text-top",ne.style.display="inline-block",ne.style.width=0,ii(q.subscript,"display"==si||"text"==si?"script":"scriptscript",!0,ni,re),re.style.fontSize="scriptscript"==si?q.div.style.fontSize:"calc(".concat(q.div.style.fontSize," * ").concat(yi,")"),di.appendChild(re),le=re.offsetWidth+1,re.style.fontSize="50px",oe=re.offsetHeight/50,di.removeChild(re),"scriptscript"==si?(re.style.fontSize="",re.style.top="".concat(-re.baseline-re.baselineOffset-q.div.renderedDepth,"em"),ne.style.paddingBottom="".concat(oe-q.div.baseline+q.div.baselineOffset+q.div.renderedDepth,"em")):(re.style.fontSize=bi,re.style.top=(-q.div.baseline-q.div.baselineOffset+q.div.renderedDepth)/yi+"em",ne.style.paddingBottom=oe*yi-q.div.baseline-q.div.baselineOffset+q.div.renderedDepth+"em"),ce=void(re.style.height=0),he=void 0,le<se?(ce=re.firstElementChild,he=ae,q.div.insertBefore(re,ae),re.style.width=0):(ce=ae,he=re.firstElementChild,q.div.appendChild(re)),(de=document.createElement("div")).style.display="inline-block",de.style.position="relative",(pe=document.createElement("div")).style.display="inline-block",pe.style.width=0,pe.style.visibility="hidden",pe.style.webkitUserSelect=pe.style.mozUserSelect=pe.style.msUserSelect=pe.style.userSelect="none",pe.appendChild(ui(ce.cloneNode(!0))),de.appendChild(pe),(me=document.createElement("div")).style.position="absolute",me.style.left=me.style.right=0,me.style.textAlign="center",me.style.display="inline-block",me.appendChild(ce),de.appendChild(me),de.style.width="".concat(Math.max(le,se)/mi/("scriptscript"!=si&&he==ae?yi:1),"em"),le<se?re.appendChild(de):((fe=document.createElement("div")).style.display="inline-block",fe.style.width=0,fe.appendChild(de),q.div.insertBefore(fe,re)),q.div.insertBefore(ne,q.div.firstElementChild),q.div.renderedDepth+=(oe*("scriptscript"==si?1:yi)-re.baseline-re.baselineOffset+re.renderedDepth)*$):q.superscript&&!q.subscript?((ue=document.createElement("div")).style.display="inline-block",ue.style.verticalAlign="text-bottom",ii(q.superscript,"display"==si||"text"==si?"script":"scriptscript",ri,ni,ue),ue.style.fontSize="scriptscript"==si?q.div.style.fontSize:"calc(".concat(q.div.style.fontSize," * ").concat(yi,")"),di.appendChild(ue),ve=ue.offsetWidth+1,ue.style.fontSize="50px",ue.offsetHeight,di.removeChild(ue),"scriptscript"==si?(ue.style.fontSize="",ue.style.marginBottom="".concat(q.div.baseline+q.div.baselineOffset+q.div.renderedHeight,"em")):(ue.style.fontSize=bi,ue.style.marginBottom="".concat((q.div.baseline+q.div.baselineOffset+q.div.renderedHeight)/yi,"em")),ye=ge=void 0,ve<se?(ge=ue.firstElementChild,ye=ae,q.div.insertBefore(ue,ae),ue.style.width=0):(ge=ae,ye=ue.firstElementChild,q.div.appendChild(ue)),(be=document.createElement("div")).style.display="inline-block",be.style.position="relative",(we=document.createElement("div")).style.display="inline-block",we.style.width=0,we.style.visibility="hidden",we.style.webkitUserSelect=we.style.mozUserSelect=we.style.msUserSelect=we.style.userSelect="none",we.appendChild(ui(ge.cloneNode(!0))),be.appendChild(we),(xe=document.createElement("div")).style.position="absolute",xe.style.left=xe.style.right=0,xe.style.textAlign="center",xe.style.display="inline-block",xe.appendChild(ge),be.appendChild(xe),be.style.width="".concat(Math.max(ve,se)/mi/("scriptscript"!=si&&ye==ae?yi:1),"em"),ve<se?ue.appendChild(be):((ke=document.createElement("div")).style.display="inline-block",ke.style.width=0,ke.appendChild(be),q.div.insertBefore(ke,ue)),q.div.renderedHeight+=(ue.baseline+ue.baselineOffset+ue.renderedHeight)*("scriptscript"==si?1:yi)*$):q.superscript&&q.subscript&&(q.div.renderedDepth=Math.max(q.div.renderedDepth,0),(Se=document.createElement("div")).style.display="inline-block",Se.style.verticalAlign="text-bottom",Se.style.position="relative",ii(q.subscript,"display"==si||"text"==si?"script":"scriptscript",!0,ni,Se),Se.style.fontSize="scriptscript"==si?q.div.style.fontSize:"calc(".concat(q.div.style.fontSize," * ").concat(yi,")"),di.appendChild(Se),De=Se.offsetWidth+1,Se.style.fontSize="50px",Ce=Se.offsetHeight/50,di.removeChild(Se),(Ee=document.createElement("div")).style.display="inline-block",Ee.style.verticalAlign="text-bottom",Ee.style.position="relative",ii(q.superscript,"display"==si||"text"==si?"script":"scriptscript",ri,ni,Ee),Ee.style.fontSize="scriptscript"==si?q.div.style.fontSize:"calc(".concat(q.div.style.fontSize," * ").concat(yi,")"),di.appendChild(Ee),Ae=Ee.offsetWidth+1,Ee.style.fontSize="50px",Ee.offsetHeight,di.removeChild(Ee),(Te=document.createElement("div")).innerText=" ",Te.style.verticalAlign="text-top",Te.style.display="inline-block",Te.style.width=0,"scriptscript"==si?(Se.style.fontSize=Ee.style.fontSize="",Se.style.top="".concat(-Se.baseline-Se.baselineOffset-q.div.renderedDepth,"em"),Te.style.paddingBottom="".concat(height-q.div.baseline+q.div.baselineOffset+q.div.renderedDepth,"em"),Ee.style.marginBottom="".concat(q.div.baseline+q.div.baselineOffset+q.div.renderedHeight,"em")):(Se.style.fontSize=Ee.style.fontSize=bi,Se.style.top="".concat((-q.div.baseline-q.div.baselineOffset+q.div.renderedDepth)/yi,"em"),Te.style.paddingBottom="".concat(Ce*yi-q.div.baseline+q.div.baselineOffset+q.div.renderedDepth,"em"),Ee.style.marginBottom="".concat((q.div.baseline+q.div.baselineOffset+q.div.renderedHeight)/yi,"em")),Se.style.height=0,De<=Ae&&se<=Ae?(q.div.insertBefore(Se,ae),q.div.appendChild(Ee),Se.style.width=0,Oe=document.createElement("div"),Le=document.createElement("div"),Oe.style.display=Le.style.display="inline-block",Oe.style.position=Le.style.position="relative",Me=document.createElement("div"),He=document.createElement("div"),Me.style.display=He.style.display="inline-block",Me.style.width=He.style.width=0,Me.style.visibility=He.style.visibility="hidden",Me.style.webkitUserSelect=Me.style.mozUserSelect=Me.style.msUserSelect=Me.style.userSelect=He.style.webkitUserSelect=He.style.mozUserSelect=He.style.msUserSelect=He.style.userSelect="none",Me.appendChild(ui(Se.firstElementChild.cloneNode(!0))),He.appendChild(ui(ae.cloneNode(!0))),Oe.appendChild(Me),Le.appendChild(He),Ie=document.createElement("div"),Re=document.createElement("div"),Ie.style.position=Re.style.position="absolute",Ie.style.left=Ie.style.right=0,Re.style.left=Re.style.right=0,Ie.style.textAlign=Re.style.textAlign="center",Ie.style.display=Re.style.display="inline-block",Ie.appendChild(Se.firstElementChild),Re.appendChild(ae),Oe.appendChild(Ie),Le.appendChild(Re),Oe.style.width="".concat(Ae/mi/("scriptscript"!=si?yi:1),"em"),Le.style.width="".concat(Ae/mi,"em"),Se.appendChild(Oe),(qe=document.createElement("div")).style.display="inline-block",qe.style.width=0,qe.appendChild(Le),q.div.insertBefore(qe,Ee)):De<=se&&Ae<=se?(q.div.insertBefore(Se,ae),q.div.insertBefore(Ee,ae),Se.style.width=Ee.style.width=0,Pe=document.createElement("div"),Be=document.createElement("div"),Pe.style.display=Be.style.display="inline-block",Pe.style.position=Be.style.position="relative",Ne=document.createElement("div"),Fe=document.createElement("div"),Ne.style.display=Fe.style.display="inline-block",Ne.style.width=Fe.style.width=0,Ne.style.visibility=Fe.style.visibility="hidden",Ne.style.webkitUserSelect=Ne.style.mozUserSelect=Ne.style.msUserSelect=Ne.style.userSelect=Fe.style.webkitUserSelect=Fe.style.mozUserSelect=Fe.style.msUserSelect=Fe.style.userSelect="none",Ne.appendChild(ui(Se.firstElementChild.cloneNode(!0))),Fe.appendChild(ui(Ee.firstElementChild.cloneNode(!0))),Pe.appendChild(Ne),Be.appendChild(Fe),ze=document.createElement("div"),Ve=document.createElement("div"),ze.style.position=Ve.style.position="absolute",ze.style.left=ze.style.right=0,Ve.style.left=Ve.style.right=0,ze.style.textAlign=Ve.style.textAlign="center",ze.style.display=Ve.style.display="inline-block",ze.appendChild(Se.firstElementChild),Ve.appendChild(Ee.firstElementChild),Pe.appendChild(ze),Be.appendChild(Ve),Pe.style.width="".concat(se/mi/("scriptscript"!=si?yi:1),"em"),Be.style.width="".concat(se/mi/("scriptscript"!=si?yi:1),"em"),Se.appendChild(Pe),Ee.appendChild(Be)):se<=De&&Ae<=De&&(q.div.insertBefore(Ee,ae),q.div.appendChild(Se),Ee.style.width=0,We=document.createElement("div"),Ue=document.createElement("div"),We.style.display=Ue.style.display="inline-block",We.style.position=Ue.style.position="relative",je=document.createElement("div"),Xe=document.createElement("div"),je.style.display=Xe.style.display="inline-block",je.style.width=Xe.style.width=0,je.style.visibility=Xe.style.visibility="hidden",je.style.webkitUserSelect=je.style.mozUserSelect=je.style.msUserSelect=je.style.userSelect=Xe.style.webkitUserSelect=Xe.style.mozUserSelect=Xe.style.msUserSelect=Xe.style.userSelect="none",je.appendChild(ui(Ee.firstElementChild.cloneNode(!0))),Xe.appendChild(ui(ae.cloneNode(!0))),We.appendChild(je),Ue.appendChild(Xe),Ge=document.createElement("div"),_e=document.createElement("div"),Ge.style.position=_e.style.position="absolute",Ge.style.left=Ge.style.right=0,_e.style.left=_e.style.right=0,Ge.style.textAlign=_e.style.textAlign="center",Ge.style.display=_e.style.display="inline-block",Ge.appendChild(Ee.firstElementChild),_e.appendChild(ae),We.appendChild(Ge),Ue.appendChild(_e),We.style.width="".concat(De/mi/("scriptscript"!=si?yi:1),"em"),Ue.style.width="".concat(De/mi,"em"),Ee.appendChild(We),($e=document.createElement("div")).style.display="inline-block",$e.style.width=0,$e.appendChild(Ue),q.div.insertBefore($e,Se)),q.div.insertBefore(Te,q.div.firstElementChild),q.div.renderedDepth+=(Ce*("scriptscript"==si?1:yi)-Se.baseline-Se.baselineOffset+Se.renderedDepth)*$,q.div.renderedHeight+=(Ee.baseline+Ee.baselineOffset+Ee.renderedHeight)*("scriptscript"==si?1:yi)*$)):q.subscript&&!q.superscript?((Ye=document.createElement("div")).style.display="inline-block",Ye.style.verticalAlign="text-bottom",Ye.style.position="relative",(Je=document.createElement("div")).style.verticalAlign="text-top",Je.textContent=" ",Je.style.display="inline-block",Je.style.width=0,ii(q.subscript,"display"==si||"text"==si?"script":"scriptscript",!0,ni,Ye),Ye.style.fontSize="50px",di.appendChild(Ye),Ke=Ye.offsetHeight/50,di.removeChild(Ye),"scriptscript"==si?(Ye.style.fontSize="",Ye.style.top="".concat(Math.max(Ye.baseline,Ye.renderedDepth)-wi.fontDimen.baselineHeightOf(fi)+Math.max(Math.max(q.div.renderedDepth,0)/$+.2,Ye.renderedHeight-wi.fontDimen.heightOf("x",fi))-Ke,"em"),Je.style.paddingBottom="".concat(Math.max(Ye.baseline,Ye.renderedDepth)-wi.fontDimen.baselineHeightOf(fi)+Math.max(Math.max(q.div.renderedDepth,0)/$+.2,Ye.renderedHeight-wi.fontDimen.heightOf("x",fi))-Ke,"em")):(Ye.style.fontSize=bi,Ye.style.top="".concat(Math.max(Ye.baseline,Ye.renderedDepth)-wi.fontDimen.baselineHeightOf(fi)/yi+Math.max(Math.max(q.div.renderedDepth,0)/$/yi+.2,Ye.renderedHeight-wi.fontDimen.heightOf("x",fi))-Ke,"em"),Je.style.paddingBottom="".concat(Math.max(Ye.baseline,Ye.renderedDepth)*yi-wi.fontDimen.baselineHeightOf(fi)+Math.max(Math.max(q.div.renderedDepth,0)/$/yi+.2,Ye.renderedHeight-wi.fontDimen.heightOf("x",fi))*yi,"em"),q.div.renderedDepth=Math.max(q.div.renderedDepth,(Ye.renderedDepth*yi+Math.max(Math.max(q.div.renderedDepth,0)/$/yi+.2,Ye.renderedHeight-wi.fontDimen.heightOf("x",fi))*yi)*$)),Ye.style.height=0,q.div.appendChild(Ye),q.div.insertBefore(Je,Ye)):q.superscript&&!q.subscript?(Qe=document.createElement("div"),ii(q.superscript,"display"==si||"text"==si?"script":"scriptscript",ri,ni,Qe),Qe.style.display="inline-block",Qe.style.verticalAlign="text-bottom",Qe.style.position="relative","scriptscript"==si?(Qe.style.top="".concat(Math.max(Qe.baseline,Qe.renderedDepth)-wi.fontDimen.baselineHeightOf(fi)-Math.max(q.div.renderedHeight/$+(ri?.1:.2)-Qe.renderedHeight,Qe.renderedDepth+(ri?.9:1)*wi.fontDimen.heightOf("x",fi)),"em"),Qe.style.paddingTop="".concat(-Math.max(Qe.baseline,Qe.renderedDepth)+wi.fontDimen.baselineHeightOf(fi)+Math.max(q.div.renderedHeight/$+(ri?.1:.2)-Qe.renderedHeight,Qe.renderedDepth+(ri?.9:1)*wi.fontDimen.heightOf("x",fi)),"em"),q.div.renderedHeight=Math.max(q.div.renderedHeight,(Qe.renderedHeight+Math.max(q.div.renderedHeight/$+(ri?.1:.2)-Qe.renderedHeight,Qe.renderedDepth+(ri?.9:1)*wi.fontDimen.heightOf("x",fi)))*$)):(Qe.style.fontSize=bi,Qe.style.top="".concat(Math.max(Qe.baseline,Qe.renderedDepth)-wi.fontDimen.baselineHeightOf(fi)/yi-Math.max(q.div.renderedHeight/$/yi+(ri?.1:.2)-Qe.renderedHeight,Qe.renderedDepth+(ri?.9:1)*wi.fontDimen.heightOf("x",fi)),"em"),Qe.style.paddingTop="".concat(-Math.max(Qe.baseline,Qe.renderedDepth)+wi.fontDimen.baselineHeightOf(fi)/yi+Math.max(q.div.renderedHeight/$/yi+(ri?.1:.2)-Qe.renderedHeight,Qe.renderedDepth+(ri?.9:1)*wi.fontDimen.heightOf("x",fi)),"em"),q.div.renderedHeight=Math.max(q.div.renderedHeight,(Qe.renderedHeight+Math.max(q.div.renderedHeight/$/yi+(ri?.1:.2)-Qe.renderedHeight,Qe.renderedDepth+(ri?.9:1)*wi.fontDimen.heightOf("x",fi)))*yi*$)),q.div.appendChild(Qe)):q.subscript&&q.superscript&&(Ze=document.createElement("div"),et=document.createElement("div"),Ze.style.display="inline-block",et.style.verticalAlign="text-top",et.innerText=" ",et.style.display="inline-block",et.style.width=0,ii(q.subscript,"display"==si||"text"==si?"script":"scriptscript",!0,ni,Ze),Ze.style.fontSize="50px",di.appendChild(Ze),tt={height:Ze.offsetHeight,width:Ze.offsetWidth+1},di.removeChild(Ze),(it=document.createElement("div")).style.display="inline-block",ii(q.superscript,"display"==si||"text"==si?"script":"scriptscript",ri,ni,it),it.style.fontSize="50px",di.appendChild(it),at={height:it.offsetHeight,width:it.offsetWidth+1},di.removeChild(it),st=tt.width<at.width+vt*mi?Ze:it,rt=tt.width<at.width+vt*mi?it:Ze,nt=at.height/50,lt=tt.height/50,it.style.marginLeft="".concat(vt,"em"),st==it&&(it.style.marginRight="".concat(-vt,"em")),Ze.style.verticalAlign=it.style.verticalAlign="text-bottom",it.style.position=Ze.style.position="relative",ot=wi.fontDimen.heightOf("x",fi),"scriptscript"==si?(Ze.style.fontSize=it.style.fontSize="",it.style.top="".concat(Math.max(it.baseline,it.renderedDepth)-wi.fontDimen.baselineHeightOf(fi)-Math.max(q.div.renderedHeight/$+(ri?.1:.2)-it.renderedHeight,it.renderedDepth+(ri?.9:1)*ot),"em"),it.style.paddingTop="".concat(-Math.max(it.baseline,it.renderedDepth)+wi.fontDimen.baselineHeightOf(fi)+Math.max(q.div.renderedHeight/$+(ri?.1:.2)-it.renderedHeight,it.renderedDepth+(ri?.9:1)*ot),"em"),q.div.renderedHeight=Math.max(q.div.renderedHeight,(it.renderedHeight+Math.max(q.div.renderedHeight/$+(ri?.1:.2)-it.renderedHeight,it.renderedDepth+(ri?.9:1)*ot))*$),Ze.style.top="".concat(Math.max(Ze.baseline,Ze.renderedDepth)-wi.fontDimen.baselineHeightOf(fi)+Math.max(Math.max(q.div.renderedDepth,0)/$+.2,Ze.renderedHeight-.8*ot)-lt,"em"),et.style.paddingBottom="".concat(Math.max(Ze.baseline,Ze.renderedDepth)-wi.fontDimen.baselineHeightOf(fi)+Math.max(Math.max(q.div.renderedDepth,0)/$+.2,Ze.renderedHeight-.8*ot)-nt,"em"),q.div.renderedDepth=Math.max(q.div.renderedDepth,(Ze.renderedDepth+Math.max(Math.max(q.div.renderedDepth,0)/$+.2,Ze.renderedHeight-.8*ot))*$)):(Ze.style.fontSize=it.style.fontSize=bi,it.style.top="".concat(Math.max(it.baseline,it.renderedDepth)-wi.fontDimen.baselineHeightOf(fi)/yi-Math.max(q.div.renderedHeight/$/yi+(ri?.1:.2)-it.renderedHeight,it.renderedDepth+(ri?.9:1)*ot),"em"),it.style.paddingTop="".concat(-Math.max(it.baseline,it.renderedDepth)+wi.fontDimen.baselineHeightOf(fi)/yi+Math.max(q.div.renderedHeight/$/yi+(ri?.1:.2)-it.renderedHeight,it.renderedDepth+(ri?.9:1)*ot),"em"),q.div.renderedHeight=Math.max(q.div.renderedHeight,(it.renderedHeight+Math.max(q.div.renderedHeight/$/yi+(ri?.1:.2)-it.renderedHeight,it.renderedDepth+(ri?.9:1)*ot))*yi*$),Ze.style.top="".concat(Math.max(Ze.baseline,Ze.renderedDepth)-wi.fontDimen.baselineHeightOf(fi)/yi+Math.max(Math.max(q.div.renderedDepth,0)/$/yi+.2,Ze.renderedHeight-.8*ot)-lt,"em"),et.style.paddingBottom="".concat(Math.max(Ze.baseline,Ze.renderedDepth)*yi-wi.fontDimen.baselineHeightOf(fi)+Math.max(Math.max(q.div.renderedDepth,0)/$/yi+.2,Ze.renderedHeight-.8*ot)*yi,"em"),q.div.renderedDepth=Math.max(q.div.renderedDepth,(Ze.renderedDepth*yi+Math.max(Math.max(q.div.renderedDepth,0)/$/yi+.2,Ze.renderedHeight-.8*ot)*yi)*$)),Ze.style.height=0,st.style.width=0,q.div.appendChild(et),q.div.appendChild(st),q.div.appendChild(rt))),_&&("horizontal"==_.boxType?(ct=void 0,_.to?((ct=new ki(_.to)).em.value+=ct.sp.value/12*16/mi,ct.sp.value=0):_.spread&&((ct=new ki(_.spread)).em.value+=ct.sp.value/12*16/mi,ct.sp.value=0,ht=q.div.style.fontSize,q.div.style.fontSize="50px",di.appendChild(q.div),dt=(q.div.offsetWidth+1)/50,di.removeChild(q.div),q.div.style.fontSize=ht,ct.em.value+=65536*dt),ct.em.value<0?(ci.splice(ci.length-1,0,{type:"kern",dimen:ct}),q.div.firstElementChild.style.width="0.0001px"):0==ct.em.value?q.div.firstElementChild.style.width="0.0001px":q.div.firstElementChild.style.width="".concat(ct.em.value/65536,"em"),q.div.firstElementChild.style.flexWrap=""):"vertical"==_.boxType&&(pt=void 0,_.to?((pt=new ki(_.to)).em.value+=pt.sp.value/12*16/mi,pt.sp.value=0):_.spread&&((pt=new ki(_.spread)).em.value+=pt.sp.value/12*16/mi,pt.sp.value=0,mt=q.div.style.fontSize,q.div.style.fontSize="50px",di.appendChild(q.div),ft=q.div.offsetHeight/50,di.removeChild(q.div),q.div.style.fontSize=mt,pt.em.value+=65536*ft),pt.em.value<0?(q.div.firstElementChild.style.height=0,q.div.firstElementChild.style.verticalAlign="text-bottom",q.div.firstElementChild.style.position="relative",q.div.firstElementChild.style.top="".concat(-pt.em.value/65536,"em"),q.div.renderedHeight=0,q.div.renderedDepth=0):(q.div.firstElementChild.style.height="".concat(pt.em.value/65536,"em"),q.div.firstElementChild.style.verticalAlign="text-bottom",ut=wi.fontDimen.baselineHeightOf(fi),q.div.renderedDepth=Math.min(ut,pt.em.value/65536),q.div.renderedHeight=Math.max(pt.em.value/65536-ut,0)),q.div.firstElementChild.style.flexWrap=""),q.div.firstElementChild.style.justifyContent="initial");var gt=void 0,yt=void 0,bt=void 0,wt=void 0,xt=void 0,kt=void 0,St=void 0,Dt=void 0,Ct=void 0,Et=void 0;switch(q.atomType){case vi.OVER:q.div.renderedHeight=Math.max(q.div.renderedHeight||0,wi.fontDimen.heightOf("x",fi)/2),gt=wi.fontDimen.visibleWidthOf("|",fi),(yt=document.createElement("div")).style.display="inline-block",yt.style.width=yt.style.height=0,yt.style.position="relative",yt.style.top="".concat(-wi.fontDimen.baselineHeightOf(fi)-q.div.renderedHeight/$-gt-.12,"em"),yt.style.verticalAlign="text-bottom",yt.style.pointerEvents="none",(bt=document.createElement("div")).style.display="inline-block",bt.style.webkitUserSelect=bt.style.mozUserSelect=bt.style.msUserSelect=bt.style.userSelect="none",bt.style.position="relative",(wt=document.createElement("div")).style.position="absolute",wt.style.left=wt.style.right=0,wt.style.borderTop="".concat(gt,"em solid currentColor"),bt.appendChild(wt),(kt=ui(q.div.cloneNode(!0))).style.visibility="hidden",kt.style.fontSize="",bt.appendChild(kt),yt.appendChild(bt),q.div.insertBefore(yt,q.div.firstElementChild),(St=document.createElement("div")).style.height="".concat(q.div.renderedHeight/$+gt+.16,"em"),St.style.display="inline-block",St.style.width=0,q.div.insertBefore(St,yt),q.div.renderedHeight+=gt+.16;break;case vi.UNDER:q.div.renderedDepth=Math.max(q.div.renderedDepth||0,0),gt=wi.fontDimen.visibleWidthOf("|",fi),(yt=document.createElement("div")).style.display="inline-block",yt.style.width=yt.style.height=0,yt.style.position="relative",yt.style.top="".concat(-wi.fontDimen.baselineHeightOf(fi)+q.div.renderedDepth/$+.12,"em"),yt.style.verticalAlign="text-bottom",yt.style.pointerEvents="none",(bt=document.createElement("div")).style.display="inline-block",bt.style.webkitUserSelect=bt.style.mozUserSelect=bt.style.msUserSelect=bt.style.userSelect="none",bt.style.position="relative",(xt=document.createElement("div")).style.position="absolute",xt.style.left=xt.style.right=0,xt.style.borderTop="".concat(gt,"em solid currentColor"),bt.appendChild(xt),(kt=ui(q.div.cloneNode(!0))).style.visibility="hidden",kt.style.fontSize="",kt.style.height=0,bt.appendChild(kt),yt.appendChild(bt),q.div.insertBefore(yt,q.div.firstElementChild),(St=document.createElement("div")).style.verticalAlign="text-top",St.innerText=" ",St.style.paddingBottom="".concat(gt+.16-wi.fontDimen.baselineHeightOf(fi)+q.div.renderedDepth/$,"em"),St.style.display="inline-block",St.style.width=0,q.div.insertBefore(St,yt),q.div.renderedDepth+=gt+.16;break;case vi.ACC:var At=document.createElement("div");At.style.display="inline-block",At.style.position="relative","it"==ni?At.style.fontStyle="italic":"sl"==ni?At.style.fontStyle="oblique":"bf"==ni&&(At.style.fontWeight="bold"),At.style.top="".concat(Math.min(wi.fontDimen.heightOf("x",fi),q.div.renderedHeight)-q.div.renderedHeight,"em"),At.style.width=0,At.style.lineHeight=1.1,At.style.height="1.1em",At.style.verticalAlign="text-bottom",At.textContent=q.accChar,Et=(Et=!q.nucleus||"symbol"!=q.nucleus.type||"it"!=ni&&"sl"!=ni?0:wi.fontDimen.italCorrOf(q.accChar,fi))||(q.nucleus&&1==q.nucleus.length&&q.nucleus[0].nucleus&&"symbol"==q.nucleus[0].nucleus.type&&q.nucleus[0].atomType==vi.VARIABLE&&"nm"==ni?wi.fontDimen.italCorrOf(q.accChar,fi):0);var Tt=q.div.style.fontSize;q.div.style.fontSize="50px",di.appendChild(q.div),At.style.left="".concat(((q.div.offsetWidth+1)/50-wi.fontDimen.widthOf(q.accChar,fi,ni))/2+Et,"em"),di.removeChild(q.div),q.div.style.fontSize=Tt,q.div.insertBefore(At,q.div.firstElementChild);var Ot=document.createElement("div");Ot.style.display="inline-block",Ot.style.width=0,Ot.style.height="".concat(q.div.renderedHeight-Math.min(wi.fontDimen.heightOf("x",fi),q.div.renderedHeight)+wi.fontDimen.heightOf(q.accChar,fi,ni),"em"),q.div.insertBefore(Ot,At),q.div.renderedHeight=q.div.renderedHeight-Math.min(wi.fontDimen.heightOf("x",fi),q.div.renderedHeight)+wi.fontDimen.heightOf(q.accChar,fi,ni);break;case vi.VCENT:var Lt=wi.fontDimen.heightOf("x",fi)/2;Et=q.div.renderedHeight-Lt-(q.div.renderedDepth+Lt),q.div.style.position="relative",q.div.style.top="".concat(Et/2,"em"),q.div.style.marginTop="".concat(-Et/2,"em"),q.div.style.marginBottom="".concat(Et/2,"em"),q.div.renderedHeight-=Et/2,q.div.renderedDepth+=Et/2;break;case vi.RAD:gt=wi.fontDimen.visibleWidthOf("|",fi),q.div.renderedHeight=Math.max(q.div.renderedHeight||0,wi.fontDimen.heightOf("x",fi)/2),q.div.renderedDepth=Math.max(q.div.renderedDepth||0,0),di.appendChild(q.div),Ct=(q.div.offsetWidth+1)/mi,di.removeChild(q.div),(yt=document.createElement("div")).style.display="inline-block",yt.style.width=yt.style.height=0,yt.style.position="relative",yt.style.top="".concat(-wi.fontDimen.baselineHeightOf(fi)-q.div.renderedHeight/$-gt-.12,"em"),yt.style.verticalAlign="text-bottom",yt.style.pointerEvents="none",(Dt=document.createElement("div")).style.display="inline-block",Dt.style.webkitUserSelect=Dt.style.mozUserSelect=Dt.style.msUserSelect=Dt.style.userSelect="none",Dt.style.position="relative",Dt.style.width="".concat(Ct,"em"),(wt=document.createElement("div")).style.position="absolute",wt.style.left=wt.style.right=0,wt.style.borderTop="".concat(gt,"em solid currentColor"),Dt.appendChild(wt),Dt.appendChild(document.createTextNode(" ")),yt.appendChild(Dt),q.div.insertBefore(yt,q.div.firstElementChild),(St=document.createElement("div")).style.height="".concat(q.div.renderedHeight/$+gt+.16,"em"),St.style.display="inline-block",St.style.width=0,q.div.insertBefore(St,yt),q.div.renderedHeight+=(gt+.16)*$;var Mt,Ht,It,Rt,qt,Pt,Bt,Nt,Ft,zt,Vt,Wt,Ut,jt,Xt,Gt,_t,$t=document.createElement("canvas"),Yt=0,Jt=0;xi["radical.build"][0]?($t.height=(q.div.renderedDepth+q.div.renderedHeight)*mi,$t.style.height="".concat(q.div.renderedDepth+q.div.renderedHeight,"em"),$t.style.position="relative",$t.style.top="".concat(q.div.renderedDepth,"em"),$t.style.marginLeft=".1em",$t.style.marginTop="".concat(-q.div.renderedDepth,"em"),Mt=gt,Ht=q.div.renderedHeight+q.div.renderedDepth-.04-Mt/2,It=xi["radical.w"][0],Rt=Math.max(0,Math.min(It,xi["radical.t"][0])),qt=Math.max(0,xi["radical.h"][0]),Pt=Ht/Math.max(0,xi["radical.verticalthreshold"][0]),Bt=Math.sqrt(Pt),Nt=Math.sqrt(3),Yt=q.div.renderedHeight+q.div.renderedDepth<Math.max(0,xi["radical.verticalthreshold"][0])?(qt=Math.min(q.div.renderedHeight+q.div.renderedDepth,qt/Math.max(xi["radical.verticalthreshold"][0],0)),Ft=Mt*Pt*Nt/(6*Pt*Pt+2),$t.width=(-Mt*(Rt*(Pt-1)-Pt*It-Ht*Bt+It)/(2*Ht)+Ft+It)*mi,$t.style.width="".concat((-Mt*Rt*(Pt-1)+Mt*Pt*It-It*(Mt-2*Ht)+Ht*(Mt+2*Ft))/(2*Ht),"em"),(zt=$t.getContext("2d")).fillStyle=pi.color,Vt=[Math.max(-Mt*(Rt*(Pt-1)-Pt*It-Ht*Bt+It)/(2*Ht),0)+Ft+It,Ht-Mt/2],Wt=[Math.min(-Mt*(-Rt*(Pt-1)+Pt*It+Ht*Bt-It)/(2*Ht)+Ft+It,Vt[0]),Ht+Mt/2],Ut=[-(4*Rt*Rt*Pt*Nt*(Pt-1)*(Pt-1)-Rt*(Pt-1)*(4*Pt*Pt*It*Nt+3*Mt*Nt*Math.pow(Pt,1.5)-4*Pt*(Ht*(qt-1)-Ft*Nt)+4*Ht*qt)-Ht*(4*Pt*Pt*It*(qt-1)+Mt*Math.pow(Pt,1.5)*(3*qt+2)-4*Pt*(qt*It-Ft*(qt-1))-3*Mt*qt*Bt-4*qt*Ft))/(4*(Nt*Rt*Pt*(Pt-1)+Ht*(Pt*(qt-1)-qt))),-(qt*Ht+Pt*Rt*Nt)/(Pt*(It-Rt))*(-(4*Rt*Rt*Pt*Nt*(Pt-1)*(Pt-1)-Rt*(Pt-1)*(4*Pt*Pt*It*Nt+3*Mt*Nt*Math.pow(Pt,1.5)-4*Pt*(Ht*(qt-1)-Ft*Nt)+4*Ht*qt)-Ht*(4*Pt*Pt*It*(qt-1)+Mt*Math.pow(Pt,1.5)*(3*qt+2)-4*Pt*(qt*It-Ft*(qt-1))-3*Mt*qt*Bt-4*qt*Ft))/(4*(Nt*Rt*Pt*(Pt-1)+Ht*(Pt*(qt-1)-qt)))-Pt*(It-Rt)-Rt-3*Mt*Bt/4-Ft)],jt=[Math.max(-Rt*(Pt-1)+Pt*It+Mt/2*Bt+Ft,-Ut[1]*(Wt[0]-Ut[0])/(Wt[1]-Ut[1])+Ut[0]+Vt[0]-(Wt[0]-Ut[0])/(Wt[1]-Ut[1])*(Vt[1]-Ut[1]+(Wt[1]-Ut[1])/(Wt[0]-Ut[0])*Ut[0])),0],zt.beginPath(),zt.moveTo(Vt[0]*mi,$t.height-Vt[1]*mi),zt.lineTo((-Mt*(Rt*(Pt-1)-Pt*It-Ht*Bt+It)/(2*Ht)+Ft+It)*mi,$t.height-(Ht+Mt/2)*mi),zt.lineTo(Wt[0]*mi,$t.height-Wt[1]*mi),zt.lineTo(Ut[0]*mi,$t.height-Ut[1]*mi),zt.lineTo((8*Rt*Rt*Pt*Nt*(Pt-1)-Rt*(8*Pt*Pt*It*Nt+6*Mt*Math.pow(Pt,1.5)*Nt+Pt*(Mt+8*Ft*Nt)+8*Ht*qt)+Mt*Pt*It-6*Mt*Ht*qt*Bt-8*Ht*qt*Ft)/(8*(Rt*Pt*Nt*(Pt-1)-Pt*Pt*It*Nt-Ht*qt))*mi,$t.height-(Jt=Pt*Nt*(8*Rt*Rt*Pt*Nt*(Pt-1)-Rt*(8*Pt*Pt*It*Nt+6*Mt*Math.pow(Pt,1.5)*Nt+Pt*(Mt+8*Ft*Nt)+8*Ht*qt)+Mt*Pt*It-6*Mt*Ht*qt*Bt-8*Ht*qt*Ft)/(8*(Rt*Pt*Nt*(Pt-1)-Pt*Pt*It*Nt-Ht*qt))+qt*Ht+Mt/8)*mi),zt.lineTo(0,$t.height-(qt*Ht+Mt/8)*mi),zt.lineTo(2*Ft*mi,$t.height-(qt*Ht-Mt/8)*mi),zt.lineTo((8*Rt*Rt*Pt*Nt*(Pt-1)-Rt*(8*Pt*Pt*Nt*(It-2*Ft)-6*Mt*Math.pow(Pt,1.5)*Nt-Pt*(Mt-8*Ft*Nt)+8*Ht*qt)-16*Ft*Pt*Pt*It*Nt-Mt*Pt*It+6*Mt*Ht*qt*Bt-8*Ht*qt*Ft)/(8*(Rt*Pt*Nt*(Pt-1)-Pt*Pt*It*Nt-Ht*qt))*mi,$t.height-(Pt*Nt*((8*Rt*Rt*Pt*Nt*(Pt-1)-Rt*(8*Pt*Pt*Nt*(It-2*Ft)-6*Mt*Math.pow(Pt,1.5)*Nt-Pt*(Mt-8*Ft*Nt)+8*Ht*qt)-16*Ft*Pt*Pt*It*Nt-Mt*Pt*It+6*Mt*Ht*qt*Bt-8*Ht*qt*Ft)/(8*(Rt*Pt*Nt*(Pt-1)-Pt*Pt*It*Nt-Ht*qt))-2*Ft)+qt*Ht-Mt/8)*mi),zt.lineTo((-Rt*(Pt-1)+Pt*It-.75*Mt*Bt+Ft)*mi,$t.height),zt.lineTo(jt[0]*mi,$t.height),zt.closePath(),zt.fill(),(Wt[0]-Ut[0])/(Wt[1]-Ut[1])*(Jt-Ut[1])+Ut[0]):(qt=Math.max(0,Math.min(Ht,xi["radical.h"][0])),$t.width=(8*It+Mt*(4+Nt))/8*mi,$t.style.width="".concat((8*It+Mt*(4+Nt))/8,"em"),(Xt=$t.getContext("2d")).fillStyle=pi.color,Xt.beginPath(),Xt.moveTo((It+Mt*(Nt+4)/8)*mi,.04*mi),Xt.lineTo((It+Mt*(Nt-4)/8)*mi,.04*mi),Xt.lineTo((It+Mt*(Nt-4)/8)*mi,$t.height-5*Mt*(qt+Rt*Nt)/(4*(It-Rt))*mi),Xt.lineTo((Rt*(4*It*Nt+Mt*(3*Nt+2)+4*qt)-Mt*(2*It-3*qt-1.5*It-qt/2*Nt))/(4*(It*Nt+qt))*mi,$t.height-(Jt=(Rt*(4*It*Nt+Mt*(3*Nt+2)+4*qt)-Mt*(2*It-3*qt))/(4*(It*Nt+qt))*Nt+qt+Mt/2)*mi),Xt.lineTo(0,$t.height-(Mt/8+qt)*mi),Xt.lineTo(Mt*Nt/4*mi,$t.height-(-Mt/8+qt)*mi),Xt.lineTo((Rt*(4*It*Nt-Mt*(3*Nt+2)+4*qt)+Mt*(2*It-3*qt+1.5*It+qt/2*Nt))/(4*(It*Nt+qt))*mi,$t.height-((Rt*(4*It*Nt-Mt*(3*Nt+2)+4*qt)+Mt*(2*It-3*qt))/(4*(It*Nt+qt))*Nt+qt-Mt/2)*mi),Xt.lineTo((It-Mt*(6-Nt)/8)*mi,$t.height),Xt.lineTo((It+Mt*(Nt+4)/8)*mi,$t.height),Xt.closePath(),Xt.fill(),It+Mt*(Nt-4)/8)):($t.height=(wi.fontDimen.heightOf("√",fi)+wi.fontDimen.depthOf("√",fi))*mi,$t.width=wi.fontDimen.widthOf("√",fi)*mi,Gt=$t.getContext("2d"),$t.style.height="".concat(q.div.renderedHeight+q.div.renderedDepth,"em"),$t.style.width="".concat(wi.fontDimen.widthOf("√",fi),"em"),$t.style.position="relative",$t.style.top="".concat(q.div.renderedDepth,"em"),$t.style.marginTop="".concat(-q.div.renderedDepth,"em"),Gt.textAlign="center",Gt.font="".concat(mi,"px ").concat(fi),Gt.fillText("√",$t.width/2,$t.height*(1-wi.fontDimen.depthOf("√",fi)))),q.div.insertBefore($t,St),q.index.length&&((_t=document.createElement("div")).style.display="inline-block",_t.style.position="relative",ii(q.index,"scriptscript",!1,ni,_t),_t.style.fontSize="50px",di.appendChild(_t),_t.style.marginLeft="".concat(Math.max(-(_t.offsetWidth+1)/50,-(Yt+.05)/("script"==si?yi:"scriptscript"==si?1:.5)),"em"),di.removeChild(_t),_t.style.fontSize="".concat("script"==si?yi:"scriptscript"==si?1:.5,"em"),_t.style.top="".concat(-Math.max(Jt-q.div.renderedDepth,wi.fontDimen.heightOf("x",fi)/2)/("script"==si?yi:"scriptscript"==si?1:.5)-_t.renderedDepth-.1,"em"),_t.style.left="".concat((.05+Yt)/("script"==si?yi:"scriptscript"==si?1:.5),"em"),q.div.insertBefore(_t,$t))}return"continue"}if("rule"==q.type){var Kt=document.createElement("div"),Qt="100%",Zt="100%",ei="";Kt.style.background="currentColor",q.height&&((Qt=new ki(q.height)).em.value+=Qt.sp.value/65536/6*8/mi*65536,Qt=Qt.em.value/65536),q.depth&&((ei=new ki(q.depth)).em.value+=ei.sp.value/65536/6*8/mi*65536,ei=ei.em.value/65536),q.width&&((Zt=new ki(q.width)).em.value+=Zt.sp.value/65536/6*8/mi*65536,Zt=Zt.em.value/65536),"v"==q.ruleType?("100%"==Qt?(Kt.style.alignSelf="stretch",Kt.renderedDepth=0,Kt.renderedHeight=0):(Kt.style.height="".concat(Math.max(Qt+ei,0),"em"),Kt.style.marginBottom=Kt.style.top="".concat(ei,"em"),Kt.style.marginTop="".concat(-ei,"em"),Kt.style.position="relative",Kt.renderedHeight=Math.max(Qt,0),Kt.renderedDepth=Math.max(ei,0)),Zt<0?ci.push({type:"kern",dimen:new ki(0,65536*Zt)}):Kt.style.width="".concat(Zt,"em")):"h"==q.ruleType&&(Kt.style.width="100%"==Zt?"100%":"".concat(Zt,"em"),Kt.style.height="".concat(Math.max(Qt+ei,0),"em"),Kt.style.marginBottom=Kt.style.top="".concat(ei,"em"),Kt.style.marginTop="".concat(-ei,"em"),Kt.style.position="relative",ci.push({type:"atom",atomType:vi.ORD,nucleus:{},superscript:null,subscript:null,style:si,isLineBreak:!0,div:document.createElement("div")}),ci[ci.length-1].div.style.width="100%",hi.push(ci[ci.length-1]));var ti={type:"atom",atomType:vi.ORD,nucleus:null,superscript:null,subscript:null,style:si,div:Kt,isLineBreak:"h"==q.ruleType,growHeight:"v"==q.ruleType};return ci.push(ti),hi.push(ti),"h"==q.ruleType&&(ci.push({type:"atom",atomType:vi.ORD,nucleus:null,superscript:null,subscript:null,isLineBreak:!0,div:document.createElement("div")}),ci[ci.length-1].div.style.width="100%",hi.push(ci[ci.length-1])),"continue"}};for(var r=0;r<ai.length;r++)s(r);hi.length&&hi[hi.length-1].atomType==vi.BIN&&(hi[hi.length-1].atomType=vi.ORD);ci.length||(oi.empty=!0);for(var r=0,n=ci.length;r<n;r++){var l,o,c,h,d=ci[r],p=hi.indexOf(d);if(d.italicCorrection&&(d.dimen=new ki(0,65536*wi.fontDimen.italCorrOf(d.italicCorrection,fi))),"glue"==d.type&&"dimension"==d.glue.stretch.type&&0==d.glue.stretch.sp.value&&0==d.glue.stretch.em.value&&"dimension"==d.glue.shrink.type&&0==d.glue.shrink.sp.value&&0==d.glue.shrink.em.value&&(d.type="kern",d.dimen=d.glue.start),"vkern"!=d.type||!d.dimen.sp.value&&!d.dimen.em.value)if("kern"!=d.type||!d.dimen.sp.value&&!d.dimen.em.value)if("glue"!=d.type){if("atom"==d.type){if(0!=p&&d.atomType==vi.BIN&&("display"!=si&&"text"!=si||((l=document.createElement("div")).style.flexShrink=1,l.style.flexGrow=1,l.style.maxWidth="".concat(6/18,"em"),l.style.width="".concat(4/18,"em"),i.push(l)),(o=document.createElement("div")).style.display="inline-flex",o.style.flexWrap="nowrap",o.style.alignItems="baseline",a&&(o.style.position="relative",o.style.marginTop="".concat(a/65536,"em"),o.style.marginBottom="".concat(-a/65536,"em"),o.style.top="".concat(-a/65536,"em"),o.verticalRaise=a),i.push(o)),0!=p&&d.atomType==vi.REL&&("display"!=si&&"text"!=si||hi[p-1].atomType==vi.REL||hi[p-1].atomType==vi.OPEN||(c=document.createElement("div"),6==hi[p-1].atomType?c.style.width="".concat(3/18,"em"):(c.style.flexGrow=1,c.style.maxWidth="".concat(10/18,"em"),c.style.minWidth="".concat(5/18,"em")),i.push(c)),(h=document.createElement("div")).style.display="inline-flex",h.style.flexWrap="nowrap",h.style.alignItems="baseline",a&&(h.style.position="relative",h.style.marginTop="".concat(a/65536,"em"),h.style.marginBottom="".concat(-a/65536,"em"),h.style.top="".concat(-a/65536,"em"),h.verticalRaise=a),i.push(h)),0!=p){var m=[vi.ORD,vi.OP,vi.BIN,vi.REL,vi.OPEN,vi.CLOSE,vi.PUNCT,vi.INNER],f=m.indexOf(hi[p-1].atomType);f=~f?f:0;var u=m.indexOf(d.atomType),v=[[0,1,0,0,0,0,0,-1],[1,1,0,0,0,0,0,-1],[-2,-2,0,0,-2,0,0,-2],[-3,-3,0,0,-3,0,0,-3],[0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,-1],[0,0,0,0,0,0,0,0],[-1,1,0,0,-1,0,-1,-1]][f][u=~u?u:0],g=document.createElement("div");switch(v<0&&(v="script"==d.style||"scriptscript"==d.style?0:-v),v){case 1:g.style.minWidth="".concat(3/18,"em"),g.style.maxWidth="".concat(3/18,"em");break;case 2:g.style.width="".concat(4/18,"}em"),g.style.maxWidth="".concat(6/18,"em"),g.style.flexGrow=1,g.style.flexShrink=1;break;case 3:g.style.minWidth="".concat(5/18,"em"),g.style.maxWidth="".concat(10/18),g.style.flexGrow=1}v&&i[i.length-1].appendChild(g)}var y,b,w,x,k=i[i.length-1];k.renderedHeight=Math.max(k.renderedHeight||0,d.div.renderedHeight),k.renderedDepth=Math.max(k.renderedDepth||0,d.div.renderedDepth),d.div.baseline+d.div.baselineOffset<k.baseline+k.baselineOffset?(k.baseline=k.baseline||0,k.baselineOffset=k.baselineOffset||0):(k.baseline=d.div.baseline,k.baselineOffset=d.div.baselineOffset),d.isLineBreak?(i.push(d.div),(y=document.createElement("div")).style.display="inline-flex",y.style.flexWrap="nowrap",y.style.alignItems="baseline",a&&(y.style.position="relative",y.style.marginTop="".concat(a/65536,"em"),y.style.marginBottom="".concat(-a/65536,"em"),y.style.top="".concat(-a/65536,"em"),y.verticalRaise=a),i.push(y)):d.growHeight?((b=document.createElement("div")).style.display="inline-flex",b.style.flexWrap="nowrap",b.style.alignItems="baseline",b.style.alignSelf="stretch",a&&(b.style.position="relative",b.style.marginTop="".concat(a/65536,"em"),b.style.marginBottom="".concat(-a/65536,"em"),b.style.top="".concat(-a/65536,"em"),b.verticalRaise=a),b.appendChild(d.div),i.push(b),(b=document.createElement("div")).style.display="inline-flex",b.style.flexWrap="nowrap",b.style.alignItems="baseline",a&&(b.style.position="relative",b.style.marginTop="".concat(a/65536,"em"),b.style.marginBottom="".concat(-a/65536,"em"),b.style.top="".concat(-a/65536,"em"),b.verticalRaise=a),i.push(b)):k.appendChild(d.div),d.atomType==vi.PUNCT&&("display"!=si&&"text"!=si||!hi[p+1]||hi[p+1].atomType==vi.REL||((w=document.createElement("div")).style.minWidth="".concat(3/18,"em"),w.style.maxWidth="".concat(3/18,"em"),i.push(w)),(x=document.createElement("div")).style.display="inline-flex",x.style.flexWrap="nowrap",x.style.alignItems="baseline",a&&(x.style.position="relative",x.style.marginTop="".concat(a/65536,"em"),x.style.marginBottom="".concat(-a/65536,"em"),x.style.top="".concat(-a/65536,"em"),x.verticalRaise=a),i.push(x))}}else{var S=document.createElement("div"),D=(d.glue.start.sp.value/12*16/mi+d.glue.start.em.value)/65536;S.style.width="".concat(D,"em"),"infinite dimension"==d.glue.stretch.type?S.style.flexGrow=d.glue.stretch.number.value/65536*Math.pow(1290,d.glue.stretch.magnitude.value):(d.glue.stretch.sp.value||d.glue.stretch.em.value)&&(S.style.flexGrow=1,S.style.maxWidth="".concat(D+(d.glue.stretch.sp.value/12*16/mi+d.glue.stretch.em.value)/65536,"em")),"infinite dimension"==d.glue.shrink.type?S.style.flexShrink=d.glue.shrink.number.value/65536*Math.pow(1290,d.glue.shrink.magnitude.value):(d.glue.shrink.sp.value||d.glue.shrink.em.value)&&(S.style.flexShrink=1,S.style.minWidth="".concat(D-(d.glue.shrink.sp.value/12*16/mi+d.glue.shrink.em.value)/65536,"em")),i.push(S);var C=document.createElement("div");C.style.display="inline-flex",C.style.flexWrap="nowrap",C.style.alignItems="baseline",a&&(C.style.position="relative",C.style.marginTop="".concat(a/65536,"em"),C.style.marginBottom="".concat(-a/65536,"em"),C.style.top="".concat(-a/65536,"em"),C.verticalRaise=a),i.push(C)}else{var E,A=i[i.length-1];A.lastElementChild&&!A.lastElementChild.style.marginRight||((E=document.createElement("div")).style.display="inline-block",A.appendChild(E)),A.lastElementChild.style.marginRight="".concat((d.dimen.sp.value/12*16/mi+d.dimen.em.value)/65536,"em")}else{a+=d.dimen.em.value,a+=d.dimen.sp.value/12*16/mi;var T=document.createElement("div");T.style.display="inline-flex",T.style.flexWrap="nowrap",T.style.alignItems="baseline",a&&(T.style.position="relative",T.style.marginTop="".concat(a/65536,"em"),T.style.marginBottom="".concat(-a/65536,"em"),T.style.top="".concat(-a/65536,"em"),T.verticalRaise=a),i.push(T)}}for(var O=0,L=i.length;O<L;O++)oi.appendChild(i[O]),oi.renderedHeight=Math.max(oi.renderedHeight||0,(i[O].renderedHeight||0)+(i[O].verticalRaise||0)/65536),oi.renderedDepth=Math.max(oi.renderedDepth||0,(i[O].renderedDepth||0)-(i[O].verticalRaise||0)/65536),i[O].baselineOffset+i[O].baseline<oi.baselineOffset+oi.baseline?(oi.baseline=oi.baseline||0,oi.baselineOffset=oi.baselineOffset||0):(oi.baseline=i[O].baseline,oi.baselineOffset=i[O].baselineOffset);e.appendChild(oi);e.renderedHeight=Math.max(e.renderedHeight||0,oi.renderedHeight);e.renderedDepth=Math.max(e.renderedDepth||0,oi.renderedDepth);oi.baselineOffset+oi.baseline<e.baselineOffset+e.baseline?(e.baseline=e.baseline||0,e.baselineOffset=e.baselineOffset||0):(e.baseline=oi.baseline,e.baselineOffset=oi.baselineOffset);return li}(e,M,!1,"nm",t),t.firstElementChild.empty&&1==t.children.length&&(t=document.createTextNode("")),t}function b(e,t){this.name=e,this.type="primitive",this.function=t}function w(e,t){this.type="macro",e instanceof b||e instanceof w?(e.proxy&&(e=e.original),this.proxy=!0,this.isLet=Boolean(t),this.original=e):(this.proxy=!1,this.replacement=e||[],this.parameters=t||[])}function Ue(e,t,i,a){this.type="integer",this.register=!0,this.message=a||"",e instanceof Ue?(this.value=e.value,this.parent=e,this.min=e.min,this.max=e.max):(this.min=null==t?Number.MIN_SAFE_INTEGER:t,this.max=null==i?Number.MAX_SAFE_INTEGER:i,e=!isNaN(e)&&Math.round(e)||0,isFinite(e)||(e=e<0?this.min:this.max),this.value=Math.max(this.min,Math.min(this.max,e)))}function ki(e,t,i){this.type="dimension",this.message=i||"",this.register=!0,e instanceof ki?(this.sp=new Ue(e.sp),this.em=new Ue(e.em),this.parent=e):e instanceof je?(this.sp=new Ue(0),this.em=new Ue(e.mu/18)):(this.sp=new Ue(e),this.em=new Ue(t))}function je(e,t){this.type="mu dimension",this.message=t||"",this.register=!0,e instanceof je?(this.mu=new Ue(e.mu),this.parent=e):this.mu=new Ue(e instanceof ki?e.em/18+e.sp/65536/12*18:e)}function Si(e,t,i,a){this.type="glue",this.message=a||"",this.register=!0,e instanceof Si?(this.start=new ki(e.start),this.stretch=new ki(e.stretch),this.shrink=new ki(e.shrink),this.parent=e):(this.start=new ki(e),this.stretch=t instanceof Ge?t:new ki(t),this.shrink=i instanceof Ge?i:new ki(i))}function Xe(e,t,i,a){this.type="mu glue",this.message=a||"",this.register=!0,e instanceof Xe?(this.start=new je(e.start),this.stretch=new je(e.stretch),this.shrink=new je(e.shrink),this.parent=e):(this.start=new je(e),this.stretch=t instanceof Ge?t:new je(t),this.shrink=i instanceof Ge?i:new je(i))}function Ge(e,t,i){this.type="infinite dimension",this.message=i||"",this.register=!0,this.number=new Ue(e),this.magnitude=new Ue(t)}new MutationObserver(e).observe(document,{childList:!0,subtree:!0}),e(),wi.ParsedFontTeX=function(e,t){this.texString=e,this.parsedTokens=t},wi.ParsedFontTeX.prototype={renderIn:function(i){s.then(function(){for(var w=this,x=a(i),k=w.parsedTokens.slice(),e=function(e){x[e].innerHTML="";var t,i,a=void 0;x[e].hasAttribute("data-fontTeX-container-id")?(t=+x[e].getAttribute("data-fontTeX-container-id"),a=S[t].styles,S[t].oldFontFamily=a.fontFamily,S[t].oldFontSize=a.fontSize,S[t].oldColor=a.color,S[t].parsedTeXInstance=w):(i=S.length,a=getComputedStyle(x[e]),x[e].setAttribute("data-fontTeX-container-id",i),S[i]={elem:x[e],styles:a,parsedTeXInstance:w,oldFontFamily:a.fontFamily,oldFontSize:a.fontSize,oldColor:a.oldColor});var s=a.fontFamily;if(!function(e,a){for(var s=e.split(", ").map(function(e){return'"'==e[0]?e.substring(1,e.length-1):e}),r=1/0,t=0,i=s.length;t<i;t++)T.then(function(i){!function e(t){requestAnimationFrame(function(){if(C.includes(s[t]))t<r&&(r=t);else{if(i.style.fontFamily="".concat(s[t],", serif"),i.offsetWidth!=E)return C.push(s[t]),void(t<r&&a(s[r=t]));if(i.style.fontFamily="".concat(s[t],", sans-serif"),i.offsetWidth!=A)return C.push(s[t]),void(t<r&&a(s[r=t]));e(t)}})}(this)}.bind(t))}(s,function(){O(s),wi.rerender(this)}.bind(x[e])),xi.parsehtml[0]){for(var r,n="",l=[],o=0,c=k.length;o<c;o++){"string"==typeof k[o]?n+=k[o]:(r=uuidv4(),l.push([r,D(x[e],k[o][0],k[o][1],a)]),n+="<span data-fontTeX-uuid-".concat(r,"></span>"))}var h=document.createElement("div");h.innerHTML=n;for(var d=!1,p=0,m=l.length;p<m;p++){var f=h.querySelector("[data-fontTeX-uuid-".concat(l[p][0],"]"));f?(f.parentNode.insertBefore(l[p][1],f),f.parentNode.removeChild(f)):d=!0}d&&console.warn("Malformed HTML was passed into `renderIn`. Some TeX couldn't be rendered.\nPassed in value: ".concat(this.texString));for(var u=0,v=h.childNodes.length;u<v;u++)x[e].appendChild(h.firstChild)}else{for(var g=document.createDocumentFragment(),y=0,b=k.length;y<b;y++)"string"==typeof k[y]?g.appendChild(document.createTextNode(k[y])):g.appendChild(D(x[e],k[y][0],k[y][1],a));x[e].appendChild(g)}x[e].setAttribute("data-fontTeX-input",w.texString),x[e].setAttribute("data-fontTeX-is-parsed","true")},t=x.length-1;0<=t;t--)e(t)}.bind(this))},again:function(){return this.parsedTokens=wi.parse(this.texString).parsedTokens,this},reparse:function(){return this.parsedTokens=wi.parse(this.texString).parsedTokens,this},texString:"",parsedTokens:null},wi.global=function(e){var t=y(e,"standalone",!0);for(var i in t.defs.macros)_e.defs.macros[i]=t.defs.macros[i];for(var a in t.defs.active)_e.defs.active[a]=t.defs.active[a];var s=[];for(var r in t.registers.count){var n=new Ue(t.registers.count[r]);_e.registers.count[r]=n,s.push(n)}for(var l in t.registers.dimen){var o=new ki(t.registers.dimen[l]);_e.registers.dimen[l]=o,s.push(o)}for(var c in t.registers.skip){var h=new Si(t.registers.skip[c]);_e.registers.skip[c]=h,s.push(h)}for(var d in t.registers.muskip){var p=new Xe(t.registers.muskip[d]);_e.registers.muskip[d]=p,s.push(p)}for(var m in t.registers.named)s.includes(t.registers.named[m])?_e.registers.named[m]=t.registers.named[m]:"integer"==t.registers.named[m].type?_e.registers.named[m]=new Ue(t.registers.named[m]):"dimension"==t.registers.named[m].type?_e.registers.named[m]=new ki(t.registers.named[m]):"mu dimension"==t.registers.named[m].type?_e.registers.named[m]=new je(t.registers.named[m]):"glue"==t.registers.named[m].type?_e.registers.named[m]=new Si(t.registers.named[m]):"mu glue"==t.registers.named[m].type&&(_e.registers.named[m]=new Xe(t.registers.named[m]));for(var f in t.cats)_e.cats[f].value=t.cats[f].value;for(var u in t.mathcodes)_e.mathcodes[u].value=t.mathcodes[u].value;for(var v in t.uc)_e.uc[v].value=t.uc[v].value;for(var g in t.lc)_e.lc[g].value=t.lc[g].value};var _e={defs:{primitive:{"(":new b("(",function(e){return this.invalid=!0,[this]}),")":new b(")",function(e){return"inline"==e.style?[{type:"character",char:"$",code:"$".codePointAt(0),cat:We.MATHSHIFT}]:(this.invalid=!0,[this])}),"/":new b("/",function(e){return"superscript"==e.lastContext.type||"subscript"==e.lastContext.type?(this.invalid=!0,[this]):(e.tokens.push({type:"kern",dimen:new ki(0),italicCorrection:!0}),[])}),"[":new b("[",function(e){return this.invalid=!0,[this]}),"]":new b("]",function(e){return"display"==e.style?[{type:"character",char:"$",code:"$".codePointAt(0),cat:We.MATHSHIFT},{type:"character",char:"$",code:"$".codePointAt(0),cat:We.MATHSHIFT}]:(this.invalid=!0,[this])}),above:new b("above",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return this.invalid=!0,[this];var t=e.mouth.eat("dimension");return t?(e.lastScope.isFrac=!0,e.lastScope.fracRightDelim=e.lastScope.fracRightDelim=".",e.lastScope.barWidth=t,e.lastScope.root&&(e.lastScope.root.invalid=!0,e.lastScope.root=!1),e.lastScope.fracNumerator=e.lastScope.tokens,e.lastScope.tokens=[],[]):(this.invalid=!0,[this])}),abovewithdelims:new b("abovewithdelims",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(i&&("command"==i.type||"character"==i.type&&i.cat==We.ACTIVE)){var a=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,a)}else{if(!i||"character"!=i.type||!_e.delims.includes(i.code)||i.cat!=We.OTHER&&i.cat!=We.LETTER)return this.invalid=!0,e.mouth.loadState(t),delete e.lastScope.fracLeftDelim,[this];if(e.lastScope.fracLeftDelim){e.lastScope.fracRightDelim=i.char;break}e.lastScope.fracLeftDelim=i.char}}var s=e.mouth.eat("dimension");return s?(e.lastScope.isFrac=!0,e.lastScope.barWidth=s,e.lastScope.root&&(e.lastScope.root.invalid=!0,e.lastScope.root=!1),e.lastScope.fracNumerator=e.lastScope.tokens,e.lastScope.tokens=[],[]):(this.invalid=!0,[this])}),accent:new b("accent",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);e.mouth.eat("integer");return!charCode||charCode.value<0?(this.invalid=!0,e.mouth.loadState(t),[this]):(e.tokens.push({type:"accent modifier",char:String.fromCharCode(charCode.value),code:charCode.value,token:this}),[])}),advance:new b("advance",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=_e.cats.active)){if(i&&i.register){var a=e.mouth.eat();if(!a||"character"!=a.type||"b"!=a.char&&"B"!=a.char||a.cat==_e.cats.active){if(!a)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert()}else{var s=e.mouth.eat();s&&"character"==s.type&&("y"==s.char||"Y"==s.char)&&s.cat!=_e.cats.active||e.mouth.revert(2)}if("integer"==i.type){if(!(a=e.mouth.eat("integer")))return this.invalid=!0,e.mouth.loadState(t),[this];i.value+=a.value;var r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).value=r.value;e.toggles.global=!1}else if("dimension"==i.type){if(!(a=e.mouth.eat("dimension")))return this.invalid=!0,e.mouth.loadState(t),[this];i.sp.value+=a.sp.value,i.em.value+=a.em.value;r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).sp.value=r.sp.value,i.em.value=r.em.value;e.toggles.global=!1}else if("mu dimension"==i.type){if(!(a=e.mouth.eat("mu dimension")))return this.invalid=!0,e.mouth.loadState(t),[this];i.mu.value+=a.mu.value;r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).mu.value=r.mu.value;e.toggles.global=!1}else if("glue"==i.type){if(!(a=e.mouth.eat("glue")))return this.invalid=!0,e.mouth.loadState(t),[this];i.start.sp.value+=a.start.sp.value,i.start.em.value+=a.start.em.value,"infinite dimension"==a.stretch.type?"infinite dimension"==i.stretch.type&&i.stretch.magnitude.value==a.stretch.magnitude.value?i.stretch.value+=a.stretch.value:("infinite dimension"!=i.stretch.type||i.stretch.magnitude.value<a.stretch.magnitude.value)&&(i.stretch=new Ge(a.stretch.number.value,a.stretch.magnitude.value)):"infinite dimension"!=i.stretch.type&&(i.stretch.sp.value+=a.stretch.sp.value,i.stretch.em.value+=a.stretch.em.value),"infinite dimension"==a.shrink.type?"infinite dimension"==i.shrink.type&&i.shrink.magnitude.value==a.shrink.magnitude.value?i.shrink.value+=a.shrink.value:("infinite dimension"!=i.shrink.type||i.shrink.magnitude.value<a.shrink.magnitude.value)&&(i.shrink=new Ge(a.shrink.number.value,a.shrink.magnitude.value)):"infinite dimension"!=i.shrink.type&&(i.shrink.sp.value+=a.shrink.sp.value,i.shrink.em.value+=a.shrink.em.value);r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.sp.value+=a.start.sp.value,i.start.em.value+=a.start.em.value,"infinite dimension"==r.stretch.type?i.stretch=new Ge(r.stretch.number.value,r.stretch.magnitude.value):i.stretch=new ki(r.stretch.sp.value,r.stretch.em.value),"infinite dimension"==r.shrink.type?i.shrink=new Ge(r.shrink.number.value,r.shrink.magnitude.value):i.shrink=new ki(r.shrink.sp.value,r.shrink.em.value);e.toggles.global=!1}else if("mu glue"==i.type){if(!(a=e.mouth.eat("mu glue")))return this.invalid=!0,e.mouth.loadState(t),[this];i.start.mu.value+=a.start.mu.value,"infinite dimension"==a.stretch.type?"infinite dimension"==i.stretch.type&&i.stretch.magnitude.value==a.stretch.magnitude.value?i.stretch.value+=a.stretch.value:("infinite dimension"!=i.stretch.type||i.stretch.magnitude.value<a.stretch.magnitude.value)&&(i.stretch=new Ge(a.stretch.number.value,a.stretch.magnitude.value)):"infinite dimension"!=i.stretch.type&&(i.stretch.mu.value+=a.stretch.mu.value),"infinite dimension"==a.shrink.type?"infinite dimension"==i.shrink.type&&i.shrink.magnitude.value==a.shrink.magnitude.value?i.shrink.value+=a.shrink.value:("infinite dimension"!=i.shrink.type||i.shrink.magnitude.value<a.shrink.magnitude.value)&&(i.shrink=new Ge(a.shrink.number.value,a.shrink.magnitude.value)):"infinite dimension"!=i.shrink.type&&(i.shrink.mu.value+=a.shrink.mu.value);r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.mu.value=r.start.mu.value,"infinite dimension"==r.stretch.type?i.stretch=new Ge(r.stretch.number.value,r.stretch.magnitude.value):i.stretch=new je(r.stretch.mu.value),"infinite dimension"==r.shrink.type?i.shrink=new Ge(r.shrink.number.value,r.shrink.magnitude.value):i.stretch=new je(r.shrink.mu.value);e.toggles.global=!1}break}return this.invalid=!0,e.mouth.loadState(t),[this]}var n=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,n)}return[]}),atop:new b("atop",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.scopes.last().isFrac=!0,e.scopes.last().fracLeftDelim=e.scopes.last().fracRightDelim=".",e.scopes.last().barWidth=new ki(0),e.scopes.last().root&&(e.scopes.last().root.invalid=!0,e.scopes.last().root=!1),e.scopes.last().fracNumerator=e.scopes.last().tokens,e.scopes.last().tokens=[],[])}),atopwithdelims:new b("atopwithdelims",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(i&&("command"==i.type||"character"==i.type&&i.cat==_e.cats.active)){var a=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,a)}else{if(!i||"character"!=i.type||!_e.delims.includes(i.code)||i.cat!=_e.cats.all&&i.cat!=_e.cats.letter)return this.invalid=!0,e.mouth.loadState(t),delete e.scopes.last().fracLeftDelim,[this];if(e.scopes.last().fracLeftDelim){e.scopes.last().fracRightDelim=i.char;break}e.scopes.last().fracLeftDelim=i.char}}return e.scopes.last().isFrac=!0,e.scopes.last().barWidth=new ki(0),e.scopes.last().root&&(e.scopes.last().root.invalid=!0,e.scopes.last().root=!1),e.scopes.last().fracNumerator=e.scopes.last().tokens,e.scopes.last().tokens=[],[]}),begingroup:new b("begingroup",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),new e.Scope,e.scopes.last().semisimple=!0,e.openGroups.push(this),e.contexts.push({toString:function(){return"scope"},type:"scope"}),this.ignore=!0,e.scopes.last().tokens.push(this),[]}),bf:new b("bf",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"bf"}),[])}),catcode:new b("catcode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");if(t){if(t.value<0)return e.mouth.revert(),this.invalid=!0,[this];if(!(t.value in _e.cats)){_e.cats[t.value]=new Ue(_e.cats.all,0,15);for(var i=0,a=e.scopes.length;i<a;i++)e.scopes[i].cats[t.value]=new Ue((0==i?_e:e.scopes[i-1]).cats[t.value])}return[e.scopes.last().cats[t.value]]}return this.invalid=!0,[this]}),char:new b("char",function(e){var t=e.mouth.eat("integer");return!t||t.value<0?(this.invalid=!0,[this]):(e.mouth.queue.unshift({type:"character",cat:_e.cats.all,char:String.fromCharCode(t.value),code:t.value}),[])}),chardef:new b("chardef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||"command"!=i.type)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i.name in _e.defs.primitive||i.name in _e.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var a=e.mouth.eat();a&&"character"==a.type&&"="==a.char&&a.cat==_e.cats.all||a&&e.mouth.revert();var s=e.mouth.eat("integer");if(!s||s.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];var r=new w([{type:"character",cat:_e.cats.all,char:String.fromCharCode(s.value),code:s.value}],[]);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){_e.defs.macros[i.name]=r,delete _e.registers.named[i.name];for(var n=0,l=e.scopes.length;n<l;n++)e.scopes[n].defs.macros[i.name]=r,delete e.scopes[n].registers.named[i.name]}else e.scopes.last().defs.macros[i.name]=r,delete e.scopes.last().registers.named[i.name];e.toggles.global=!1}),count:new b("count",function(e){var t=e.mouth.eat("integer");if(!t||t.value<0)return this.invalid=!0,[this];if(!_e.registers.count[t.value]){_e.registers.count[t.value]=new Ue(0);for(var i=0,a=e.scopes.length;i<a;i++)e.scopes[i].registers.count[t.value]=new Ue((i?e.scopes[i-1]:_e).registers.count[t.value])}return[e.scopes.last().registers.count[t.value]]}),countdef:new b("countdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if("command"!=i.type)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i.name in _e.defs.primitive||i.name in _e.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var a=e.mouth.eat();a&&"character"==a.type&&"="==a.char&&a.cat==_e.cats.all||a&&e.mouth.revert();var s=e.mouth.eat("integer");if(!s||s.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i=i.name,s=s.value,!_e.registers.count[s]){_e.registers.count[s]=new Ue(0);for(var r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.count[s]=new Ue((r?e.scopes[r-1]:_e).registers.count[s])}if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){_e.registers.named[i]=_e.registers.count[s],delete _e.defs.macros[i];for(r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.named[i]=e.scopes[r].registers.count[s],delete e.scopes[r].defs.macros[i]}else e.scopes.last().registers.named[i]=e.scopes.last().registers.count[s],delete e.scopes.last().defs.macros[i]}),cr:new b("cr",function(e){if("scope"!=e.contexts.last)return this.invalid=!0,[this];for(var t=!1,i=e.scopes.length-1;0<=i;i--)if(e.scopes[i].isHalign||e.scopes[i].isHalignCell){t=e.scopes[i];break}if(!t)return this.invalid=!0,[this];var a=t.isHalign?t:t.parentScope;if((h=t.isHalign?null:a.cellData[a.cellData.length-1])&&h[h.length-1].omit&&(this.postPreamble=!0),this.postPreamble&&!e.scopes.last().isHalign&&!e.scopes.last().isHalignCell)return this.invalid=!0,[this];if(t.isHalignCell){if(!this.postPreamble){for(var s=-1,i=0,r=h.length;i<r;i++)s+=h[i].span;if(a.preamble[s])d=a.preamble[s][1];else{if(!~a.repeatPreambleAt)return this.invalid=!0,[this];var n=a.preamble.slice(a.repeatPreambleAt,a.preamble.length);d=n[(s-a.repeatPreambleAt)%n.length][1]}for(var l=[],i=0,r=d.length;i<r;i++){var o={};for(var c in d[i])o[c]=d[i][c];l.push(o)}return this.postPreamble=!0,l.concat(this)}e.scopes.last().root&&(e.scopes.last().root.invalid=!0),e.contexts.pop();var h,d=e.scopes.last().tokens;e.scopes.last().isFrac?(h[h.length-1].content.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:e.scopes.last().fracNumerator,denominator:d,barWidth:e.scopes.last().barWidth,delims:[e.scopes.last().fracLeftDelim,e.scopes.last().fracRightDelim],nullDelimiterSpace:new ki(e.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),e.scopes.pop()):(e.scopes.pop(),(h=e.scopes.last().cellData[e.scopes.last().cellData.length-1])[h.length-1].content=h[h.length-1].content.concat(d))}var p=Symbol(),m=!1;for(e.mouth.saveState(p);;){if(!(o=e.mouth.eat())){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}if("character"==o.type&&o.cat!=_e.cats.active){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}if("command"==o.type||"character"==o.type&&o.cat==_e.cats.active){if(o.name in e.scopes.last().registers.named){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}if(!(b="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char])){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}if(b===_e.defs.primitive.the||b.proxy&&b.original===_e.defs.primitive.the||b===_e.defs.primitive.expandafter||b.proxy&&b.original===_e.defs.primitive.expandafter||b===_e.defs.primitive.number||b.proxy&&b.original===_e.defs.primitive.number||b===_e.defs.primitive.romannumeral||b.proxy&&b.original===_e.defs.primitive.romannumeral||b===_e.defs.primitive.csname||b.proxy&&b.original===_e.defs.primitive.csname||b===_e.defs.primitive.string||b.proxy&&b.original===_e.defs.primitive.string||b===_e.defs.primitive.if||b.isLet&&b.original===_e.defs.primitive.if||b===_e.defs.primitive.ifcase||b.isLet&&b.original===_e.defs.primitive.ifcase||b===_e.defs.primitive.ifcat||b.isLet&&b.original===_e.defs.primitive.ifcat||b===_e.defs.primitive.ifdim||b.isLet&&b.original===_e.defs.primitive.ifdim||b===_e.defs.primitive.ifeof||b.isLet&&b.original===_e.defs.primitive.ifeof||b===_e.defs.primitive.iffalse||b.isLet&&b.original===_e.defs.primitive.iffalse||b===_e.defs.primitive.ifodd||b.isLet&&b.original===_e.defs.primitive.ifodd||b===_e.defs.primitive.ifnum||b.isLet&&b.original===_e.defs.primitive.ifnum||b===_e.defs.primitive.ifhmode||b.isLet&&b.original===_e.defs.primitive.ifhmode||b===_e.defs.primitive.ifinner||b.isLet&&b.original===_e.defs.primitive.ifinner||b===_e.defs.primitive.ifmmode||b.isLet&&b.original===_e.defs.primitive.ifmmode||b===_e.defs.primitive.iftrue||b.isLet&&b.original===_e.defs.primitive.iftrue||b===_e.defs.primitive.ifvmode||b.isLet&&b.original===_e.defs.primitive.ifvmode||b===_e.defs.primitive.ifvoid||b.isLet&&b.original===_e.defs.primitive.ifvoid||b===_e.defs.primitive.ifx||b.isLet&&b.original===_e.defs.primitive.ifx){if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]===o&&o.invalid){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}e.mouth.queue.unshift.apply(e.mouth.queue,w);continue}if(b===_e.defs.primitive.noalign||b.proxy&&b.original===_e.defs.primitive.noalign){e.mouth.preview().cat!=_e.cats.open?(e.mouth.loadState(p),e.scopes.last().noAligns.push(null)):m=!0;break}if("primitive"==b.type||b.proxy&&"primitive"==b.original.type){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]==-o&&o.invalid){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}}var f=Symbol();for(e.mouth.saveState(f);;){if(!(o=e.mouth.eat())){e.mouth.loadState(f);break}if("character"==o.type&&o.cat!=_e.cats.active){e.mouth.loadState(f);break}if("command"==o.type||"character"==o.type&&o.cat==_e.cats.active){if(o.name in e.scopes.last().registers.named){e.mouth.loadState(f);break}if(!(b="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char])){e.mouth.loadState(f);break}if(b===_e.defs.primitive.the||b.proxy&&b.original===_e.defs.primitive.the||b===_e.defs.primitive.expandafter||b.proxy&&b.original===_e.defs.primitive.expandafter||b===_e.defs.primitive.number||b.proxy&&b.original===_e.defs.primitive.number||b===_e.defs.primitive.romannumeral||b.proxy&&b.original===_e.defs.primitive.romannumeral||b===_e.defs.primitive.csname||b.proxy&&b.original===_e.defs.primitive.csname||b===_e.defs.primitive.string||b.proxy&&b.original===_e.defs.primitive.string||b===_e.defs.primitive.if||b.isLet&&b.original===_e.defs.primitive.if||b===_e.defs.primitive.ifcase||b.isLet&&b.original===_e.defs.primitive.ifcase||b===_e.defs.primitive.ifcat||b.isLet&&b.original===_e.defs.primitive.ifcat||b===_e.defs.primitive.ifdim||b.isLet&&b.original===_e.defs.primitive.ifdim||b===_e.defs.primitive.ifeof||b.isLet&&b.original===_e.defs.primitive.ifeof||b===_e.defs.primitive.iffalse||b.isLet&&b.original===_e.defs.primitive.iffalse||b===_e.defs.primitive.ifodd||b.isLet&&b.original===_e.defs.primitive.ifodd||b===_e.defs.primitive.ifnum||b.isLet&&b.original===_e.defs.primitive.ifnum||b===_e.defs.primitive.ifhmode||b.isLet&&b.original===_e.defs.primitive.ifhmode||b===_e.defs.primitive.ifinner||b.isLet&&b.original===_e.defs.primitive.ifinner||b===_e.defs.primitive.ifmmode||b.isLet&&b.original===_e.defs.primitive.ifmmode||b===_e.defs.primitive.iftrue||b.isLet&&b.original===_e.defs.primitive.iftrue||b===_e.defs.primitive.ifvmode||b.isLet&&b.original===_e.defs.primitive.ifvmode||b===_e.defs.primitive.ifvoid||b.isLet&&b.original===_e.defs.primitive.ifvoid||b===_e.defs.primitive.ifx||b.isLet&&b.original===_e.defs.primitive.ifx){if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]===o&&o.invalid){e.mouth.loadState(f);break}e.mouth.queue.unshift.apply(e.mouth.queue,w);continue}if(b===_e.defs.primitive.crcr||b.proxy&&b.original===_e.defs.primitive.crcr)break;if("primitive"==b.type||b.proxy&&"primitive"==b.original.type){e.mouth.loadState(f);break}if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]==-o&&o.invalid){e.mouth.loadState(f);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}}var u=Symbol();for(e.mouth.saveState(u);;){if(!(o=e.mouth.eat())){e.mouth.loadState(u);break}if("character"==o.type&&o.cat==_e.cats.close){if(~(a=e.scopes.last()).repeatPreambleAt)for(var v=Math.max.apply(Math,a.cellData.map(function(e){for(var t=0,i=0,a=e.length;i<a;i++)t+=e[i].span;return t})),g=a.tabSkips.slice(a.repeatPreambleAt+1,a.tabSkips.length),y=0;a.tabSkips.length<v+1;)a.tabSkips.push(g[y]),y=(y+1)%g.length;return e.scopes.pop(),e.scopes.last().tokens.push({type:"atom",atomType:"inner",nucleus:[{type:"table",cellData:a.cellData,tabSkips:a.tabSkips,noAligns:a.noAligns}],superscript:null,subscript:null}),[]}if("character"==o.type&&o.cat!=_e.cats.active){e.mouth.loadState(u);break}if("command"==o.type||"character"==o.type&&o.cat==_e.cats.active){if(o.name in e.scopes.last().registers.named){e.mouth.loadState(u);break}if(!(b="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char])){e.mouth.loadState(u);break}if(b===_e.defs.primitive.the||b.proxy&&b.original===_e.defs.primitive.the||b===_e.defs.primitive.expandafter||b.proxy&&b.original===_e.defs.primitive.expandafter||b===_e.defs.primitive.number||b.proxy&&b.original===_e.defs.primitive.number||b===_e.defs.primitive.romannumeral||b.proxy&&b.original===_e.defs.primitive.romannumeral||b===_e.defs.primitive.csname||b.proxy&&b.original===_e.defs.primitive.csname||b===_e.defs.primitive.string||b.proxy&&b.original===_e.defs.primitive.string||b===_e.defs.primitive.if||b.isLet&&b.original===_e.defs.primitive.if||b===_e.defs.primitive.ifcase||b.isLet&&b.original===_e.defs.primitive.ifcase||b===_e.defs.primitive.ifcat||b.isLet&&b.original===_e.defs.primitive.ifcat||b===_e.defs.primitive.ifdim||b.isLet&&b.original===_e.defs.primitive.ifdim||b===_e.defs.primitive.ifeof||b.isLet&&b.original===_e.defs.primitive.ifeof||b===_e.defs.primitive.iffalse||b.isLet&&b.original===_e.defs.primitive.iffalse||b===_e.defs.primitive.ifodd||b.isLet&&b.original===_e.defs.primitive.ifodd||b===_e.defs.primitive.ifnum||b.isLet&&b.original===_e.defs.primitive.ifnum||b===_e.defs.primitive.ifhmode||b.isLet&&b.original===_e.defs.primitive.ifhmode||b===_e.defs.primitive.ifinner||b.isLet&&b.original===_e.defs.primitive.ifinner||b===_e.defs.primitive.ifmmode||b.isLet&&b.original===_e.defs.primitive.ifmmode||b===_e.defs.primitive.iftrue||b.isLet&&b.original===_e.defs.primitive.iftrue||b===_e.defs.primitive.ifvmode||b.isLet&&b.original===_e.defs.primitive.ifvmode||b===_e.defs.primitive.ifvoid||b.isLet&&b.original===_e.defs.primitive.ifvoid||b===_e.defs.primitive.ifx||b.isLet&&b.original===_e.defs.primitive.ifx){if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]===o&&o.invalid){e.mouth.loadState(u);break}e.mouth.queue.unshift.apply(e.mouth.queue,w);continue}if("primitive"==b.type||b.proxy&&"primitive"==b.original.type){e.mouth.loadState(u);break}if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]==-o&&o.invalid){e.mouth.loadState(u);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}}var b,w,x=Symbol();for(e.mouth.saveState(x),e.scopes.last().cellData.push([{type:"cell",content:[],omit:!1,span:1}]);;){if(!(o=e.mouth.eat())){e.mouth.loadState(x);break}if("character"==o.type&&o.cat!=_e.cats.active){e.mouth.loadState(x);break}if("command"==o.type||"character"==o.type&&o.cat==_e.cats.active){if(o.name in e.scopes.last().registers.named){e.mouth.loadState(x);break}if(!(b="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char])){e.mouth.loadState(x);break}if(b===_e.defs.primitive.the||b.proxy&&b.original===_e.defs.primitive.the||b===_e.defs.primitive.expandafter||b.proxy&&b.original===_e.defs.primitive.expandafter||b===_e.defs.primitive.number||b.proxy&&b.original===_e.defs.primitive.number||b===_e.defs.primitive.romannumeral||b.proxy&&b.original===_e.defs.primitive.romannumeral||b===_e.defs.primitive.csname||b.proxy&&b.original===_e.defs.primitive.csname||b===_e.defs.primitive.string||b.proxy&&b.original===_e.defs.primitive.string||b===_e.defs.primitive.if||b.isLet&&b.original===_e.defs.primitive.if||b===_e.defs.primitive.ifcase||b.isLet&&b.original===_e.defs.primitive.ifcase||b===_e.defs.primitive.ifcat||b.isLet&&b.original===_e.defs.primitive.ifcat||b===_e.defs.primitive.ifdim||b.isLet&&b.original===_e.defs.primitive.ifdim||b===_e.defs.primitive.ifeof||b.isLet&&b.original===_e.defs.primitive.ifeof||b===_e.defs.primitive.iffalse||b.isLet&&b.original===_e.defs.primitive.iffalse||b===_e.defs.primitive.ifodd||b.isLet&&b.original===_e.defs.primitive.ifodd||b===_e.defs.primitive.ifnum||b.isLet&&b.original===_e.defs.primitive.ifnum||b===_e.defs.primitive.ifhmode||b.isLet&&b.original===_e.defs.primitive.ifhmode||b===_e.defs.primitive.ifinner||b.isLet&&b.original===_e.defs.primitive.ifinner||b===_e.defs.primitive.ifmmode||b.isLet&&b.original===_e.defs.primitive.ifmmode||b===_e.defs.primitive.iftrue||b.isLet&&b.original===_e.defs.primitive.iftrue||b===_e.defs.primitive.ifvmode||b.isLet&&b.original===_e.defs.primitive.ifvmode||b===_e.defs.primitive.ifvoid||b.isLet&&b.original===_e.defs.primitive.ifvoid||b===_e.defs.primitive.ifx||b.isLet&&b.original===_e.defs.primitive.ifx){if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]===o&&o.invalid){e.mouth.loadState(x);break}e.mouth.queue.unshift.apply(e.mouth.queue,w);continue}if(b===_e.defs.primitive.omit||b.proxy&&b.original===_e.defs.primitive.omit){e.scopes.last().cellData[e.scopes.last().cellData.length-1][0].omit=!0;break}if("primitive"==b.type||b.proxy&&"primitive"==b.original.type){e.mouth.loadState(x);break}if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]==-o&&o.invalid){e.mouth.loadState(x);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}}a=e.scopes.last();if(e.contexts.push({toString:function(){return"scope"},type:"scope"}),new e.Scope,e.scopes.last().isHalignCell=!0,e.scopes.last().noAligned=m,a.cellData[a.cellData.length-1][0].omit)return[];for(l=[],i=0,r=(d=a.preamble[0][0]).length;i<r;i++){o={};for(var c in d[i])o[c]=d[i][c];l.push(o)}return l}),crcr:new b("crcr",null),csname:new b("csname",function(e){var t=Symbol();e.mouth.saveState(t);for(var i=[];;){var a=e.mouth.eat("pre space");if(!a)return this.invalid=!0,e.mouth.loadState(t),[this];if(0!=i.length||a.cat!=_e.cats.whitespace)if("command"==a.type||"character"==a.type&&a.cat==_e.cats.active){if(a.name in e.scopes.last().registers.named)return this.invalid=!0,e.mouth.loadState(t),[this];var s,r="command"==a.type?e.scopes.last().defs.primitive[a.name]||e.scopes.last().defs.macros[a.name]:e.scopes.last().defs.active[a.char];if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if(r.proxy&&(r=r.original),r===_e.defs.primitive.endcsname)break;if(r===_e.defs.primitive.the||r===_e.defs.primitive.expandafter||r===_e.defs.primitive.number||r===_e.defs.primitive.romannumeral||r===_e.defs.primitive.csname||r===_e.defs.primitive.string||r===_e.defs.primitive.if||r===_e.defs.primitive.ifcase||r===_e.defs.primitive.ifcat||r===_e.defs.primitive.ifdim||r===_e.defs.primitive.ifeof||r===_e.defs.primitive.iffalse||r===_e.defs.primitive.ifodd||r===_e.defs.primitive.ifnum||r===_e.defs.primitive.ifhmode||r===_e.defs.primitive.ifinner||r===_e.defs.primitive.ifmmode||r===_e.defs.primitive.iftrue||r===_e.defs.primitive.ifvmode||r===_e.defs.primitive.ifvoid||r===_e.defs.primitive.ifx){if(1==(s=e.mouth.expand(a,e.mouth)).length&&s[0]===a&&s[0].invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,s);continue}if(r instanceof b)return this.invalid=!0,e.mouth.loadState(t),[this];if(1==(s=e.mouth.expand(a,e.mouth)).length&&s[0]===a&&s[0].invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,s)}else i.push(a)}return[{type:"command",nameType:"command",escapeChar:String.fromCharCode(e.scopes.last().registers.named.escapechar.value),name:i.map(function(e){return e.char}).join("")}]}),day:new b("day",function(e){return[new Ue((new Date).getDate())]}),def:new b("def",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("character"==a.type){if(e.catOf(a.char)!=_e.cats.active)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",a=a.char}else if("command"==a.type&&(i="macro",(a=a.name)in e.scopes.last().defs.primitive||_e.parameters.includes(a)))return this.invalid=!0,e.mouth.loadState(t),[this];for(var s=[],r=0,n=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if(o.cat==_e.cats.open){e.mouth.revert();break}if(o.cat==_e.cats.param){var l=e.mouth.eat("pre space");if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.cat==_e.cats.open)n=!0,e.mouth.revert(),s.push({type:"character",cat:_e.cats.open,char:l.char,code:l.code});else{if(!(48<l.code&&l.code<58&&l.cat==_e.cats.all&&+l.char==r+1))return this.invalid=!0,e.mouth.loadState(t),[this];s.push(o),r++}}else s.push(o)}for(var o,c=0,h=[],d=!1;;){if(!(o=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=o.type||o.cat!=_e.cats.param||d)if("character"==o.type&&o.cat==_e.cats.open)c++;else if("character"==o.type&&o.cat==_e.cats.close){if(0==--c)break}else d=d&&!1;else{var p=e.mouth.eat("pre space");if(!p||!(p.cat==_e.cats.param||p.cat==_e.cats.all&&p.char<=s.length&&1<=p.char))return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert(),p.cat==_e.cats.param&&(d=!0)}h.push(o)}h.shift(),n&&h.push(s[s.length-1]);var m=new w(h,s);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)if("macro"==i){_e.defs.macros[a]=m,delete _e.registers.named[a];for(var f=0,u=e.scopes.length;f<u;f++)e.scopes[f].defs.macros[a]=m,delete e.scopes[f].registers[a]}else{_e.defs.active[a]=m,delete _e.registers.named[a];for(f=0,u=e.scopes.length;f<u;f++)e.scopes[f].defs.ative[a]=m,delete e.scopes[f].registers[a]}else e.scopes.last().defs["macro"==i?"macros":"active"][a]=m,delete e.scopes.last().registers.named[a];return e.toggles.global=!1,[]}),dimen:new b("dimen",function(e){var t=e.mouth.eat("integer");if(!t||t.value<0)return this.invalid=!0,[this];if(!_e.registers.dimen[t.value]){_e.registers.dimen[t.value]=new ki(0,0);for(var i=0,a=e.scopes.length;i<a;i++)e.scopes[i].registers.dimen[t.value]=new ki((i?e.scopes[i-1]:_e).registers.dimen[t.value])}return[e.scopes.last().registers.dimen[t.value]]}),dimendef:new b("dimendef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if("command"!=i.type)return this.invalid=!0,e.mouth.loadState(countDefSym),[!0];if(i.name in _e.defs.primitive||i.name in _e.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var a=e.mouth.eat();a&&"character"==a.type&&"="==a.char&&a.cat==_e.cats.all||a&&e.mouth.revert();var s=e.mouth.eat("integer");if(!s||s.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i=i.name,s=s.value,!_e.registers.dimen[s]){_e.registers.dimen[s]=new ki(0,0);for(var r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.dimen[s]=new ki((r?e.scopes[r-1]:_e).registers.dimen[s])}if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){_e.registers.named[i]=_e.registers.dimen[s],delete _e.defs.macros[i];for(r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.named[i]=e.scopes[r].registers.dimen[s],delete e.scopes[r].defs.macros[i]}else e.scopes.last().registers.named[i]=e.scopes.last().registers.dimen[s],delete e.scopes.last().defs.macros[i]}),displaylimits:new b("displaylimits",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"limit modifier",value:"display",token:this}),[])}),displaystyle:new b("displaystyle",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"displaystyle"}),[])}),divide:new b("divide",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=We.ACTIVE)){if(i&&i.register){if(i&&i.register){var a=e.mouth.eat();if(!a||"character"!=a.type||"b"!=a.char&&"B"!=a.char||a.cat==_e.cats.active){if(!a)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert()}else{var s=e.mouth.eat();s&&"character"==s.type&&("y"==s.char||"Y"==s.char)&&s.cat!=_e.cats.active||e.mouth.revert(2)}var r=e.mouth.eat("integer");if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if("integer"==i.type){i.value=~~(i.value/r.value);var n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).value=n.value;e.toggles.global=!1}else if("dimension"==i.type){i.sp.value=~~(i.sp.value/r.value),i.em.value=~~(i.em.value/r.value);n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).sp.value=n.sp.value,i.em.value=n.em.value;e.toggles.global=!1}else if("mu dimension"==i.type){i.mu.value=~~(i.mu.value/r.value);n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).mu.value=n.mu.value;e.toggles.global=!1}else if("glue"==i.type){i.start.sp.value=~~(i.start.sp.value/r.value),i.start.em.value=~~(i.start.em.value/r.value),"infinite dimension"==i.stretch.type?i.stretch.number.value=~~(i.stretch.number.value/r.value):(i.stretch.sp.value=~~(i.stretch.sp.value/r.value),i.stretch.em.value=~~(i.stretch.em.value/r.value)),"infinite dimension"==i.shrink.type?i.shrink.number.value=~~(i.shrink.number.value/r.value):(i.shrink.sp.value=~~(i.shrink.sp.value/r.value),i.shrink.em.value=~~(i.shrink.em.value/r.value));n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.sp.value=n.start.sp.value,i.start.em.value=n.start.em.value,"infinite dimension"==n.stretch.type?i.stretch=new Ge(n.stretch.number.value,n.stretch.magnitude.value):i.stretch=new ki(n.stretch.sp.value,n.stretch.em.value),"infinite dimension"==n.shrink.type?i.shrink=new Ge(n.shrink.number.value,n.shrink.magnitude.value):i.shrink=new ki(n.shrink.sp.value,n.shrink.em.value);e.toggles.global=!1}else if("mu glue"==i.type){i.start.mu.value=~~(i.start.mu.value/r.value),"infinite dimension"==i.stretch.type?i.stretch.number.value=~~(i.stretch.number.value/r.value):i.stretch.mu.value=~~(i.stretch.mu.value/r.value),"infinite dimension"==i.shrink.type?i.shrink.number.value=~~(i.shrink.number.value/r.value):i.shrink.mu.value=~~(i.shrink.mu.value/r.value);n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.mu.value=n.start.mu.value,"infinite dimension"==n.stretch.type?i.stretch=new Ge(n.stretch.number.value,n.stretch.magnitude.value):i.stretch=new je(n.stretch.mu.value),"infinite dimension"==n.shrink.type?i.shrink=new Ge(n.shrink.number.value,n.shrink.magnitude.value):i.shrink=new je(n.shrink.mu.value);e.toggles.global=!1}break}return this.invalid=!0,e.mouth.loadState(t),[this]}return this.invalid=!0,e.mouth.loadState(t),[this]}var l=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,l)}return[]}),edef:new b("edef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("character"==a.type){if(e.catOf(a.char)!=_e.cats.active)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",a=a.char}else if("command"==a.type&&(i="macro",(a=a.name)in e.scopes.last().defs.primitive||a in _e.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];for(var s=[],r=0,n=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if(o.cat==_e.cats.open){e.mouth.revert();break}if(o.cat==_e.cats.param){var l=e.mouth.eat("pre space");if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.cat==_e.cats.open)n=!0,e.mouth.revert(),s.push({type:"character",cat:_e.cats.open,char:l.char,code:l.code});else{if(!(48<l.code&&l.code<58&&l.cat==_e.cats.all&&+l.char==r+1))return this.invalid=!0,e.mouth.loadState(t),[this];s.push(o),r++}}else s.push(o)}for(var o,c=0,h=[],d=!1,p=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=o.type||o.cat!=_e.cats.param||p)if("character"==o.type&&o.cat==_e.cats.open)c++,h.push(o),d=!1;else if("character"==o.type&&o.cat==_e.cats.close){if(0==--c)break;h.push(o),d=!1}else if(d)h.push(o),d=!1;else if("command"==o.type||"character"==o.type&&o.cat==_e.cats.active){if(o.name in e.scopes.last().registers.named){h.push(o);continue}if(!(u="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char]))return this.invalid=!0,e.mouth.loadState(t),[this];if(u===_e.defs.primitive.the||u.proxy&&u.original===_e.defs.primitive.the||u===_e.defs.primitive.expandafter||u.proxy&&u.original===_e.defs.primitive.expandafter||u===_e.defs.primitive.number||u.proxy&&u.original===_e.defs.primitive.number||u===_e.defs.primitive.romannumeral||u.proxy&&u.original===_e.defs.primitive.romannumeral||u===_e.defs.primitive.csname||u.proxy&&u.original===_e.defs.primitive.csname||u===_e.defs.primitive.string||u.proxy&&u.original===_e.defs.primitive.string||u===_e.defs.primitive.if||u.isLet&&u.original===_e.defs.primitive.if||u===_e.defs.primitive.ifcase||u.isLet&&u.original===_e.defs.primitive.ifcase||u===_e.defs.primitive.ifcat||u.isLet&&u.original===_e.defs.primitive.ifcat||u===_e.defs.primitive.ifdim||u.isLet&&u.original===_e.defs.primitive.ifdim||u===_e.defs.primitive.ifeof||u.isLet&&u.original===_e.defs.primitive.ifeof||u===_e.defs.primitive.iffalse||u.isLet&&u.original===_e.defs.primitive.iffalse||u===_e.defs.primitive.ifodd||u.isLet&&u.original===_e.defs.primitive.ifodd||u===_e.defs.primitive.ifnum||u.isLet&&u.original===_e.defs.primitive.ifnum||u===_e.defs.primitive.ifhmode||u.isLet&&u.original===_e.defs.primitive.ifhmode||u===_e.defs.primitive.ifinner||u.isLet&&u.original===_e.defs.primitive.ifinner||u===_e.defs.primitive.ifmmode||u.isLet&&u.original===_e.defs.primitive.ifmmode||u===_e.defs.primitive.iftrue||u.isLet&&u.original===_e.defs.primitive.iftrue||u===_e.defs.primitive.ifvmode||u.isLet&&u.original===_e.defs.primitive.ifvmode||u===_e.defs.primitive.ifvoid||u.isLet&&u.original===_e.defs.primitive.ifvoid||u===_e.defs.primitive.ifx||u.isLet&&u.original===_e.defs.primitive.ifx){var m=e.mouth.expand(o,e.mouth);if(1==m.length&&m[0]===o&&o.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,m);continue}if(u===_e.defs.primitive.noexpand||u.proxy&&u.original===_e.defs.primitive.noexpand){d=!0;continue}if(u instanceof b||u.proxy&&u.original instanceof b){h.push(o);continue}e.mouth.queue.unshift.apply(e.mouth.queue,e.mouth.expand(o,e.mouth))}else h.push(o);else{var f=e.mouth.eat("pre space");if(!f||!(f.cat==_e.cats.param||f.cat==_e.cats.all&&f.char<=s.length&&1<=f.char))return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert(),f.cat==_e.cats.param&&(p=!0),h.push(o),d=!1}}h.shift(),n&&h.push(s[s.length-1]);var u=new w(h,s);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)if("macro"==i){_e.defs.macros[a]=u,delete _e.registers.named[a];for(var v=0,g=e.scopes.length;v<g;v++)e.scopes[v].defs.macros[a]=u,delete e.scopes[v].registers.named[a]}else{_e.defs.active[a]=u,delete _e.registers.named[a];for(v=0,g=e.scopes.length;v<g;v++)e.scopes[v].defs.ative[a]=u,delete e.scopes[v].registers.named[a]}else e.scopes.last().defs["macro"==i?"macros":"active"][a]=u,delete e.scopes.last().registers.named[a];return e.toggles.global=!1,[]}),else:new b("else",function(e){return this.invalid=!0,[this]}),endcsname:new b("endcsname",function(e){return this.invalid=!0,[this]}),endgroup:new b("endgroup",function(e){if(!e.openGroups.length||e.scopes.last().delimited||e.scopes.last().isHalign||e.scopes.last().isHalignCell||!e.scopes.last().semisimple||"scope"!=e.contexts.last)return this.invalid=!0,[this];e.scopes.last().root&&(e.scopes.last().root.invalid=!0),e.openGroups.pop(),e.contexts.pop();var t=e.scopes.last().tokens;e.scopes.last().isFrac?(e.scopes[e.scopes.length-2].tokens.push({type:"atom",atomType:0,nucleus:[{type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:e.scopes.last().fracNumerator,denominator:t,barWidth:e.scopes.last().barWidth,delims:[e.scopes.last().fracLeftDelim,e.scopes.last().fracRightDelim],nullDelimiterSpace:new ki(e.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}],superscript:null,subscript:null}),e.scopes.pop()):(e.scopes.pop(),e.scopes.last().tokens.push({type:"atom",atomType:0,nucleus:t,superscript:null,subscript:null}))}),Error:new b("Error",function(e){var t=Symbol();if(e.mouth.saveState(t),(i=e.mouth.eat())&&"character"==i.type&&i.cat==_e.cats.open){for(var i,a=0,s=[];;){if(!(i=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==i.type&&i.cat==_e.cats.open)a++,s.push(i.char);else if("character"==i.type&&i.cat==_e.cats.close){if(!a)break;a--,s.push(i.char)}else"command"==i.type?(s.push(i.escapeChar),s.push.apply(s,i.name.split(""))):s.push(i.char)}return s.map(function(e){return{type:"character",char:e,code:e.charCodeAt(0),cat:12,invalid:!0,recognized:!0}})}return this.invalid=!0,[this]}),expandafter:new b("expandafter",function(e){var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i)return this.invalid=!0,[this];var a=e.mouth.eat(),s=e.mouth.expand(a,e.mouth);return 1==s.length&&s[0]===a&&a.invalid?(this.invalid=!0,e.mouth.loadState(t),[this]):[i].concat(s)}),ExpandedError:new b("ExpandedError",function(e){var t=Symbol();if(e.mouth.saveState(t),(i=e.mouth.eat())&&"character"==i.type&&i.cat==_e.cats.open){for(var i,a=0,s=[],r=!1;;){if(!(i=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==i.type&&i.cat==_e.cats.open)a++,s.push(i.char),r=!1;else if("character"==i.type&&i.cat==_e.cats.close){if(!a)break;a--,s.push(i.char),r=!1}else if("command"==i.type||"character"==i.type&&i.cat==_e.cats.active){var n,l="command"==i.type?e.scopes.last().defs.primitive[i.name]||e.scopes.last().defs.macros[i.name]:e.scopes.last().defs.active[i.char];if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.proxy&&(l=l.original),l===_e.defs.primitive.noexpand){r=!0;continue}if(!(r||l!==_e.defs.primitive.the&&l!==_e.defs.primitive.expandafter&&l!==_e.defs.primitive.number&&l!==_e.defs.primitive.romannumeral&&l!==_e.defs.primitive.csname&&l!==_e.defs.primitive.string&&l!==_e.defs.primitive.if&&l!==_e.defs.primitive.ifcase&&l!==_e.defs.primitive.ifcat&&l!==_e.defs.primitive.ifdim&&l!==_e.defs.primitive.ifeof&&l!==_e.defs.primitive.iffalse&&l!==_e.defs.primitive.ifodd&&l!==_e.defs.primitive.ifnum&&l!==_e.defs.primitive.ifhmode&&l!==_e.defs.primitive.ifinner&&l!==_e.defs.primitive.ifmmode&&l!==_e.defs.primitive.iftrue&&l!==_e.defs.primitive.ifvmode&&l!==_e.defs.primitive.ifvoid&&l!==_e.defs.primitive.ifx)){if(1==(n=e.mouth.expand(i,e.mouth)).length&&n[0]===i&&n[0].invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,n),r=!1;continue}if(l instanceof b){s.push(String.fromCharCode(e.scopes.last().registers.named.escapechar.value)),s.push.apply(s,l.name.split("")),r=!1;continue}if(r)s.push(String.fromCharCode(e.scopes.last().registers.named.escapechar.value)),s.push.apply(s,i.name.split(""));else{if(1==(n=e.mouth.expand(i,e.mouth)).length&&n[0]===i&&n[0].invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,n)}r=!1}else s.push(i.char),r=!1}return s.map(function(e){return{type:"character",char:e,code:e.charCodeAt(0),cat:12,invalid:!0,recognized:!0}})}return this.invalid=!0,[this]}),fi:new b("fi",function(e){return this.invalid=!0,[this]}),futurelet:new b("futurelet",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("character"==a.type){if(e.catOf(a.char)!=_e.cats.active)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",a=a.char}else if("command"==a.type&&(i="macro",(a=a.name)in e.scopes.last().defs.primitive||a in _e.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];var s=e.mouth.eat();s&&"character"==s.type&&"="==s.char&&s.cat==_e.cats.all||s&&e.mouth.revert();var r=e.mouth.eat();if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];var n=e.mouth.eat();if(!n)return this.invalid=!0,e.mouth.loadState(t),[this];if("command"==n.type||"character"==n.type&&n.cat==_e.cats.active){if(h="command"==n.type?e.scopes.last().defs.primitive[n.name]||e.scopes.last().defs.macros[n.name]:e.scopes.last().defs.active[n.name])h=new w(h,"primitive"==h.type||h.isLet);else if("command"==n.type&&"macro"==i){var l=e.scopes.last().registers.named[n.name];if(l){if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){_e.registers.named[a]=l,delete _e.defs.macros[a];for(var o=0,c=e.scopes.length;o<c;o++)e.scopes[o].registers.named[a]=l,delete e.scopes[o].defs.macros[a]}else e.scopes.last().registers.named[a]=l,delete e.scopes.last().defs.macros[a];return e.toggles.global=!1,[]}}}else var h=new w(new w([n]),!0);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)if("macro"==i){h?_e.defs.macros[a]=h:delete _e.defs.macros[a],delete _e.registers.named[a];for(o=0,c=e.scopes.length;o<c;o++)h?e.scopes[o].defs.macros[a]=h:delete e.scopes[o].defs.macros[a],delete e.scopes[o].registers.named[a]}else{h?_e.defs.active[a]=h:delete e.scopes[o].defs.macros[a],delete _e.registers.named[a];for(o=0,c=e.scopes.length;o<c;o++)h?e.scopes[o].defs.ative[a]=h:delete e.scopes[o].defs.macros[a],delete e.scopes[o].registers.named[a]}else h?e.scopes.last().defs["macro"==i?"macros":"active"][a]=h:delete e.scopes.last().defs["macro"==i?"macros":"active"][a],delete e.scopes.last().registers.named[a];return e.toggles.global=!1,[r,n]}),gdef:new b("gdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("character"==a.type){if(e.catOf(a.char)!=_e.cats.active)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",a=a.char}else if("command"==a.type&&(i="macro",(a=a.name)in e.scopes.last().defs.primitive||a in _e.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];for(var s=[],r=0,n=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if(o.cat==_e.cats.open){e.mouth.revert();break}if(o.cat==_e.cats.param){var l=e.mouth.eat("pre space");if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.cat==_e.cats.open)n=!0,e.mouth.revert(),s.push({type:"character",cat:_e.cats.open,char:l.char,code:l.code});else{if(!(48<l.code&&l.code<58&&l.cat==_e.cats.all&&+l.char==r+1))return this.invalid=!0,e.mouth.loadState(t),[this];s.push(o),r++}}else s.push(o)}for(var o,c=0,h=[],d=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=o.type||o.cat!=_e.cats.param||d){if("character"==o.type&&o.cat==_e.cats.open)c++;else if("character"==o.type&&o.cat==_e.cats.close&&0==--c)break}else{var p=e.mouth.eat("pre space");if(!p||!(p.cat==_e.cats.param||p.cat==_e.cats.all&&p.char<=s.length&&1<=p.char))return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert(),p.cat==_e.cats.param&&(d=!0)}h.push(o)}h.shift(),n&&h.push(s[s.length-1]);var m=new w(h,s);if(e.scopes.last().registers.named.globaldefs.value<0)e.scopes.last().defs["macro"==i?"macros":"active"][a]=m,delete e.scopes.last().registers.named[a];else if("macro"==i){_e.defs.macros[a]=m,delete _e.registers.named[a];for(var f=0,u=e.scopes.length;f<u;f++)e.scopes[f].defs.macros[a]=m,delete e.scopes[f].registers.named[a]}else{_e.defs.active[a]=m,delete _e.registers.named[a];for(f=0,u=e.scopes.length;f<u;f++)e.scopes[f].defs.ative[a]=m,delete e.scopes[f].registers.named[a]}return e.toggles.global=!1,[]}),global:new b("global",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?this.invalid=!0:(e.toggles.global=this).ignore=!0,[this]}),halign:new b("halign",function(e){var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||i.cat!=_e.cats.open)return this.invalid=!0,e.mouth.loadState(t),[this];for(var a=[[[]]],s=-1,r=[new Si(e.scopes.last().registers.named.tabskip)],n=!1;;){if(!(i=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("command"==i.type||"character"==i.type&&i.cat==_e.cats.active){var l="command"==i.type?e.scopes.last().defs.primitive[i.name]||e.scopes.last().defs.macros[i.name]||e.scopes.last().registers.named[i.name]:e.scopes.last().defs.active[i.char];if(!(l=l&&l.isLet?l.original:l)){(a[a.length-1][1]||a[a.length-1][0]).push(i);continue}if(l===_e.defs.primitive.cr){if(a[a.length-1][1]){r.push(new Si(e.scopes.last().registers.named.tabskip));var o=n||r[0];(h=e.scopes.last().registers.named.tabskip).start.sp.value=o.start.sp.value,h.start.em.value=o.start.em.value,"infinite dimension"==o.stretch.type?h.stretch=new Ge(o.stretch.number.value,o.stretch.magnitude.value):h.stretch=new ki(o.stretch.sp.value,o.stretch.em.value),"infinite dimension"==o.shrink.type?h.shrink=new Ge(o.shrink.number.value,o.shrink.magnitude.value):h.shrink=new ki(o.shrink.sp.value,o.shrink.em.value);break}return this.invalid=!0,e.mouth.loadState(t),[this]}if(l===e.scopes.last().registers.named.tabskip){var c=Symbol();e.mouth.saveState(c);var h,d=e.mouth.eat();if(d&&"character"==d.type&&"="==d.char&&d.cat==_e.cats.all||d&&e.mouth.revert(),!(o=e.mouth.eat("glue"))){e.mouth.loadState(c),(a[a.length-1][1]||a[a.length-1][0]).push(i);continue}if((h=e.scopes.last().registers.named.tabskip).start.sp.value=o.start.sp.value,h.start.em.value=o.start.em.value,"infinite dimension"==o.stretch.type?h.stretch=new Ge(o.stretch.number.value,o.stretch.magnitude.value):h.stretch=new ki(o.stretch.sp.value,o.stretch.em.value),"infinite dimension"==o.shrink.type?h.shrink=new Ge(o.shrink.number.value,o.shrink.magnitude.value):h.shrink=new ki(o.shrink.sp.value,o.shrink.em.value),0<e.scopes.last().registers.named.globaldefs.value)for(n=new Si(h);h.parent;)(h=h.parent).start.sp.value=o.start.sp.value,h.start.em.value=o.start.em.value,"infinite dimension"==o.stretch.type?h.stretch=new Ge(o.stretch.number.value,o.stretch.magnitude.value):h.stretch=new ki(o.stretch.sp.value,o.stretch.em.value),"infinite dimension"==o.shrink.type?r.shrink=new Ge(o.shrink.number.value,o.shrink.magnitude.value):h.shrink=new ki(o.shrink.sp.value,o.shrink.em.value);continue}if(l===_e.defs.primitive.span){var p=e.mouth.eat();if(!p)return this.invalid=!0,e.mouth.loadState(t),[this];var m=e.mouth.expand(p,e.mouth);if(1==m.length&&m[0]===p&&p.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,m);continue}if(l.replacement&&l.replacement[0]&&l.replacement[0].cat==_e.cats.param){if(a[a.length-1][1])return this.invalid=!0,e.mouth.loadState(t),[this];a[a.length-1][1]=[];continue}if(l.replacement&&l.replacement[0]&&l.replacement[0].cat==_e.cats.alignment){if(~s||a[a.length-1][0].length||a[a.length-1][1]){if(!a[a.length-1][1])return this.invalid=!0,e.mouth.loadState(t),[this];a.push([[]]),r.push(new Si(e.scopes.last().registers.named.tabskip))}else s=a.length-1;continue}}else{if(i.cat==_e.cats.param){if(a[a.length-1][1])return this.invalid=!0,e.mouth.loadState(t),[this];a[a.length-1][1]=[];continue}if(i.cat==_e.cats.alignment){if(~s||a[a.length-1][0].length||a[a.length-1][1]){if(!a[a.length-1][1])return this.invalid=!0,e.mouth.loadState(t),[this];a.push([[]]),r.push(new Si(e.scopes.last().registers.named.tabskip))}else s=a.length-1;continue}if(i.cat==_e.cats.whitespace&&!a[a.length-1][0].length&&!a[a.length-1][1])continue}(a[a.length-1][1]||a[a.length-1][0]).push(i)}var f={type:"atom",atomType:0,nucleus:("command"==this.type?this.escapeChar+this.name:this.char).split("").map(function(e){return{type:"atom",atomType:0,nucleus:{type:"symbol",char:e,code:e.charCodeAt(0)},superscript:null,subscript:null}}),superscript:null,subscript:null,ignore:!0};return e.openGroups.push(f),e.contexts.push({toString:function(){return"scope"},type:"scope"}),new e.Scope,e.scopes.last().tokens.push(f),e.scopes.last().isHalign=!0,e.scopes.last().cellData=[],e.scopes.last().preamble=a,e.scopes.last().repeatPreambleAt=s,e.scopes.last().tabSkips=r,e.scopes.last().noAligns=[],e.mouth.revert(),[]}),hbox:new b("hbox",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t,i,a=Symbol();for(e.mouth.saveState(a);;){var s=e.mouth.eat();if(!s)return this.invalid=!0,[this];if("command"!=s.type&&("character"!=s.type||s.cat!=_e.cats.active)){if("character"!=s.type||"t"!=s.char&&"T"!=s.char){if("character"!=s.type||"s"!=s.char&&"S"!=s.char){if("character"!=s.type||s.cat!=_e.cats.open)return this.invalid=!0,e.mouth.loadState(a),[this];e.mouth.revert();break}var r=e.mouth.eat(),n=e.mouth.eat(),l=e.mouth.eat(),o=e.mouth.eat(),c=e.mouth.eat();if(!r||"character"!=r.type||"p"!=r.char&&"P"!=r.char||r.cat==_e.cats.active||!n||"character"!=n.type||"r"!=n.char&&"R"!=n.char||n.cat==_e.cats.active||!l||"character"!=l.type||"e"!=l.char&&"E"!=l.char||l.cat==_e.cats.active||!o||"character"!=o.type||"a"!=o.char&&"A"!=o.char||o.cat==_e.cats.active||!c||"character"!=c.type||"d"!=c.char&&"D"!=c.char||c.cat==_e.cats.active)return this.invalid=!0,e.mouth.loadState(a),[this];if(h=e.mouth.eat("dimension")){t=h;break}return this.invalid=!0,e.mouth.loadState(a),[this]}var h,d=e.mouth.eat("pre space");if(!d||"character"!=d.type||"o"!=d.char&&"O"!=s.char||s.cat==_e.cats.active)return this.invalid=!0,e.mouth.loadState(a),[this];if(h=e.mouth.eat("dimension")){i=h;break}return this.invalid=!0,e.mouth.loadState(a),[this]}var p="command"==s.type?e.scopes.last().defs.primitive[s.name]||e.scopes.last().defs.macros[s.name]:e.scopes.last().defs.active[s.char];if(p&&(p===_e.defs.primitive.relax||p.proxy&&p.original===_e.defs.primitive.relax))break;var m=e.mouth.expand(s,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,m)}var f=e.mouth.preview();return f&&"character"==f.type&&f.cat==_e.cats.open?(i||t||(t=new ki(0,0)),e.tokens.push({type:"box wrapper",value:"horizontal",to:i,spread:t,token:this}),[]):(this.invalid=!0,e.mouth.loadState(a),[this])}),hfil:new b("hfil",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"glue",glue:new Si(new ki(0),new Ge(65536,1),new ki(0))}),[])}),hfill:new b("hfill",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"glue",glue:new Si(new ki(0),new Ge(65536,2),new ki(0))}),[])}),hrule:new b("hrule",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);for(var i=!1,a=!1,s=!1;;){var r=e.mouth.eat();if(!r)break;if("h"!=r.char&&"H"!=r.char||r.cat==_e.cats.active){if("d"!=r.char&&"D"!=r.char||r.cat==_e.cats.active){if("w"!=r.char&&"W"!=r.char||r.cat==_e.cats.active){e.mouth.revert();break}if(!(r=e.mouth.eat("pre space"))||"i"!=r.char&&"I"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"d"!=r.char&&"D"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?5:4);else{if(r=e.mouth.eat("dimension")){s=r;continue}e.mouth.revert(5)}break}if(!(r=e.mouth.eat("pre space"))||"e"!=r.char&&"E"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"p"!=r.char&&"P"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?5:4);else{if(r=e.mouth.eat("dimension")){a=r;continue}e.mouth.revert(5)}break}if(!(r=e.mouth.eat("pre space"))||"e"!=r.char&&"E"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"i"!=r.char&&"I"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"g"!=r.char&&"G"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?5:4);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?6:5);else{if(r=e.mouth.eat("dimension")){i=r;continue}e.mouth.revert(6)}break}return i=i||new ki(0,65536/30),a=a||new ki(0,0),e.tokens.push({type:"rule",ruleType:"h",height:i,depth:a,width:s}),[]}),hskip:new b("hskip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("glue");return t?(e.tokens.push({type:"glue",glue:t}),[]):(this.invalid=!0,[this])}),if:new b("if",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);for(var i=[],a=!1;i.length<2;){var s=e.mouth.eat("pre space");if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=s.type||s.cat!=_e.cats.whitespace||0!=i.length)if("character"==s.type&&i.cat!=_e.cats.active)i.push(s),a=!1;else if(a)i.push(s),a=!1;else if("command"==s.type||"character"==s.type&&s.cat==_e.cats.active){if(s.name in e.scopes.last().registers.named){i.push(s);continue}var r,n="command"==s.type?e.scopes.last().defs.primitive[s.name]||e.scopes.last().defs.macros[s.name]:e.scopes.last().defs.active[s.char];if(!n)return this.invalid=!0,e.mouth.loadState(t),[this];if(n===_e.defs.primitive.the||n.proxy&&n.original===_e.defs.primitive.the||n===_e.defs.primitive.expandafter||n.proxy&&n.original===_e.defs.primitive.expandafter||n===_e.defs.primitive.number||n.proxy&&n.original===_e.defs.primitive.number||n===_e.defs.primitive.romannumeral||n.proxy&&n.original===_e.defs.primitive.romannumeral||n===_e.defs.primitive.csname||n.proxy&&n.original===_e.defs.primitive.csname||n===_e.defs.primitive.string||n.proxy&&n.original===_e.defs.primitive.string||n===_e.defs.primitive.if||n.isLet&&n.original===_e.defs.primitive.if||n===_e.defs.primitive.ifcase||n.isLet&&n.original===_e.defs.primitive.ifcase||n===_e.defs.primitive.ifcat||n.isLet&&n.original===_e.defs.primitive.ifcat||n===_e.defs.primitive.ifdim||n.isLet&&n.original===_e.defs.primitive.ifdim||n===_e.defs.primitive.ifeof||n.isLet&&n.original===_e.defs.primitive.ifeof||n===_e.defs.primitive.iffalse||n.isLet&&n.original===_e.defs.primitive.iffalse||n===_e.defs.primitive.ifodd||n.isLet&&n.original===_e.defs.primitive.ifodd||n===_e.defs.primitive.ifnum||n.isLet&&n.original===_e.defs.primitive.ifnum||n===_e.defs.primitive.ifhmode||n.isLet&&n.original===_e.defs.primitive.ifhmode||n===_e.defs.primitive.ifinner||n.isLet&&n.original===_e.defs.primitive.ifinner||n===_e.defs.primitive.ifmmode||n.isLet&&n.original===_e.defs.primitive.ifmmode||n===_e.defs.primitive.iftrue||n.isLet&&n.original===_e.defs.primitive.iftrue||n===_e.defs.primitive.ifvmode||n.isLet&&n.original===_e.defs.primitive.ifvmode||n===_e.defs.primitive.ifvoid||n.isLet&&n.original===_e.defs.primitive.ifvoid||n===_e.defs.primitive.ifx||n.isLet&&n.original===_e.defs.primitive.ifx){if(1==(r=e.mouth.expand(s,e.mouth)).length&&r[0]===s&&s.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,r);continue}if(n===_e.defs.primitive.noexpand||n.proxy&&n.original===_e.defs.primitive.noexpand){a=!0;continue}if(n instanceof b||n.proxy&&n.original instanceof b){i.push(s);continue}if(1==(r=e.mouth.expand(s,e.mouth)).length&&r[0]==-s&&s.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,r)}else i.push(s)}return l.call(this,"command"==i[0].type&&"command"==i[1].type||"character"==i[0].type&&i[0].char==i[1].char,e.mouth,e.scopes,t)}),ifcase:new b("ifcase",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var e=Symbol();a.mouth.saveState(e);var t=a.mouth.eat("integer");if(!t)return this.invalid=!0,[this];var i=[],s=!1;if((t=t.value)<0)o("else");else for(;0<t&&!s;t--)o("or");for(;;){var r=a.mouth.eat();if(!r)return this.invalid=!0,a.mouth.loadState(stateSymbol),[this];if("command"==r.type||"character"==r.type&&r.cat==_e.cats.active){var n="command"==r.type?a.scopes.last().defs.primitive[r.name]||a.scopes.last().defs.macros[r.name]:a.scopes.last().defs.active[r.char];if(n&&(n===_e.defs.primitive.fi||n.isLet&&n.original===_e.defs.primitive.fi))return i;if(!s&&n&&(n===_e.defs.primitive.or||n.isLet&&n.original===_e.defs.primitive.or||n===_e.defs.primitive.else||n.isLet&&n.original===_e.defs.primitive.else)){o("fi");continue}var l=a.mouth.expand(r,a.mouth);a.mouth.queue.unshift.apply(a.mouth.queue,l)}else i.push(r)}function o(e){for(;;){var t=a.mouth.eat();if(!t)return;if("command"==t.type||"character"==t.type&&t.cat===_e.cats.active){var i="command"==t.type?a.scopes.last().defs.primitive[t.name]||a.scopes.last().defs.macros[t.name]:a.scopes.last().defs.active[t.char];if(!i)continue;if(i===_e.defs.primitive.if||i.isLet&&i.original===_e.defs.primitive.if||i===_e.defs.primitive.ifcase||i.isLet&&i.original===_e.defs.primitive.ifcase||i===_e.defs.primitive.ifcat||i.isLet&&i.original===_e.defs.primitive.ifcat||i===_e.defs.primitive.ifdim||i.isLet&&i.original===_e.defs.primitive.ifdim||i===_e.defs.primitive.ifeof||i.isLet&&i.original===_e.defs.primitive.ifeof||i===_e.defs.primitive.iffalse||i.isLet&&i.original===_e.defs.primitive.iffalse||i===_e.defs.primitive.ifodd||i.isLet&&i.original===_e.defs.primitive.ifodd||i===_e.defs.primitive.ifnum||i.isLet&&i.original===_e.defs.primitive.ifnum||i===_e.defs.primitive.ifhmode||i.isLet&&i.original===_e.defs.primitive.ifhmode||i===_e.defs.primitive.ifinner||i.isLet&&i.original===_e.defs.primitive.ifinner||i===_e.defs.primitive.ifmmode||i.isLet&&i.original===_e.defs.primitive.ifmmode||i===_e.defs.primitive.iftrue||i.isLet&&i.original===_e.defs.primitive.iftrue||i===_e.defs.primitive.ifvmode||i.isLet&&i.original===_e.defs.primitive.ifvmode||i===_e.defs.primitive.ifvoid||i.isLet&&i.original===_e.defs.primitive.ifvoid||i===_e.defs.primitive.ifx||i.isLet&&i.original===_e.defs.primitive.ifx){o("fi"),a.mouth.eat();continue}if("or"==e&&(i===_e.defs.primitive.or||i.isLet&&i.original===_e.defs.primitive.or))return;if(("or"==e||"else"==e)&&(i===_e.defs.primitive.else||i.isLet&&i.original===_e.defs.primitive.else))return void(s=!0);if(i===_e.defs.primitive.fi||i.isLet&&i.original===_e.defs.primitive.fi)return void a.mouth.revert()}}}}),ifcat:new b("ifcat",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);for(var i=[],a=!1;i.length<2;){var s=e.mouth.eat("pre space");if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=s.type||s.cat!=_e.cats.whitespace||0!=i.length)if("character"==s.type&&i.cat!=_e.cats.active)i.push(s),a=!1;else if(a)i.push(s),a=!1;else if("command"==s.type||"character"==s.type&&s.cat==_e.cats.active){if(s.name in e.scopes.last().registers.named){i.push(s);continue}var r,n="command"==s.type?e.scopes.last().defs.primitive[s.name]||e.scopes.last().defs.macros[s.name]:e.scopes.last().defs.active[s.char];if(!n)return this.invalid=!0,e.mouth.loadState(t),[this];if(n===_e.defs.primitive.the||n.proxy&&n.original===_e.defs.primitive.the||n===_e.defs.primitive.expandafter||n.proxy&&n.original===_e.defs.primitive.expandafter||n===_e.defs.primitive.number||n.proxy&&n.original===_e.defs.primitive.number||n===_e.defs.primitive.romannumeral||n.proxy&&n.original===_e.defs.primitive.romannumeral||n===_e.defs.primitive.csname||n.proxy&&n.original===_e.defs.primitive.csname||n===_e.defs.primitive.string||n.proxy&&n.original===_e.defs.primitive.string||n===_e.defs.primitive.if||n.isLet&&n.original===_e.defs.primitive.if||n===_e.defs.primitive.ifcase||n.isLet&&n.original===_e.defs.primitive.ifcase||n===_e.defs.primitive.ifcat||n.isLet&&n.original===_e.defs.primitive.ifcat||n===_e.defs.primitive.ifdim||n.isLet&&n.original===_e.defs.primitive.ifdim||n===_e.defs.primitive.ifeof||n.isLet&&n.original===_e.defs.primitive.ifeof||n===_e.defs.primitive.iffalse||n.isLet&&n.original===_e.defs.primitive.iffalse||n===_e.defs.primitive.ifodd||n.isLet&&n.original===_e.defs.primitive.ifodd||n===_e.defs.primitive.ifnum||n.isLet&&n.original===_e.defs.primitive.ifnum||n===_e.defs.primitive.ifhmode||n.isLet&&n.original===_e.defs.primitive.ifhmode||n===_e.defs.primitive.ifinner||n.isLet&&n.original===_e.defs.primitive.ifinner||n===_e.defs.primitive.ifmmode||n.isLet&&n.original===_e.defs.primitive.ifmmode||n===_e.defs.primitive.iftrue||n.isLet&&n.original===_e.defs.primitive.iftrue||n===_e.defs.primitive.ifvmode||n.isLet&&n.original===_e.defs.primitive.ifvmode||n===_e.defs.primitive.ifvoid||n.isLet&&n.original===_e.defs.primitive.ifvoid||n===_e.defs.primitive.ifx||n.isLet&&n.original===_e.defs.primitive.ifx){if(1==(r=e.mouth.expand(s,e.mouth)).length&&r[0]===s&&s.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,r);continue}if(n===_e.defs.primitive.noexpand||n.proxy&&n.original===_e.defs.primitive.noexpand){a=!0;continue}if(n instanceof b||n.proxy&&n.original instanceof b){i.push(s);continue}if(1==(r=e.mouth.expand(s,e.mouth)).length&&r[0]==-s&&s.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,r)}else i.push(s)}return l.call(this,"command"==i[0].type&&"command"==i[1].type||"character"==i[0].type&&i[0].cat==i[1].cat,e.mouth,e.scopes,t)}),ifdim:new b("ifdim",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("dimension");if(!i)return this.invalid=!0,[this];i=i.sp.value+12*i.em.value;var a=e.mouth.eat();if(!a||a.cat==_e.cats.active&&("<"==a.char||"="==a.char||">"==a.char))return this.invalid=!0,e.mouth.loadState(t),[this];var s=e.mouth.eat("dimension");return s?(s=s.sp.value+12*s.em.value,l.call(this,"<"==a.char?i<s:"="==a.char?i==s:s<i,e.mouth,e.scopes,t)):(this.invalid=!0,e.mouth.loadState(t),[this])}),ifeof:new b("ifeof",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!0,e.mouth,e.scopes,t)}),iffalse:new b("iffalse",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!1,e.mouth,e.scopes,t)}),ifodd:new b("ifodd",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("integer");return i?l.call(this,i.value%2==1,e.mouth,e.scopes,t):(this.invalid=!0,[this])}),ifnum:new b("ifnum",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("integer");if(!i)return this.invalid=!0,[this];var a=e.mouth.eat();if(!a||a.cat==_e.cats.active&&("<"==a.char||"="==a.char||">"==a.char))return this.invalid=!0,e.mouth.loadState(t),[this];var s=e.mouth.eat("integer");return s?l.call(this,"<"==a.char?i.value<s.value:"="==a.char?i.value==s.value:i.value>s.value,e.mouth,e.scopes,t):(this.invalid=!0,e.mouth.loadState(t),[this])}),ifhmode:new b("ifhmode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!1,e.mouth,e.scopes,t)}),ifinner:new b("ifinner",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,"inline"==e.style,e.mouth,e.scopes,t)}),ifmmode:new b("ifmmode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!0,e.mouth,e.scopes,t)}),iftrue:new b("iftrue",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!0,e.mouth,e.scopes,t)}),ifvmode:new b("ifvmode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!1,e.mouth,e.scopes,t)}),ifvoid:new b("ifvoid",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!0,e.mouth,e.scopes,t)}),ifx:new b("ifx",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i)return this.invalid=!0,[this];var a=e.mouth.eat("pre space");if(!a)return this.invalid=!0,e.mouth.loadState(t),[this];if((i="command"==i.type?e.scopes.last().defs.primitive[i.name]||e.scopes.last().defs.macros[i.name]:"character"==i.type&&i.cat==_e.cats.active?e.scopes.last().defs.active[i.char]:i)&&i.proxy&&(i=i.original),(a="command"==a.type?e.scopes.last().defs.primitive[a.name]||e.scopes.last().defs.macros[a.name]:"character"==a.type&&a.cat==_e.cats.active?e.scopes.last().defs.active[a.char]:a)&&a.proxy&&(a=a.original),!i&&!a)return l.call(this,!0,e.mouth,e.scopes,t);if(!i||!a||i.type!=a.type)return l.call(this,!1,e.mouth,e.scopes,t);if("character"==i.type)return l.call(this,i.char==a.char&&i.cat==a.cat,e.mouth,e.scopes,t);if("primitive"==i.type)return l.call(this,i===a,e.mouth,e.scopes,t);if(i.parameters.length!=a.parameters.length||i.replacement.length!=a.replacement.length)return l.call(this,!1,e.mouth,e.scopes,t);for(var s=0,r=i.parameters.length;s<r;s++)if(!("character"==i.parameters[s].type&&i.parameters[s].char==a.parameters[s].char&&i.parameters[s].cat==a.parameters[s].cat||"command"==i.parameters[s].type&&i.parameters[s].name==a.parameters[s].name))return l.call(this,!1,e.mouth,e.scopes,t);for(s=0,r=i.replacement.length;s<r;s++)if(!("character"==i.replacement[s].type&&i.replacement[s].char==a.replacement[s].char&&i.replacement[s].cat==a.replacement[s].cat||"command"==i.replacement[s].type&&i.replacement[s].name==a.replacement[s].name))return l.call(this,!1,e.mouth,e.scopes,t);return l.call(this,!0,e.mouth,e.scopes,t)}),it:new b("it",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"it"}),[])}),kern:new b("kern",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("dimension");return t?(e.tokens.push({type:"kern",dimen:t}),[]):(this.invalid=!0,[this])}),lccode:new b("lccode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");return t&&0<t.value?[e.scopes.last().lc[t.value]=e.scopes.last().lc[t.value]||new Ue(0)]:(this.invalid=!0,[this])}),left:new b("left",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=_e.cats.active)){if(!i||"character"!=i.type||!_e.delims.includes(i.code)||i.cat!=_e.cats.all&&i.cat!=_e.cats.letter)return this.invalid=!0,e.mouth.loadState(t),[this];new e.Scope,e.scopes.last().delimited=!0,e.scopes.last().leftDelimiter=i.char,e.scopes.last().nullDelimiterSpace=new ki(e.scopes.last().registers.named.nulldelimiterspace),e.openGroups.push(this),e.contexts.push({toString:function(){return"scope"},type:"scope"}),e.scopes.last().tokens.push(this),e.scopes.last().tokens.push({type:"atom",atomType:0,nucleus:{type:"symbol",char:i.char,code:i.code},subscript:null,superscript:null}),this.ignore=!0;break}var a=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,a)}}),let:new b("let",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("character"==a.type){if(e.catOf(a.char)!=_e.cats.active)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",a=a.char}else if("command"==a.type&&(i="macro",(a=a.name)in e.scopes.last().defs.primitive||a in _e.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];var s=e.mouth.eat();s&&"character"==s.type&&"="==s.char&&s.cat==_e.cats.all||s&&e.mouth.revert();var r=e.mouth.eat();if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if("command"==r.type||"character"==r.type&&r.cat==_e.cats.active){if(c="command"==r.type?e.scopes.last().defs.primitive[r.name]||e.scopes.last().defs.macros[r.name]:e.scopes.last().defs.active[r.name])c=new w(c,"primitive"==c.type||c.isLet);else if("command"==r.type&&"macro"==i){var n=e.scopes.last().registers.named[r.name];if(n){if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){_e.registers.named[a]=n,delete _e.defs.macros[a];for(var l=0,o=e.scopes.length;l<o;l++)e.scopes[l].registers.named[a]=n,delete e.scopes[l].defs.macros[a]}else e.scopes.last().registers.named[a]=n,delete e.scopes.last().defs.macros[a];return e.toggles.global=!1,[]}}}else var c=new w(new w([r]),!0);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)if("macro"==i){c?_e.defs.macros[a]=c:delete _e.defs.macros[a],delete _e.registers.named[a];for(l=0,o=e.scopes.length;l<o;l++)c?e.scopes[l].defs.macros[a]=c:delete e.scopes[l].defs.macros[a],delete e.scopes[l].registers.named[a]}else{c?_e.defs.active[a]=c:delete _e.defs.active[a],delete _e.registers.named[a];for(l=0,o=e.scopes.length;l<o;l++)c?e.scopes[l].defs.active[a]=c:delete e.scopes[l].defs.active[a],delete e.scopes[l].registers[a]}else c?e.scopes.last().defs["macro"==i?"macros":"active"][a]=c:delete e.scopes.last().defs["macro"==i?"macros":"active"][a],delete e.scopes.last().registers.named[a];return e.toggles.global=!1,[]}),limits:new b("limits",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"limit modifier",value:!0,token:this}),[])}),lower:new b("lower",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("dimension");return t?(t.sp.value*=-1,t.em.value*=-1,e.tokens.push({type:"vkern",dimen:t}),[]):(this.invalid=!0,[this])}),lowercase:new b("lowercase",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("pre space");if(!i||i.cat!=_e.cats.open)return this.invalid=!0,e.mouth.loadState(t),[this];for(var a=[],s=1;;){var r=e.mouth.eat("pre space");if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==r.type&&r.cat==_e.cats.open)s++,a.push(r);else if("character"==r.type&&r.cat==_e.cats.close){if(!(0<--s))break;a.push(r)}else a.push(r)}for(var n=0,l=a.length;n<l;n++)"character"==a[n].type&&e.scopes.last().lc[a[n].code]&&0<e.scopes.last().lc[a[n].code].value&&(a[n].code=e.scopes.last().lc[a[n].code].value,a[n].char=String.fromCharCode(a[n].code));return a}),mathbin:new b("mathbin",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:2,token:this}),[])}),mathchar:new b("mathchar",function(e){var t,i,a=e.mouth.eat("integer");return!a||a.value<0?(this.invalid=!0,[this]):(!(a.value<65536)&&a.value<524288?(t=a.value%65536,i=(a.value-t)/65536,a.value=t):i=0,e.mouth.queue.unshift({type:"character",cat:_e.cats.all,char:String.fromCharCode(a.value),code:a.value,forcedMathCode:i}),[])}),mathchardef:new b("mathchardef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||"command"!=i.type)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i.name in _e.defs.primitive||i.name in _e.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var a=e.mouth.eat();a&&"character"==a.type&&"="==a.char&&a.cat==_e.cats.all||a&&e.mouth.revert();var s,r,n=e.mouth.eat("integer");if(!n||n.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];!(n.value<65536)&&n.value<524288?(s=n.value%65536,r=(n.value-s)/65536,n.value=s):r=0;var l=new w([{type:"character",cat:_e.cats.all,char:String.fromCharCode(n.value),code:n.value,forcedMathCode:r}],[]);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){_e.defs.macros[i.name]=l,delete _e.registers.named[i.name];for(var o=0,c=e.scopes.length;o<c;o++)e.scopes[o].defs.macros[i.name]=l,delete e.scopes[o].registers.named[i.name]}else e.scopes.last().defs.macros[i.name]=l,delete e.scopes.last().registers.named[i.name];e.toggles.global=!1}),mathchoice:new b("mathchoice",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t={type:"command",nameType:"command",escapeChar:this.escapeChar,name:"mathchoice",recognized:!0};e.contexts.push({toString:function(){return"mathchoice"},type:"mathchoice",token:t,current:0,failed:function(){this.token.invalid=!0,e.contexts.pop()},succeeded:function(){e.contexts.pop(),this.token.type="mathchoice",this.token.groups=e.scopes.last().tokens.splice(e.scopes.last().tokens.length-4,4),this.token.ignore=!1}}),e.tokens.push(t),t.ignore=!0}),mathclose:new b("mathclose",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:5,token:this}),[])}),mathcode:new b("mathcode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");if(t){if(t.value<0)return e.mouth.revert(),this.invalid=!0,[this];if(!(t.value in _e.mathcodes)){_e.mathcodes[t.value]=new Ue(_e.mathcodes.ord,0,8);for(var i=0,a=e.scopes.length;i<a;i++)e.scopes[i].mathcodes[t.value]=new Ue((0==i?_e:e.scopes[i-1]).mathcodes[t.value])}return[e.scopes.last().mathcodes[t.value]]}return this.invalid=!0,[this]}),mathinner:new b("mathinner",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"inner",token:this}),[])}),mathop:new b("mathop",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:1,token:this}),[])}),mathopen:new b("mathopen",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:4,token:this}),[])}),mathord:new b("mathord",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:0,token:this}),[])}),mathpunct:new b("mathpunct",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:6,token:this}),[])}),mathrel:new b("mathrel",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:3,token:this}),[])}),meaning:new b("meaning",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];e.mouth.string;var t=e.mouth.eat();if(!t)return this.invalid=!0,[this];var i="",a=!1;if("command"==t.type||"character"==t.type&&t.cat==We.ACTIVE){var s="command"==t.type?e.scopes[e.scopes.length-1].defs.primitive[t.name]||e.scopes[e.scopes.length-1].defs.macros[t.name]:e.scopes[e.scopes.length-1].defs.active[t.char];if(s)if("primitive"==s.type||s.isLet&&"primitive"==s.original.type)i+="".concat(t.escapeChar).concat(t.name,"=").concat(String.fromCodePoint(e.scopes[e.scopes.length-1].registers.named.escapechar.value)).concat((s.original||s).name),a=!0;else if(s.isLet)i+="".concat(t.escapeChar+t.name||t.char,"="),t=s.original.replacement[0];else{s.proxy&&(s=s.original),i+="".concat(t.escapeChar+t.name||t.char,"=macro:\n");for(var r=0,n=0,l=s.parameters.length;n<l;n++)"character"==s.parameters[n].type&&s.parameters[n].cat!=We.PARAMETER?i+=s.parameters[n].char:"character"==s.parameters[n].type?(r++,i+=s.parameters[n].char+r):i+=s.parameters[n].escapeChar+s.parameters[n].name;i+="->";for(var o=0,c=s.replacement.length;o<c;o++)i+="character"==s.replacement[o].type?s.replacement[o].char:s.replacement[o].escapeChar+s.replacement[o].name;a=!0}else i+="".concat(t.escapeChar).concat(t.name,"=undefined."),a=!0}if(!a)switch(t.cat){case We.OPEN:i+="begin-group character ".concat(t.char,".");break;case We.CLOSE:i+="end-group character ".concat(t.char,".");break;case We.MATHSHIFT:i+="math shift character ".concat(t.char,".");break;case We.ALIGN:i+="alignment tab character ".concat(t.char,".");break;case We.PARAMETER:i+="macro parameter character ".concat(t.char,".");break;case We.SUPERSCRIPT:i+="superscript character ".concat(t.char,".");break;case We.SUBSCRIPT:i+="subscript character ".concat(t.char,".");break;case We.WHITESPACE:i+="blank space ".concat(t.char,".");break;case We.LETTER:i+="the letter ".concat(t.char,".");break;case We.OTHER:default:i+="the character ".concat(t.char,".")}return i.replace(/\n/g," ").split("").map(function(e){return{type:"character",cat:We.OTHER,char:e,code:e.codePointAt(0)}})}),message:new b("message",function(e){var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||"character"!=i.type||i.cat!=_e.cats.open)return this.invalid=!0,[this];for(var a=0,s=[];;){if(!(i=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==i.type&&i.cat==_e.cats.open)a++,s.push(i.char);else if("character"==i.type&&i.cat==_e.cats.close){if(!a)break;a--,s.push(i.char)}else"command"==i.type?(s.push(i.escapeChar),s.push.apply(s,i.name.split(""))):s.push(i.char)}h(s.join(""))}),mkern:new b("mkern",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("mu dimension");return t?(e.tokens.push({type:"kern",dimen:t}),[]):(this.invalid=!0,[this])}),month:new b("month",function(e){return[new Ue((new Date).getMonth()+1)]}),mskip:new b("mskip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("mu glue");return t?(e.tokens.push({type:"glue",glue:t}),[]):(this.invalid=!0,[this])}),multiply:new b("multiply",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=_e.cats.active)){if(i&&i.register){if(i&&i.register){var a=e.mouth.eat();if(!a||"character"!=a.type||"b"!=a.char&&"B"!=a.char||a.cat==_e.cats.active){if(!a)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert()}else{var s=e.mouth.eat();s&&"character"==s.type&&("y"==s.char||"Y"==s.char)&&s.cat!=_e.cats.active||e.mouth.revert(2)}var r=e.mouth.eat("integer");if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if("integer"==i.type){i.value*=r.value;var n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).value=n.value;e.toggles.global=!1}else if("dimension"==i.type){i.sp.value*=r.value,i.em.value*=r.value;n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).sp.value=n.sp.value,i.em.value=n.em.value;e.toggles.global=!1}else if("mu dimension"==i.type){i.mu.value*=r.value;n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).mu.value=n.mu.value;e.toggles.global=!1}else if("glue"==i.type){i.start.sp.value*=r.value,i.start.em.value*=r.value,"infinite dimension"==i.stretch.type?i.stretch.number.value*=r.value:(i.stretch.sp.value*=r.value,i.stretch.em.value*=r.value),"infinite dimension"==i.shrink.type?i.shrink.number.value*=r.value:(i.shrink.sp.value*=r.value,i.shrink.em.value*=r.value);n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.sp.value=n.start.sp.value,i.start.em.value=n.start.em.value,"infinite dimension"==n.stretch.type?i.stretch=new Ge(n.stretch.number.value,n.stretch.magnitude.value):i.stretch=new ki(n.stretch.sp.value,n.stretch.em.value),"infinite dimension"==n.shrink.type?i.shrink=new Ge(n.shrink.number.value,n.shrink.magnitude.value):i.shrink=new ki(n.shrink.sp.value,n.shrink.em.value);e.toggles.global=!1}else if("mu glue"==i.type){i.start.mu.value*=r.value,"infinite dimension"==i.stretch.type?i.stretch.number.value*=r.value:i.stretch.mu.value*=r.value,"infinite dimension"==i.shrink.type?i.shrink.number.value*=r.value:i.shrink.mu.value*=r.value;n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.mu.value=n.start.mu.value,"infinite dimension"==n.stretch.type?i.stretch=new Ge(n.stretch.number.value,n.stretch.magnitude.value):i.stretch=new je(n.stretch.mu.value),"infinite dimension"==n.shrink.type?i.shrink=new Ge(n.shrink.number.value,n.shrink.magnitude.value):i.shrink=new je(n.shrink.mu.value);e.toggles.global=!1}break}return this.invalid=!0,e.mouth.loadState(t),[this]}return this.invalid=!0,e.mouth.loadState(t),[this]}var l=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,l)}return[]}),muskip:new b("muskip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");if(!t||t.value<0)return this.invalid=!0,[this];if(!_e.registers.muskip[t.value]){_e.registers.muskip[t.value]=new Xe(new je(0,0),new je(0,0),new je(0,0));for(var i=0,a=e.scopes.length;i<a;i++)e.scopes[i].registers.muskip[t.value]=new Xe((i?e.scopes[i-1]:_e).registers.muskip[t.value])}return[e.scopes.last().registers.muskip[t.value]]}),muskipdef:new b("muskipdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if("command"!=i.type)return this.invalid=!0,e.mouth.loadState(countDefSym),[!0];if(i.name in _e.defs.primitive||i.name in _e.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var a=e.mouth.eat();a&&"character"==a.type&&"="==a.char&&a.cat==_e.cats.all||a&&e.mouth.revert();var s=e.mouth.eat("integer");if(!s||s.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i=i.name,s=s.value,!_e.registers.muskip[s]){_e.registers.muskip[s]=new Xe(new je(0),new je(0),new je(0));for(var r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.muskip[s]=new Xe((r?e.scopes[r-1]:_e).registers.muskip[s])}if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){_e.registers.named[i]=_e.registers.muskip[s],delete _e.defs.macros[i];for(r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.named[i]=e.scopes[r].registers.muskip[s],delete e.scopes[r].defs.macros[i]}else e.scopes.last().registers.named[i]=e.scopes.last().registers.muskip[s],delete e.scopes.last().defs.macros[i]}),noalign:new b("noalign",function(e){return this.invalid=!0,[this]}),noexpand:new b("noexpand",function(e){var t=e.mouth.eat();return t?(e.mouth.revert(),"command"==t.type||"character"==t.type&&t.cat==_e.cats.active?(this.invalid=!0,[this]):[]):(this.invalid=!0,[this])}),nolimits:new b("nolimits",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"limit modifier",value:!1,token:this}),[])}),nonscript:new b("nonscript",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"glue",isNonScript:!0}),[])}),normalfont:new b("normalfont",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"nm"}),[])}),number:new b("number",function(e){var t=e.mouth.eat("integer");return t?t.value.toString().split("").map(function(e){return{type:"character",cat:_e.cats.all,char:e,code:e.charCodeAt(0)}}):(this.invalid=!0,[this])}),of:new b("of",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];if(e.scopes.last().root){var t=e.scopes.last().tokens.indexOf(e.scopes.last().root);return e.tokens.push({type:"family modifier",value:"rad",index:e.scopes.last().tokens.splice(t,e.scopes.last().tokens.length-t+1).slice(1),token:this}),e.scopes.last().root=!1,[]}return this.invalid=!0,[this]}),omit:new b("omit",function(e){return this.invalid=!0,[this]}),or:new b("or",function(e){return this.invalid=!0,[this]}),over:new b("over",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.scopes.last().isFrac=!0,e.scopes.last().fracLeftDelim=e.scopes.last().fracRightDelim=".",e.scopes.last().barWidth="from font",e.scopes.last().root&&(e.scopes.last().root.invalid=!0,e.scopes.last().root=!1),e.scopes.last().fracNumerator=e.scopes.last().tokens,e.scopes.last().tokens=[],[])}),overline:new b("overline",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"over",token:this}),[])}),overwithdelims:new b("overwithdelims",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(i&&("command"==i.type||"character"==i.type&&i.cat==_e.cats.active)){var a=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,a)}else{if(!i||"character"!=i.type||!_e.delims.includes(i.code)||i.cat!=_e.cats.all&&i.cat!=_e.cats.letter)return this.invalid=!0,e.mouth.loadState(t),delete e.scopes.last().fracLeftDelim,[this];if(e.scopes.last().fracLeftDelim){e.scopes.last().fracRightDelim=i.char;break}e.scopes.last().fracLeftDelim=i.char}}return e.scopes.last().isFrac=!0,e.scopes.last().barWidth="from font",e.scopes.last().root&&(e.scopes.last().root.invalid=!0,e.scopes.last().root=!1),e.scopes.last().fracNumerator=e.scopes.last().tokens,e.scopes.last().tokens=[],[]}),phantom:new b("phantom",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"phantom",index:[],token:this}),[])}),raise:new b("raise",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("dimension");return t?(e.tokens.push({type:"vkern",dimen:t}),[]):(this.invalid=!0,[this])}),relax:new b("relax",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):[]}),right:new b("right",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];if(!e.openGroups.length||!e.scopes.last().delimited||e.scopes.last().isHalign||e.scopes.last().isHalignCell||e.scopes.last().semisimple)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=_e.cats.active)){if(!i||"character"!=i.type||!_e.delims.includes(i.code)||i.cat!=_e.cats.all&&i.cat!=_e.cats.letter)return this.invalid=!0,e.mouth.loadState(t),[this];if("scope"!=e.contexts.last)return this.invalid=!0,e.mouth.loadState(t),[this];e.openGroups.pop(),e.contexts.pop();var a,s=e.scopes.last().tokens;e.scopes.last().root&&(e.scopes.last().root.invalid=!0),e.scopes.last().isFrac?(e.scopes.last().fracNumerator.shift(),e.scopes.last().fracNumerator.shift(),e.scopes[e.scopes.length-2].tokens.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:e.scopes.last().fracNumerator,denominator:s,barWidth:e.scopes.last().barWidth,delims:[e.scopes.last().fracLeftDelim,e.scopes.last().fracRightDelim],nullDelimiterSpace:new ki(e.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null,delimited:!0,nullDelimiterSpace:new ki(e.scopes.last().registers.named.nulldelimiterspace),delims:[e.scopes.last().leftDelimiter,i.char]}),e.scopes.pop()):(s.shift(),s.shift(),a=e.scopes.last().leftDelimiter,e.scopes.pop(),e.scopes.last().tokens.push({type:"atom",atomType:"inner",nucleus:s,superscript:null,subscript:null,delimited:!0,nullDelimiterSpace:new ki(e.scopes.last().registers.named.nulldelimiterspace),delims:[a,i.char]}));break}var r=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,r)}}),rm:new b("rm",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"rm"}),[])}),romannumeral:new b("romannumeral",function(e){var t=e.mouth.eat("integer");if(!t)return this.invalid=!0,[this];if(t.value<=0)return this.invalid=!0,e.mouth.revert(),[this];var i="",a=~~((t=t.value)/1e3),s=~~((t%=1e3)/100),r=~~((t%=100)/10),n=t%10,i=new Array(1+a).join("m");return i+=s<3?new Array(1+s).join("c"):4==s?"cd":s<9?"d"+new Array(s%5+1).join("c"):"cm",i+=r<3?new Array(1+r).join("x"):4==r?"xl":r<9?"l"+new Array(r%5+1).join("x"):"xc",(i+=n<3?new Array(1+n).join("i"):4==n?"iv":n<9?"v"+new Array(n%5+1).join("i"):"ix").split("").map(function(e){return{type:"character",cat:_e.cats.all,char:e,code:e.charCodeAt(0)}})}),scriptscriptstyle:new b("scriptscriptstyle",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"scriptscriptstyle"}),[])}),scriptstyle:new b("scriptstyle",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"scriptstyle"}),[])}),show:new b("show",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.string,i=e.mouth.eat();if(!i)return this.invalid=!0,[this];var a='"'.concat(this.escapeChar).concat(this.name).concat(t.substring(0,t.length-e.mouth.string.length),'":\n');if("command"==i.type||"character"==i.type&&i.cat==We.ACTIVE){var s="command"==i.type?e.scopes[e.scopes.length-1].defs.primitive[i.name]||e.scopes[e.scopes.length-1].defs.macros[i.name]:e.scopes[e.scopes.length-1].defs.active[i.char];if(!s)return h("".concat(a).concat(i.escapeChar).concat(i.name,"=undefined.")),[];if("primitive"==s.type||s.isLet&&"primitive"==s.original.type)return h("".concat(a).concat(i.escapeChar).concat(i.name,"=").concat(String.fromCodePoint(e.scopes[e.scopes.length-1].registers.named.escapechar.value)).concat((s.original||s).name)),[];if(!s.isLet){s.proxy&&(s=s.original),a+="".concat(i.escapeChar+i.name||i.char,"=macro:\n");for(var r=0,n=0,l=s.parameters.length;n<l;n++)"character"==s.parameters[n].type&&s.parameters[n].cat!=We.PARAMETER?a+=s.parameters[n].char:"character"==s.parameters[n].type?(r++,a+=s.parameters[n].char+r):a+=s.parameters[n].escapeChar+s.parameters[n].name;a+="->";for(var o=0,c=s.replacement.length;o<c;o++)a+="character"==s.replacement[o].type?s.replacement[o].char:s.replacement[o].escapeChar+s.replacement[o].name;return h(a),[]}a+="".concat(i.escapeChar+i.name||i.char,"="),i=s.original.replacement[0]}switch(i.cat){case We.OPEN:h("".concat(a,"begin-group character ").concat(i.char,"."));break;case We.CLOSE:h("".concat(a,"end-group character ").concat(i.char,"."));break;case We.MATHSHIFT:h("".concat(a,"math shift character ").concat(i.char,"."));break;case We.ALIGN:h("".concat(a,"alignment tab character ").concat(i.char,"."));break;case We.PARAMETER:h("".concat(a,"macro parameter character ").concat(i.char,"."));break;case We.SUPERSCRIPT:h("".concat(a,"superscript character ").concat(i.char,"."));break;case We.SUBSCRIPT:h("".concat(a,"subscript character ").concat(i.char,"."));break;case We.WHITESPACE:h("".concat(a,"blank space ").concat(i.char,"."));break;case We.LETTER:h("".concat(a,"the letter ").concat(i.char,"."));break;case We.OTHER:default:h("".concat(a,"the character ").concat(i.char,"."))}return[]}),showthe:new b("showthe",function(e){var t=Symbol();for(e.mouth.saveState(t);;){var i,a,s,r,n=e.mouth.eat();if(!n||"command"!=n.type&&("character"!=n.type||n.cat!=_e.cats.active))return n&&n.register?("integer"==n.type?h(n.value+"."):"dimension"==n.type?(i=Math.round(n.sp.value/65536*1e5)/1e5,i+=Math.round(n.em.value/65536*1e5)/1e5*12,h(i+(Number.isInteger(i)?".0pt.":"pt."))):"mu dimension"==n.type?(s=Math.round(n.mu.value/65536*1e5)/1e5,h(s+(Number.isInteger(s)?".0mu.":"mu."))):"glue"==n.type?(a="",i=Math.round(n.start.sp.value/65536*1e5)/1e5,a=(i+=Math.round(n.start.em.value/65536*1e5)/1e5*12)+(Number.isInteger(i)?".0pt":"pt"),n.stretch instanceof ki&&(n.stretch.sp.value||n.stretch.em.value)?(i=Math.round(n.stretch.sp.value/65536*1e5)/1e5,a+=" plus "+(i+=Math.round(n.stretch.em.value/65536*1e5)/1e5*12)+(Number.isInteger(i)?".0pt":"pt")):n.stretch instanceof Ge&&n.stretch.number.value&&(a+=" plus "+(r=Math.round(n.stretch.number.value/65536*1e5)/1e5)+(Number.isInteger(r)?".0":"")+"fil"+new Array(n.stretch.magnitude.value).join("l")),n.shrink instanceof ki&&(n.shrink.sp.value||n.shrink.em.value)?(i=Math.round(n.shrink.sp.value/65536*1e5)/1e5,a+=" minus "+(i+=Math.round(n.shrink.em.value/65536*1e5)/1e5*12)+(Number.isInteger(i)?".0pt":"pt")):n.shrink instanceof Ge&&n.shrink.number.value&&(a+=" minus "+(r=Math.round(n.shrink.number.value/65536*1e5)/1e5)+(Number.isInteger(r)?".0":"")+"fil"+new Array(n.shrink.magnitude.value).join("l")),h(a+".")):"mu glue"==n.type&&(a="",a=(s=Math.round(n.start.mu.value/65536*1e5)/1e5)+(Number.isInteger(s)?".0mu":"mu"),n.stretch instanceof je&&n.stretch.mu.value?a+=" plus "+(s=Math.round(n.stretch.mu.value/65536*1e5)/1e5)+(Number.isInteger(s)?".0mu":"mu"):n.stretch instanceof Ge&&n.stretch.number.value&&(a+=" plus "+(r=Math.round(n.stretch.number.value/65536*1e5)/1e5)+(Number.isInteger(r)?".0":"")+"fil"+new Array(n.stretch.magnitude.value).join("l")),n.shrink instanceof je&&n.shrink.mu.value?a+=" minus "+(s=Math.round(n.shrink.mu.value/65536*1e5)/1e5)+(Number.isInteger(s)?".0mu":"mu"):n.shrink instanceof Ge&&n.shrink.number.value&&(a+=" minus "+(r=Math.round(n.shrink.number.value/65536*1e5)/1e5)+(Number.isInteger(r)?".0":"")+"fil"+new Array(n.shrink.magnitude.value).join("l")),h(a+".")),[]):(this.invalid=!0,e.mouth.loadState(t),[this]);var l=e.mouth.expand(n,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,l)}}),skip:new b("skip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");if(!t||t.value<0)return this.invalid=!0,[this];if(!_e.registers.skip[t.value]){_e.registers.skip[t.value]=new Si(new ki(0,0),new ki(0,0),new ki(0,0));for(var i=0,a=e.scopes.length;i<a;i++)e.scopes[i].registers.skip[t.value]=new Si((i?e.scopes[i-1]:_e).registers.skip[t.value])}return[e.scopes.last().registers.skip[t.value]]}),skipdef:new b("skipdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if("command"!=i.type)return this.invalid=!0,e.mouth.loadState(countDefSym),[!0];if(i.name in _e.defs.primitive||i.name in _e.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var a=e.mouth.eat();a&&"character"==a.type&&"="==a.char&&a.cat==_e.cats.all||a&&e.mouth.revert();var s=e.mouth.eat("integer");if(!s||s.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i=i.name,s=s.value,!_e.registers.skip[s]){_e.registers.skip[s]=new Si(new ki(0,0),new ki(0,0),new ki(0,0));for(var r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.skip[s]=new Si((r?e.scopes[r-1]:_e).registers.skip[s])}if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){_e.registers.named[i]=_e.registers.skip[s],delete _e.defs.macros[i];for(r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.named[i]=e.scopes[r].registers.skip[s],delete e.scopes[r].defs.macros[i]}else e.scopes.last().registers.named[i]=e.scopes.last().registers.skip[s],delete e.scopes.last().defs.macros[i]}),sl:new b("sl",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"sl"}),[])}),span:new b("span",function(e){"mathchoice"==e.contexts.last&&e.contexts.last.failed();for(var t=!1,i=e.scopes.length-1;0<=i;i--)if(e.scopes[i].isHalignCell){t=e.scopes[i];break}if(!t)return this.invalid=!0,[this];var a=t.parentScope,s=a.cellData[a.cellData.length-1];if(s[s.length-1].omit&&(this.postPreamble=!0),this.postPreamble&&!e.scopes.last().isHalignCell||"scope"!=e.contexts.last)return this.invalid=!0,[this];if(!this.postPreamble){for(var r=-1,i=0,n=s.length;i<n;i++)r+=s[i].span;if(a.preamble[r])h=a.preamble[r][1];else{if(!~a.repeatPreambleAt)return this.invalid=!0,[this];h=(f=a.preamble.slice(a.repeatPreambleAt,a.preamble.length))[(r-a.repeatPreambleAt)%f.length][1]}if(!a.preamble[++r]&&!~a.repeatPreambleAt)return this.invalid=!0,[this];for(var l=[],i=0,n=h.length;i<n;i++){var o={};for(var c in h[i])o[c]=h[i][c];l.push(o)}return this.postPreamble=!0,l.concat(this)}e.scopes.last().root&&(e.scopes.last().root.invalid=!0),e.contexts.pop();var h=e.scopes.last().tokens;e.scopes.last().isFrac?(s[s.length-1].content.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:e.scopes.last().fracNumerator,denominator:h,barWidth:e.scopes.last().barWidth,delims:[e.scopes.last().fracLeftDelim,e.scopes.last().fracRightDelim],nullDelimiterSpace:new ki(e.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),e.scopes.pop()):(e.scopes.pop(),s[s.length-1].content=s[s.length-1].content.concat(h));var d=Symbol();for(e.mouth.saveState(d),s[s.length-1].omit=!1,s[s.length-1].span++;;){if(!(o=e.mouth.eat())){e.mouth.loadState(d);break}if("character"==o.type&&o.cat!=_e.cats.active){e.mouth.loadState(d);break}if("command"==o.type||"character"==o.type&&o.cat==_e.cats.active){if(o.name in e.scopes.last().registers.named){e.mouth.loadState(d);break}var p,m="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char];if(!m){e.mouth.loadState(d);break}if(m===_e.defs.primitive.the||m.proxy&&m.original===_e.defs.primitive.the||m===_e.defs.primitive.expandafter||m.proxy&&m.original===_e.defs.primitive.expandafter||m===_e.defs.primitive.number||m.proxy&&m.original===_e.defs.primitive.number||m===_e.defs.primitive.romannumeral||m.proxy&&m.original===_e.defs.primitive.romannumeral||m===_e.defs.primitive.csname||m.proxy&&m.original===_e.defs.primitive.csname||m===_e.defs.primitive.string||m.proxy&&m.original===_e.defs.primitive.string||m===_e.defs.primitive.if||m.isLet&&m.original===_e.defs.primitive.if||m===_e.defs.primitive.ifcase||m.isLet&&m.original===_e.defs.primitive.ifcase||m===_e.defs.primitive.ifcat||m.isLet&&m.original===_e.defs.primitive.ifcat||m===_e.defs.primitive.ifdim||m.isLet&&m.original===_e.defs.primitive.ifdim||m===_e.defs.primitive.ifeof||m.isLet&&m.original===_e.defs.primitive.ifeof||m===_e.defs.primitive.iffalse||m.isLet&&m.original===_e.defs.primitive.iffalse||m===_e.defs.primitive.ifodd||m.isLet&&m.original===_e.defs.primitive.ifodd||m===_e.defs.primitive.ifnum||m.isLet&&m.original===_e.defs.primitive.ifnum||m===_e.defs.primitive.ifhmode||m.isLet&&m.original===_e.defs.primitive.ifhmode||m===_e.defs.primitive.ifinner||m.isLet&&m.original===_e.defs.primitive.ifinner||m===_e.defs.primitive.ifmmode||m.isLet&&m.original===_e.defs.primitive.ifmmode||m===_e.defs.primitive.iftrue||m.isLet&&m.original===_e.defs.primitive.iftrue||m===_e.defs.primitive.ifvmode||m.isLet&&m.original===_e.defs.primitive.ifvmode||m===_e.defs.primitive.ifvoid||m.isLet&&m.original===_e.defs.primitive.ifvoid||m===_e.defs.primitive.ifx||m.isLet&&m.original===_e.defs.primitive.ifx){if(1==(p=e.mouth.expand(o,e.mouth)).length&&p[0]===o&&o.invalid){e.mouth.loadState(d);break}e.mouth.queue.unshift.apply(e.mouth.queue,p);continue}if(m===_e.defs.primitive.omit||m.proxy&&m.original===_e.defs.primitive.omit){s[s.length-1].omit=!0;break}if("primitive"==m.type||m.proxy&&"primitive"==m.original.type){e.mouth.loadState(d);break}if(1==(p=e.mouth.expand(o,e.mouth)).length&&p[0]==-o&&o.invalid){e.mouth.loadState(d);break}e.mouth.queue.unshift.apply(e.mouth.queue,p)}}if(e.contexts.push({toString:function(){return"scope"},type:"scope"}),new e.Scope,e.scopes.last().isHalignCell=!0,!s[s.length-1].omit){for(var f,r=-1,i=0,n=s.length;i<n;i++)r+=s[i].span;a.preamble[r]?h=a.preamble[r][0]:~a.repeatPreambleAt&&(h=(f=a.preamble.slice(a.repeatPreambleAt,a.preamble.length))[(r-a.repeatPreambleAt)%f.length][0]);for(l=[],i=0,n=h.length;i<n;i++){o={};for(var c in h[i])o[c]=h[i][c];l.push(o)}return l}}),radical:new b("radical",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"rad",index:[],token:this}),[])}),root:new b("root",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last||e.scopes.last().root?(this.invalid=!0,[this]):(this.ignore=!0,[e.scopes.last().root=this])}),string:new b("string",function(e){var t=e.mouth.eat();return t?"character"==t.type?[{type:"character",cat:_e.cats.all,char:t.char,code:t.code}]:"command"==t.type?(String.fromCharCode(e.scopes.last().registers.named.escapechar.value)+t.name).split("").map(function(e){return{type:"character",cat:_e.cats.all,char:e,code:e.charCodeAt(0)}}):(this.invalid=!0,e.mouth.revert(),[this]):(this.invalid=!0,[this])}),textstyle:new b("textstyle",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"textstyle"}),[])}),the:new b("the",function(e){var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(i&&("command"==i.type||"character"==i.type&&i.cat==_e.cats.active)){var a=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,a)}else{if(!i||!i.register)return this.invalid=!0,e.mouth.loadState(t),[this];if("integer"==i.type)return i.value.toString().split("").map(function(e){return{type:"character",cat:_e.cats.all,char:e,code:e.charCodeAt(0)}});if("dimension"==i.type){var s=Math.round(i.sp.value/65536*1e5)/1e5;return((s+=Math.round(i.em.value/65536*1e5)/1e5*12)+(Number.isInteger(s)?".0pt":"pt")).split("").map(function(e){return{type:"character",cat:_e.cats.all,char:e,code:e.charCodeAt(0)}})}if("mu dimension"==i.type)return((n=Math.round(i.mu.value/65536*1e5)/1e5)+(Number.isInteger(n)?".0mu":"mu")).split("").map(function(e){return{type:"character",cat:_e.cats.all,char:e,code:e.charCodeAt(0)}});if("glue"==i.type){var r="",s=Math.round(i.start.sp.value/65536*1e5)/1e5;return r=(s+=Math.round(i.start.em.value/65536*1e5)/1e5*12)+(Number.isInteger(s)?".0pt":"pt"),i.stretch instanceof ki&&(i.stretch.sp.value||i.stretch.em.value)?(s=Math.round(i.stretch.sp.value/65536*1e5)/1e5,r+=" plus "+(s+=Math.round(i.stretch.em.value/65536*1e5)/1e5*12)+(Number.isInteger(s)?".0pt":"pt")):i.stretch instanceof Ge&&i.stretch.number.value&&(r+=" plus "+(l=Math.round(i.stretch.number.value/65536*1e5)/1e5)+(Number.isInteger(l)?".0":"")+"fil"+new Array(i.stretch.magnitude.value).join("l")),i.shrink instanceof ki&&(i.shrink.sp.value||i.shrink.em.value)?(s=Math.round(i.shrink.sp.value/65536*1e5)/1e5,r+=" minus "+(s+=Math.round(i.shrink.em.value/65536*1e5)/1e5*12)+(Number.isInteger(s)?".0pt":"pt")):i.shrink instanceof Ge&&i.shrink.number.value&&(r+=" minus "+(l=Math.round(i.shrink.number.value/65536*1e5)/1e5)+(Number.isInteger(l)?".0":"")+"fil"+new Array(i.shrink.magnitude.value).join("l")),r.split("").map(function(e){return{type:"character",cat:_e.cats.all,char:e,code:e.charCodeAt(0)}})}if("mu glue"==i.type){var n,l,r="";return r=(n=Math.round(i.start.mu.value/65536*1e5)/1e5)+(Number.isInteger(n)?".0mu":"mu"),i.stretch instanceof je&&i.stretch.mu.value?r+=" plus "+(n=Math.round(i.stretch.mu.value/65536*1e5)/1e5)+(Number.isInteger(n)?".0mu":"mu"):i.stretch instanceof Ge&&i.stretch.number.value&&(r+=" plus "+(l=Math.round(i.stretch.number.value/65536*1e5)/1e5)+(Number.isInteger(l)?".0":"")+"fil"+new Array(i.stretch.magnitude.value).join("l")),i.shrink instanceof je&&i.shrink.mu.value?r+=" minus "+(n=Math.round(i.shrink.mu.value/65536*1e5)/1e5)+(Number.isInteger(n)?".0mu":"mu"):i.shrink instanceof Ge&&i.shrink.number.value&&(r+=" minus "+(l=Math.round(i.shrink.number.value/65536*1e5)/1e5)+(Number.isInteger(l)?".0":"")+"fil"+new Array(i.shrink.magnitude.value).join("l")),r.split("").map(function(e){return{type:"character",cat:_e.cats.all,char:e,code:e.charCodeAt(0)}})}}}}),time:new b("time",function(e){var t=new Date;return[new Ue(60*t.getHours()+t.getMinutes())]}),uccode:new b("uccode",function(e){var t=e.mouth.eat("integer");return t&&0<t.value?[e.scopes.last().uc[t.value]=e.scopes.last().uc[t.value]||new Ue(0)]:(this.invalid=!0,[this])}),underline:new b("underline",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"under",token:this}),[])}),uppercase:new b("uppercase",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||i.cat!=_e.cats.open)return this.invalid=!0,e.mouth.loadState(t),[this];for(var a=[],s=1;;){var r=e.mouth.eat("pre space");if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==r.type&&r.cat==_e.cats.open)s++,a.push(r);else if("character"==r.type&&r.cat==_e.cats.close){if(!(0<--s))break;a.push(r)}else a.push(r)}for(var n=0,l=a.length;n<l;n++)"character"==a[n].type&&e.scopes.last().uc[a[n].code]&&0<e.scopes.last().uc[a[n].code].value&&(a[n].code=e.scopes.last().uc[a[n].code].value,a[n].char=String.fromCharCode(a[n].code));return a}),vbox:new b("vbox",function(e){var t,i,a=Symbol();for(e.mouth.saveState(a);;){var s=e.mouth.eat();if(!s)return this.invalid=!0,[this];if("command"!=s.type&&("character"!=s.type||s.cat!=_e.cats.active)){if("character"!=s.type||"t"!=s.char&&"T"!=s.char){if("character"!=s.type||"s"!=s.char&&"S"!=s.char){if("character"!=s.type||s.cat!=_e.cats.open)return this.invalid=!0,e.mouth.loadState(a),[this];e.mouth.revert();break}var r=e.mouth.eat(),n=e.mouth.eat(),l=e.mouth.eat(),o=e.mouth.eat(),c=e.mouth.eat();if(!r||"character"!=r.type||"p"!=r.char&&"P"!=r.char||r.cat==_e.cats.active||!n||"character"!=n.type||"r"!=n.char&&"R"!=n.char||n.cat==_e.cats.active||!l||"character"!=l.type||"e"!=l.char&&"E"!=l.char||l.cat==_e.cats.active||!o||"character"!=o.type||"a"!=o.char&&"A"!=o.char||o.cat==_e.cats.active||!c||"character"!=c.type||"d"!=c.char&&"D"!=c.char||c.cat==_e.cats.active)return this.invalid=!0,e.mouth.loadState(a),[this];if(h=e.mouth.eat("dimension")){t=h;break}return this.invalid=!0,e.mouth.loadState(a),[this]}var h,d=e.mouth.eat("pre space");if(!d||"character"!=d.type||"o"!=d.char&&"O"!=s.char||s.cat==_e.cats.active)return this.invalid=!0,e.mouth.loadState(a),[this];if(h=e.mouth.eat("dimension")){i=h;break}return this.invalid=!0,e.mouth.loadState(a),[this]}var p="command"==s.type?e.scopes.last().defs.primitive[s.name]||e.scopes.last().defs.macros[s.name]:e.scopes.last().defs.active[s.char];if(p&&(p===_e.defs.primitive.relax||p.proxy&&p.original===_e.defs.primitive.relax))break;var m=e.mouth.expand(s,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,m)}var f=e.mouth.preview();return f&&"character"==f.type&&f.cat==_e.cats.open?(i||t||(t=new ki(0,0)),e.tokens.push({type:"box wrapper",value:"vertical",to:i,spread:t,token:this}),[]):(this.invalid=!0,e.mouth.loadState(a),[this])}),vcenter:new b("vcenter",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"vcent",token:this}),[])}),vfil:new b("vfil",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"vglue",glue:new Si(new ki(0),new Ge(1,1),new ki(0))}),[])}),vfill:new b("vfill",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"vglue",glue:new Si(new ki(0),new Ge(1,2),new ki(0))}),[])}),vrule:new b("vrule",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);for(var i=!1,a=!1,s=!1;;){var r=e.mouth.eat();if(!r){e.mouth.revert();break}if("h"!=r.char&&"H"!=r.char||r.cat==_e.cats.active){if("d"!=r.char&&"D"!=r.char||r.cat==_e.cats.active){if("w"!=r.char&&"W"!=r.char||r.cat==_e.cats.active){e.mouth.revert();break}if(!(r=e.mouth.eat("pre space"))||"i"!=r.char&&"I"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"d"!=r.char&&"D"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?5:4);else{if(r=e.mouth.eat("dimension")){s=r;continue}e.mouth.revert(5)}break}if(!(r=e.mouth.eat("pre space"))||"e"!=r.char&&"E"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"p"!=r.char&&"P"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?5:4);else{if(r=e.mouth.eat("dimension")){a=r;continue}e.mouth.revert(5)}break}if(!(r=e.mouth.eat("pre space"))||"e"!=r.char&&"E"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"i"!=r.char&&"I"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"g"!=r.char&&"G"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?5:4);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==_e.cats.active)e.mouth.revert(r?6:5);else{if(r=e.mouth.eat("dimension")){i=r;continue}e.mouth.revert(6)}break}return s=s||new ki(0,65536/30),e.tokens.push({type:"rule",ruleType:"v",height:i,depth:a,width:s}),[]}),vskip:new b("vskip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("glue");return t?(e.tokens.push({type:"vglue",glue:t}),[]):(this.invalid=!0,[this])}),xdef:new b("xdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("character"==a.type){if(e.catOf(a.char)!=_e.cats.active)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",a=a.char}else if("command"==a.type&&(i="macro",(a=a.name)in e.scopes.last().defs.primitive||a in _e.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];for(var s=[],r=0,n=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if(o.cat==_e.cats.open){e.mouth.revert();break}if(o.cat==_e.cats.param){var l=e.mouth.eat("pre space");if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.cat==_e.cats.open)n=!0,e.mouth.revert(),s.push({type:"character",cat:_e.cats.open,char:l.char,code:l.code});else{if(!(48<l.code&&l.code<58&&l.cat==_e.cats.all&&+l.char==r+1))return this.invalid=!0,e.mouth.loadState(t),[this];s.push(o),r++}}else s.push(o)}for(var o,c=0,h=[],d=!1,p=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=o.type||o.cat!=_e.cats.param||p)if("character"==o.type&&o.cat==_e.cats.open)c++,h.push(o),d=!1;else if("character"==o.type&&o.cat==_e.cats.close){if(0==--c)break;h.push(o),d=!1}else if(d)h.push(o),d=!1;else if("command"==o.type||"character"==o.type&&o.cat==_e.cats.active){if(o.name in e.scopes.last().registers.named){h.push(o);continue}if(!(u="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char]))return this.invalid=!0,e.mouth.loadState(t),[this];if(u===_e.defs.primitive.the||u.proxy&&u.original===_e.defs.primitive.the||u===_e.defs.primitive.expandafter||u.proxy&&u.original===_e.defs.primitive.expandafter||u===_e.defs.primitive.number||u.proxy&&u.original===_e.defs.primitive.number||u===_e.defs.primitive.romannumeral||u.proxy&&u.original===_e.defs.primitive.romannumeral||u===_e.defs.primitive.csname||u.proxy&&u.original===_e.defs.primitive.csname||u===_e.defs.primitive.string||u.proxy&&u.original===_e.defs.primitive.string||u===_e.defs.primitive.if||u.isLet&&u.original===_e.defs.primitive.if||u===_e.defs.primitive.ifcase||u.isLet&&u.original===_e.defs.primitive.ifcase||u===_e.defs.primitive.ifcat||u.isLet&&u.original===_e.defs.primitive.ifcat||u===_e.defs.primitive.ifdim||u.isLet&&u.original===_e.defs.primitive.ifdim||u===_e.defs.primitive.ifeof||u.isLet&&u.original===_e.defs.primitive.ifeof||u===_e.defs.primitive.iffalse||u.isLet&&u.original===_e.defs.primitive.iffalse||u===_e.defs.primitive.ifodd||u.isLet&&u.original===_e.defs.primitive.ifodd||u===_e.defs.primitive.ifnum||u.isLet&&u.original===_e.defs.primitive.ifnum||u===_e.defs.primitive.ifhmode||u.isLet&&u.original===_e.defs.primitive.ifhmode||u===_e.defs.primitive.ifinner||u.isLet&&u.original===_e.defs.primitive.ifinner||u===_e.defs.primitive.ifmmode||u.isLet&&u.original===_e.defs.primitive.ifmmode||u===_e.defs.primitive.iftrue||u.isLet&&u.original===_e.defs.primitive.iftrue||u===_e.defs.primitive.ifvmode||u.isLet&&u.original===_e.defs.primitive.ifvmode||u===_e.defs.primitive.ifvoid||u.isLet&&u.original===_e.defs.primitive.ifvoid||u===_e.defs.primitive.ifx||u.isLet&&u.original===_e.defs.primitive.ifx){var m=e.mouth.expand(o,e.mouth);if(1==m.length&&m[0]===o&&o.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,m);continue}if(u===_e.defs.primitive.noexpand||u.proxy&&u.original===_e.defs.primitive.noexpand){d=!0;continue}if(u instanceof b||u.proxy&&u.original instanceof b){h.push(o);continue}e.mouth.queue.unshift.apply(e.mouth.queue,e.mouth.expand(o,e.mouth))}else h.push(o);else{var f=e.mouth.eat("pre space");if(!f||!(f.cat==_e.cats.param||f.cat==_e.cats.all&&f.char<=s.length&&1<=f.char))return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert(),f.cat==_e.cats.param&&(p=!0),h.push(o),d=!1}}h.shift(),n&&h.push(s[s.length-1]);var u=new w(h,s);if(e.scopes.last().registers.named.globaldefs.value<0)e.scopes.last().defs["macro"==i?"macros":"active"][a]=u,delete e.scopes.last().registers.named[a];else if("macro"==i){_e.defs.macros[a]=u,delete _e.registers.named[a];for(var v=0,g=e.scopes.length;v<g;v++)e.scopes[v].defs.macros[a]=u,delete e.scopes.last().registers.named[a]}else{_e.defs.active[a]=u,delete _e.registers.named[a];for(v=0,g=e.scopes.length;v<g;v++)e.scopes[v].defs.ative[a]=u,delete e.scopes.last().registers.named[a]}return e.toggles.global=!1,[]}),year:new b("year",function(e){return[new Ue((new Date).getFullYear())]}),"@debug":new b("@debug",function(e){}),"@exec@JavaScript":new b("@exec@JavaScript",function(e){})},macros:{},active:{}},registers:{count:{},dimen:{},skip:{},muskip:{},named:{pretolerance:new Ue(100),tolerance:new Ue(200),hbadness:new Ue(1e3),vbadness:new Ue(1e3),linepenalty:new Ue(10),hypenpenalty:new Ue(50),exhyphenpenalty:new Ue(50),binoppenalty:new Ue(700),relpenalty:new Ue(500),clubpenalty:new Ue(150),widowpenalty:new Ue(150),displaywidowpenalty:new Ue(50),brokenpenalty:new Ue(100),predisplaypenalty:new Ue(1e4),postdisplaypenalty:new Ue(0),floatingpenalty:new Ue(0),interlinepenalty:new Ue(0),outputpenalty:new Ue(-10001),doublehyphendemerits:new Ue(1e4),finalhyphendemerits:new Ue(5e3),adjdemerits:new Ue(1e4),looseness:new Ue(0),pausing:new Ue(0),holdinginserts:new Ue(0),tracingonline:new Ue(0),tracingmacros:new Ue(0),tracingstats:new Ue(0),tracingparagraphs:new Ue(0),tracingpages:new Ue(0),tracingoutput:new Ue(0),tracinglostchars:new Ue(0),tracingcommands:new Ue(0),tracingrestores:new Ue(0),language:new Ue(0),uchyph:new Ue(1),lefthyphenmin:new Ue(2),righthyphenmin:new Ue(3),globaldefs:new Ue(0),defaulthyphenchar:new Ue(45),defaultskewchar:new Ue(-1),escapechar:new Ue(92),endlinechar:new Ue(13),newlinechar:new Ue(10),maxdeadcycles:new Ue(100),hangafter:new Ue(1),fam:new Ue(0),mag:new Ue(1e3),delimiterfactor:new Ue(901),showboxbreadth:new Ue(-1),showboxdepth:new Ue(-1),errorcontextlines:new Ue(-1),hfuzz:new ki(6553.6,0),vfuzz:new ki(6553.6,0),overfullrule:new ki(0,0),emergencystetch:new ki(0,0),hsize:new ki(22609920,0),vsize:new ki(36044800,0),maxdepth:new ki(327680,0),splitmaxdepth:new ki(1074397184,-65536),boxmaxdepth:new ki(1074397184,-65536),lineskiplimit:new ki(0,0),delimitershortfall:new ki(327680,0),nulldelimiterspace:new ki(0,6553.6),scriptspace:new ki(32768,0),mathsurround:new ki(0,0),predisplaystyle:new ki(0,0),displaywidth:new ki(0,0),displayindent:new ki(0,0),parindent:new ki(983040,0),hangindent:new ki(0,0),hoffset:new ki(0,0),voffset:new ki(0,0),baselineskip:new Si(new ki(786432,0)),lineskip:new Si(new ki(65536,0)),parskip:new Si(new ki(0,0),new ki(65536,0)),abovedisplayskip:new Si(new ki(655360,0),new ki(131072,0),new ki(327680,0)),abovedisplayshortskip:new Si(new ki(0,0),new ki(196608,0)),belowdisplayskip:new Si(new ki(0,0),new ki(196608,0)),belowdisplayshortskip:new Si(new ki(393216,0),new ki(196608,0),new ki(196608,0)),leftskip:new Si(new ki(0,0)),rightskip:new Si(new ki(0,0)),topskip:new Si(new ki(655360,0)),splittopskip:new Si(new ki(655360,0)),tabskip:new Si(new ki(0,0)),spaceskip:new Si(new ki(0,0)),xspaceskip:new Si(new ki(0,0)),parfillskip:new Si(new ki(0,0),new Ge(65536,1)),thinmuskip:new Xe(new je(196608)),medmuskip:new Xe(new je(262144),new je(131072),new je(262144)),thickmuskip:new Xe(new je(327680),new je(327680))}},cats:function(){for(var e={92:new Ue(0,0,15),123:new Ue(1,0,15),125:new Ue(2,0,15),36:new Ue(3,0,15),38:new Ue(4,0,15),10:new Ue(5,0,15),35:new Ue(6,0,15),94:new Ue(7,0,15),95:new Ue(8,0,15),0:new Ue(9,0,15),9:new Ue(10,0,15),32:new Ue(10,0,15),126:new Ue(13,0,15),37:new Ue(14,0,15),127:new Ue(15,0,15),escape:0,open:1,close:2,math:3,alignment:4,eol:5,param:6,super:7,sub:8,ignored:9,whitespace:10,letter:11,all:12,active:13,comment:14,invalid:15},t=0;t<52;t++)e["abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charCodeAt(t)]=new Ue(11);return e}(),mathcodes:function(){for(var e={ord:0,op:1,bin:2,rel:3,open:4,close:5,punct:6,variable:7,active:8},t="+-*±∓∖×∗⋆⋄∘∙÷∩∪⊎⊓⊔◃▹≀◯△▽∨∧⊕⊖⊗⊘⊙†‡⨿",i='<>=:"≤≺⪯≪⊂⊆⊏⊑∈⊢⌣⌢≥≻⪰≫⊃⊇⊐⊒∋⊣≡∼≃≍≈≅⋈∝⊨≐⊥≮≰⊀⊄⊈⋢≯≱⊁⊅⊉⋣≠≢≁≄≆≭',a="abcdefghħijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZαβγδϵεζηθϑικλμνξπϖρϱσςτυϕφχψω",s=0,r="".length;s<r;s++)e["".charCodeAt(s)]=new Ue(1,0,8);for(s=0,r=t.length;s<r;s++)e[t.charCodeAt(s)]=new Ue(2,0,8);for(s=0,r=i.length;s<r;s++)e[i.charCodeAt(s)]=new Ue(3,0,8);for(s=0,r="([{`".length;s<r;s++)e["([{`".charCodeAt(s)]=new Ue(4,0,8);for(s=0,r="}])!?".length;s<r;s++)e["}])!?".charCodeAt(s)]=new Ue(5,0,8);for(s=0,r=",;".length;s<r;s++)e[",;".charCodeAt(s)]=new Ue(6,0,8);for(s=0,r=a.length;s<r;s++)e[a.charCodeAt(s)]=new Ue(7,0,8);return e}(),delims:[40,41,46,60,62,47,91,92,93,123,124,125,8214,8593,8595,8597,8657,8659,8661,8741,8968,8969,8970,8971,9130,9136,9137,9168,10216,10217,10222,10223],parameters:["pretolerance","tolerance","hbadness","vbadness","linepenalty","hypenpenalty","exhyphenpenalty","binoppenalty","relpenalty","clubpenalty","widowpenalty","displaywidowpenalty","brokenpenalty","predisplaypenalty","postdisplaypenalty","floatingpenalty","interlinepenalty","outputpenalty","doublehyphendemerits","finalhyphendemerits","adjdemerits","looseness","pausing","holdinginserts","tracingonline","tracingmacros","tracingstats","tracingparagraphs","tracingpages","tracingoutput","tracinglostchars","tracingcommands","tracingrestores","language","uchyph","lefthyphenmin","righthyphenmin","globaldefs","defaulthyphenchar","defaultskewchar","escapechar","endlinechar","newlinechar","maxdeadcycles","hangafter","fam","mag","delimiterfactor","showboxbreadth","showboxdepth","errorcontextlines","hfuzz","vfuzz","overfullrule","emergencystetch","hsize","vsize","maxdepth","splitmaxdepth","boxmaxdepth","lineskiplimit","delimitershortfall","nulldelimiterfall","scriptspace","mathsurround","predisplaystyle","displaywidth","displayindent","parindent","hangindent","hoffset","voffset","baselineskip","lineskip","parskip","abovedisplayskip","abovedisplayshortskip","belowdisplayskip","belowdisplayshortskip","leftskip","rightskip","topskip","splittopskip","tabskip","spaceskip","xspaceskip","parfillskip","thinmuskip","medmuskip","thickmuskip"],lc:{65:new Ue(97),66:new Ue(98),67:new Ue(99),68:new Ue(100),69:new Ue(101),70:new Ue(102),71:new Ue(103),72:new Ue(104),73:new Ue(105),74:new Ue(106),75:new Ue(107),76:new Ue(108),77:new Ue(109),78:new Ue(110),79:new Ue(111),80:new Ue(112),81:new Ue(113),82:new Ue(114),83:new Ue(115),84:new Ue(116),85:new Ue(117),86:new Ue(118),87:new Ue(119),88:new Ue(120),89:new Ue(121),90:new Ue(122),97:new Ue(97),98:new Ue(98),99:new Ue(99),100:new Ue(100),101:new Ue(101),102:new Ue(102),103:new Ue(103),104:new Ue(104),105:new Ue(105),106:new Ue(106),107:new Ue(107),108:new Ue(108),109:new Ue(109),110:new Ue(110),111:new Ue(111),112:new Ue(112),113:new Ue(113),114:new Ue(114),115:new Ue(115),116:new Ue(116),117:new Ue(117),118:new Ue(118),119:new Ue(119),120:new Ue(120),121:new Ue(121),122:new Ue(122),913:new Ue(945),914:new Ue(946),915:new Ue(947),916:new Ue(948),917:new Ue(949),918:new Ue(950),919:new Ue(951),920:new Ue(952),921:new Ue(953),922:new Ue(954),923:new Ue(955),924:new Ue(956),925:new Ue(957),926:new Ue(958),927:new Ue(959),928:new Ue(960),929:new Ue(961),931:new Ue(963),932:new Ue(964),933:new Ue(965),934:new Ue(966),935:new Ue(967),936:new Ue(968),937:new Ue(969),945:new Ue(945),946:new Ue(946),947:new Ue(947),948:new Ue(948),949:new Ue(949),950:new Ue(950),951:new Ue(951),952:new Ue(952),953:new Ue(953),954:new Ue(954),955:new Ue(955),956:new Ue(956),957:new Ue(957),958:new Ue(958),959:new Ue(959),960:new Ue(960),961:new Ue(961),963:new Ue(963),964:new Ue(964),965:new Ue(965),966:new Ue(966),967:new Ue(967),968:new Ue(968),969:new Ue(969)},uc:{65:new Ue(65),66:new Ue(66),67:new Ue(67),68:new Ue(68),69:new Ue(69),70:new Ue(70),71:new Ue(71),72:new Ue(72),73:new Ue(73),74:new Ue(74),75:new Ue(75),76:new Ue(76),77:new Ue(77),78:new Ue(78),79:new Ue(79),80:new Ue(80),81:new Ue(81),82:new Ue(82),83:new Ue(83),84:new Ue(84),85:new Ue(85),86:new Ue(86),87:new Ue(87),88:new Ue(88),89:new Ue(89),90:new Ue(90),97:new Ue(65),98:new Ue(66),99:new Ue(67),100:new Ue(68),101:new Ue(69),102:new Ue(70),103:new Ue(71),104:new Ue(72),105:new Ue(73),106:new Ue(74),107:new Ue(75),108:new Ue(76),109:new Ue(77),110:new Ue(78),111:new Ue(79),112:new Ue(80),113:new Ue(81),114:new Ue(82),115:new Ue(83),116:new Ue(84),117:new Ue(85),118:new Ue(86),119:new Ue(87),120:new Ue(88),121:new Ue(89),122:new Ue(90),913:new Ue(913),914:new Ue(914),915:new Ue(915),916:new Ue(916),917:new Ue(917),918:new Ue(918),919:new Ue(919),920:new Ue(920),921:new Ue(921),922:new Ue(922),923:new Ue(923),924:new Ue(924),925:new Ue(925),926:new Ue(926),927:new Ue(927),928:new Ue(928),929:new Ue(929),931:new Ue(931),932:new Ue(932),933:new Ue(933),934:new Ue(934),935:new Ue(935),936:new Ue(936),937:new Ue(937),945:new Ue(913),946:new Ue(914),947:new Ue(915),948:new Ue(916),949:new Ue(917),950:new Ue(918),951:new Ue(919),952:new Ue(920),953:new Ue(921),954:new Ue(922),955:new Ue(923),956:new Ue(924),957:new Ue(925),958:new Ue(926),959:new Ue(927),960:new Ue(928),961:new Ue(929),963:new Ue(931),964:new Ue(932),965:new Ue(933),966:new Ue(934),967:new Ue(935),968:new Ue(936),969:new Ue(937)}},$e=[_e.defs.primitive.catcode,_e.defs.primitive.count,_e.defs.primitive.day,_e.defs.primitive.dimen,_e.defs.primitive.lccode,_e.defs.primitive.mathcode,_e.defs.primitive.meaning,_e.defs.primitive.month,_e.defs.primitive.muskip,_e.defs.primitive.skip,_e.defs.primitive.time,_e.defs.primitive.uccode,_e.defs.primitive.year],Ee=[_e.defs.primitive.the,_e.defs.primitive.expandafter,_e.defs.primitive.number,_e.defs.primitive.romannumeral,_e.defs.primitive.csname,_e.defs.primitive.string,_e.defs.primitive.if,_e.defs.primitive.ifcase,_e.defs.primitive.ifcat,_e.defs.primitive.ifdim,_e.defs.primitive.ifeof,_e.defs.primitive.iffalse,_e.defs.primitive.ifodd,_e.defs.primitive.ifnum,_e.defs.primitive.ifhmode,_e.defs.primitive.ifinner,_e.defs.primitive.ifmmode,_e.defs.primitive.iftrue,_e.defs.primitive.ifvmode,_e.defs.primitive.ifvoid,_e.defs.primitive.ifx];function l(e,s,r,t){var i,a,n,l=[];if(e)for(;;){if(!(i=s.eat()))return this.invalid=!0,s.loadState(t),[this];if("command"==i.type||"character"==i.type&&i.cat==_e.cats.active){if(!(a="command"==i.type?r.last().defs.primitive[i.name]||r.last().defs.macros[i.name]:r.last().defs.active[i.char])){l.push(i);continue}if(a===_e.defs.primitive.if||a.isLet&&a.original===_e.defs.primitive.if||a===_e.defs.primitive.ifcase||a.isLet&&a.original===_e.defs.primitive.ifcase||a===_e.defs.primitive.ifcat||a.isLet&&a.original===_e.defs.primitive.ifcat||a===_e.defs.primitive.ifdim||a.isLet&&a.original===_e.defs.primitive.ifdim||a===_e.defs.primitive.ifeof||a.isLet&&a.original===_e.defs.primitive.ifeof||a===_e.defs.primitive.iffalse||a.isLet&&a.original===_e.defs.primitive.iffalse||a===_e.defs.primitive.ifodd||a.isLet&&a.original===_e.defs.primitive.ifodd||a===_e.defs.primitive.ifnum||a.isLet&&a.original===_e.defs.primitive.ifnum||a===_e.defs.primitive.ifhmode||a.isLet&&a.original===_e.defs.primitive.ifhmode||a===_e.defs.primitive.ifinner||a.isLet&&a.original===_e.defs.primitive.ifinner||a===_e.defs.primitive.ifmmode||a.isLet&&a.original===_e.defs.primitive.ifmmode||a===_e.defs.primitive.iftrue||a.isLet&&a.original===_e.defs.primitive.iftrue||a===_e.defs.primitive.ifvmode||a.isLet&&a.original===_e.defs.primitive.ifvmode||a===_e.defs.primitive.ifvoid||a.isLet&&a.original===_e.defs.primitive.ifvoid||a===_e.defs.primitive.ifx||a.isLet&&a.original===_e.defs.primitive.ifx){if(n=c()){l.push(i),l.push.apply(l,n);continue}return this.invalid=!0,s.loadState(t),[this]}if(a===_e.defs.primitive.else||a.proxy&&a.original===_e.defs.primitive.else){o("fi");continue}if(a===_e.defs.primitive.fi||a.proxy&&a.original===_e.defs.primitive.fi)break;l.push(i)}else l.push(i)}else for(o("else");;){if(!(i=s.eat()))return this.invalid=!0,s.loadState(t),[this];if("command"==i.type||"character"==i.type&&i.cat==_e.cats.active){if(!(a="command"==i.type?r.last().defs.primitive[i.name]||r.last().defs.macros[i.name]:r.last().defs.active[i.char])){l.push(i);continue}if(a===_e.defs.primitive.if||a.isLet&&a.original===_e.defs.primitive.if||a===_e.defs.primitive.ifcase||a.isLet&&a.original===_e.defs.primitive.ifcase||a===_e.defs.primitive.ifcat||a.isLet&&a.original===_e.defs.primitive.ifcat||a===_e.defs.primitive.ifdim||a.isLet&&a.original===_e.defs.primitive.ifdim||a===_e.defs.primitive.ifeof||a.isLet&&a.original===_e.defs.primitive.ifeof||a===_e.defs.primitive.iffalse||a.isLet&&a.original===_e.defs.primitive.iffalse||a===_e.defs.primitive.ifodd||a.isLet&&a.original===_e.defs.primitive.ifodd||a===_e.defs.primitive.ifnum||a.isLet&&a.original===_e.defs.primitive.ifnum||a===_e.defs.primitive.ifhmode||a.isLet&&a.original===_e.defs.primitive.ifhmode||a===_e.defs.primitive.ifinner||a.isLet&&a.original===_e.defs.primitive.ifinner||a===_e.defs.primitive.ifmmode||a.isLet&&a.original===_e.defs.primitive.ifmmode||a===_e.defs.primitive.iftrue||a.isLet&&a.original===_e.defs.primitive.iftrue||a===_e.defs.primitive.ifvmode||a.isLet&&a.original===_e.defs.primitive.ifvmode||a===_e.defs.primitive.ifvoid||a.isLet&&a.original===_e.defs.primitive.ifvoid||a===_e.defs.primitive.ifx||a.isLet&&a.original===_e.defs.primitive.ifx){if(n=c()){l.push(i),l.push.apply(l,n);continue}return this.invalid=!0,s.loadState(t),[this]}if(a&&(a===_e.defs.primitive.fi||a.proxy&&a.original===_e.defs.primitive.fi))break;l.push(i)}else l.push(i)}return l;function o(e){for(;;){var t=s.eat();if(!t)return;if("command"==t.type||"character"==t.type&&t.cat===_e.cats.active){var i="command"==t.type?r.last().defs.primitive[t.name]||r.last().defs.macros[t.name]:r.last().defs.active[t.char];if(!i)continue;if(i===_e.defs.primitive.if||i.isLet&&i.original===_e.defs.primitive.if||i===_e.defs.primitive.ifcase||i.isLet&&i.original===_e.defs.primitive.ifcase||i===_e.defs.primitive.ifcat||i.isLet&&i.original===_e.defs.primitive.ifcat||i===_e.defs.primitive.ifdim||i.isLet&&i.original===_e.defs.primitive.ifdim||i===_e.defs.primitive.ifeof||i.isLet&&i.original===_e.defs.primitive.ifeof||i===_e.defs.primitive.iffalse||i.isLet&&i.original===_e.defs.primitive.iffalse||i===_e.defs.primitive.ifodd||i.isLet&&i.original===_e.defs.primitive.ifodd||i===_e.defs.primitive.ifnum||i.isLet&&i.original===_e.defs.primitive.ifnum||i===_e.defs.primitive.ifhmode||i.isLet&&i.original===_e.defs.primitive.ifhmode||i===_e.defs.primitive.ifinner||i.isLet&&i.original===_e.defs.primitive.ifinner||i===_e.defs.primitive.ifmmode||i.isLet&&i.original===_e.defs.primitive.ifmmode||i===_e.defs.primitive.iftrue||i.isLet&&i.original===_e.defs.primitive.iftrue||i===_e.defs.primitive.ifvmode||i.isLet&&i.original===_e.defs.primitive.ifvmode||i===_e.defs.primitive.ifvoid||i.isLet&&i.original===_e.defs.primitive.ifvoid||i===_e.defs.primitive.ifx||i.isLet&&i.original===_e.defs.primitive.ifx){o("fi"),s.eat();continue}if("else"==e&&(i===_e.defs.primitive.else||i.isLet&&i.original===_e.defs.primitive.else))return;if(i===_e.defs.primitive.fi||i.isLet&&i.original===_e.defs.primitive.fi)return void s.revert()}}}function c(){for(var e=[];;){var t=s.eat();if(!t)return null;if("command"==t.type||"character"==t.type&&t.cat===_e.cats.active){var i="command"==t.type?r.last().defs.primitive[t.name]||r.last().defs.macros[t.name]:r.last().defs.active[t.char];if(!i){e.push(t);continue}if(i===_e.defs.primitive.if||i.isLet&&i.original===_e.defs.primitive.if||i===_e.defs.primitive.ifcase||i.isLet&&i.original===_e.defs.primitive.ifcase||i===_e.defs.primitive.ifcat||i.isLet&&i.original===_e.defs.primitive.ifcat||i===_e.defs.primitive.ifdim||i.isLet&&i.original===_e.defs.primitive.ifdim||i===_e.defs.primitive.ifeof||i.isLet&&i.original===_e.defs.primitive.ifeof||i===_e.defs.primitive.iffalse||i.isLet&&i.original===_e.defs.primitive.iffalse||i===_e.defs.primitive.ifodd||i.isLet&&i.original===_e.defs.primitive.ifodd||i===_e.defs.primitive.ifnum||i.isLet&&i.original===_e.defs.primitive.ifnum||i===_e.defs.primitive.ifhmode||i.isLet&&i.original===_e.defs.primitive.ifhmode||i===_e.defs.primitive.ifinner||i.isLet&&i.original===_e.defs.primitive.ifinner||i===_e.defs.primitive.ifmmode||i.isLet&&i.original===_e.defs.primitive.ifmmode||i===_e.defs.primitive.iftrue||i.isLet&&i.original===_e.defs.primitive.iftrue||i===_e.defs.primitive.ifvmode||i.isLet&&i.original===_e.defs.primitive.ifvmode||i===_e.defs.primitive.ifvoid||i.isLet&&i.original===_e.defs.primitive.ifvoid||i===_e.defs.primitive.ifx||i.isLet&&i.original===_e.defs.primitive.ifx){var a=c();if(a){e.push(t),e.push.apply(e,a);continue}return null}if(e.push(t),i===_e.defs.primitive.fi||i.isLet&&i.original===_e.defs.primitive.fi)return e}else e.push(t)}}}_e.defs.primitive.crcr.function=_e.defs.primitive.cr.function;var i="`";wi.global(String.raw(_templateObject(),i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i)),wi.fontDimen={widthOf:function(e,t,i){return i={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[i||"nm"],this.cache[t]&&this.cache[t][i]&&this.cache[t][i][e]&&!isNaN(this.cache[t][i][e].width)?this.cache[t][i][e].width:(this.context.font="".concat(i||""," 500px ").concat(t),this.cache[t]=this.cache[t]||{},this.cache[t][i]=this.cache[t][i]||{},this.cache[t][i][e]=this.cache[t][i][e]||{},this.cache[t][i][e].width=this.context.measureText(e).width/500)},visibleWidthOf:function(h,d,p){if(p={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[p||"nm"],this.cache[d]&&this.cache[d][p]&&this.cache[d][p][h]&&!isNaN(this.cache[d][p][h].vWidth))return this.cache[d][p][h].vWidth;function m(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(.5-t));for(var s=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=void 0,o=void 0,l=0;l<150;l++){for(var c=0;c<150;c++)r<(o=s[4*l+600*c+3])&&(r=o,n=c);if(r)break}return!1===r&&0==i?-1:250<o?e+(l/150-.5)/Math.pow(2,i):m.call(this,e+(l/150-.5)/Math.pow(2,i),t+(n/150-.5)/Math.pow(2,i),i+1)}this.context.textBaseline="middle",this.context.textAlign="center";var e=m.call(this,.5,.5,0);if(-1==e)return this.cache[d]=this.cache[d]||{},this.cache[d][p]=this.cache[d][p]||{},this.cache[d][p][h]=this.cache[d][p][h]||{},this.cache[d][p][h].vWidth=0;function f(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(.5-t));for(var s=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=void 0,o=void 0,l=149;0<=l;l--){for(var c=0;c<150;c++)r<(o=s[4*l+600*c+3])&&(r=o,n=c);if(r)break}return 250<o?e+(l/150-.5)/Math.pow(2,i):f.call(this,e+(l/150-.5)/Math.pow(2,i),t+(n/150-.5)/Math.pow(2,i),i+1)}var t=f.call(this,.5,.5,0);return this.cache[d]=this.cache[d]||{},this.cache[d][p]=this.cache[d][p]||{},this.cache[d][p][h]=this.cache[d][p][h]||{},this.cache[d][p][h].vWidth=1.5*(t-e)+.01},heightOf:function(h,d,p){if(p={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[p||"nm"],this.cache[d]&&this.cache[d][p]&&this.cache[d][p][h]&&!isNaN(this.cache[d][p][h].height))return this.cache[d][p][h].height;function m(e,t,i){if(7==i)return t;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(1-t));for(var s=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=void 0,o=void 0,l=0;l<150;l++){for(var c=0;c<150;c++)r<(o=s[4*l*150+4*c+3])&&(r=o,n=c);if(r)break}return!1===r&&0==i?1:250<o?t+(l/150-.5)/Math.pow(2,i):m.call(this,e+(n/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}return this.context.textBaseline="alphabetic",this.context.textAlign="center",this.cache[d]=this.cache[d]||{},this.cache[d][p]=this.cache[d][p]||{},this.cache[d][p][h]=this.cache[d][p][h]||{},this.cache[d][p][h].height=1.5*(1-m.call(this,.5,.5,0))},depthOf:function(h,d,p){if(p={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[p||"nm"],this.cache[d]&&this.cache[d][p]&&this.cache[d][p][h]&&!isNaN(this.cache[d][p][h].depth))return Math.max(0,this.cache[d][p][h].depth);function m(e,t,i){if(7==i)return t;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(.5-t));for(var s=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=void 0,o=void 0,l=149;0<=l;l--){for(var c=0;c<150;c++)r<(o=s[4*l*150+4*c+3])&&(r=o,n=c);if(r)break}return!1===r&&0==i?.5:250<o?t+(l/150-.5)/Math.pow(2,i):m.call(this,e+(n/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}return this.context.textBaseline="alphabetic",this.context.textAlign="center",this.cache[d]=this.cache[d]||{},this.cache[d][p]=this.cache[d][p]||{},this.cache[d][p][h]=this.cache[d][p][h]||{},Math.max(0,this.cache[d][p][h].depth=1.5*(m.call(this,.5,.5,0)-.5))},trueDepthOf:function(e,t,i){return this.depthOf(e,t,i),this.cache[t][i={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[i||"nm"]][e].depth},italCorrOf:function(h,d){if(this.cache[d]&&this.cache[d].italic&&this.cache[d].italic[h]&&!isNaN(this.cache[d].italic[h].italCorr))return this.cache[d].italic[h].italCorr;function p(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="italic ".concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*-e,75+150*a*(.5-t));for(var s=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=void 0,o=void 0,l=149;0<=l;l--){for(var c=0;c<150;c++)r<(o=s[4*l+600*c+3])&&(r=o,n=c);if(r)break}return!1===r&&0==i?0:250<o?e+(l/150-.5)/Math.pow(2,i):p.call(this,e+(l/150-.5)/Math.pow(2,i),t+(n/150-.5)/Math.pow(2,i),i+1)}return this.context.textBaseline="middle",this.context.textAlign="left",this.cache[d]=this.cache[d]||{},this.cache[d].italic=this.cache[d].italic||{},this.cache[d].italic[h]=this.cache[d].italic[h]||{},this.cache[d].italic[h].italCorr=Math.max(0,1.5*p.call(this,.5,.5,0)-wi.fontDimen.widthOf(h,d,"it"))},scriptOffsetOf:function(h,d,p){if(p={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[p||"nm"],this.cache[d]&&this.cache[d][p]&&this.cache[d][p][h]&&!isNaN(this.cache[d][p][h].scriptOffset))return this.cache[d][p][h].scriptOffset;function m(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(.5-t));for(var s=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=void 0,o=void 0,l=149;0<=l;l--){for(var c=0;c<Math.max(150,Math.min(0,c<75+150*a*(.5-t)));c++)r<(o=s[4*l+600*c+3])&&(r=o,n=c);if(r)break}return!1===r&&0==i?0:250<o?e+(l/150-.5)/Math.pow(2,i):m.call(this,e+(l/150-.5)/Math.pow(2,i),t+(n/150-.5)/Math.pow(2,i),i+1)}function f(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(.5-t));for(var s=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=void 0,o=void 0,l=149;0<=l;l--){for(var c=75;c<Math.max(150,c<75+150*a*(1-e));c++)r<(o=s[4*l+600*c+3])&&(r=o,n=c);if(r)break}return!1===r&&0==i?1:250<o?e+(l/150-.5)/Math.pow(2,i):f.call(this,e+(l/150-.5)/Math.pow(2,i),t+(n/150-.5)/Math.pow(2,i),i+1)}this.context.textBaseline="middle",this.context.textAlign="left";var e=m.call(this,.5,.5,0),t=f.call(this,.5,.5,0);return this.cache[d]=this.cache[d]||{},this.cache[d][p]=this.cache[d][p]||{},this.cache[d][p][h]=this.cache[d][p][h]||{},this.cache[d][p][h].scriptOffset=1.5*Math.max(e-t,0)},leftOffsetOf:function(h,d,p){if(p={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[p||"nm"],this.cache[d]&&this.cache[d][p]&&this.cache[d][p][h]&&!isNaN(this.cache[d][p][h].leftOffset))return this.cache[d][p][h].leftOffset;function m(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(.5-t));for(var s=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=void 0,o=void 0,l=0;l<150;l++){for(var c=0;c<150;c++)r<(o=s[4*l+600*c+3])&&(r=o,n=c);if(r)break}return!1===r&&0==i?-1:250<o?e+(l/150-.5)/Math.pow(2,i):m.call(this,e+(l/150-.5)/Math.pow(2,i),t+(n/150-.5)/Math.pow(2,i),i+1)}return this.context.textBaseline="middle",this.context.textAlign="start",this.cache[d]=this.cache[d]||{},this.cache[d][p]=this.cache[d][p]||{},this.cache[d][p][h]=this.cache[d][p][h]||{},this.cache[d][p][h].leftOffset=-1.5*(m.call(this,.5,.5,0)-.5)},baselineHeightOf:function(h){if(this.cache[h]&&!isNaN(this.cache[h].baseline))return this.cache[h].baseline;function d(e,t,i){if(this.context.textBaseline="bottom",7==i)return t;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(100*a,"px ").concat(h),this.context.fillText("A",75+150*a*(.5-e),75+150*a*(1-t));for(var s=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=void 0,o=void 0,l=0;l<150;l++){for(var c=0;c<150;c++)r<(o=s[4*l*150+4*c+3])&&(r=o,n=c);if(r)break}return!1===r&&0==i?1:250<o?t+(l/150-.5)/Math.pow(2,i):d.call(this,e+(n/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}function p(e,t,i){if(this.context.textBaseline="alphabetic",7==i)return t;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(100*a,"px ").concat(h),this.context.fillText("A",75+150*a*(.5-e),75+150*a*(1-t));for(var s=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=void 0,o=void 0,l=0;l<150;l++){for(var c=0;c<150;c++)r<(o=s[4*l*150+4*c+3])&&(r=o,n=c);if(r)break}return!1===r&&0==i?1:250<o?t+(l/150-.5)/Math.pow(2,i):p.call(this,e+(n/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}return this.context.textAlign="center",this.cache[h]=this.cache[h]||{},this.cache[h].baseline=1.5*(p.call(this,.5,.5,0)-d.call(this,.5,.5,0))},cache:{}};var s=new Promise(function(t,e){!function e(){requestAnimationFrame(function(){document.body?t(document.body):e()})}()});s.then(function(e){var t=document.createElement("canvas");t.style.position="fixed",t.style.top="100vh",t.style.left="100vw",t.style.pointerEvents="none",t.style.opacity=0,t.width=150,t.height=150,wi.fontDimen.canvas=t,wi.fontDimen.context=t.getContext("2d"),e.appendChild(t)});var C=[];var E=void 0,A=void 0,T=new Promise(function(i,e){s.then(function(e){var t=document.createElement("div");t.style.visibility="hidden",t.style.fontSize="300px",t.style.position="fixed",t.style.top="100vh",t.style.left="100vw",t.textContent="This is a string that changes font.",e.appendChild(t),t.style.fontFamily="serif",E=t.offsetWidth,t.style.fontFamily="sans-serif",A=t.offsetWidth,i(t)})});function O(e,t){if(e&&!t)delete wi.fontDimen.cache[e];else if(t&&!e){if((t=t.split(",").filter(function(e){return/^\\?(?:normalfont|nm|rm|it|sl|bf)$/.test(e.trim())}).map(function(e){return"\\normalfont"==e.trim()||"normalfont"==e.trim()?"nm":"\\"==e.trim()[0]?e.trim().substring(1):e.trim()})).length)for(var i in wi.fontDimen.cache)for(var a=t.length-1;0<=a;a--)delete wi.fontDimen.cache[i][a]}else if(e&&t){if((t=t.split(",").filter(function(e){return/^\\?(?:normalfont|nm|rm|it|sl|bf)$/.test(e.trim())}).map(function(e){return"\\normalfont"==e.trim()||"normalfont"==e.trim()?"nm":"\\"==e.trim()[0]?e.trim().substring(1):e.trim()})).length&&wi.fontDimen.cache[e])for(var s=t.length-1;0<=s;s--)delete wi.fontDimen.cache[e][s]}else wi.fontDimen.cache={}}return wi._debug={data:_e,clearFontCache:O,reset:function(){_e.defs.macros={},_e.defs.active={},_e.registers.count={},_e.registers.dimen={},_e.registers.skip={},_e.registers.muskip={},_e.registers.named={}}},wi}();