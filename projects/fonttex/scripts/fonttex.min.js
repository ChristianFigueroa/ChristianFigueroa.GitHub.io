"use strict";function _typeof(e){function t(e){return i.apply(this,arguments)}var i,s;function a(e){return s.apply(this,arguments)}return(_typeof="function"==typeof Symbol&&"symbol"===_typeof(Symbol.iterator)?(s=function(e){return void 0===e?"undefined":_typeof(e)},a.toString=function(){return s.toString()},a):(i=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof(e)},t.toString=function(){return i.toString()},t))(e)}!function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).uuidv4=t()}(void 0,function(){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),l=new Uint8Array(16);for(var o=[],e=0;e<256;++e)o.push((e+256).toString(16).substr(1));return function(e,t,i){"string"==typeof e&&(t="binary"===e?new Uint8Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||function(){if(!n)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(l)})();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){for(var a=i||0,r=0;r<16;++r)t[a+r]=s[r];return t}return(o[s[0]]+o[s[1]]+o[s[2]]+o[s[3]]+"-"+o[s[4]]+o[s[5]]+"-"+o[s[6]]+o[s[7]]+"-"+o[s[8]]+o[s[9]]+"-"+o[s[10]]+o[s[11]]+o[s[12]]+o[s[13]]+o[s[14]]+o[s[15]]).toLowerCase()}}),window.fontTeX=function(){var d=0,m=3,u=11,f=13,yt={ORD:0,OP:1,BIN:2,REL:3,OPEN:4,CLOSE:5,PUNCT:6,VARIABLE:7,ACTIVE:8,INNER:"inner",OVER:"over",UNDER:"under",VCENTER:"vcenter",RAD:"rad",ACC:"acc"},bt={version:"0.5.1",config:function(e,t){var i=Object.keys(wt);if("string"==typeof e)return e=e.toLowerCase(),i.includes(e)?(1<arguments.length&&("number"!=typeof(t=wt[e][1](t))||isFinite(t)||(t=0),wt[e][0]=t),wt[e][0]):null;for(var s={},a=i.length-1;0<=a;a--){var r,n=i[a];e&&n in e&&("number"!=typeof(r=wt[n][1](e[n]))||isFinite(r)||(r=0),wt[n][0]=r),s[n]=wt[n][0]}return s}},wt={autoupdate:[!0,Boolean],parsehtml:[!0,Boolean],"invalid.color":["red",String],"radical.build":[!0,Boolean],"radical.w":[.5,Number],"radical.t":[.15,Number],"radical.h":[1.25,Number],"radical.verticalthreshold":[2.75,Number],"operator.growamount":[1.75,Number],"operator.growchars":["⅀∏∐∑∫∮⋀⋁⋂⋃⨀⨁⨂⨃⨄⨅⨆⨉⫿",String]};function y(e){return"string"==typeof e?y(document.querySelectorAll(e)):e instanceof HTMLElement?[e]:e instanceof NodeList||e instanceof HTMLCollection?Array.prototype.slice.call(e):Array.isArray(e)?e.filter(function(e){return e instanceof Node}):[]}function n(e){if("string"==typeof e)return n(document.querySelectorAll(e));if(e instanceof HTMLCollection||e instanceof NodeList)return n(Array.prototype.slice.call(e));if(e instanceof HTMLElement)return n([e]);if(e instanceof bt.ParsedFontTeX)return[e];if(Array.isArray(e)){for(var t,i=[],s=b.map(function(e){return e.elem}),a=0,r=e.length;a<r;a++){e[a]instanceof bt.ParsedFontTeX?i.push(e[a]):e[a]instanceof HTMLElement&&(~(t=s.indexOf(e[a]))&&i.push(b[t].parsedTeXInstance))}return i}return b.map(function(e){return e.parsedTeXInstance})}bt.rerender=function(e){for(var t=n(e),i=(t=b.filter(function(e){return t.includes(e.parsedTeXInstance)})).length-1;0<=i;i--)t[i].parsedTeXInstance.renderIn(t[i].elem)},bt.updateStyles=function(e){for(var t=n(e),i=0,s=(t=b.filter(function(e){return t.includes(e.parsedTeXInstance)})).length-1;0<=s;s--)t[s].oldFontFamily==t[s].styles.fontFamily&&t[s].oldFontSize==t[s].styles.fontSize&&t[s].oldColor==t[s].styles.color||(t[s].oldFontFamily=t[s].styles.fontFamily,t[s].oldFontSize=t[s].styles.fontSize,t[s].oldColor=t[s].styles.color,t[s].parsedTeXInstance.renderIn(t[s].elem),i++);return i};var b=[];function o(){console.log.apply(console,arguments)}new MutationObserver(function(){wt.autoupdate[0]&&bt.updateStyles()}).observe(document,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","style"]}),bt.parse=function(p){function e(e){var t=p[e]||"",i=J.cats[t.charCodeAt(0)];if(!i)return[{},0];if((i=i.value)!=d&&i!=m&&i!=f)return[{},0];if(i==d){var s=p[e+1],a=p.codePointAt(e+1),r="",n=void 0;if(a in J.cats&&J.cats[a].value==u){for(var l=e+1,o=p.codePointAt(l);o&&o in J.cats&&J.cats[o].value==u;o=p.codePointAt(++l))r+=p[l];if(!J.defs.macros[r])return[{},0];n=J.defs.macros[r]}else{if(!s||!J.defs.primitive[s]&&!J.defs.macros[s])return[{},0];r=s,n=J.defs.primitive[s]||J.defs.macros[s]}var c=!1;return n.isLet&&(n=n.original,c=!0),n===J.defs.primitive["["]?[{type:"command",name:"[",cat:-1},r.length+1]:n===J.defs.primitive["("]?[{type:"command",name:"(",cat:-1},r.length+1]:c&&n.replacement&&1==n.replacement.length&&n.replacement[0].cat==m?[{char:t,cat:m},r.length+1]:[{},0]}if(i==m)return[{char:t,cat:m},1];if(i==f&&J.defs.active[t]){if(J.defs.active[t].isLet){var h=J.defs.active[t].original;if(h===J.defs.primitive["["])return[{type:"command",name:"[",cat:-1},1];if(h===J.defs.primitive["("])return[{type:"command",name:"(",cat:-1},1];if(h.replacement&&1==h.replacement.length&&h.replacement[0].cat==m)return[{char:t,cat:m},1]}return[{},0]}}for(var t=[],i=p;p;)if(p.charCodeAt(0)in J.cats){var s,a=e(0),r=null,n=0;if(a[0].cat==m?(n+=a[1],(s=e(a[1]))[0].cat==m?(r="display",n+=s[1]):r="inline"):"command"==a[0].type&&"["==a[0].name?(r="display",n+=a[1]):"command"==a[0].type&&"("==a[0].name&&(r="inline",n+=a[1]),"display"==r||"inline"==r){var l=c(p.substring(n),r);if(!l[2]){t.push(p),p="";break}p=l[1],t.push([l[0],"display"==r?"display":"text"])}else"string"==typeof t[t.length-1]?t[t.length-1]+=p[0]:t.push(p[0]),p=p.substring(1)}else"string"==typeof t[t.length-1]?t[t.length-1]+=p[0]:t.push(p[0]),p=p.substring(1);return new bt.ParsedFontTeX(i,t)},bt.render=function(e){for(var t=(e=y(e)).length-1;0<=t;t--){var i=e[t].getAttribute("data-fontTeX-input");null===i&&(i=e[t].getAttribute("use")||e[t].getAttribute("data-use")||e[t].innerHTML),bt.parse(i).renderIn(e[t]),e[t].setAttribute("data-fontTeX-input",i)}};var t=document.getElementsByTagName("font-tex");function e(){for(var e=t.length-1;0<=e;e--)"true"!=t[e].getAttribute("data-fontTeX-is-parsed")&&(bt.render(t[e]),t[e].setAttribute("data-fontTeX-is-parsed","true"))}function c(e,y,t){var a=[],P=e,U=[];U.last=function(){return U[U.length-1]},new x;var b={global:!1},w=[];function j(i,s){function F(t,e){if(e=e||this,!t||"command"!=t.type&&("character"!=t.type||t.cat!=J.cats.active))return[t];if(t.invalid){var i=(i=("command"==t.type?t.escapeChar+t.name:t.char).split("")).map(function(e){return{type:"character",cat:J.cats.all,char:e,code:e.charCodeAt(0),invalid:!0,recognized:t.recognized}});return[{type:"character",cat:1,char:"{",code:123,invalid:!0}].concat(i).concat({type:"character",cat:2,char:"}",code:125,invalid:!0})}if(t.ignore)return[{type:"ignored command",token:t}];if("command"==t.type){if(t.name in U.last().defs.macros){if(U.last().defs.macros[t.name].proxy&&"primitive"==U.last().defs.macros[t.name].original.type){var s=U.last().defs.macros[t.name].original.function.call(t,{mouth:e,tokens:U.last().tokens,toggles:b,catOf:X,mathCodeOf:k,scopes:U,openGroups:S,contexts:w,Scope:x,style:y});return t.recognized=!0,Array.isArray(s)?s:[]}t.recognized=!0,(u=U.last().defs.macros[t.name]).proxy&&(u=u.original);var a=Symbol();e.saveState(a);for(var r=[],n=0,l=u.parameters.length;n<l;n++){if((v=u.parameters[n]).cat==J.cats.param)if(u.parameters[n+1]&&u.parameters[n+1].cat!=J.cats.param){var o=u.parameters[n+1];for(r.push([]),g=0;;){if(!(c=e.eat("argument")))return t.invalid=!0,e.loadState(a),[t];if(c[0].type==o.type&&c[0].cat==o.cat&&c[0].code==o.code&&c[0].name==o.name){e.revert();break}r[r.length-1]=r[r.length-1].concat(c),g++}1==g&&r[r.length-1][0].cat==J.cats.open&&r[r.length-1][r[r.length-1].length-1].cat==J.cats.close&&(r[r.length-1].shift(),r[r.length-1].pop())}else{if(!(c=e.eat("argument")))return t.invalid=!0,e.loadState(a),[t];2<c.length&&(c.shift(),c.pop()),r.push(c)}else{var c=e.eat();if(!v||!c||v.type!=c.type||v.cat!=c.cat||v.code!=c.code||v.name!=c.name)return t.invalid=!0,e.loadState(a),[t]}}for(var h,p=[],n=0,l=u.replacement.length;n<l;n++)if(u.replacement[n].cat==J.cats.param){u.replacement[n+1].cat==J.cats.param?(p.push(u.replacement[n+1]),n++):(h=u.replacement[n+1].char-1)>r.length?p=p.concat({type:"character",cat:J.cats.all,char:u.replacement[n].char,code:macros.replacement[n].code,invalid:!0}):(p=p.concat(r[h]),n++)}else{var d={};for(var m in u.replacement[n])d[m]=u.replacement[n][m];p.push(d)}return p}if(t.name in U.last().defs.primitive){s=U.last().defs.primitive[t.name].function.call(t,{mouth:e,tokens:U.last().tokens,toggles:b,catOf:X,scopes:U,openGroups:S,contexts:w,Scope:x,style:y});return t.recognized=!0,Array.isArray(s)?s:[]}return t.name in U.last().registers.named?[U.last().registers.named[t.name]]:(t.invalid=!0,[t])}if("character"==t.type){if(t.char in U.last().defs.active){if(U.last().defs.active[t.char].proxy&&"primitive"==U.last().defs.active[t.char].original.type){s=(U.last().defs.active[t.char].proxy?U.last().defs.active[t.char].original:U.last().defs.active[t.char]).function.call(t,{mouth:e,tokens:U.last().tokens,toggles:b,catOf:X,scopes:U,openGroups:S,contexts:w,Scope:x,style:y});return t.recognized=!0,Array.isArray(s)?s:[]}t.recognized=!0;var u=U.last().defs.active[t.char],f=Symbol();e.saveState(f),u.proxy&&(u=u.original);for(var v,r=[],n=0,l=u.parameters.length;n<l;n++){if((v=u.parameters[n]).cat==J.cats.param)if(u.parameters[n+1]&&u.parameters[n+1].cat!=J.cats.param){var o=u.parameters[n+1],g=0;for(r.push([]);;){if(!(c=e.eat("argument")))return t.invalid=!0,e.loadState(f),[t];if(c[0].type==o.type&&c[0].cat==o.cat&&c.code==o.code&&c.name==c.name){e.revert();break}r[r.length-1].push(c),g++}1==g&&r[r.length-1][0].cat==J.cats.open&&r[r.length-1][r[r.length-1].length-1].cat==J.cats.close&&(r[r.length-1].shift(),r[r.length-1].pop())}else{if(!(c=e.eat("argument")))return t.invalid=!0,e.loadState(f),[t];2<c.length&&(c.shift(),c.pop()),r.push([c])}else{c=e.eat();if(!v||!c||v.type!=c.type||v.cat!=c.cat||v.code!=c.code||v.name!=c.name)return t.invalid=!0,e.loadState(f),[t]}}for(p=[],n=0,l=u.replacement.length;n<l;n++)if(u.replacement[n].cat==J.cats.param)u.replacement[n+1].cat==J.cats.param?p.push(u.replacement[n+1]):p=p.concat(r[u.replacement[n+1].char-1]),n++;else{d={};for(var m in u.replacement[n])d[m]=u.replacement[n][m];p.push(d)}return p}return t.invalid=!0,[t]}}this.queue=(s||a).slice(),this.string="string"==typeof i?i:P,this.history=[],this.savedStates={},this.eat=function(e){switch(e){case void 0:case"pre space":default:if(this.queue.length)return this.queue[0].cat==J.cats.whitespace&&"pre space"!=e?(this.queue.shift(),this.eat(e)):(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),this.queue.shift());if(0==this.string.length)return null;if(X(this.string[0])==J.cats.escape){if(!this.string[1]||"\n"==this.string[1])return this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),this.string=this.string.substring(2),{type:"command",escapeChar:this.string[0],name:"",nameType:"command"};if(this.string[1]==this.string[2]&&X(this.string[1])==J.cats.super&&P[4]&&"0123456789abcdef".includes(P[3])&&"0123456789abcdef".includes(P[4])?this.string=this.string[0]+String.fromCharCode(this.string[3]+this.string[4],16)+this.string.substring(5):this.string[1]==this.string[2]&&X(this.string[1])==J.cats.super&&P[3].charCodeAt(0)<128&&(this.string=this.string[0]+String.fromCharCode((this.string[3].charCodeAt(0)+64)%128)+this.string.substring(4)),X(this.string[1])==J.cats.letter){for(var t="",i=1;;i++)if(X(this.string[i])==J.cats.letter)t+=this.string[i];else if(this.string[i]==this.string[i+1]&&X(this.string[i])==J.cats.super&&"0123456789abcdef".includes(this.string[i+2])&&"0123456789abcdef".includes(this.string[i+3]))this.string=this.string.substring(0,i)+String.fromCharCode(this.string.substring(i+2,i+4),16)+this.string.substring(0,i+4),i--;else{if(!(this.string[i]==this.string[i+1]&&X(this.string[i])==J.cats.super&&this.string.charCodeAt(i+2)<128))break;this.string=this.string.substring(0,i)+String.fromCharCode((this.string.charCodeAt(i+2)+64)%128)+this.string.substring(i+3),i--}this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});var s={type:"command",escapeChar:this.string[0],name:t,nameType:"command"};return this.string=this.string.substring(1+t.length),s}this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});s={type:"command",escapeChar:this.string[0],name:this.string[1],nameType:"symbol"};return this.string=this.string.substring(2),s}if(X(this.string[0])==J.cats.super&&this.string[0]==this.string[1]&&X(this.string[0])==J.cats.super&&"0123456789abcdef".includes(this.string[2])&&"0123456789abcdef".includes(this.string[3]))return this.string=String.fromCharCode(parseInt(this.string.substring(2,4),16))+this.string.substring(4),this.eat(e);if(X(this.string[0])==J.cats.super&&this.string[0]==this.string[1]&&X(this.string[0])==J.cats.super&&this.string.charCodeAt(2)<128)return this.string=String.fromCharCode((this.string.charCodeAt(2)+64)%128)+this.string.substring(3),this.eat(e);if([1,2,3,4,6,7,8,11,12,13].includes(X(this.string[0]))){this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});var a=this.string[0];return this.string=this.string.substring(1),{type:"character",char:a,code:a.charCodeAt(0),cat:X(a)}}if(X(this.string[0])==J.cats.eol){var r=this.string.indexOf("\n");for(this.string=this.string.substring(~r?r+1:this.string.length);X(this.string[0])==J.cats.whitespace;)this.string=this.string.substring(1);return"pre space"==e&&this.queue.unshift({type:"character",char:" ",code:32,cat:J.cats.whitespace}),this.eat(e)}if(X(this.string[0])==J.cats.comment){r=this.string.indexOf("\n");return this.string=this.string.substring(~r?r+1:this.string.length),this.eat(e)}if(X(this.string[0])==J.cats.whitespace&&"pre space"!=e||X(this.string[0])==J.cats.ignored)return this.string=this.string.substring(1),this.eat();if(X(this.string[0])==J.cats.whitespace&&"pre space"==e){this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});a=this.string[0];return this.string=this.string.substring(1),{type:"character",char:a,code:a.charCodeAt(0),cat:J.cats.whitespace}}if(X(this.string[0])!=J.cats.invalid)break;this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});a=this.string[0];return this.string=this.string.substring(1),{type:"character",char:a,code:a.charCodeAt(0),cat:J.cats.all,invalid:!0};case"argument":for(var n=new j(this.string,this.queue),l=0,o=[];;){if(!(s=n.eat()))break;if(s.cat==J.cats.open?l++:s.cat==J.cats.close&&l--,o.push(s),0==l)break}return 0<l||0==o.length?null:(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),n.finalize(),this.string=n.string,o);case"integer":for(var n=new j(this.string,this.queue),c=1,e="start",h=0,p=!1,d="pre space";;){if(!(s=n.eat(d)))break;if("start"==e&&("command"==s.type||"character"==s.type&&s.cat==J.cats.active)){if((R="command"==s.type?U.last().defs.primitive[s.name]||U.last().defs.macros[s.name]||U.last().registers.named[s.name]:U.last().defs.active[s.char])&&(R.register||R===J.defs.primitive.catcode||R.proxy&&R.original===J.defs.primitive.catcode||R===J.defs.primitive.count||R.proxy&&R.original===J.defs.primitive.count||R===J.defs.primitive.day||R.proxy&&R.original===J.defs.primitive.day||R===J.defs.primitive.dimen||R.proxy&&R.original===J.defs.primitive.dimen||R===J.defs.primitive.lccode||R.proxy&&R.original===J.defs.primitive.lccode||R===J.defs.primitive.mathcode||R.proxy&&R.original===J.defs.primitive.mathcode||R===J.defs.primitive.month||R.proxy&&R.original===J.defs.primitive.month||R===J.defs.primitive.muskip||R.proxy&&R.original===J.defs.primitive.muskip||R===J.defs.primitive.skip||R.proxy&&R.original===J.defs.primitive.skip||R===J.defs.primitive.time||R.proxy&&R.original===J.defs.primitive.time||R===J.defs.primitive.uccode||R.proxy&&R.original===J.defs.primitive.uccode||R===J.defs.primitive.year||R.proxy&&R.original===J.defs.primitive.year)){if(1==(W=F(s,n)).length&&W[0]===s&&s.invalid){n.revert();break}n.queue.unshift.apply(n.queue,W);continue}if(R&&(R===J.defs.primitive.relax||R.proxy&&R.original===J.defs.primitive.relax))break;n.revert();break}if("start"!=e||s.cat!=J.cats.whitespace)if("start"==e&&s.cat==J.cats.all&&"-"==s.char)c*=-1;else{if("start"==e&&s.cat==J.cats.all&&"+"==s.char)continue;if("start"==e&&s.register){"integer"==s.type?(h=s.value,d="pre space"):"dimension"==s.type?h=s.sp.value+12*s.em.value:"mu dimension"==s.type?h=12*s.mu.value/18:"glue"==s.type?h=s.start.sp.value+12*s.start.em.value:"mu glue"==s.type&&(h=12*s.start.mu.value/18),p=!0;break}if("start"!=e){n.revert();break}d="unsigned int",n.revert()}}return p?(h*=c,this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),n.finalize(),this.string=n.string,new G(h)):null;case"dimension":for(var m,u,n=new j(this.string,this.queue),c=1,e="start",f=!1,v=!1,h=" ",g=0,y=0,b=!1,d="pre space";!v;){if(!(s=n.eat(d)))break;if("start"==e&&("command"==s.type||"character"==s.type&&s.cat==J.cats.active)){if((R="command"==s.type?U.last().defs.primitive[s.name]||U.last().defs.macros[s.name]||U.last().registers.named[s.name]:U.last().defs.active[s.char])&&(R.register||R===J.defs.primitive.catcode||R.proxy&&R.original===J.defs.primitive.catcode||R===J.defs.primitive.count||R.proxy&&R.original===J.defs.primitive.count||R===J.defs.primitive.day||R.proxy&&R.original===J.defs.primitive.day||R===J.defs.primitive.dimen||R.proxy&&R.original===J.defs.primitive.dimen||R===J.defs.primitive.lccode||R.proxy&&R.original===J.defs.primitive.lccode||R===J.defs.primitive.mathcode||R.proxy&&R.original===J.defs.primitive.mathcode||R===J.defs.primitive.month||R.proxy&&R.original===J.defs.primitive.month||R===J.defs.primitive.muskip||R.proxy&&R.original===J.defs.primitive.muskip||R===J.defs.primitive.skip||R.proxy&&R.original===J.defs.primitive.skip||R===J.defs.primitive.time||R.proxy&&R.original===J.defs.primitive.time||R===J.defs.primitive.uccode||R.proxy&&R.original===J.defs.primitive.uccode||R===J.defs.primitive.year||R.proxy&&R.original===J.defs.primitive.year)){if(1==(W=F(s,n)).length&&W[0]===s&&s.invalid){n.revert();break}n.queue.unshift.apply(n.queue,W);continue}if(R&&(R===J.defs.primitive.relax||R.proxy&&R.original===J.defs.primitive.relax))break;n.revert();break}if("start"!=e||s.cat!=J.cats.whitespace)if("start"==e&&s.cat==J.cats.all&&"-"==s.char)c*=-1;else{if("start"==e&&s.cat==J.cats.all&&"+"==s.char)continue;if("start"==e&&!f&&s.register){if("integer"==s.type?(h=s.value,"decimal"==s.message&&(h/=65536),h=" "+h,d="pre space",e="unit start"):"dimension"==s.type?(g=s.sp.value,y=s.em.value,v=!0):"mu dimension"==s.type?(y=s.mu.value/18,v=!0):"glue"==s.type?(g=s.start.sp.value,y=s.start.em.value,v=!0):"mu glue"==s.type&&(y=s.start.mu.value/18,v=!0),f=!0,v)break;continue}if(f&&"unit start"==e&&s.cat==J.cats.whitespace)e="unit start";else{if(f&&s.register){h=parseFloat((h+" ").replace(" .",".").replace(". ","")||"0"),"integer"==s.type?g=h*s.value:"dimension"==s.type?(g=h*s.sp.value,y=h*s.em.value):"mu dimension"==s.type?y=h*s.mu.value/18:"glue"==s.type?(g=h*s.start.sp.value,y=h*s.start.em.value):"mu glue"==s.type&&(y=h*s.start.mu.value),v=!0;break}if(f&&!b&&("t"==s.char||"T"==s.char)){var w=n.eat("pre space");if(!w||"r"!=w.char&&"R"!=w.char||w.cat==J.cats.active)n.revert(2);else if(!(B=n.eat("pre space"))||"u"!=B.char&&"U"!=w.char||B.cat==J.cats.active)n.revert(3);else{var x=n.eat("pre space");if(x&&("e"==x.char||"E"==x.char)&&x.cat!=J.cats.active){b=!0,e="unit start";continue}n.revert(4)}break}if(!f||b||"e"!=s.char&&"E"!=s.char)if(!f||"p"!=s.char&&"P"!=s.char)if(!f||"i"!=s.char&&"I"!=s.char)if(!f||"b"!=s.char&&"B"!=s.char)if(!f||"c"!=s.char&&"C"!=s.char)if(!f||"m"!=s.char&&"M"!=s.char)if(!f||"d"!=s.char&&"D"!=s.char)if(!f||"s"!=s.char&&"S"!=s.char){if("start"!=e||f){n.revert();break}d="factor",n.revert()}else{if(!(m=n.eat("pre space"))||"p"!=m.char&&"P"!=m.char||m.cat==J.cats.active){n.revert(2);break}g=parseFloat((h+" ").replace(" .",".").replace(". ","")||"0"),v=!0}else{var k=n.eat("pre space");if(!k||"d"!=k.char&&"D"!=k.char||k.cat==J.cats.active){n.revert(2);break}g=65536*parseFloat((h+" ").replace(" .",".").replace(". ","")||"0")*1238/1157,v=!0}else{var S=n.eat("pre space");if(!S||"m"!=S.char&&"M"!=S.char||S.cat==J.cats.active){n.revert(2);break}g=65536*parseFloat((h+" ").replace(" .",".").replace(". ","")||"0")*72/2.54/10,v=!0}else{if(!(u=n.eat("pre space"))||"m"!=u.char&&"M"!=u.char||u.cat==J.cats.active){if(!u||"c"!=u.char&&"C"!=u.char||u.cat==J.cats.active){n.revert(2);break}g=65536*parseFloat((h+" ").replace(" .",".").replace(". ","")||"0")*1238/1157*12,v=!0}else g=65536*parseFloat((h+" ").replace(" .",".").replace(". ","")||"0")*72/2.54,v=!0}else{if(!(m=n.eat("pre space"))||"p"!=m.char&&"P"!=m.char||m.cat==J.cats.active){n.revert(2);break}g=65536*parseFloat((h+" ").replace(" .",".").replace(". ","")||"0"),v=!0}else{if(!(H=n.eat("pre space"))||"n"!=H.char&&"N"!=H.char||H.cat==J.cats.active){n.revert(2);break}g=65536*parseFloat((h+" ").replace(" .",".").replace(". ","")||"0")*72,v=!0}else{if(!(u=n.eat("pre space"))||"t"!=u.char&&"T"!=u.char||u.cat==J.cats.active)if(!u||"c"!=u.char&&"C"!=u.char||u.cat==J.cats.active){if(!u||"x"!=u.char&&"X"!=u.char||u.cat==J.cats.active){n.revert(2);break}g=65536*parseFloat((h+" ").replace(" .",".").replace(". ","")||"0")*12/16,v=!0}else g=65536*parseFloat((h+" ").replace(" .",".").replace(". ","")||"0")*12,v=!0;else g=65536*parseFloat((h+" ").replace(" .",".").replace(". ","")||"0"),v=!0}else{if(!(u=n.eat("pre space"))||"m"!=u.char&&"M"!=u.char||u.cat==J.cats.active){if(!u||"x"!=u.char&&"X"!=u.char||u.cat==J.cats.active){n.revert(2);break}y=233*parseFloat((h+" ").replace(" .",".").replace(". ","")||"0")/480*65536}else y=65536*parseFloat((h+" ").replace(" .",".").replace(". ","")||"0");v=!0}}}}return f&&v?(g*=c,y*=c,this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),n.finalize(),this.string=n.string,b?new xt(1e3*g/U.last().registers.named.mag.value,1e3*y/U.last().registers.named.mag.value):new xt(g,y)):null;case"mu dimension":for(var n=new j(this.string,this.queue),c=1,e="start",f=!1,v=!1,h=" ",D=0,b=!1,d="pre space";!v;){if(!(s=n.eat(d)))break;if("start"==e&&("command"==s.type||"character"==s.type&&s.cat==J.cats.active)){if((R="command"==s.type?U.last().defs.primitive[s.name]||U.last().defs.macros[s.name]||U.last().registers.named[s.name]:U.last().defs.active[s.char])&&(R.register||R===J.defs.primitive.catcode||R.proxy&&R.original===J.defs.primitive.catcode||R===J.defs.primitive.count||R.proxy&&R.original===J.defs.primitive.count||R===J.defs.primitive.day||R.proxy&&R.original===J.defs.primitive.day||R===J.defs.primitive.dimen||R.proxy&&R.original===J.defs.primitive.dimen||R===J.defs.primitive.lccode||R.proxy&&R.original===J.defs.primitive.lccode||R===J.defs.primitive.mathcode||R.proxy&&R.original===J.defs.primitive.mathcode||R===J.defs.primitive.month||R.proxy&&R.original===J.defs.primitive.month||R===J.defs.primitive.muskip||R.proxy&&R.original===J.defs.primitive.muskip||R===J.defs.primitive.skip||R.proxy&&R.original===J.defs.primitive.skip||R===J.defs.primitive.time||R.proxy&&R.original===J.defs.primitive.time||R===J.defs.primitive.uccode||R.proxy&&R.original===J.defs.primitive.uccode||R===J.defs.primitive.year||R.proxy&&R.original===J.defs.primitive.year)){if(1==(W=F(s,n)).length&&W[0]===s&&s.invalid){n.revert();break}n.queue.unshift.apply(n.queue,W);continue}if(R&&(R===J.defs.primitive.relax||R.proxy&&R.original===J.defs.primitive.relax))break;n.revert();break}if("start"!=e||s.cat!=J.cats.whitespace)if("start"==e&&s.cat==J.cats.all&&"-"==s.char)c*=-1;else{if("start"==e&&s.cat==J.cats.all&&"+"==s.char)continue;if("start"==e&&!f&&s.register){if("integer"==s.type?(h=s.value,"decimal"==s.message&&(h/=65536),h=" "+h,d="pre space",e="unit start"):"dimension"==s.type?(D=s.em.value/65536*18,v=!0):"mu dimension"==s.type?(D=s.mu.value/65536,v=!0):"glue"==s.type?(D=s.start.em.value/65536*18,v=!0):"mu glue"==s.type&&(D=s.start.mu.value/65536,v=!0),f=!0,v)break;continue}if(f&&"unit start"==e&&s.cat==J.cats.whitespace)e="unit start";else{if(f&&s.register&&"mu glue"==s.type){D=(h=parseFloat((h+" ").replace(" .",".").replace(". ","")||"0"))*s.start.mu.value/65536,v=!0;break}if(!f||"m"!=s.char&&"M"!=s.char){if("start"!=e||f){n.revert();break}d="factor",n.revert()}else{if(!(B=n.eat("pre space"))||"u"!=B.char&&"U"!=B.char||B.cat==J.cats.active){n.revert(2);break}D=parseFloat((h+" ").replace(" .",".").replace(". ","")||"0"),v=!0}}}}return f&&v?(D*=c,this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),n.finalize(),this.string=n.string,new V(65536*D)):null;case"glue":for(var n=new j(this.string,this.queue),c=1,C=1,L=1,e="start",A=!1,O=!1,d="pre space";;){if(!(s=n.eat(d))&&("post start"!=e&&"stretch signs"!=e||"dimension"!=d)&&("post stretch"!=e&&"shrink signs"!=e||"dimension"!=d)){M&&n.loadState(M);break}if(s||"dimension"!=d){if(("start"==e||"signs"==e||"post start"==e||"stretch signs"==e||"post stretch"==e||"shrink signs"==e)&&("command"==s.type||"character"==s.type&&s.cat==J.cats.active)){if((R="command"==s.type?U.last().defs.primitive[s.name]||U.last().defs.macros[s.name]||U.last().registers.named[s.name]:U.last().defs.active[s.char])&&(R.register||R===J.defs.primitive.catcode||R.proxy&&R.original===J.defs.primitive.catcode||R===J.defs.primitive.count||R.proxy&&R.original===J.defs.primitive.count||R===J.defs.primitive.day||R.proxy&&R.original===J.defs.primitive.day||R===J.defs.primitive.dimen||R.proxy&&R.original===J.defs.primitive.dimen||R===J.defs.primitive.lccode||R.proxy&&R.original===J.defs.primitive.lccode||R===J.defs.primitive.mathcode||R.proxy&&R.original===J.defs.primitive.mathcode||R===J.defs.primitive.month||R.proxy&&R.original===J.defs.primitive.month||R===J.defs.primitive.muskip||R.proxy&&R.original===J.defs.primitive.muskip||R===J.defs.primitive.skip||R.proxy&&R.original===J.defs.primitive.skip||R===J.defs.primitive.time||R.proxy&&R.original===J.defs.primitive.time||R===J.defs.primitive.uccode||R.proxy&&R.original===J.defs.primitive.uccode||R===J.defs.primitive.year||R.proxy&&R.original===J.defs.primitive.year)){if(1==(W=F(s,n)).length&&W[0]===s&&s.invalid){n.revert();break}n.queue.unshift.apply(n.queue,W);continue}if(R&&(R===J.defs.primitive.relax||R.proxy&&R.original===J.defs.primitive.relax))break;n.revert();break}if(("start"==e||"signs"==e||"post start"==e||"post stretch"==e||"stretch signs"==e||"shrink signs"==e)&&s.cat==J.cats.whitespace)continue;if("start"!=e&&"signs"!=e||s.cat!=J.cats.all||"-"!=s.char)if("start"!=e&&"signs"!=e||s.cat!=J.cats.all||"+"!=s.char){if(("start"==e||"signs"==e)&&s.register&&"glue"==s.type){T=new xt(s.start.sp.value*c,s.start.em.value*c),E=new xt(s.stretch.sp.value*c,s.stretch.em.value*c),q=new xt(s.shrink.sp.value*c,s.shrink.em.value*c),O=A=!0;break}if("start"!=e&&"signs"!=e||!s.register||"dimension"!=s.type)if("start"==e||"signs"==e)d="dimension",n.revert();else{if("post start"==e&&T&&!O&&!A&&"p"==s.char){if((N=n.eat("pre space"))&&("l"==N.char||"L"==N.char)&&N.cat!=J.cats.active)if((B=n.eat("pre space"))&&("u"==B.char||"U"==B.char)&&B.cat!=J.cats.active)if((I=n.eat("pre space"))&&("s"==I.char||"S"==I.char)&&I.cat!=J.cats.active){O=!0;continue}n.loadState(M);break}if("post start"==e&&O&&s.cat==J.cats.all&&"-"==s.char)C*=-1,e="stretch signs";else if("post start"==e&&O&&s.cat==J.cats.all&&"+"==s.char)e="stretch signs";else if(("post start"==e||"stretch signs"==e)&&O&&s.register&&"dimension"==s.type)E=new xt(s.sp.value*C,s.em.value*L),e="post stretch",d="pre space",n.saveState(M=Symbol());else{if(("post start"==e||"stretch signs"==e)&&O&&s.register&&"integer"==s.type){if(d="pre space",(z=n.eat())&&("f"==z.char||"F"==z.char)&&z.cat!=J.cats.active)if((i=n.eat("pre space"))&&("i"==i.char||"I"==i.char)&&i.cat!=J.cats.active)if((N=n.eat("pre space"))&&("l"==N.char||"L"==N.char)&&N.cat!=J.cats.active){E=!(N=n.eat("pre space"))||"l"!=N.char&&"L"!=N.char||N.cat==J.cats.active?(N&&n.revert(),new Y(s.value*C,1)):!(N=n.eat("pre space"))||"l"!=N.char&&"L"!=N.char||N.cat==J.cats.active?(N&&n.revert(),new Y(s.value*C,2)):new Y(s.value*C,3),e="post stretch",n.saveState(M=Symbol());continue}n.loadState(M);break}if("post start"!=e&&"stretch signs"!=e||!O){if(("post start"==e&&!O||"post stretch"==e)&&!A&&"m"==s.char){if((i=n.eat("pre space"))&&("i"==i.char||"I"==i.char)&&i.cat!=J.cats.active)if((H=n.eat("pre space"))&&("n"==H.char||"N"==H.char)&&H.cat!=J.cats.active)if((B=n.eat("pre space"))&&("u"==B.char||"U"==B.char)&&B.cat!=J.cats.active)if((I=n.eat("pre space"))&&("s"==I.char||"S"==I.char)&&I.cat!=J.cats.active){A=!0;continue}n.loadState(M);break}if("post stretch"==e&&A&&s.cat==J.cats.all&&"-"==s.char)L*=-1,e="shrink signs";else if("post stretch"==e&&A&&s.cat==J.cats.all&&"+"==s.char)e="shrink signs";else{if(("post stretch"==e||"shrink signs"==e||"post start"==e)&&A&&s.register&&"dimension"==s.type){q=new xt(s.sp.value*L,s.em.value*L);break}if(("post stretch"==e||"shrink signs"==e||"post start"==e)&&A&&s.register&&"integer"==s.type){if((z=n.eat())&&("f"==z.char||"F"==z.char)&&z.cat!=J.cats.active)if((i=n.eat("pre space"))&&("i"==i.char||"I"==i.char)&&i.cat!=J.cats.active)if((N=n.eat("pre space"))&&("l"==N.char||"L"==N.char)&&N.cat!=J.cats.active){q=!(N=n.eat("pre space"))||"l"!=N.char&&"L"!=N.char||N.cat==J.cats.active?(N&&n.revert(),new Y(s.value*L,1)):!(N=n.eat("pre space"))||"l"!=N.char&&"L"!=N.char||N.cat==J.cats.active?(N&&n.revert(),new Y(s.value*L,2)):new Y(s.value*L,3);break}n.loadState(M);break}if("post stretch"!=e&&"shrink signs"!=e&&"post start"!=e||!A){M?n.loadState(M):n.revert();break}d="dimension",n.revert()}}else d="dimension",n.revert()}}else T=new xt(s.sp.value*c,s.em.value*c),e="post start",d="pre space",n.saveState(M=Symbol())}else e="signs";else c*=-1,e="signs"}else d="factor"}return T?(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),n.finalize(),this.string=n.string,new _(T,E,q)):null;case"mu glue":for(var M,T,E,q,H,B,I,z,N,n=new j(this.string,this.queue),c=1,C=1,L=1,e="start",A=!1,O=!1,d="pre space";;){if(!(s=n.eat(d))&&("post start"!=e&&"stretch signs"!=e||"mu dimension"!=d)&&("post stretch"!=e&&"shrink signs"!=e||"mu dimension"!=d)){M&&n.loadState(M);break}if(s||"mu dimension"!=d){if(("start"==e||"signs"==e||"post start"==e||"stretch signs"==e||"post stretch"==e||"shrink signs"==e)&&("command"==s.type||"character"==s.type&&s.cat==J.cats.active)){if((R="command"==s.type?U.last().defs.primitive[s.name]||U.last().defs.macros[s.name]||U.last().registers.named[s.name]:U.last().defs.active[s.char])&&(R.register||R===J.defs.primitive.catcode||R.proxy&&R.original===J.defs.primitive.catcode||R===J.defs.primitive.count||R.proxy&&R.original===J.defs.primitive.count||R===J.defs.primitive.day||R.proxy&&R.original===J.defs.primitive.day||R===J.defs.primitive.dimen||R.proxy&&R.original===J.defs.primitive.dimen||R===J.defs.primitive.lccode||R.proxy&&R.original===J.defs.primitive.lccode||R===J.defs.primitive.mathcode||R.proxy&&R.original===J.defs.primitive.mathcode||R===J.defs.primitive.month||R.proxy&&R.original===J.defs.primitive.month||R===J.defs.primitive.muskip||R.proxy&&R.original===J.defs.primitive.muskip||R===J.defs.primitive.skip||R.proxy&&R.original===J.defs.primitive.skip||R===J.defs.primitive.time||R.proxy&&R.original===J.defs.primitive.time||R===J.defs.primitive.uccode||R.proxy&&R.original===J.defs.primitive.uccode||R===J.defs.primitive.year||R.proxy&&R.original===J.defs.primitive.year)){if(1==(W=F(s,n)).length&&W[0]===s&&s.invalid){n.revert();break}n.queue.unshift.apply(n.queue,W);continue}if(R&&(R===J.defs.primitive.relax||R.proxy&&R.original===J.defs.primitive.relax))break;n.revert();break}if(("start"==e||"signs"==e||"post start"==e||"post stretch"==e||"stretch signs"==e||"shrink signs"==e)&&s.cat==J.cats.whitespace)continue;if("start"!=e&&"signs"!=e||s.cat!=J.cats.all||"-"!=s.char)if("start"!=e&&"signs"!=e||s.cat!=J.cats.all||"+"!=s.char){if(("start"==e||"signs"==e)&&s.register&&"mu glue"==s.type){T=new V(s.start.mu.value*c),E=new V(s.stretch.mu.value*c),q=new V(s.shrink.mu.value*c),O=A=!0;break}if("start"!=e&&"signs"!=e||!s.register||"mu dimension"!=s.type)if("start"==e||"signs"==e)d="mu dimension",n.revert();else{if("post start"==e&&T&&!O&&!A&&"p"==s.char){if((N=n.eat("pre space"))&&("l"==N.char||"L"==N.char)&&N.cat!=J.cats.active)if((B=n.eat("pre space"))&&("u"==B.char||"U"==B.char)&&B.cat!=J.cats.active)if((I=n.eat("pre space"))&&("s"==I.char||"S"==I.char)&&I.cat!=J.cats.active){O=!0;continue}n.loadState(M);break}if("post start"==e&&O&&s.cat==J.cats.all&&"-"==s.char)C*=-1,e="stretch signs";else if("post start"==e&&O&&s.cat==J.cats.all&&"+"==s.char)e="stretch signs";else if(("post start"==e||"stretch signs"==e)&&O&&s.register&&"mu dimension"==s.type)E=new V(s.mu.value*C),e="post stretch",d="pre space",n.saveState(M=Symbol());else{if(("post start"==e||"stretch signs"==e)&&O&&s.register&&"integer"==s.type){if(d="pre space",(z=n.eat())&&("f"==z.char||"F"==z.char)&&z.cat!=J.cats.active)if((i=n.eat("pre space"))&&("i"==i.char||"I"==i.char)&&i.cat!=J.cats.active)if((N=n.eat("pre space"))&&("l"==N.char||"L"==N.char)&&N.cat!=J.cats.active){E=!(N=n.eat("pre space"))||"l"!=N.char&&"L"!=N.char||N.cat==J.cats.active?(n.revert(),new Y(s.value*C,1)):!(N=n.eat("pre space"))||"l"!=N.char&&"L"!=N.char||N.cat==J.cats.active?(n.revert(),new Y(s.value*C,2)):new Y(s.value*C,3),e="post stretch",n.saveState(M=Symbol());continue}n.loadState(M);break}if("post start"!=e&&"stretch signs"!=e||!O){if(("post start"==e&&!O||"post stretch"==e)&&!A&&"m"==s.char){if((i=n.eat("pre space"))&&("i"==i.char||"I"==i.char)&&i.cat!=J.cats.active)if((H=n.eat("pre space"))&&("n"==H.char||"N"==H.char)&&H.cat!=J.cats.active)if((B=n.eat("pre space"))&&("u"==B.char||"U"==B.char)&&B.cat!=J.cats.active)if((I=n.eat("pre space"))&&("s"==I.char||"S"==I.char)&&I.cat!=J.cats.active){A=!0;continue}n.loadState(M);break}if("post stretch"==e&&A&&s.cat==J.cats.all&&"-"==s.char)L*=-1,e="shrink signs";else if("post stretch"==e&&A&&s.cat==J.cats.all&&"+"==s.char)e="shrink signs";else{if(("post stretch"==e||"shrink signs"==e||"post start"==e)&&A&&s.register&&"mu dimension"==s.type){q=new V(s.mu.value*L);break}if(("post stretch"==e||"shrink signs"==e||"post start"==e)&&A&&s.register&&"integer"==s.type){if((z=n.eat())&&("f"==z.char||"F"==z.char)&&z.cat!=J.cats.active)if((i=n.eat("pre space"))&&("i"==i.char||"I"==i.char)&&i.cat!=J.cats.active)if((N=n.eat("pre space"))&&("l"==N.char||"L"==N.char)&&N.cat!=J.cats.active){q=!(N=n.eat("pre space"))||"l"!=N.char&&"L"!=N.char||N.cat==J.cats.active?new Y(s.value*L,1):!(N=n.eat("pre space"))||"l"!=N.char&&"L"!=N.char||N.cat==J.cats.active?new Y(s.value*L,2):new Y(s.value*L,3);break}n.loadState(M);break}if("post stretch"!=e&&"shrink signs"!=e&&"post start"!=e||!A){M?n.loadState(M):n.revert();break}d="mu dimension",n.revert()}}else d="mu dimension",n.revert()}}else T=new V(s.mu.value*c),e="post start",d="pre space",n.saveState(M=Symbol())}else e="signs";else c*=-1,e="signs"}else d="factor"}return T?(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),n.finalize(),this.string=n.string,new $(T,E,q)):null;case"unsigned int":for(n=new j(this.string,this.queue),e="start",h=0,p=!1;;){if(!(s=n.eat("pre space")))break;if("grave"==e){if("command"==s.type&&1==s.name.length)h=s.name.charCodeAt(0);else{if("character"!=s.type)return null;h=s.char.charCodeAt(0)}p=!0;break}if("start"==e&&("command"==s.type||"character"==s.type&&s.cat==J.cats.active)){if((R="command"==s.type?U.last().defs.primitive[s.name]||U.last().defs.macros[s.name]||U.last().registers.named[s.name]:U.last().defs.active[s.char])&&(R.register||R===J.defs.primitive.catcode||R.proxy&&R.original===J.defs.primitive.catcode||R===J.defs.primitive.count||R.proxy&&R.original===J.defs.primitive.count||R===J.defs.primitive.day||R.proxy&&R.original===J.defs.primitive.day||R===J.defs.primitive.dimen||R.proxy&&R.original===J.defs.primitive.dimen||R===J.defs.primitive.lccode||R.proxy&&R.original===J.defs.primitive.lccode||R===J.defs.primitive.mathcode||R.proxy&&R.original===J.defs.primitive.mathcode||R===J.defs.primitive.month||R.proxy&&R.original===J.defs.primitive.month||R===J.defs.primitive.muskip||R.proxy&&R.original===J.defs.primitive.muskip||R===J.defs.primitive.skip||R.proxy&&R.original===J.defs.primitive.skip||R===J.defs.primitive.time||R.proxy&&R.original===J.defs.primitive.time||R===J.defs.primitive.uccode||R.proxy&&R.original===J.defs.primitive.uccode||R===J.defs.primitive.year||R.proxy&&R.original===J.defs.primitive.year)){if(1==(W=F(s,n)).length&&W[0]===s&&s.invalid){n.revert();break}n.queue.unshift.apply(n.queue,W);continue}if(R&&(R===J.defs.primitive.relax||R.proxy&&R.original===J.defs.primitive.relax))break;n.revert();break}if("start"!=e||s.cat!=J.cats.whitespace){if("start"==e&&s.register&&"integer"==s.type){h=s.value,p=!0;break}if(("decimal"==e||"start"==e)&&s.cat==J.cats.all&&47<s.code&&s.code<58)h=10*h+ +s.char,e="decimal",p=!0;else if("start"==e&&s.cat==J.cats.all&&"'"==s.char)e="octal";else if("start"==e&&s.cat==J.cats.all&&'"'==s.char)e="hexadecimal";else if("start"==e&&s.cat==J.cats.all&&"`"==s.char)e="grave";else if("octal"==e&&s.cat==J.cats.all&&47<s.code&&s.code<56)h=8*h+ +s.char,p=!0;else{if("hexadecimal"!=e||!(s.cat==J.cats.all&&47<s.code&&s.code<58||(s.cat==J.cats.all||s.cat==J.cats.letter)&&64<s.code&&s.code<71)){n.revert();break}h=16*h+parseInt(s.char,16),p=!0}}}return p?(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),n.finalize(),this.string=n.string,new G(h)):null;case"factor":for(var R,W,n=new j(this.string,this.queue),e="start",d="pre space",p=!1,h="";;){if(!(s=n.eat(d)))break;if("start"==e&&("command"==s.type||"character"==s.type&&s.cat==J.cats.active)){if((R="command"==s.type?U.last().defs.primitive[s.name]||U.last().defs.macros[s.name]||U.last().registers.named[s.name]:U.last().defs.active[s.char])&&(R.register||R===J.defs.primitive.catcode||R.proxy&&R.original===J.defs.primitive.catcode||R===J.defs.primitive.count||R.proxy&&R.original===J.defs.primitive.count||R===J.defs.primitive.day||R.proxy&&R.original===J.defs.primitive.day||R===J.defs.primitive.dimen||R.proxy&&R.original===J.defs.primitive.dimen||R===J.defs.primitive.lccode||R.proxy&&R.original===J.defs.primitive.lccode||R===J.defs.primitive.mathcode||R.proxy&&R.original===J.defs.primitive.mathcode||R===J.defs.primitive.month||R.proxy&&R.original===J.defs.primitive.month||R===J.defs.primitive.muskip||R.proxy&&R.original===J.defs.primitive.muskip||R===J.defs.primitive.skip||R.proxy&&R.original===J.defs.primitive.skip||R===J.defs.primitive.time||R.proxy&&R.original===J.defs.primitive.time||R===J.defs.primitive.uccode||R.proxy&&R.original===J.defs.primitive.uccode||R===J.defs.primitive.year||R.proxy&&R.original===J.defs.primitive.year)){if(1==(W=F(s,n)).length&&W[0]===s&&s.invalid){n.revert();break}n.queue.unshift.apply(n.queue,W);continue}if(R&&(R===J.defs.primitive.relax||R.proxy&&R.original===J.defs.primitive.relax))break;n.revert();break}if("start"!=e||s.cat!=J.cats.whitespace){if("start"==e&&s.register&&"integer"==s.type){h=s.value.toString(),p=!0;break}if(("pre decimal"==e||"start"==e)&&s.cat==J.cats.all&&47<s.code&&s.code<58)h+=s.char,e="pre decimal",p=!0;else if("pre decimal"!=e&&"start"!=e||s.cat!=J.cats.all||"."!=s.char&&","!=s.char)if("post decimal"==e&&s.cat==J.cats.all&&47<s.code&&s.code<58)h+=s.char;else{if("start"!=e){n.revert();break}d="unsigned int",n.revert()}else h+=".",e="post decimal",p=!0}}return p?(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),n.finalize(),this.string=n.string,new G(65536*h,null,null,"decimal")):null}},this.preview=function(e){var t=this.eat(e);return t&&this.revert(),t},this.revert=function(e){for(e="number"==typeof e?e:1;0<e;e--){if(0==this.history.length)return this;this.string=this.history[this.history.length-1].string;for(var t=0,i=this.history[this.history.length-1].queue.length;t<i;t++)this.queue[t]=this.history[this.history.length-1].queue[t];this.queue.length=this.history[this.history.length-1].queue.length,this.history=this.history[this.history.length-1].history}return this},this.finalize=function(){for(var e=0,t=this.queue.length;e<t;e++)(s||a)[e]=this.queue[e];(s||a).length=this.queue.length,"string"!=typeof i&&(P=this.string)},this.saveState=function(e){return this.savedStates[e]={queue:this.queue.slice(),string:this.string,history:this.history.slice()},this},this.loadState=function(e){this.string=this.savedStates[e].string,this.history=this.savedStates[e].history;for(var t=0,i=this.savedStates[e].queue.length;t<i;t++)this.queue[t]=this.savedStates[e].queue[t];return this.queue.length=this.savedStates[e].queue.length,this},this.expand=F}function x(){var e=this.parentScope=U.last()||J;for(var t in this.defs={primitive:{},macros:{},active:{}},this.registers={count:{},dimen:{},skip:{},muskip:{},named:{}},this.cats={},this.mathcodes={},this.lc={},this.uc={},this.font={},e.defs.primitive)this.defs.primitive[t]=e.defs.primitive[t];for(t in e.defs.macros)this.defs.macros[t]=e.defs.macros[t];for(t in e.defs.active)this.defs.active[t]=e.defs.active[t];for(t in e.lc)this.lc[t]=new G(e.lc[t]);for(t in e.uc)this.uc[t]=new G(e.uc[t]);for(t in e.font)this.font[t]=e.font[t];for(t in e.cats)isNaN(t)||(this.cats[t]=new G(e.cats[t]));for(t in e.mathcodes)isNaN(t)||(this.mathcodes[t]=new G(e.mathcodes[t]));for(t in e.registers.count)this.registers.count[t]=new G(e.registers.count[t]);for(t in e.registers.dimen)this.registers.dimen[t]=new xt(e.registers.dimen[t]);for(t in e.registers.skip)this.registers.skip[t]=new _(e.registers.skip[t]);for(t in e.registers.muskip)this.registers.muskip[t]=new $(e.registers.muskip[t]);for(t in e.registers.named){var i=e.registers.named[t],s="integer"==i.type?"count":"dimension"==i.type?"dimen":"glue"==i.type?"skip":"muskip";if(Object.values(e.registers[s]).includes(i))for(var a in e.registers[s])e.registers.named[t]===e.registers[s][a]&&(this.registers.named[t]=this.registers[s][a]);else this.registers.named[t]=new("integer"==i.type?G:"dimension"==i.type?xt:"glue"==i.type?_:$)(i)}this.tokens=[],this.split=!1,U.push(this)}function X(e){return e?(e=e.charCodeAt(0))in U.last().cats?U.last().cats[e].value:J.cats.all:null}function k(e){return e?(e=e.charCodeAt(0))in U.last().mathcodes?U.last().mathcodes[e].value:J.mathcodes.ord:null}Object.defineProperty(w,"last",{get:function(){return this[this.length-1]}});for(var i=new j,S=[];;){if(null===(O=i.eat()))return[[],e,!1];if("command"==O.type||"character"==O.type&&O.cat==J.cats.active){"mathchoice"==w.last&&w.last.failed();var s=i.expand(O,i);i.queue.unshift.apply(i.queue,s)}else{if("character"==O.type&&O.cat==J.cats.param)"mathchoice"==w.last&&w.last.failed(),i.queue.unshift({type:"character",cat:J.cats.all,char:O.char,code:O.code,invalid:!0});else if("character"==O.type&&O.cat==J.cats.math){if("mathchoice"==w.last&&w.last.failed(),"display"!=y)break;for(var r=new j(i.string,i.queue),n=!1;;){var l=r.eat();if(!l)break;if("command"!=l.type&&("character"!=l.type||l.cat!=J.cats.active)){if("character"!=l.type||l.cat!=J.cats.math)break;n=!0,r.finalize(),i.string=r.string;break}s=r.expand(l,r);r.queue.unshift.apply(r.queue,s)}if(n)break;i.queue.unshift({type:"character",cat:J.cats.all,char:O.char,code:O.code,invalid:!0})}else if("character"==O.type&&O.cat==J.cats.super){"mathchoice"==w.last&&w.last.failed();for(var o=null,c=U.last().tokens.length-1;0<=c;c--)if("atom"==U.last().tokens[c].type&&!U.last().tokens[c].ignore){o=U.last().tokens[c];break}o||(U.last().tokens.push({type:"atom",atomType:0,nucleus:null,superscript:null,subscript:null}),o=U.last().tokens[U.last().tokens.length-1]),o.superscript?U.last().tokens.push({type:"atom",atomType:0,nucleus:{type:"symbol",char:O.char,code:O.code,invalid:!0},superscript:null,subscript:null}):"superscript"==w.last?(o.superscript=[{type:"atom",atomType:0,nucleus:{type:"symbol",char:O.char,code:O.code,invalid:!0},superscript:null,subscript:null}],w.pop()):"subscript"==w.last?(o.subscript=[{type:"atom",atomType:0,nucleus:{type:"symbol",char:O.char,code:O.code,invalid:!0},superscript:null,subscript:null}],w.pop()):(O={type:"atom",atomType:0,nucleus:{type:"symbol",char:O.char,code:O.code},superscript:null,subscript:null,ignore:!0},U.last().tokens.push(O),w.push({toString:function(){return"superscript"},token:O}))}else if("character"==O.type&&O.cat==J.cats.sub){"mathchoice"==w.last&&w.last.failed();for(o=null,c=U.last().tokens.length-1;0<=c;c--)if("atom"==U.last().tokens[c].type&&!U.last().tokens[c].ignore){o=U.last().tokens[c];break}o||(U.last().tokens.push({type:"atom",atomType:0,nucleus:null,superscript:null,subscript:null}),o=U.last().tokens[U.last().tokens.length-1]),o.subscript?U.last().tokens.push({type:"atom",atomType:0,nucleus:{type:"symbol",char:O.char,code:O.code,invalid:!0},superscript:null,subscript:null}):"superscript"==w.last||"subscript"==w.last?(o.subscript=[{type:"atom",atomType:0,nucleus:{type:"symbol",char:O.char,code:O.code,invalid:!0},superscript:null,subscript:null}],w.pop()):(O={type:"atom",atomType:0,nucleus:{type:"symbol",char:O.char,code:O.code},superscript:null,subscript:null,ignore:!0},U.last().tokens.push(O),w.push({toString:function(){return"subscript"},token:O}))}else if("character"==O.type&&O.cat==J.cats.open){o={type:"atom",atomType:0,nucleus:{type:"symbol",char:O.char,code:O.code},superscript:null,subscript:null,ignore:!0};S.push(o),w.push("scope"),new x,U.last().tokens.push(o)}else if("character"==O.type&&O.cat==J.cats.close){if(U[0]===U.last()||!S.length||U.last().delimited||U.last().semisimple||U.last().isHalign||U.last().isHalignCell||"scope"!=w.last)i.queue.unshift({type:"character",cat:J.cats.all,char:O.char,code:O.code,invalid:!0});else if(S.pop(),w.pop(),D=U.last().isFrac?[{type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:U.last().fracNumerator,denominator:U.last().tokens,barWidth:U.last().barWidth,delims:[U.last().fracLeftDelim,U.last().fracRightDelim],nullDelimiterSpace:new xt(U.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}]:U.last().tokens,U.last().root&&(U.last().root.invalid=!0),U[U.length-2]&&U[U.length-2].noAligned)U[U.length-3].noAligns.push({type:"atom",atomType:0,nucleus:D,superscript:null,subscript:null}),U.pop();else if("superscript"==w.last){U.pop();for(c=U.last().tokens.length-1;0<=c;c--)if("atom"==U.last().tokens[c].type&&!U.last().tokens[c].ignore){U.last().tokens[c].superscript=D;break}w.pop()}else if("subscript"==w.last){U.pop();for(c=U.last().tokens.length-1;0<=c;c--)if("atom"==U.last().tokens[c].type&&!U.last().tokens[c].ignore){U.last().tokens[c].subscript=D;break}w.pop()}else U.last().isFrac?(U.pop(),U.last().tokens.push(D[0])):(U.pop(),U.last().tokens.push({type:"atom",atomType:0,nucleus:D,superscript:null,subscript:null})),"mathchoice"==w.last&&4==++w.last.current&&w.last.succeeded()}else if("character"==O.type&&O.cat==J.cats.alignment){"mathchoice"==w.last&&w.last.failed();for(var h=!1,c=U.length-1;0<=c;c--)if(U[c].isHalignCell){h=U[c];break}if(!h){i.queue.unshift({type:"character",cat:J.cats.all,char:O.char,code:O.code,invalid:!0});continue}var p=h.parentScope,d=p.cellData[p.cellData.length-1];if(d[d.length-1].omit&&(O.postPreamble=!0),O.postPreamble&&!U.last().isHalignCell||"scope"!=w.last){i.queue.unshift({type:"character",cat:J.cats.all,char:O.char,code:O.code,invalid:!0});continue}if(!O.postPreamble){for(var m=-1,c=0,u=d.length;c<u;c++)m+=d[c].span;if(p.preamble[m])D=p.preamble[m][1];else{if(!~p.repeatPreambleAt){i.queue.unshift({type:"character",cat:J.cats.all,char:O.char,code:O.code,invalid:!0});continue}D=(A=p.preamble.slice(p.repeatPreambleAt,p.preamble.length))[(m-p.repeatPreambleAt)%A.length][1]}if(!p.preamble[++m]&&!~p.repeatPreambleAt){i.queue.unshift({type:"character",cat:J.cats.all,char:O.char,code:O.code,invalid:!0});continue}for(var f=[],c=0,u=D.length;c<u;c++){var v={};for(var g in D[c])v[g]=D[c][g];f.push(v)}i.queue.unshift.apply(i.queue,f.concat(O)),O.postPreamble=!0;continue}U.last().root&&(U.last().root.invalid=!0),w.pop();var D=U.last().tokens;U.last().isFrac?(d[d.length-1].content.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:U.last().fracNumerator,denominator:D,barWidth:U.last().barWidth,delims:[U.last().fracLeftDelim,U.last().fracRightDelim],nullDelimiterSpace:new xt(U.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),U.pop()):(U.pop(),d[d.length-1].content=d[d.length-1].content.concat(D));var C=Symbol();for(i.saveState(C),d.push({type:"cell",content:[],omit:!1,span:1});;){if(!(O=i.eat())){i.loadState(C);break}if("character"==O.type&&O.cat!=J.cats.active){i.loadState(C);break}if("command"==O.type||"character"==O.type&&O.cat==J.cats.active){if(O.name in U.last().registers.named){i.loadState(C);break}var L="command"==O.type?U.last().defs.primitive[O.name]||U.last().defs.macros[O.name]:U.last().defs.active[O.char];if(!L){i.loadState(C);break}if(L===J.defs.primitive.the||L.proxy&&L.original===J.defs.primitive.the||L===J.defs.primitive.expandafter||L.proxy&&L.original===J.defs.primitive.expandafter||L===J.defs.primitive.number||L.proxy&&L.original===J.defs.primitive.number||L===J.defs.primitive.romannumeral||L.proxy&&L.original===J.defs.primitive.romannumeral||L===J.defs.primitive.csname||L.proxy&&L.original===J.defs.primitive.csname||L===J.defs.primitive.string||L.proxy&&L.original===J.defs.primitive.string||L===J.defs.primitive.if||L.isLet&&L.original===J.defs.primitive.if||L===J.defs.primitive.ifcase||L.isLet&&L.original===J.defs.primitive.ifcase||L===J.defs.primitive.ifcat||L.isLet&&L.original===J.defs.primitive.ifcat||L===J.defs.primitive.ifdim||L.isLet&&L.original===J.defs.primitive.ifdim||L===J.defs.primitive.ifeof||L.isLet&&L.original===J.defs.primitive.ifeof||L===J.defs.primitive.iffalse||L.isLet&&L.original===J.defs.primitive.iffalse||L===J.defs.primitive.ifodd||L.isLet&&L.original===J.defs.primitive.ifodd||L===J.defs.primitive.ifnum||L.isLet&&L.original===J.defs.primitive.ifnum||L===J.defs.primitive.ifhmode||L.isLet&&L.original===J.defs.primitive.ifhmode||L===J.defs.primitive.ifinner||L.isLet&&L.original===J.defs.primitive.ifinner||L===J.defs.primitive.ifmmode||L.isLet&&L.original===J.defs.primitive.ifmmode||L===J.defs.primitive.iftrue||L.isLet&&L.original===J.defs.primitive.iftrue||L===J.defs.primitive.ifvmode||L.isLet&&L.original===J.defs.primitive.ifvmode||L===J.defs.primitive.ifvoid||L.isLet&&L.original===J.defs.primitive.ifvoid||L===J.defs.primitive.ifx||L.isLet&&L.original===J.defs.primitive.ifx){if(1==(s=i.expand(O,i)).length&&s[0]===O&&O.invalid){i.loadState(C);break}i.queue.unshift.apply(i.queue,s);continue}if(L===J.defs.primitive.omit||L.proxy&&L.original===J.defs.primitive.omit){d[d.length-1].omit=!0;break}if("primitive"==L.type||L.proxy&&"primitive"==L.original.type){i.loadState(C);break}if(1==(s=i.expand(O,i)).length&&s[0]==-O&&O.invalid){i.loadState(C);break}i.queue.unshift.apply(i.queue,s)}}if(w.push("scope"),new x,U.last().isHalignCell=!0,!d[d.length-1].omit){for(var A,m=-1,c=0,u=d.length;c<u;c++)m+=d[c].span;p.preamble[m]?D=p.preamble[m][0]:~p.repeatPreambleAt&&(D=(A=p.preamble.slice(p.repeatPreambleAt,p.preamble.length))[(m-p.repeatPreambleAt)%A.length][0]);for(f=[],c=0,u=D.length;c<u;c++){var O={};for(var g in D[c])O[g]=D[c][g];f.push(O)}i.queue.unshift.apply(i.queue,f)}}else if("character"==O.type){"mathchoice"==w.last&&w.last.failed();var M={type:"symbol",char:O.char,code:O.code,invalid:O.invalid},T=O.forcedMathCode+1?O.forcedMathCode:k(M.char);if(O.invalid&&O.recognized&&(T=0),T==J.mathcodes.active){if(U.last().defs.active[O.char]){i.queue.unshift.apply(i.queue,(U.last().defs.active[O.char].replacement||U.last().defs.active[O.char].original.replacement).slice());continue}O.invalid=M.invalid=!0,T=0}if("superscript"==w.last){for(c=U.last().tokens.length-1;0<=c;c--)if("atom"==U.last().tokens[c].type&&!U.last().tokens[c].ignore){U.last().tokens[c].superscript=[{type:"atom",atomType:T,nucleus:M,superscript:null,subscript:null}];break}w.pop()}else if("subscript"==w.last){for(c=U.last().tokens.length-1;0<=c;c--)if("atom"==U.last().tokens[c].type&&!U.last().tokens[c].ignore){U.last().tokens[c].subscript=[{type:"atom",atomType:T,nucleus:M,superscript:null,subscript:null}];break}w.pop()}else U.last().tokens.push({type:"atom",atomType:T,nucleus:M,superscript:null,subscript:null})}else if(O.register){"mathchoice"==w.last&&w.last.failed();var E=Symbol();i.saveState(E);var q,H,B=i.eat();if(B&&"character"==B.type&&"="==B.char&&B.cat==J.cats.all||B&&i.revert(),"integer"==O.type){var I=i.eat("integer");if(I){if(I.value<O.min||I.value>O.max){i.loadState(E);continue}var z=O;if(b.global&&0<=U.last().registers.named.globaldefs.value||0<U.last().registers.named.globaldefs.value)for(;O.parent;)(O=O.parent).value=I.value;z.value=I.value,b.global=!1}else i.loadState(E)}else if("dimension"==O.type){if(q=i.eat("dimension")){if(O.sp.value=q.sp.value,O.em.value=q.em.value,b.global&&0<=U.last().registers.named.globaldefs.value||0<U.last().registers.named.globaldefs.value)for(;O.parent;)(O=O.parent).sp.value=q.sp.value,O.em.value=q.em.value;b.global=!1}else i.loadState(E)}else if("mu dimension"==O.type){if(q=i.eat("mu dimension")){if(O.mu.value=q.mu.value,b.global&&0<=U.last().registers.named.globaldefs.value||0<U.last().registers.named.globaldefs.value)for(;O.parent;)(O=O.parent).mu.value=I.mu.value;b.global=!1}else i.loadState(E)}else if("glue"==O.type){if(H=i.eat("glue")){if(O.start.sp.value=H.start.sp.value,O.start.em.value=H.start.em.value,"infinite dimension"==H.stretch.type?O.stretch=new Y(H.stretch.number.value,H.stretch.magnitude.value):O.stretch=new xt(H.stretch.sp.value,H.stretch.em.value),"infinite dimension"==H.shrink.type?O.shrink=new Y(H.shrink.number.value,H.shrink.magnitude.value):O.shrink=new xt(H.shrink.sp.value,H.shrink.em.value),b.global&&0<=U.last().registers.named.globaldefs.value||0<U.last().registers.named.globaldefs.value)for(;O.parent;)(O=O.parent).start.sp.value=H.start.sp.value,O.start.em.value=H.start.em.value,"infinite dimension"==H.stretch.type?O.stretch=new Y(H.stretch.number.value,H.stretch.magnitude.value):O.stretch=new xt(H.stretch.sp.value,H.stretch.em.value),"infinite dimension"==H.shrink.type?O.shrink=new Y(H.shrink.number.value,H.shrink.magnitude.value):O.shrink=new xt(H.shrink.sp.value,H.shrink.em.value);b.global=!1}else i.loadState(E)}else if("mu glue"==O.type){if(H=i.eat("mu glue")){if(O.start.mu.value=H.start.mu.value,"infinite dimension"==H.stretch.type?O.stretch=new Y(H.stretch.number.value,H.stretch.magnitude.value):O.stretch=new V(H.stretch.mu.value),"infinite dimension"==H.shrink.type?O.shrink=new Y(H.shrink.number.value,H.shrink.magnitude.value):O.shrink=new V(H.shrink.mu.value),b.global&&0<=U.last().registers.named.globaldefs.value||0<U.last().registers.named.globaldefs.value)for(;O.parent;)(O=O.parent).start.mu.value=H.start.mu.value,"infinite dimension"==H.stretch.type?O.stretch=new Y(H.stretch.number.value,H.stretch.magnitude.value):O.stretch=new V(H.stretch.mu.value),"infinite dimension"==H.shrink.type?O.shrink=new Y(H.shrink.number.value,H.shrink.magnitude.value):O.shrink=new V(H.shrink.mu.value);b.global=!1}else i.loadState(E)}}else if("ignored command"==O.type){U.last().tokens.push(O.token);continue}for(var N in b)b[N]&&(b[N].invalid=!0,b[N]=!1)}}for("superscript"!=w.last&&"subscript"!=w.last||(w.last.token.invalid=!0,w.last.token.ignore=!1);U.last()!=U[0];){w.pop();var D=U.last().tokens;if(U.last().root&&(U.last().root.invalid=!0),"superscript"==w.last){U.pop();for(c=U.last().tokens.length-1;0<=c;c--)if("atom"==U.last().tokens[c].type&&!U.last().tokens[c].ignore){U.last().tokens[c].superscript=D;break}w.pop()}else if("subscript"==w.last){U.pop();for(c=U.last().tokens.length-1;0<=c;c--)if("atom"==U.last().tokens[c].type&&!U.last().tokens[c].ignore){U.last().tokens[c].subscript=D;break}w.pop()}else U.last().isFrac?(U[U.length-2].tokens.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:U.last().fracNumerator,denominator:D,barWidth:U.last().barWidth,delims:[U.last().fracLeftDelim,U.last().fracRightDelim],nullDelimiterSpace:new xt(U.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),U.pop()):(U.pop(),U.last().tokens.push({type:"atom",atomType:0,nucleus:D,superscript:null,subscript:null}))}U[0].isFrac&&(D=U[0].tokens,U[0].tokens=[{type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:U[0].fracNumerator,denominator:D,barWidth:U[0].barWidth,delims:[U[0].fracLeftDelim,U[0].fracRightDelim],nullDelimiterSpace:new xt(U[0].registers.named.nulldelimiterspace)}],superscript:null,subscript:null}]);for(c=0,u=S.length;c<u;c++)S[c].invalid=!0;return function e(t){for(var i,s=0,a=t.length;s<a;s++)if(t[s]&&t[s].ignore&&"command"==t[s].type)t[s].invalid?(i=(t[s].escapeChar+t[s].name).split("").map(function(e){return{type:"atom",atomType:t[s].recognized?0:7,nucleus:{type:"symbol",char:e,code:e.charCodeAt(0),invalid:!0},superscript:null,subscript:null}}),t.splice(s,1,{type:"atom",atomType:0,nucleus:i,superscript:null,subscript:null})):t.splice(s,1),a=t.length,s--;else if(t[s]&&t[s].ignore&&!t[s].invalid)t.splice(s,1),a=t.length,s--;else if(t[s]&&"fraction"==t[s].type)e(t[s].numerator),e(t[s].denominator);else if(t[s]&&"table"==t[s].type){e(t[s].noAligns);for(var r=0,n=t[s].cellData.length;r<n;r++)for(var l=0,o=t[s].cellData[r].length;l<o;l++)e(t[s].cellData[r][l].content)}else t[s]&&"atom"==t[s].type?(Array.isArray(t[s].nucleus)&&e(t[s].nucleus),Array.isArray(t[s].superscript)&&e(t[s].superscript),Array.isArray(t[s].subscript)&&e(t[s].subscript)):t[s]&&"mathchoice"==t[s].type?e(t[s].groups):t[s]&&"box"==t[s].type?e([t[s].content]):t[s]&&"family modifier"==t[s].type&&"rad"==t[s].value&&e(t[s].index)}(U[0].tokens),function e(t){for(var i,s=0,a=t.length;s<a;s++)if(t[s]&&"family modifier"==t[s].type)t[s+1]&&"atom"==t[s+1].type?("phantom"==t[s].value?(t.splice(s,1),t[s].phantom=!0):(t.splice(s,2,{type:"atom",atomType:t[s].value,nucleus:[t[s+1]],superscript:t[s+1].superscript,subscript:t[s+1].subscript,invalid:t[s+1].invalid,index:t[s].index,phantom:t[s+1].phantom}),t[s].nucleus[0].superscript=null,t[s].nucleus[0].subscript=null,s--),a=t.length):(i=("command"==t[s].token.type?t[s].token.escapeChar+t[s].token.name:t[s].token.char).split("").map(function(e){return{type:"atom",atomType:0,nucleus:{type:"symbol",char:e,code:e.charCodeAt(0),invalid:!0},superscript:null,subscript:null}}),t[s]={type:"atom",atomType:0,nucleus:i,superscript:null,subscript:null});else if(t[s]&&"fraction"==t[s].type)e(t[s].numerator),e(t[s].denominator);else if(t[s]&&"table"==t[s].type){e(t[s].noAligns);for(var r=0,n=t[s].cellData.length;r<n;r++)for(var l=0,o=t[s].cellData[r].length;l<o;l++)e(t[s].cellData[r][l].content)}else t[s]&&"atom"==t[s].type?(Array.isArray(t[s].nucleus)&&e(t[s].nucleus),Array.isArray(t[s].superscript)&&e(t[s].superscript),Array.isArray(t[s].subscript)&&e(t[s].subscript),Array.isArray(t[s].index)&&e(t[s].index)):t[s]&&"mathchoice"==t[s].type?e(t[s].groups):t[s]&&"box"==t[s].type&&e([t[s].content])}(U[0].tokens),function e(t){for(var i,s=0,a=t.length;s<a;s++)if(t[s]&&"accent modifier"==t[s].type)t[s+1]&&"atom"==t[s+1].type?(t.splice(s,2,{type:"atom",atomType:"acc",nucleus:[t[s+1]],superscript:t[s+1].superscript,subscript:t[s+1].subscript,accChar:t[s].char,accCode:t[s].code,invalid:t[s+1].invalid,phantom:t[s+1].phantom}),t[s].nucleus[0].superscript=null,t[s].nucleus[0].subscript=null,a=t.length,s--):(i=("command"==t[s].token.type?t[s].token.escapeChar+t[s].token.name:t[s].token.char).split("").map(function(e){return{type:"atom",atomType:0,nucleus:{type:"symbol",char:e,code:e.charCodeAt(0),invalid:!0},superscript:null,subscript:null}}),t[s]={type:"atom",atomType:0,nucleus:i,superscript:null,subscript:null});else if(t[s]&&"fraction"==t[s].type)e(t[s].numerator),e(t[s].denominator);else if(t[s]&&"table"==t[s].type){e(t[s].noAligns);for(var r=0,n=t[s].cellData.length;r<n;r++)for(var l=0,o=t[s].cellData[r].length;l<o;l++)e(t[s].cellData[r][l].content)}else t[s]&&"atom"==t[s].type?(Array.isArray(t[s].nucleus)&&e(t[s].nucleus),Array.isArray(t[s].superscript)&&e(t[s].superscript),Array.isArray(t[s].subscript)&&e(t[s].subscript),Array.isArray(t[s].index)&&e(t[s].index)):t[s]&&"mathchoice"==t[s].type?e(t[s].groups):t[s]&&"box"==t[s].type&&e([t[s].content])}(U[0].tokens),function e(t){for(var i,s=0,a=t.length;s<a;s++)if(t[s]&&"limit modifier"==t[s].type)t[s-1]&&"atom"==t[s-1].type&&1==t[s-1].atomType?(t[s-1].limits=t[s].value,t.splice(s,1),a=t.length,s--):(i=("command"==t[s].token.type?t[s].token.escapeChar+t[s].token.name:t[s].token.char).split("").map(function(e){return{type:"atom",atomType:0,nucleus:{type:"symbol",char:e,code:e.charCodeAt(0),invalid:!0},superscript:null,subscript:null}}),t[s]={type:"atom",atomType:0,nucleus:i,superscript:null,subscript:null});else if(t[s]&&"fraction"==t[s].type)e(t[s].numerator),e(t[s].denominator);else if(t[s]&&"table"==t[s].type){e(t[s].noAligns);for(var r=0,n=t[s].cellData.length;r<n;r++)for(var l=0,o=t[s].cellData[r].length;l<o;l++)e(t[s].cellData[r][l].content)}else t[s]&&"atom"==t[s].type?(1==t[s].atomType&&(t[s].limits="display"),Array.isArray(t[s].nucleus)&&e(t[s].nucleus),Array.isArray(t[s].superscript)&&e(t[s].superscript),Array.isArray(t[s].subscript)&&e(t[s].subscript),Array.isArray(t[s].index)&&e(t[s].index)):t[s]&&"mathchoice"==t[s].type?e(t[s].groups):t[s]&&"box"==t[s].type&&e([t[s].content])}(U[0].tokens),function e(t){for(var i,s=0,a=t.length;s<a;s++)if(t[s]&&"box wrapper"==t[s].type)t[s+1]&&"atom"==t[s+1].type?(t.splice(s,2,{type:"box",boxType:t[s].value,to:t[s].to,spread:t[s].spread,content:t[s+1],superscript:null,subscript:null}),a=t.length,s--):(i=("command"==t[s].token.type?t[s].token.escapeChar+t[s].token.name:t[s].token.char).split("").map(function(e){return{type:"atom",atomType:0,nucleus:{type:"symbol",char:e,code:e.charCodeAt(0),invalid:!0},superscript:null,subscript:null}}),t[s]={type:"atom",atomType:0,nucleus:i,superscript:null,subscript:null});else if(t[s]&&"fraction"==t[s].type)e(t[s].numerator),e(t[s].denominator);else if(t[s]&&"table"==t[s].type){e(t[s].noAligns);for(var r=0,n=t[s].cellData.length;r<n;r++)for(var l=0,o=t[s].cellData[r].length;l<o;l++)e(t[s].cellData[r][l].content)}else t[s]&&"atom"==t[s].type?(Array.isArray(t[s].nucleus)&&e(t[s].nucleus),Array.isArray(t[s].superscript)&&e(t[s].superscript),Array.isArray(t[s].subscript)&&e(t[s].subscript),Array.isArray(t[s].index)&&e(t[s].index)):t[s]&&"mathchoice"==t[s].type?e(t[s].groups):t[s]&&"box"==t[s].type&&e([t[s].content])}(U[0].tokens),function e(t){for(var i=0,s=t.length;i<s;i++)if(t[i]&&"atom"==t[i].type){if(Array.isArray(t[i].nucleus)&&e(t[i].nucleus),Array.isArray(t[i].superscript)&&e(t[i].superscript),Array.isArray(t[i].subscript)&&e(t[i].subscript),Array.isArray(t[i].index)&&e(t[i].index),Array.isArray(t[i].nucleus)&&1==t[i].nucleus.length&&!t[i].nucleus[0].delimited)if([0,2,3,4,5,6,"inner"].includes(t[i].nucleus[0].atomType)&&!["over","under","rad"].includes(t[i].atomType)){if(!t[i].nucleus[0].superscript&&!t[i].nucleus[0].subscript){t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].nucleus=t[i].nucleus[0].nucleus,i--;continue}if(!t[i].superscript&&!t[i].subscript){t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].superscript=t[i].nucleus[0].superscript,t[i].subscript=t[i].nucleus[0].subscript,t[i].nucleus=t[i].nucleus[0].nucleus,i--;continue}}else if(7==t[i].nucleus[0].atomType&&0==t[i].atomType){if(!t[i].nucleus[0].superscript&&!t[i].nucleus[0].subscript){t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].nucleus=t[i].nucleus[0].nucleus,t[i].atomType=7,i--;continue}if(!t[i].superscript&&!t[i].subscript){t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].superscript=t[i].nucleus[0].superscript,t[i].subscript=t[i].nucleus[0].subscript,t[i].nucleus=t[i].nucleus[0].nucleus,t[i].atomType=7,i--;continue}}else 7!=t[i].nucleus[0].atomType&&["over","under","rad","acc"].includes(t[i].atomType)&&(t[i].nucleus[0].superscript||t[i].nucleus[0].subscript||(t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].nucleus=t[i].nucleus[0].nucleus))}else if(t[i]&&"fraction"==t[i].type)t[i].numerator&&Array.isArray(t[i].numerator)&&1==t[i].numerator.length&&!t[i].numerator.subscript&&!t[i].numerator.superscript&&Array.isArray(t[i].numerator[0].nucleus)&&(t[i].numerator=t[i].numerator[0].nucleus),t[i].denominator&&Array.isArray(t[i].denominator.nucleus)&&1==t[i].denominator.length&&!t[i].denominator.subscript&&!t[i].denominator.superscript&&Array.isArray(t[i].denominator[0].nucleus)&&(t[i].denominator=t[i].denominator[0].nucleus),e(t[i].numerator),e(t[i].denominator);else if(t[i]&&"table"==t[i].type){e(t[i].noAligns);for(var a=0,r=t[i].cellData.length;a<r;a++)for(var n=0,l=t[i].cellData[a].length;n<l;n++)e(t[i].cellData[a][n].content)}else t[i]&&"mathchoice"==t[i].type?e(t[i].groups):t[i]&&"box"==t[i].type&&e(t[i].content.nucleus)}(U[0].tokens),i.finalize(),2<arguments.length&&t?U[0]:[U[0].tokens,P,!0]}function w(mt,e,o,ut){var t=document.createElement("div");"display"==o?t.style.textAlign="center":t.style.display="inline-block";var ft=parseFloat(ut.fontSize),vt=ut.fontFamily;function gt(e){for(var t=0,i=e.children.length;t<i;t++)gt(e.children[t]);return e.style.flexWrap&&(e.style.flexWrap="nowrap"),e}return function $(Y,J,K,Q,e){Y=Y.slice();if(!Y.length){var t=document.createElement("div");return t.style.display="inline-flex",t.displayedStyle=J,t.crampedStyle=K,t.renderedDepth=0,t.renderedHeight=0,e.renderedHeight=e.renderedHeight||0,e.renderedDepth=e.renderedDepth||0,e.baseline=bt.fontDimen.baselineHeightOf(vt),e.baselineOffset=0,e.appendChild(t),void(t.empty=!0)}var Z=null;var ee=document.createElement("div");ee.style.display="inline-flex";ee.style.flexWrap="wrap";ee.style.alignItems="baseline";ee.displayedStyle=J;ee.crampedStyle=K;ee.style.justifyContent="display"==o?"center":"initial";var p=[document.createElement("div")];p.last=function(){return p[p.length-1]};p[0].style.display="inline-flex";p[0].style.flexWrap="nowrap";p[0].style.alignItems="baseline";var te=[];var ie=[];var d=0;var i=function(e,t){var I=Y[e];Y[e+1],Y[e-1];if("atom"==I.type&&I.atomType==yt.OP&&"display"==I.limits&&(I.limits="display"==J),"fraction"==I.type){var i=function(e,t,i,s){var a=void 0,r=void 0,n=void 0,l=void 0,o=void 0,c=void 0,h=void 0,p=void 0,d=void 0,m=void 0;switch(t){case".":default:te.splice(te.length-(i?1:0),0,{type:"kern",dimen:I.nullDelimiterSpace});break;case"|":case"/":case"\\":case"‖":case"⎪":case"⏐":case"⟨":case"⟩":a=Math.max(z,bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)),e.style.height=a+"em",e.style.width=bt.fontDimen.widthOf(t,vt)+"em",e.style.verticalAlign="middle",e.height=s,e.width=bt.fontDimen.widthOf(t,vt)/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))*s,(r=e.getContext("2d")).textAlign="center",r.fillStyle=ut.color,r.font=s/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))+"px "+vt,r.fillText(t,e.width/2,s-bt.fontDimen.depthOf(t,vt)*s/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))),I.div.insertBefore(e,i?I.div.firstElementChild:null);break;case"(":case")":if(a=Math.max(z,bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)),e.style.height=a+"em",e.style.width=bt.fontDimen.widthOf(t,vt)+"em",e.style.verticalAlign="middle",Math.floor(Math.floor(s/2*a)-s)<=0)e.height=s,e.width=bt.fontDimen.widthOf(t,vt)/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))*s,(r=e.getContext("2d")).textAlign="center",r.fillStyle=ut.color,r.font=s/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))+"px "+vt,r.fillText(t,e.width/2,s-bt.fontDimen.depthOf(t,vt)*s/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)));else if(n=bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt),e.height=Math.max(a,1)*s,e.width=bt.fontDimen.widthOf(t,vt)/bt.fontDimen.heightOf(t,vt)*s*(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)),(r=e.getContext("2d")).textAlign="center",r.fillStyle=ut.color,r.font=s/n+"px "+vt,r.fillText(t,e.width/2,s/2-bt.fontDimen.depthOf(t,vt)*s*n),c=r.getImageData(0,0,e.width,s/2),r.clearRect(0,0,e.width,e.height),r.fillText(t,e.width/2,s-bt.fontDimen.depthOf(t,vt)*s/n),r.clearRect(0,s/2,e.width,e.height),r.putImageData(c,0,e.height-s/2),e.height>s){l=r.createImageData(e.width,e.height-s),d=r.getImageData(0,s/2-1,e.width,1).data,m=c.data.slice(0,4*e.width);for(var u=0,f=l.height/2;u<f;u++)for(var v=0,g=e.width;v<g;v++){var y=u*e.width*4+4*v;l.data[y]=d[4*v+0],l.data[1+y]=d[4*v+1],l.data[2+y]=d[4*v+2],l.data[3+y]=d[4*v+3],y=~~(u+l.height/2)*e.width*4+4*v,l.data[y]=m[4*v+0],l.data[1+y]=m[4*v+1],l.data[2+y]=m[4*v+2],l.data[3+y]=m[4*v+3]}r.putImageData(l,0,s/2)}I.div.insertBefore(e,i?I.div.firstElementChild:null);break;case"[":case"]":case"⟮":case"⟯":case"↑":case"↓":case"↕":case"⇑":case"⇓":case"⇕":case"⌈":case"⌉":case"⌊":case"⌋":case"⎰":case"⎱":if(B=bt.fontDimen.heightOf("x",vt)/2,a=Math.max(z,bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)),e.style.height=a+"em",e.style.width=bt.fontDimen.widthOf(t,vt)+"em",e.style.verticalAlign="middle",n=bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt),e.height=Math.max(a,1)*s,e.width=bt.fontDimen.widthOf(t,vt)/bt.fontDimen.heightOf(t,vt)*s*(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)),(r=e.getContext("2d")).textAlign="center",r.fillStyle=ut.color,r.font=s/n+"px "+vt,r.fillText(t,e.width/2,s/2-bt.fontDimen.depthOf(t,vt)*s*n),c=r.getImageData(0,0,e.width,s/2),r.clearRect(0,0,e.width,e.height),r.fillText(t,e.width/2,s-bt.fontDimen.depthOf(t,vt)*s/n),r.clearRect(0,s/2,e.width,e.height),r.putImageData(c,0,e.height-s/2),e.height>s){l=r.createImageData(e.width,e.height-s),d=r.getImageData(0,s/2-1,e.width,1).data,m=c.data.slice(0,4*e.width);for(var b=0,w=l.height/2;b<w;b++)for(var x=0,k=e.width;x<k;x++){var S=b*e.width*4+4*x;l.data[S]=d[4*x+0],l.data[1+S]=d[4*x+1],l.data[2+S]=d[4*x+2],l.data[3+S]=d[4*x+3],S=~~(b+l.height/2)*e.width*4+4*x,l.data[S]=m[4*x+0],l.data[1+S]=m[4*x+1],l.data[2+S]=m[4*x+2],l.data[3+S]=m[4*x+3]}r.putImageData(l,0,s/2)}I.div.insertBefore(e,i?I.div.firstElementChild:null);break;case"{":case"}":if(a=Math.max(z,bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)),e.style.height=a+"em",e.style.width=bt.fontDimen.widthOf(t,vt)+"em",e.style.verticalAlign="middle",n=s/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)),e.height=Math.max(a,1)*s,e.width=bt.fontDimen.widthOf(t,vt)/bt.fontDimen.heightOf(t,vt)*s*(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)),(r=e.getContext("2d")).textAlign="center",r.fillStyle=ut.color,r.font=n+"px "+vt,3<=s&&(r.fillText(t,e.width/2,Math.floor(s/3)-bt.fontDimen.depthOf(t,vt)*n),c=r.getImageData(0,0,e.width,Math.floor(s/3)),r.clearRect(0,0,e.width,e.height),r.fillText(t,e.width/2,s-bt.fontDimen.depthOf(t,vt)*n),o=r.getImageData(0,0,e.width,Math.floor(s/3)),r.clearRect(0,0,e.width,e.height),r.fillText(t,e.width/2,e.height/2+s/2-bt.fontDimen.depthOf(t,vt)*n),r.clearRect(0,0,e.width,Math.floor(e.height/2)-Math.floor(s/2)+Math.floor(s/3)),r.clearRect(0,Math.ceil(e.height/2)+Math.floor(s/2)-Math.floor(s/3),e.width,e.height),r.putImageData(o,0,0),r.putImageData(c,0,e.height-Math.floor(s/3)),e.height>s)){h=r.createImageData(e.width,Math.ceil((e.height-s)/2)),d=o.data.slice((Math.floor(s/3)-1)*e.width*4,Math.floor(s/3)*e.width*4),m=r.getImageData(0,Math.floor(e.height/2)-Math.floor(s/2)+Math.floor(s/3),e.width,1).data;for(var D=0,C=h.height/2;D<C;D++)for(var L=0,A=e.width;L<A;L++){var O=D*e.width*4+4*L;h.data[O]=d[4*L+0],h.data[1+O]=d[4*L+1],h.data[2+O]=d[4*L+2],h.data[3+O]=d[4*L+3],O=~~(D+h.height/2)*e.width*4+4*L,h.data[O]=m[4*L+0],h.data[1+O]=m[4*L+1],h.data[2+O]=m[4*L+2],h.data[3+O]=m[4*L+3]}p=r.createImageData(e.width,Math.floor(e.height/2)-Math.floor(s/2)+1),d=r.getImageData(0,Math.ceil(e.height/2)+Math.floor(s/2)-Math.floor(s/3)-1,e.width,1).data,m=c.data.slice(0,4*e.width);for(var M=0,T=p.height/2;M<T;M++)for(var E=0,q=e.width;E<q;E++){var H=M*e.width*4+4*E;p.data[H]=d[4*E+0],p.data[1+H]=d[4*E+1],p.data[2+H]=d[4*E+2],p.data[3+H]=d[4*E+3],H=~~(M+p.height/2)*e.width*4+4*E,p.data[H]=m[4*E+0],p.data[1+H]=m[4*E+1],p.data[2+H]=m[4*E+2],p.data[3+H]=m[4*E+3]}r.putImageData(h,0,Math.floor(s/3)),r.putImageData(p,0,e.height/2+Math.floor(s/2)-Math.floor(s/3))}I.div.insertBefore(e,i?I.div.firstElementChild:null)}},s={type:"atom",atomType:yt.INNER,nucleus:null,superscript:null,subscript:null,style:J,div:document.createElement("div")};te.push(s),ie.push(s),I.style=J,I.div=s.div,I.div.style.display="inline-block",I.div.style.whiteSpace="nowrap";var B=bt.fontDimen.heightOf("x",vt)/2+bt.fontDimen.baselineHeightOf(vt),a=document.createElement("div"),r=document.createElement("div");a.style.display=r.style.display="inline-block",a.style.verticalAlign="text-bottom",a.style.position="relative",r.style.verticalAlign="text-bottom",r.style.position="relative";var n="display"==J?"text":"text"==J?"script":"scriptscript";$(I.numerator,n,K,Q,a),$(I.denominator,n,!0,Q,r);var l="from font"==I.barWidth?new xt(0,65536*bt.fontDimen.visibleWidthOf("|",vt)):new xt(I.barWidth);l.em.value+=l.sp.value/12*16/ft,l.sp.value=0;var o="text"==J||"script"==J,c=l.em.value/65536+"em",h=l.em.value*(o?.707106781:1)/65536+"em",p=l.em.value*("script"==J||"scriptscript"==J?.707106781:1)/65536;mt.appendChild(r),mt.appendChild(a);var d=a.offsetWidth+1,m=a.offsetHeight/ft,u=d*(o?.707106781:1),f=r.offsetHeight/ft,v=r.offsetWidth+1,g=f*(o?.707106781:1),y=v*(o?.707106781:1);mt.removeChild(r),mt.removeChild(a),o?(a.style.fontSize=r.style.fontSize="0.707106781em",a.style.paddingTop="calc("+B/.707106781+"em + "+c+" / 2)",a.style.top="calc("+-B/.707106781+"em - "+c+" / 2)",r.style.top="calc("+(f-B/.707106781)+"em + "+c+" / 2 - "+f+"em)",I.div.style.paddingBottom="calc("+(g-B)+"em + "+h+" / 2)"):(a.style.fontSize=r.style.fontSize="",a.style.paddingTop="calc("+B+"em + "+h+" / 2)",a.style.top="calc("+-B+"em - "+h+" / 2)",r.style.top="calc("+(f-B)+"em + "+h+" / 2 - "+f+"em)",I.div.style.paddingBottom="calc("+(f-B)+"em + "+h+" / 2)"),r.style.height=0;var b=v<d?r:a,w=v<d?a:r,x=document.createElement("div"),k=document.createElement("div"),S=document.createElement("div");x.style.display="inline-block",x.style.position="relative",x.style.verticalAlign="text-bottom",x.style.top=-B+"em",x.style.width=".05em",x.style.height=0,k.style.borderTop=h+" solid currentColor",k.style.padding="0 .05em",k.style.position="relative",k.style.top="calc("+h+" / -2)",k.style.display="inline-block",k.style.height=0,S.style.display="inline-block",S.style.visibility="hidden",x.style.webkitUserSelect=x.style.mozUserSelect=x.style.msUserSelect=x.style.userSelect="none",S.style.width=Math.max(u,y)/ft+"em",k.appendChild(S),x.appendChild(k),I.div.appendChild(x);var D=document.createElement("div"),C=document.createElement("div"),L=document.createElement("div"),A=b.firstElementChild,O=document.createElement("div"),M=document.createElement("div");A&&(A.style.width="100%",A.insertBefore(O,A.firstElementChild),A.appendChild(M),C.appendChild(A)),D.style.position="relative",D.style.display="inline-block",L.style.display="inline-block",L.style.height=(v<d?f:m)+"em",L.textContent=" ",L.style.width=(Math.max(d,v)+1)/ft+"em",C.style.position="absolute",O.style.flexGrow=M.style.flexGrow=O.style.flexShrink=M.style.flexShrink=1,b.style.width=0,C.style.left=-1/ft+"em",C.style.right=1/ft+"em",C.style.top=0,D.appendChild(C),D.appendChild(L),b.appendChild(D),I.div.appendChild(b),I.div.appendChild(w);var T=document.createElement("div");T.style.display="inline-block",T.style.width=".05em",I.div.appendChild(T);var E=document.createElement("canvas"),q=document.createElement("canvas"),z="display"==J?2.416666666:"text"==J?1.416666666:0;return E.style.display=q.style.display="inline-block",">"==I.delims[0]&&(I.delims[0]="⟩"),">"==I.delims[1]&&(I.delims[1]="⟩"),"<"==I.delims[0]&&(I.delims[0]="⟨"),"<"==I.delims[1]&&(I.delims[1]="⟨"),i(E,I.delims[0],!0,ft),i(q,I.delims[1],!1,ft),re={display:{display:1,text:1,script:.707106781,scriptscript:.5},text:{display:1,text:1,script:.707106781,scriptscript:.5},script:{display:1.414213562,text:1.414213562,script:1,scriptscript:.707106781},scriptscript:{display:2,text:2,script:1.414213562,scriptscript:1}}[ee.displayedStyle][J],I.div.renderedDepth=(g-bt.fontDimen.heightOf("x",vt)/2+p/2+(-r.baseline-r.baselineOffset+r.renderedDepth)*("text"==J||"script"==J?.707106781:1))*re,I.div.renderedHeight=(bt.fontDimen.heightOf("x",vt)/2+p/2+(a.baseline+a.baselineOffset+a.renderedHeight)*("text"==J||"script"==J?.707106781:1))*re,I.div.baseline=r.baseline*re*("text"==J||"script"==J?.707106781:1),I.div.baselineOffset=(g-bt.fontDimen.heightOf("x",vt)/2+p/2-r.baseline*("text"==J||"script"==J?.707106781:1))*re,Z=" ","continue"}if("atom"==I.type||"box"==I.type&&"atom"==I.content.type){var H=!1;"box"==I.type&&(I=(H=I).content);var N={display:{display:1,text:1,script:.707106781,scriptscript:.5},text:{display:1,text:1,script:.707106781,scriptscript:.5},script:{display:1.414213562,text:1.414213562,script:1,scriptscript:.707106781},scriptscript:{display:2,text:2,script:1.414213562,scriptscript:1}}[ee.displayedStyle][J];if(([yt.OVER,yt.UNDER,yt.RAD].includes(I.atomType)&&(I.subscript||I.superscript)||I.atomType==yt.RAD&&1!=N)&&(I.nucleus=[{type:"atom",atomType:I.atomType,nucleus:I.nucleus,superscript:null,subscript:null,index:I.index,invalid:I.invalid,phantom:I.phantom}],I.atomType=yt.ORD),te.push(I),ie.push(I),I.style=J,I.div=document.createElement("div"),I.div.style.display="inline-block",I.div.style.whiteSpace="nowrap",I.div.renderedHeight=0,I.div.renderedDepth=-.5,I.div.baselineOffset=0,I.invalid){if(I.nucleus)if("symbol"==I.nucleus.type)I.nucleus.invalid=!0;else for(var R=I.nucleus.length-1;0<=R;R--)I.nucleus[R].invalid=!0;I.superscript&&(I.superscript[0].invalid=!0),I.subscript&&(I.subscript[0].invalid=!0)}![yt.ORD,yt.OP,yt.BIN,yt.REL,yt.OPEN,yt.CLOSE,yt.PUNCT,yt.INNER].includes(I.atomType)||!I.nucleus||1!=I.nucleus.length||I.nucleus[0].atomType!=yt.OP||I.nucleus[0].delimited||I.nucleus[0].limits||I.superscript||I.subscript||I.nucleus[0].nucleus&&("symbol"==I.nucleus[0].nucleus.type&&wt["operator.growchars"][0].includes(I.nucleus[0].nucleus.char)||1==I.nucleus[0].nucleus.length&&I.nucleus[0].nucleus[0].atomType==yt.VARIABLE&&wt["operator.growchars"][0].includes(I.nucleus[0].nucleus[0].nucleus[0].char))||(I.superscript=I.nucleus[0].superscript,I.subscript=I.nucleus[0].subscript,I.nucleus=I.nucleus[0].nucleus);var W,F,P,U,j,X,G,V=0;switch(I.nucleus&&"symbol"==I.nucleus.type?(10==I.nucleus.code?(I.isLineBreak=!0,I.div.style.width="100%"):(I.div.innerHTML='<div style="white-space:pre;display:inline-block;'+(I.nucleus.invalid?"color:"+wt["invalid.color"][0]+";":"")+{nm:I.atomType==yt.VARIABLE?'font-style:italic"><div style="display:inline-block;margin:0 '+bt.fontDimen.italCorrOf(I.nucleus.char,vt)+"em 0 "+bt.fontDimen.leftOffsetOf(I.nucleus.char,vt,"it")+"em":"",rm:"",bf:"font-weight:bold;",it:"font-style:italic;",sl:"font-style:oblique;"}[Q]+'">'+(45==I.nucleus.code?"−":I.nucleus.char)+"</div>"+("nm"==Q&&I.atomType==yt.VARIABLE?"</div>":""),W="nm"==Q?I.atomType==yt.VARIABLE?"it":"nm":Q,I.div.renderedHeight=bt.fontDimen.heightOf(I.nucleus.char,vt,W)*N,I.div.renderedDepth=bt.fontDimen.trueDepthOf(I.nucleus.char,vt,W)*N,I.div.baseline=bt.fontDimen.baselineHeightOf(vt)*N,V=bt.fontDimen.scriptOffsetOf(I.nucleus.char,vt,"nm"==Q&&I.atomType==yt.VARIABLE?"it":Q)),Z=I.nucleus.char):Array.isArray(I.nucleus)&&(Z=$(I.nucleus,J,K||I.atomType==yt.OVER||I.atomType==yt.RAD,Q,I.div)||Z,I.div.renderedHeight*=N,I.div.renderedDepth*=N,I.div.baseline*=N,I.div.baselineOffset*=N,!I.div.firstElementChild.empty||I.superscript||I.subscript||I.delimited||[yt.RAD,yt.ACC,yt.OVER,yt.UNDER].includes(I.atomType)||(I.div.empty=!0)),I.phantom&&(I.div.firstElementChild.style.visibility="hidden"),I.div.style.fontSize=N+"em","display"==J&&I.atomType==yt.OP&&I.nucleus&&("symbol"==I.nucleus.type||1==I.nucleus.length&&I.nucleus[0].nucleus&&"symbol"==I.nucleus[0].nucleus.type&&I.nucleus[0].atomType==yt.VARIABLE)&&(F=1,wt["operator.growchars"][0].includes(I.nucleus.char||I.nucleus[0].nucleus.char)&&(F=wt["operator.growamount"][0],I.div.renderedHeight*=F,I.div.renderedDepth*=F,I.div.firstElementChild.style.fontSize=F+"em",V*=F),P=bt.fontDimen.heightOf("x",vt)/2,U=(I.div.renderedHeight-P-I.div.renderedDepth-P)/2,I.div.firstElementChild.style.top=U/F+"em",I.div.renderedHeight-=U,I.div.renderedDepth+=U,I.div.firstElementChild.style.position="relative",I.div.firstElementChild.style.marginTop=-U/F+"em",I.div.firstElementChild.style.marginBottom=U/F+"em"),I.delimited&&(j=function(e,t,i,s){var a=void 0,r=void 0,n=void 0,l=void 0,o=void 0,c=void 0,h=void 0,p=void 0,d=void 0,m=void 0,u=void 0;switch(t){case".":default:te.splice(te.length-(i?1:0),0,{type:"kern",dimen:I.nullDelimiterSpace});break;case"|":case"/":case"\\":case"‖":case"⎪":case"⏐":case"⟨":case"⟩":a=bt.fontDimen.heightOf("x",vt)/2,r=2*Math.max(I.div.renderedHeight-a,I.div.renderedDepth+a,(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))/2),e.style.height=r+"em",e.style.width=bt.fontDimen.visibleWidthOf(t,vt)+"em",e.style.marginLeft=-bt.fontDimen.leftOffsetOf(t,vt)+"em",e.style.marginRight=bt.fontDimen.widthOf(t,vt)-bt.fontDimen.visibleWidthOf(t,vt)+bt.fontDimen.leftOffsetOf(t,vt)+"em",e.style.verticalAlign="middle",I.div.renderedHeight=Math.max(r/2+a,I.div.renderedHeight),I.div.renderedDepth=Math.max(r/2-a,I.div.renderedDepth),e.height=s,e.width=bt.fontDimen.visibleWidthOf(t,vt)/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))*s,(n=e.getContext("2d")).fillStyle=ut.color,n.font=s/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))+"px "+vt,n.fillText(t,bt.fontDimen.leftOffsetOf(t,vt)*s,s-bt.fontDimen.depthOf(t,vt)*s/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))),I.div.insertBefore(e,i?I.div.firstElementChild:null);break;case"(":case")":if(a=bt.fontDimen.heightOf("x",vt)/2,r=2*Math.max(I.div.renderedHeight-a,I.div.renderedDepth+a,(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))/2),e.style.height=r+"em",e.style.width=bt.fontDimen.widthOf(t,vt)+"em",e.style.verticalAlign="middle",I.div.renderedHeight=Math.max(r/2+a,I.div.renderedHeight),I.div.renderedDepth=Math.max(r/2-a,I.div.renderedDepth),Math.floor(Math.floor(s/2*r)-s)<=0)e.height=s,e.width=bt.fontDimen.widthOf(t,vt)/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))*s,(n=e.getContext("2d")).textAlign="center",n.fillStyle=ut.color,n.font=s/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))+"px "+vt,n.fillText(t,e.width/2,s-bt.fontDimen.depthOf(t,vt)*s/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)));else{l=bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt),e.height=s/2*r,e.width=bt.fontDimen.widthOf(t,vt)/bt.fontDimen.heightOf(t,vt)*s*(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)),(n=e.getContext("2d")).textAlign="center",n.fillStyle=ut.color,n.font=s/l+"px "+vt,n.fillText(t,e.width/2,s/2-bt.fontDimen.depthOf(t,vt)*s/l),d=n.getImageData(0,0,e.width,s/2),n.clearRect(0,0,e.width,e.height),n.fillText(t,e.width/2,s-bt.fontDimen.depthOf(t,vt)*s/l),n.clearRect(0,s/2,e.width,e.height),n.putImageData(d,0,e.height-s/2),o=n.createImageData(e.width,e.height-s),m=n.getImageData(0,s/2-1,e.width,1).data,u=d.data.slice(0,4*e.width);for(var f=0,v=o.height/2;f<v;f++)for(var g=0,y=e.width;g<y;g++){var b=f*e.width*4+4*g;o.data[b]=m[4*g+0],o.data[1+b]=m[4*g+1],o.data[2+b]=m[4*g+2],o.data[3+b]=m[4*g+3],b=~~(f+o.height/2)*e.width*4+4*g,o.data[b]=u[4*g+0],o.data[1+b]=u[4*g+1],o.data[2+b]=u[4*g+2],o.data[3+b]=u[4*g+3]}n.putImageData(o,0,s/2)}I.div.insertBefore(e,i?I.div.firstElementChild:null);break;case"[":case"]":case"⟮":case"⟯":case"↑":case"↓":case"↕":case"⇑":case"⇓":case"⇕":case"⌈":case"⌉":case"⌊":case"⌋":case"⎰":case"⎱":if(a=bt.fontDimen.heightOf("x",vt)/2,r=2*Math.max(I.div.renderedHeight-a,I.div.renderedDepth+a,(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))/2),e.style.height=r+"em",e.style.width=bt.fontDimen.widthOf(t,vt)+"em",e.style.verticalAlign="middle",I.div.renderedHeight=Math.max(r/2+a,I.div.renderedHeight),I.div.renderedDepth=Math.max(r/2-a,I.div.renderedDepth),l=bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt),e.height=s*r,e.width=bt.fontDimen.widthOf(t,vt)/bt.fontDimen.heightOf(t,vt)*s*(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)),(n=e.getContext("2d")).textAlign="center",n.fillStyle=ut.color,n.font=s/l+"px "+vt,n.fillText(t,e.width/2,s/2-bt.fontDimen.depthOf(t,vt)*s/l),d=n.getImageData(0,0,e.width,s/2),n.clearRect(0,0,e.width,e.height),n.fillText(t,e.width/2,s-bt.fontDimen.depthOf(t,vt)*s/l),n.clearRect(0,s/2,e.width,e.height),n.putImageData(d,0,e.height-s/2),e.height>s){o=n.createImageData(e.width,e.height-s),m=n.getImageData(0,s/2-1,e.width,1).data,u=d.data.slice(0,4*e.width);for(var w=0,x=o.height/2;w<x;w++)for(var k=0,S=e.width;k<S;k++){var D=w*e.width*4+4*k;o.data[D]=m[4*k+0],o.data[1+D]=m[4*k+1],o.data[2+D]=m[4*k+2],o.data[3+D]=m[4*k+3],D=~~(w+o.height/2)*e.width*4+4*k,o.data[D]=u[4*k+0],o.data[1+D]=u[4*k+1],o.data[2+D]=u[4*k+2],o.data[3+D]=u[4*k+3]}n.putImageData(o,0,s/2)}I.div.insertBefore(e,i?I.div.firstElementChild:null);break;case"{":case"}":if(a=bt.fontDimen.heightOf("x",vt)/2,r=2*Math.max(I.div.renderedHeight-a,I.div.renderedDepth+a,(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt))/2),e.style.height=r+"em",e.style.width=bt.fontDimen.widthOf(t,vt)+"em",e.style.verticalAlign="middle",l=s/(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)),e.height=Math.max(r,1)*s,e.width=bt.fontDimen.widthOf(t,vt)/bt.fontDimen.heightOf(t,vt)*s*(bt.fontDimen.heightOf(t,vt)+bt.fontDimen.depthOf(t,vt)),(n=e.getContext("2d")).textAlign="center",n.fillStyle=ut.color,n.font=l+"px "+vt,I.div.renderedHeight=Math.max(r/2+a,I.div.renderedHeight),I.div.renderedDepth=Math.max(r/2-a,I.div.renderedDepth),3<=s&&(n.fillText(t,e.width/2,Math.floor(s/3)-bt.fontDimen.depthOf(t,vt)*l),d=n.getImageData(0,0,e.width,Math.floor(s/3)),n.clearRect(0,0,e.width,e.height),n.fillText(t,e.width/2,s-bt.fontDimen.depthOf(t,vt)*l),p=n.getImageData(0,0,e.width,Math.floor(s/3)),n.clearRect(0,0,e.width,e.height),n.fillText(t,e.width/2,e.height/2+s/2-bt.fontDimen.depthOf(t,vt)*l),n.clearRect(0,0,e.width,Math.floor(e.height/2)-Math.floor(s/2)+Math.floor(s/3)),n.clearRect(0,Math.ceil(e.height/2)+Math.floor(s/2)-Math.floor(s/3),e.width,e.height),n.putImageData(p,0,0),n.putImageData(d,0,e.height-Math.floor(s/3)),e.height>s)){c=n.createImageData(e.width,Math.ceil((e.height-s)/2)),m=p.data.slice((Math.floor(s/3)-1)*e.width*4,Math.floor(s/3)*e.width*4),u=n.getImageData(0,Math.floor(e.height/2)-Math.floor(s/2)+Math.floor(s/3),e.width,1).data;for(var C=0,L=c.height/2;C<L;C++)for(var A=0,O=e.width;A<O;A++){var M=C*e.width*4+4*A;c.data[M]=m[4*A+0],c.data[1+M]=m[4*A+1],c.data[2+M]=m[4*A+2],c.data[3+M]=m[4*A+3],M=~~(C+c.height/2)*e.width*4+4*A,c.data[M]=u[4*A+0],c.data[1+M]=u[4*A+1],c.data[2+M]=u[4*A+2],c.data[3+M]=u[4*A+3]}h=n.createImageData(e.width,Math.floor(e.height/2)-Math.floor(s/2)+1),m=n.getImageData(0,Math.ceil(e.height/2)+Math.floor(s/2)-Math.floor(s/3)-1,e.width,1).data,u=d.data.slice(0,4*e.width);for(var T=0,E=h.height/2;T<E;T++)for(var q=0,H=e.width;q<H;q++){var B=T*e.width*4+4*q;h.data[B]=m[4*q+0],h.data[1+B]=m[4*q+1],h.data[2+B]=m[4*q+2],h.data[3+B]=m[4*q+3],B=~~(T+h.height/2)*e.width*4+4*q,h.data[B]=u[4*q+0],h.data[1+B]=u[4*q+1],h.data[2+B]=u[4*q+2],h.data[3+B]=u[4*q+3]}n.putImageData(c,0,Math.floor(s/3)),n.putImageData(h,0,e.height/2+Math.floor(s/2)-Math.floor(s/3))}I.div.insertBefore(e,i?I.div.firstElementChild:null)}},X=document.createElement("canvas"),G=document.createElement("canvas"),X.style.display=G.style.display="inline-block",">"==I.delims[0]&&(I.delims[0]="⟩"),">"==I.delims[1]&&(I.delims[1]="⟩"),"<"==I.delims[0]&&(I.delims[0]="⟨"),"<"==I.delims[1]&&(I.delims[1]="⟨"),j(X,I.delims[0],!0,ft),j(G,I.delims[1],!1,ft)),!I.superscript&&!I.subscript||1==I.atomType&&I.limits?(I.superscript||I.subscript)&&1==I.atomType&&I.limits&&(ce=I.div.firstElementChild,mt.appendChild(I.div),he=I.div.offsetWidth+1,mt.removeChild(I.div),I.subscript&&!I.superscript?(I.div.renderedDepth=Math.max(I.div.renderedDepth,0),ve=document.createElement("div"),Ge=document.createElement("div"),ve.style.display="inline-block",ve.style.verticalAlign="text-bottom",ve.style.position="relative",Ge.innerText=" ",Ge.style.verticalAlign="text-top",Ge.style.display="inline-block",Ge.style.width=0,$(I.subscript,"display"==J||"text"==J?"script":"scriptscript",!0,Q,ve),ve.style.fontSize="scriptscript"==J?I.div.style.fontSize:"calc("+I.div.style.fontSize+" * .707106781)",mt.appendChild(ve),Pe=ve.offsetWidth+1,ve.style.fontSize="50px",qe=ve.offsetHeight/50,mt.removeChild(ve),"scriptscript"==J?(ve.style.fontSize="",ve.style.top=-ve.baseline-ve.baselineOffset-I.div.renderedDepth+"em",Ge.style.paddingBottom=qe-I.div.baseline+I.div.baselineOffset+I.div.renderedDepth+"em"):(ve.style.fontSize=".707106781em",ve.style.top=(-I.div.baseline-I.div.baselineOffset+I.div.renderedDepth)/.707106781+"em",Ge.style.paddingBottom=.707106781*qe-I.div.baseline-I.div.baselineOffset+I.div.renderedDepth+"em"),ve.style.height=0,Pe<he?(pe=ve.firstElementChild,de=ce,I.div.insertBefore(ve,ce),ve.style.width=0):(pe=ce,de=ve.firstElementChild,I.div.appendChild(ve)),(me=document.createElement("div")).style.display="inline-block",me.style.position="relative",(ue=document.createElement("div")).style.display="inline-block",ue.style.width=0,ue.style.visibility="hidden",ue.style.webkitUserSelect=ue.style.mozUserSelect=ue.style.msUserSelect=ue.style.userSelect="none",ue.appendChild(gt(pe.cloneNode(!0))),me.appendChild(ue),(fe=document.createElement("div")).style.position="absolute",fe.style.left=fe.style.right=0,fe.style.textAlign="center",fe.style.display="inline-block",fe.appendChild(pe),me.appendChild(fe),me.style.width=Math.max(Pe,he)/ft/("scriptscript"!=J&&de==ce?.707106781:1)+"em",Pe<he?ve.appendChild(me):((Te=document.createElement("div")).style.display="inline-block",Te.style.width=0,Te.appendChild(me),I.div.insertBefore(Te,ve)),I.div.insertBefore(Ge,I.div.firstElementChild),I.div.renderedDepth+=(qe*("scriptscript"==J?1:.707106781)-ve.baseline-ve.baselineOffset+ve.renderedDepth)*N):I.superscript&&!I.subscript?((be=document.createElement("div")).style.display="inline-block",be.style.verticalAlign="text-bottom",$(I.superscript,"display"==J||"text"==J?"script":"scriptscript",K,Q,be),be.style.fontSize="scriptscript"==J?I.div.style.fontSize:"calc("+I.div.style.fontSize+" * .707106781)",mt.appendChild(be),Pe=be.offsetWidth+1,be.style.fontSize="50px",qe=be.offsetHeight/50,mt.removeChild(be),"scriptscript"==J?(be.style.fontSize="",be.style.marginBottom=I.div.baseline+I.div.baselineOffset+I.div.renderedHeight+"em"):(be.style.fontSize=".707106781em",be.style.marginBottom=(I.div.baseline+I.div.baselineOffset+I.div.renderedHeight)/.707106781+"em"),Pe<he?(pe=be.firstElementChild,de=ce,I.div.insertBefore(be,ce),be.style.width=0):(pe=ce,de=be.firstElementChild,I.div.appendChild(be)),(me=document.createElement("div")).style.display="inline-block",me.style.position="relative",(ue=document.createElement("div")).style.display="inline-block",ue.style.width=0,ue.style.visibility="hidden",ue.style.webkitUserSelect=ue.style.mozUserSelect=ue.style.msUserSelect=ue.style.userSelect="none",ue.appendChild(gt(pe.cloneNode(!0))),me.appendChild(ue),(fe=document.createElement("div")).style.position="absolute",fe.style.left=fe.style.right=0,fe.style.textAlign="center",fe.style.display="inline-block",fe.appendChild(pe),me.appendChild(fe),me.style.width=Math.max(Pe,he)/ft/("scriptscript"!=J&&de==ce?.707106781:1)+"em",Pe<he?be.appendChild(me):((Te=document.createElement("div")).style.display="inline-block",Te.style.width=0,Te.appendChild(me),I.div.insertBefore(Te,be)),I.div.renderedHeight+=(be.baseline+be.baselineOffset+be.renderedHeight)*("scriptscript"==J?1:.707106781)*N):I.superscript&&I.subscript&&(I.div.renderedDepth=Math.max(I.div.renderedDepth,0),(ve=document.createElement("div")).style.display="inline-block",ve.style.verticalAlign="text-bottom",ve.style.position="relative",$(I.subscript,"display"==J||"text"==J?"script":"scriptscript",!0,Q,ve),ve.style.fontSize="scriptscript"==J?I.div.style.fontSize:"calc("+I.div.style.fontSize+" * .707106781)",mt.appendChild(ve),ge=ve.offsetWidth+1,ve.style.fontSize="50px",ye=ve.offsetHeight/50,mt.removeChild(ve),(be=document.createElement("div")).style.display="inline-block",be.style.verticalAlign="text-bottom",be.style.position="relative",$(I.superscript,"display"==J||"text"==J?"script":"scriptscript",K,Q,be),be.style.fontSize="scriptscript"==J?I.div.style.fontSize:"calc("+I.div.style.fontSize+" * .707106781)",mt.appendChild(be),we=be.offsetWidth+1,be.style.fontSize="50px",be.offsetHeight,mt.removeChild(be),(Ge=document.createElement("div")).innerText=" ",Ge.style.verticalAlign="text-top",Ge.style.display="inline-block",Ge.style.width=0,"scriptscript"==J?(ve.style.fontSize=be.style.fontSize="",ve.style.top=-ve.baseline-ve.baselineOffset-I.div.renderedDepth+"em",Ge.style.paddingBottom=qe-I.div.baseline+I.div.baselineOffset+I.div.renderedDepth+"em",be.style.marginBottom=I.div.baseline+I.div.baselineOffset+I.div.renderedHeight+"em"):(ve.style.fontSize=be.style.fontSize=".707106781em",ve.style.top=(-I.div.baseline-I.div.baselineOffset+I.div.renderedDepth)/.707106781+"em",Ge.style.paddingBottom=.707106781*ye-I.div.baseline+I.div.baselineOffset+I.div.renderedDepth+"em",be.style.marginBottom=(I.div.baseline+I.div.baselineOffset+I.div.renderedHeight)/.707106781+"em"),ve.style.height=0,ge<=we&&he<=we?(I.div.insertBefore(ve,ce),I.div.appendChild(be),ve.style.width=0,xe=document.createElement("div"),Ce=document.createElement("div"),xe.style.display=Ce.style.display="inline-block",xe.style.position=Ce.style.position="relative",ke=document.createElement("div"),Ae=document.createElement("div"),ke.style.display=Ae.style.display="inline-block",ke.style.width=Ae.style.width=0,ke.style.visibility=Ae.style.visibility="hidden",ke.style.webkitUserSelect=ke.style.mozUserSelect=ke.style.msUserSelect=ke.style.userSelect=Ae.style.webkitUserSelect=Ae.style.mozUserSelect=Ae.style.msUserSelect=Ae.style.userSelect="none",ke.appendChild(gt(ve.firstElementChild.cloneNode(!0))),Ae.appendChild(gt(ce.cloneNode(!0))),xe.appendChild(ke),Ce.appendChild(Ae),Se=document.createElement("div"),Me=document.createElement("div"),Se.style.position=Me.style.position="absolute",Se.style.left=Se.style.right=0,Me.style.left=Me.style.right=0,Se.style.textAlign=Me.style.textAlign="center",Se.style.display=Me.style.display="inline-block",Se.appendChild(ve.firstElementChild),Me.appendChild(ce),xe.appendChild(Se),Ce.appendChild(Me),xe.style.width=we/ft/("scriptscript"!=J?.707106781:1)+"em",Ce.style.width=we/ft+"em",ve.appendChild(xe),(Te=document.createElement("div")).style.display="inline-block",Te.style.width=0,Te.appendChild(Ce),I.div.insertBefore(Te,be)):ge<=he&&we<=he?(I.div.insertBefore(ve,ce),I.div.insertBefore(be,ce),ve.style.width=be.style.width=0,xe=document.createElement("div"),De=document.createElement("div"),xe.style.display=De.style.display="inline-block",xe.style.position=De.style.position="relative",ke=document.createElement("div"),Le=document.createElement("div"),ke.style.display=Le.style.display="inline-block",ke.style.width=Le.style.width=0,ke.style.visibility=Le.style.visibility="hidden",ke.style.webkitUserSelect=ke.style.mozUserSelect=ke.style.msUserSelect=ke.style.userSelect=Le.style.webkitUserSelect=Le.style.mozUserSelect=Le.style.msUserSelect=Le.style.userSelect="none",ke.appendChild(gt(ve.firstElementChild.cloneNode(!0))),Le.appendChild(gt(be.firstElementChild.cloneNode(!0))),xe.appendChild(ke),De.appendChild(Le),Se=document.createElement("div"),Oe=document.createElement("div"),Se.style.position=Oe.style.position="absolute",Se.style.left=Se.style.right=0,Oe.style.left=Oe.style.right=0,Se.style.textAlign=Oe.style.textAlign="center",Se.style.display=Oe.style.display="inline-block",Se.appendChild(ve.firstElementChild),Oe.appendChild(be.firstElementChild),xe.appendChild(Se),De.appendChild(Oe),xe.style.width=he/ft/("scriptscript"!=J?.707106781:1)+"em",De.style.width=he/ft/("scriptscript"!=J?.707106781:1)+"em",ve.appendChild(xe),be.appendChild(De)):he<=ge&&we<=ge&&(I.div.insertBefore(be,ce),I.div.appendChild(ve),be.style.width=0,De=document.createElement("div"),Ce=document.createElement("div"),De.style.display=Ce.style.display="inline-block",De.style.position=Ce.style.position="relative",Le=document.createElement("div"),Ae=document.createElement("div"),Le.style.display=Ae.style.display="inline-block",Le.style.width=Ae.style.width=0,Le.style.visibility=Ae.style.visibility="hidden",Le.style.webkitUserSelect=Le.style.mozUserSelect=Le.style.msUserSelect=Le.style.userSelect=Ae.style.webkitUserSelect=Ae.style.mozUserSelect=Ae.style.msUserSelect=Ae.style.userSelect="none",Le.appendChild(gt(be.firstElementChild.cloneNode(!0))),Ae.appendChild(gt(ce.cloneNode(!0))),De.appendChild(Le),Ce.appendChild(Ae),Oe=document.createElement("div"),Me=document.createElement("div"),Oe.style.position=Me.style.position="absolute",Oe.style.left=Oe.style.right=0,Me.style.left=Me.style.right=0,Oe.style.textAlign=Me.style.textAlign="center",Oe.style.display=Me.style.display="inline-block",Oe.appendChild(be.firstElementChild),Me.appendChild(ce),De.appendChild(Oe),Ce.appendChild(Me),De.style.width=ge/ft/("scriptscript"!=J?.707106781:1)+"em",Ce.style.width=ge/ft+"em",be.appendChild(De),(Te=document.createElement("div")).style.display="inline-block",Te.style.width=0,Te.appendChild(Ce),I.div.insertBefore(Te,ve)),I.div.insertBefore(Ge,I.div.firstElementChild),I.div.renderedDepth+=(ye*("scriptscript"==J?1:.707106781)-ve.baseline-ve.baselineOffset+ve.renderedDepth)*N,I.div.renderedHeight+=(be.baseline+be.baselineOffset+be.renderedHeight)*("scriptscript"==J?1:.707106781)*N)):I.subscript&&!I.superscript?(ve=document.createElement("div"),Ge=document.createElement("div"),ve.style.display="inline-block",ve.style.verticalAlign="text-bottom",ve.style.position="relative",Ge.style.verticalAlign="text-top",Ge.innerText=" ",Ge.style.display="inline-block",Ge.style.width=0,$(I.subscript,"display"==J||"text"==J?"script":"scriptscript",!0,Q,ve),ve.style.fontSize="50px",mt.appendChild(ve),qe=ve.offsetHeight/50,mt.removeChild(ve),"scriptscript"==J?(ve.style.fontSize="",ve.style.top=Math.max(ve.baseline,ve.renderedDepth)-bt.fontDimen.baselineHeightOf(vt)+Math.max(Math.max(I.div.renderedDepth,0)/N+.2,ve.renderedHeight-bt.fontDimen.heightOf("x",vt))-qe+"em",Ge.style.paddingBottom=Math.max(ve.baseline,ve.renderedDepth)-bt.fontDimen.baselineHeightOf(vt)+Math.max(Math.max(I.div.renderedDepth,0)/N+.2,ve.renderedHeight-bt.fontDimen.heightOf("x",vt))-qe+"em",I.div.renderedDepth=Math.max(I.div.renderedDepth,(ve.renderedDepth+Math.max(Math.max(I.div.renderedDepth,0)/N+.2,ve.renderedHeight-bt.fontDimen.heightOf("x",vt)))*N)):(ve.style.fontSize=".707106781em",ve.style.top=Math.max(ve.baseline,ve.renderedDepth)-bt.fontDimen.baselineHeightOf(vt)/.707106781+Math.max(Math.max(I.div.renderedDepth,0)/N/.707106781+.2,ve.renderedHeight-bt.fontDimen.heightOf("x",vt))-qe+"em",Ge.style.paddingBottom=.707106781*Math.max(ve.baseline,ve.renderedDepth)-bt.fontDimen.baselineHeightOf(vt)+.707106781*Math.max(Math.max(I.div.renderedDepth,0)/N/.707106781+.2,ve.renderedHeight-bt.fontDimen.heightOf("x",vt))+"em",I.div.renderedDepth=Math.max(I.div.renderedDepth,(.707106781*ve.renderedDepth+.707106781*Math.max(Math.max(I.div.renderedDepth,0)/N/.707106781+.2,ve.renderedHeight-bt.fontDimen.heightOf("x",vt)))*N)),ve.style.height=0,I.div.appendChild(ve),I.div.insertBefore(Ge,ve)):I.superscript&&!I.subscript?(be=document.createElement("div"),$(I.superscript,"display"==J||"text"==J?"script":"scriptscript",K,Q,be),be.style.display="inline-block",be.style.verticalAlign="text-bottom",be.style.position="relative","scriptscript"==J?(be.style.top=Math.max(be.baseline,be.renderedDepth)-bt.fontDimen.baselineHeightOf(vt)-Math.max(I.div.renderedHeight/N+(K?.1:.2)-be.renderedHeight,be.renderedDepth+(K?.9:1)*bt.fontDimen.heightOf("x",vt))+"em",be.style.paddingTop=-Math.max(be.baseline,be.renderedDepth)+bt.fontDimen.baselineHeightOf(vt)+Math.max(I.div.renderedHeight/N+(K?.1:.2)-be.renderedHeight,be.renderedDepth+(K?.9:1)*bt.fontDimen.heightOf("x",vt))+"em",I.div.renderedHeight=Math.max(I.div.renderedHeight,(be.renderedHeight+Math.max(I.div.renderedHeight/N+(K?.1:.2)-be.renderedHeight,be.renderedDepth+(K?.9:1)*bt.fontDimen.heightOf("x",vt)))*N)):(be.style.fontSize=".707106781em",be.style.top=Math.max(be.baseline,be.renderedDepth)-bt.fontDimen.baselineHeightOf(vt)/.707106781-Math.max(I.div.renderedHeight/N/.707106781+(K?.1:.2)-be.renderedHeight,be.renderedDepth+(K?.9:1)*bt.fontDimen.heightOf("x",vt))+"em",be.style.paddingTop=-Math.max(be.baseline,be.renderedDepth)+bt.fontDimen.baselineHeightOf(vt)/.707106781+Math.max(I.div.renderedHeight/N/.707106781+(K?.1:.2)-be.renderedHeight,be.renderedDepth+(K?.9:1)*bt.fontDimen.heightOf("x",vt))+"em",I.div.renderedHeight=Math.max(I.div.renderedHeight,.707106781*(be.renderedHeight+Math.max(I.div.renderedHeight/N/.707106781+(K?.1:.2)-be.renderedHeight,be.renderedDepth+(K?.9:1)*bt.fontDimen.heightOf("x",vt)))*N)),I.div.appendChild(be)):I.subscript&&I.superscript&&(ve=document.createElement("div"),Ge=document.createElement("div"),ve.style.display="inline-block",Ge.style.verticalAlign="text-top",Ge.innerText=" ",Ge.style.display="inline-block",Ge.style.width=0,$(I.subscript,"display"==J||"text"==J?"script":"scriptscript",!0,Q,ve),ve.style.fontSize="50px",mt.appendChild(ve),ne={height:ve.offsetHeight,width:ve.offsetWidth+1},mt.removeChild(ve),(be=document.createElement("div")).style.display="inline-block",$(I.superscript,"display"==J||"text"==J?"script":"scriptscript",K,Q,be),be.style.fontSize="50px",mt.appendChild(be),le={height:be.offsetHeight,width:be.offsetWidth+1},mt.removeChild(be),be.style.marginLeft=V+"em",pe=ne.width<le.width+V?ve:be,de=ne.width<le.width+V?be:ve,qe=le.height/50,oe=ne.height/50,ve.style.verticalAlign=be.style.verticalAlign="text-bottom",be.style.position=ve.style.position="relative","scriptscript"==J?(ve.style.fontSize=be.style.fontSize="",be.style.top=Math.max(be.baseline,be.renderedDepth)-bt.fontDimen.baselineHeightOf(vt)-Math.max(I.div.renderedHeight/N+(K?.1:.2)-be.renderedHeight,be.renderedDepth+(K?.9:1)*bt.fontDimen.heightOf("x",vt))+"em",be.style.paddingTop=-Math.max(be.baseline,be.renderedDepth)+bt.fontDimen.baselineHeightOf(vt)+Math.max(I.div.renderedHeight/N+(K?.1:.2)-be.renderedHeight,be.renderedDepth+(K?.9:1)*bt.fontDimen.heightOf("x",vt))+"em",I.div.renderedHeight=Math.max(I.div.renderedHeight,(be.renderedHeight+Math.max(I.div.renderedHeight/N+(K?.1:.2)-be.renderedHeight,be.renderedDepth+(K?.9:1)*bt.fontDimen.heightOf("x",vt)))*N),ve.style.top=Math.max(ve.baseline,ve.renderedDepth)-bt.fontDimen.baselineHeightOf(vt)+Math.max(Math.max(I.div.renderedDepth,0)/N+.2,ve.renderedHeight-.8*bt.fontDimen.heightOf("x",vt))-oe+"em",Ge.style.paddingBottom=Math.max(ve.baseline,ve.renderedDepth)-bt.fontDimen.baselineHeightOf(vt)+Math.max(Math.max(I.div.renderedDepth,0)/N+.2,ve.renderedHeight-.8*bt.fontDimen.heightOf("x",vt))-qe+"em",I.div.renderedDepth=Math.max(I.div.renderedDepth,(ve.renderedDepth+Math.max(Math.max(I.div.renderedDepth,0)/N+.2,ve.renderedHeight-.8*bt.fontDimen.heightOf("x",vt)))*N)):(ve.style.fontSize=be.style.fontSize=".707106781em",be.style.top=Math.max(be.baseline,be.renderedDepth)-bt.fontDimen.baselineHeightOf(vt)/.707106781-Math.max(I.div.renderedHeight/N/.707106781+(K?.1:.2)-be.renderedHeight,be.renderedDepth+(K?.9:1)*bt.fontDimen.heightOf("x",vt))+"em",be.style.paddingTop=-Math.max(be.baseline,be.renderedDepth)+bt.fontDimen.baselineHeightOf(vt)/.707106781+Math.max(I.div.renderedHeight/N/.707106781+(K?.1:.2)-be.renderedHeight,be.renderedDepth+(K?.9:1)*bt.fontDimen.heightOf("x",vt))+"em",I.div.renderedHeight=Math.max(I.div.renderedHeight,.707106781*(be.renderedHeight+Math.max(I.div.renderedHeight/N/.707106781+(K?.1:.2)-be.renderedHeight,be.renderedDepth+(K?.9:1)*bt.fontDimen.heightOf("x",vt)))*N),ve.style.top=Math.max(ve.baseline,ve.renderedDepth)-bt.fontDimen.baselineHeightOf(vt)/.707106781+Math.max(Math.max(I.div.renderedDepth,0)/N/.707106781+.2,ve.renderedHeight-.8*bt.fontDimen.heightOf("x",vt))-oe+"em",Ge.style.paddingBottom=.707106781*Math.max(ve.baseline,ve.renderedDepth)-bt.fontDimen.baselineHeightOf(vt)+.707106781*Math.max(Math.max(I.div.renderedDepth,0)/N/.707106781+.2,ve.renderedHeight-.8*bt.fontDimen.heightOf("x",vt))+"em",I.div.renderedDepth=Math.max(I.div.renderedDepth,(.707106781*ve.renderedDepth+.707106781*Math.max(Math.max(I.div.renderedDepth,0)/N/.707106781+.2,ve.renderedHeight-.8*bt.fontDimen.heightOf("x",vt)))*N)),ve.style.height=0,pe.style.width=0,I.div.appendChild(Ge),I.div.appendChild(pe),I.div.appendChild(de)),H&&"horizontal"==H.boxType?(H.to?((Pe=new xt(H.to)).em.value+=Pe.sp.value/65536/6*8/ft*65536,Pe.sp.value=0):H.spread&&((Pe=new xt(H.spread)).em.value+=Pe.sp.value/65536/6*8/ft*65536,Pe.sp.value=0,Re=I.div.style.fontSize,I.div.style.fontSize="50px",mt.appendChild(I.div),Ee=(I.div.offsetWidth+1)/50,mt.removeChild(I.div),I.div.style.fontSize=Re,Pe.em.value+=65536*Ee),Pe.em.value<0?(te.splice(te.length-1,0,{type:"kern",dimen:Pe}),I.div.firstElementChild.style.width=0):I.div.firstElementChild.style.width=Pe.em.value/65536+"em",I.div.firstElementChild.style.flexWrap=""):H&&"vertical"==H.boxType&&(H.to?((qe=new xt(H.to)).em.value+=qe.sp.value/65536/6*8/ft*65536,qe.sp.value=0):H.spread&&((qe=new xt(H.spread)).em.value+=qe.sp.value/65536/6*8/ft*65536,qe.sp.value=0,Re=I.div.style.fontSize,I.div.style.fontSize="50px",mt.appendChild(I.div),He=I.div.offsetHeight/50,mt.removeChild(I.div),I.div.style.fontSize=Re,qe.em.value+=65536*He),qe.em.value<0?(I.div.firstElementChild.style.height=0,I.div.firstElementChild.style.verticalAlign="text-bottom",I.div.firstElementChild.style.position="relative",I.div.firstElementChild.style.top=-qe.em.value/65536+"em",I.div.renderedHeight=0,I.div.renderedDepth=0):(I.div.firstElementChild.style.height=qe.em.value/65536+"em",I.div.firstElementChild.style.verticalAlign="text-bottom",I.div.renderedDepth=Math.min(bt.fontDimen.baselineHeightOf(vt),qe.em.value/65536),I.div.renderedHeight=Math.max(qe.em.value/65536-bt.fontDimen.baselineHeightOf(vt),0)),I.div.firstElementChild.style.flexWrap=""),H&&(I.div.firstElementChild.style.justifyContent="initial"),I.atomType){case"over":I.div.renderedHeight=Math.max(I.div.renderedHeight||0,bt.fontDimen.heightOf("x",vt)/2),Ue=document.createElement("div"),je=document.createElement("div"),Ie=document.createElement("div"),Ge=document.createElement("div"),Ve=gt(I.div.cloneNode(!0)),je.style.display="inline-block",je.style.width=je.style.height=0,je.style.position="relative",je.style.top=-bt.fontDimen.baselineHeightOf(vt)-I.div.renderedHeight/N-bt.fontDimen.visibleWidthOf("|",vt)-.12+"em",je.style.verticalAlign="text-bottom",je.style.pointerEvents="none",Ie.style.display="inline-block",Ie.style.webkitUserSelect=Ie.style.mozUserSelect=Ie.style.msUserSelect=Ie.style.userSelect="none",Ie.style.position="relative",Ue.style.position="absolute",Ue.style.left=Ue.style.right=0,Ue.style.borderTop=bt.fontDimen.visibleWidthOf("|",vt)+"em solid currentColor",Ie.appendChild(Ue),Ve.style.visibility="hidden",Ve.style.fontSize="",Ie.appendChild(Ve),je.appendChild(Ie),I.div.insertBefore(je,I.div.firstElementChild),Ge.style.height=I.div.renderedHeight/N+bt.fontDimen.visibleWidthOf("|",vt)+.16+"em",Ge.style.display="inline-block",Ge.style.width=0,I.div.insertBefore(Ge,je),I.div.renderedHeight+=bt.fontDimen.visibleWidthOf("|",vt)+.16;break;case"under":I.div.renderedDepth=Math.max(I.div.renderedDepth||0,0),Be=document.createElement("div"),je=document.createElement("div"),Ie=document.createElement("div"),Ge=document.createElement("div"),Ve=gt(I.div.cloneNode(!0)),je.style.display="inline-block",je.style.width=je.style.height=0,je.style.position="relative",je.style.top=-bt.fontDimen.baselineHeightOf(vt)+I.div.renderedDepth/N+.12+"em",je.style.verticalAlign="text-bottom",je.style.pointerEvents="none",Ie.style.display="inline-block",Ie.style.webkitUserSelect=Ie.style.mozUserSelect=Ie.style.msUserSelect=Ie.style.userSelect="none",Ie.style.position="relative",Be.style.position="absolute",Be.style.left=Be.style.right=0,Be.style.borderTop=bt.fontDimen.visibleWidthOf("|",vt)+"em solid currentColor",Ie.appendChild(Be),Ve.style.visibility="hidden",Ve.style.fontSize="",Ve.style.height=0,Ie.appendChild(Ve),je.appendChild(Ie),I.div.insertBefore(je,I.div.firstElementChild),Ge.style.verticalAlign="text-top",Ge.innerText=" ",Ge.style.paddingBottom=bt.fontDimen.visibleWidthOf("|",vt)+.16-bt.fontDimen.baselineHeightOf(vt)+I.div.renderedDepth/N+"em",Ge.style.display="inline-block",Ge.style.width=0,I.div.insertBefore(Ge,je),I.div.renderedDepth+=bt.fontDimen.visibleWidthOf("|",vt)+.16;break;case"acc":ze=document.createElement("div"),Ne=document.createElement("div"),ze.style.display="inline-block",ze.style.position="relative","it"==Q?ze.style.fontStyle="italic":"sl"==Q?ze.style.fontStyle="oblique":"bf"==Q&&(ze.style.fontWeight="bold"),ze.style.top=Math.min(bt.fontDimen.heightOf("x",vt),I.div.renderedHeight)-I.div.renderedHeight+"em",ze.style.width=0,ze.style.lineHeight=1.1,ze.style.height="1.1em",ze.style.verticalAlign="text-bottom",ze.innerText=I.accChar,Fe=(Fe=!I.nucleus||"symbol"!=I.nucleus.type||"it"!=Q&&"sl"!=Q?0:bt.fontDimen.italCorrOf(I.accChar,vt))||(I.nucleus&&1==I.nucleus.length&&I.nucleus[0].nucleus&&"symbol"==I.nucleus[0].nucleus.type&&7==I.nucleus[0].atomType&&"nm"==Q?bt.fontDimen.italCorrOf(I.accChar,vt):0),Re=I.div.style.fontSize,I.div.style.fontSize="50px",mt.appendChild(I.div),ze.style.left=((I.div.offsetWidth+1)/50-bt.fontDimen.widthOf(I.accChar,vt,Q))/2+Fe+"em",mt.removeChild(I.div),I.div.style.fontSize=Re,I.div.insertBefore(ze,I.div.firstElementChild),Ne.style.display="inline-block",Ne.style.width=0,Ne.style.height=I.div.renderedHeight-Math.min(bt.fontDimen.heightOf("x",vt),I.div.renderedHeight)+bt.fontDimen.heightOf(I.accChar,vt,Q)+"em",I.div.insertBefore(Ne,ze),I.div.renderedHeight=I.div.renderedHeight-Math.min(bt.fontDimen.heightOf("x",vt),I.div.renderedHeight)+bt.fontDimen.heightOf(I.accChar,vt,Q);break;case"vcenter":We=bt.fontDimen.heightOf("x",vt)/2,Fe=I.div.renderedHeight-We-(I.div.renderedDepth+We),I.div.style.position="relative",I.div.style.top=Fe/2+"em",I.div.style.marginTop=-Fe/2+"em",I.div.style.marginBottom=Fe/2+"em",I.div.renderedHeight-=Fe/2,I.div.renderedDepth+=Fe/2;break;case"rad":I.div.renderedHeight=Math.max(I.div.renderedHeight||0,bt.fontDimen.heightOf("x",vt)/2),I.div.renderedDepth=Math.max(I.div.renderedDepth||0,0),mt.appendChild(I.div),Pe=(I.div.offsetWidth+1)/ft,mt.removeChild(I.div),Ue=document.createElement("div"),je=document.createElement("div"),Xe=document.createElement("div"),Ge=document.createElement("div"),Ve=gt(I.div.cloneNode(!0)),je.style.display="inline-block",je.style.width=je.style.height=0,je.style.position="relative",je.style.top=-bt.fontDimen.baselineHeightOf(vt)-I.div.renderedHeight/N-bt.fontDimen.visibleWidthOf("|",vt)-.12+"em",je.style.verticalAlign="text-bottom",je.style.pointerEvents="none",Xe.style.display="inline-block",Xe.style.webkitUserSelect=Xe.style.mozUserSelect=Xe.style.msUserSelect=Xe.style.userSelect="none",Xe.style.position="relative",Ue.style.position="absolute",Xe.style.width=Pe+"em",Ue.style.left=Ue.style.right=0,Ue.style.borderTop=bt.fontDimen.visibleWidthOf("|",vt)+"em solid currentColor",Xe.appendChild(Ue),Xe.appendChild(document.createTextNode(" ")),je.appendChild(Xe),I.div.insertBefore(je,I.div.firstElementChild),Ge.style.height=I.div.renderedHeight/N+bt.fontDimen.visibleWidthOf("|",vt)+.16+"em",Ge.style.display="inline-block",Ge.style.width=0,I.div.insertBefore(Ge,je),I.div.renderedHeight+=(bt.fontDimen.visibleWidthOf("|",vt)+.16)*N,_e=document.createElement("canvas"),Ye=$e=0,wt["radical.build"][0]?(Je=bt.fontDimen.visibleWidthOf("|",vt),_e.height=(I.div.renderedDepth+I.div.renderedHeight)*ft,_e.style.height=I.div.renderedDepth+I.div.renderedHeight+"em",_e.style.position="relative",_e.style.top=I.div.renderedDepth+"em",_e.style.marginLeft=".1em",_e.style.marginTop=-I.div.renderedDepth+"em",Ke=Je,Qe=I.div.renderedHeight+I.div.renderedDepth-.04-Ke/2,Ze=Math.max(wt["radical.w"][0]),et=Math.max(0,Math.min(Ze,wt["radical.t"][0])),tt=Math.max(0,wt["radical.h"][0]),it=Qe/Math.max(0,wt["radical.verticalthreshold"][0]),st=Math.sqrt(it),at=Math.sqrt(3),$e=I.div.renderedHeight+I.div.renderedDepth<Math.max(0,wt["radical.verticalthreshold"][0])?(tt=Math.min(I.div.renderedHeight+I.div.renderedDepth,tt/Math.max(wt["radical.verticalthreshold"][0],0)),rt=Ke*it*at/(6*it*it+2),_e.width=(-Ke*(et*(it-1)-it*Ze-Qe*st+Ze)/(2*Qe)+rt+Ze)*ft,_e.style.width=(-Ke*et*(it-1)+Ke*it*Ze-Ze*(Ke-2*Qe)+Qe*(Ke+2*rt))/(2*Qe)+"em",(ht=_e.getContext("2d")).fillStyle=ut.color,nt=[Math.max(-Ke*(et*(it-1)-it*Ze-Qe*st+Ze)/(2*Qe),0)+rt+Ze,Qe-Ke/2],lt=[Math.min(-Ke*(-et*(it-1)+it*Ze+Qe*st-Ze)/(2*Qe)+rt+Ze,nt[0]),Qe+Ke/2],ot=[-(4*et*et*it*at*(it-1)*(it-1)-et*(it-1)*(4*it*it*Ze*at+3*Ke*at*Math.pow(it,1.5)-4*it*(Qe*(tt-1)-rt*at)+4*Qe*tt)-Qe*(4*it*it*Ze*(tt-1)+Ke*Math.pow(it,1.5)*(3*tt+2)-4*it*(tt*Ze-rt*(tt-1))-3*Ke*tt*st-4*tt*rt))/(4*(at*et*it*(it-1)+Qe*(it*(tt-1)-tt))),-(tt*Qe+it*et*at)/(it*(Ze-et))*(-(4*et*et*it*at*(it-1)*(it-1)-et*(it-1)*(4*it*it*Ze*at+3*Ke*at*Math.pow(it,1.5)-4*it*(Qe*(tt-1)-rt*at)+4*Qe*tt)-Qe*(4*it*it*Ze*(tt-1)+Ke*Math.pow(it,1.5)*(3*tt+2)-4*it*(tt*Ze-rt*(tt-1))-3*Ke*tt*st-4*tt*rt))/(4*(at*et*it*(it-1)+Qe*(it*(tt-1)-tt)))-it*(Ze-et)-et-3*Ke*st/4-rt)],ct=[Math.max(-et*(it-1)+it*Ze+Ke/2*st+rt,-ot[1]*(lt[0]-ot[0])/(lt[1]-ot[1])+ot[0]+nt[0]-(lt[0]-ot[0])/(lt[1]-ot[1])*(nt[1]-ot[1]+(lt[1]-ot[1])/(lt[0]-ot[0])*ot[0])),0],ht.beginPath(),ht.moveTo(nt[0]*ft,_e.height-nt[1]*ft),ht.lineTo((-Ke*(et*(it-1)-it*Ze-Qe*st+Ze)/(2*Qe)+rt+Ze)*ft,_e.height-(Qe+Ke/2)*ft),ht.lineTo(lt[0]*ft,_e.height-lt[1]*ft),ht.lineTo(ot[0]*ft,_e.height-ot[1]*ft),ht.lineTo((8*et*et*it*at*(it-1)-et*(8*it*it*Ze*at+6*Ke*Math.pow(it,1.5)*at+it*(Ke+8*rt*at)+8*Qe*tt)+Ke*it*Ze-6*Ke*Qe*tt*st-8*Qe*tt*rt)/(8*(et*it*at*(it-1)-it*it*Ze*at-Qe*tt))*ft,_e.height-(Ye=it*at*(8*et*et*it*at*(it-1)-et*(8*it*it*Ze*at+6*Ke*Math.pow(it,1.5)*at+it*(Ke+8*rt*at)+8*Qe*tt)+Ke*it*Ze-6*Ke*Qe*tt*st-8*Qe*tt*rt)/(8*(et*it*at*(it-1)-it*it*Ze*at-Qe*tt))+tt*Qe+Ke/8)*ft),ht.lineTo(0,_e.height-(tt*Qe+Ke/8)*ft),ht.lineTo(2*rt*ft,_e.height-(tt*Qe-Ke/8)*ft),ht.lineTo((8*et*et*it*at*(it-1)-et*(8*it*it*at*(Ze-2*rt)-6*Ke*Math.pow(it,1.5)*at-it*(Ke-8*rt*at)+8*Qe*tt)-16*rt*it*it*Ze*at-Ke*it*Ze+6*Ke*Qe*tt*st-8*Qe*tt*rt)/(8*(et*it*at*(it-1)-it*it*Ze*at-Qe*tt))*ft,_e.height-(it*at*((8*et*et*it*at*(it-1)-et*(8*it*it*at*(Ze-2*rt)-6*Ke*Math.pow(it,1.5)*at-it*(Ke-8*rt*at)+8*Qe*tt)-16*rt*it*it*Ze*at-Ke*it*Ze+6*Ke*Qe*tt*st-8*Qe*tt*rt)/(8*(et*it*at*(it-1)-it*it*Ze*at-Qe*tt))-2*rt)+tt*Qe-Ke/8)*ft),ht.lineTo((-et*(it-1)+it*Ze-.75*Ke*st+rt)*ft,_e.height),ht.lineTo(ct[0]*ft,_e.height),ht.closePath(),ht.fill(),(lt[0]-ot[0])/(lt[1]-ot[1])*(Ye-ot[1])+ot[0]):(tt=Math.max(0,Math.min(Qe,wt["radical.h"][0])),_e.width=(8*Ze+Ke*(4+at))/8*ft,_e.style.width=(8*Ze+Ke*(4+at))/8+"em",(ht=_e.getContext("2d")).fillStyle=ut.color,ht.beginPath(),ht.moveTo((Ze+Ke*(at+4)/8)*ft,.04*ft),ht.lineTo((Ze+Ke*(at-4)/8)*ft,.04*ft),ht.lineTo((Ze+Ke*(at-4)/8)*ft,_e.height-5*Ke*(tt+et*at)/(4*(Ze-et))*ft),ht.lineTo((et*(4*Ze*at+Ke*(3*at+2)+4*tt)-Ke*(2*Ze-3*tt-1.5*Ze-tt/2*at))/(4*(Ze*at+tt))*ft,_e.height-(Ye=(et*(4*Ze*at+Ke*(3*at+2)+4*tt)-Ke*(2*Ze-3*tt))/(4*(Ze*at+tt))*at+tt+Ke/2)*ft),ht.lineTo(0,_e.height-(Ke/8+tt)*ft),ht.lineTo(Ke*at/4*ft,_e.height-(-Ke/8+tt)*ft),ht.lineTo((et*(4*Ze*at-Ke*(3*at+2)+4*tt)+Ke*(2*Ze-3*tt+1.5*Ze+tt/2*at))/(4*(Ze*at+tt))*ft,_e.height-((et*(4*Ze*at-Ke*(3*at+2)+4*tt)+Ke*(2*Ze-3*tt))/(4*(Ze*at+tt))*at+tt-Ke/2)*ft),ht.lineTo((Ze-Ke*(6-at)/8)*ft,_e.height),ht.lineTo((Ze+Ke*(at+4)/8)*ft,_e.height),ht.closePath(),ht.fill(),Ze+Ke*(at-4)/8)):(_e.height=(bt.fontDimen.heightOf("√",vt)+bt.fontDimen.depthOf("√",vt))*ft,_e.width=bt.fontDimen.widthOf("√",vt)*ft,ht=_e.getContext("2d"),_e.style.height=I.div.renderedHeight+I.div.renderedDepth+"em",_e.style.width=bt.fontDimen.widthOf("√",vt)+"em",_e.style.position="relative",_e.style.top=I.div.renderedDepth+"em",_e.style.marginTop=-I.div.renderedDepth+"em",ht.textAlign="center",ht.font=ft+"px "+vt,ht.fillText("√",_e.width/2,_e.height*(1-bt.fontDimen.depthOf("√",vt)))),I.div.insertBefore(_e,Ge),I.index.length&&((pt=document.createElement("div")).style.display="inline-block",pt.style.position="relative",$(I.index,"scriptscript",!1,Q,pt),pt.style.fontSize="50px",mt.appendChild(pt),pt.style.marginLeft=Math.max(-(pt.offsetWidth+1)/50,-($e+.05)/("script"==J?.707106781:"scriptscript"==J?1:.5))+"em",mt.removeChild(pt),pt.style.fontSize=("script"==J?.707106781:"scriptscript"==J?1:.5)+"em",pt.style.top=-Math.max(Ye-I.div.renderedDepth,bt.fontDimen.heightOf("x",vt)/2)/("script"==J?.707106781:"scriptscript"==J?1:.5)-pt.renderedDepth-.1+"em",pt.style.left=(.05+$e)/("script"==J?.707106781:"scriptscript"==J?1:.5)+"em",I.div.insertBefore(pt,_e))}return"continue"}var _=dt(1,e,t);_&&(e=_[0],t=_[1]),se=e,ae=t};for(var se=0,ae=Y.length;se<ae;se++){var re,ne,le,oe,ce,he,pe,de,me,ue,fe,ve,ge,ye,be,we,xe,ke,Se,De,Ce,Le,Ae,Oe,Me,Te,Ee,qe,He,Be,Ie,ze,Ne,Re,We,Fe,Pe,Ue,je,Xe,Ge,Ve,_e,$e,Ye,Je,Ke,Qe,Ze,et,tt,it,st,at,rt,nt,lt,ot,ct,ht,pt;i(se,ae)}ie.length&&ie[ie.length-1].atomType==yt.BIN&&(ie[ie.length-1].atomType=yt.ORD);te.length||(ee.empty=!0);for(var s=0,a=te.length;s<a;s++){var r=m(1,s,a);r&&(s=r[0],a=r[1])}function dt(e,t,i){var s,a,r,n=Y[t],l=Y[t+1]||{};Y[t-1];switch(e){case 1:default:if("glue"!=n.type&&"kern"!=n.type&&"vglue"!=n.type&&"vkern"!=n.type)return dt(2,t,i);if(n.italicCorrection&&(n.italicCorrection=Z||""),"glue"==n.type&&n.isNonScript)return"script"!=J&&"scriptscript"!=J||"glue"!=l.type&&"vglue"!=l.type&&"kern"!=l.type&&"vkern"!=l.type||(Y.splice(t+1,1),i--),[t,i];"glue"==n.type&&"mu glue"==n.glue.type?n.glue=new _(new xt(0,n.glue.start.mu.value/18),"infinite dimension"==n.glue.stretch.type?n.glue.stretch:new xt(0,~~(n.glue.stretch.mu.value/18)),"infinite dimension"==n.glue.shrink.type?n.glue.shrink:new xt(0,~~(n.glue.shrink.mu.value/18))):"kern"==n.type&&"mu dimension"==n.dimen.type?n.dimen=new xt(0,~~(n.dimen.mu.value/18)):"vglue"==n.type&&(n.type="vkern",n.dimen=n.glue.start,delete n.glue),te.push(n);break;case 2:return"font modifier"==n.type?(["displaystyle","textstyle","scriptstyle","scriptscriptstyle"].includes(n.value)?J=n.value.substring(0,n.value.length-5):Q=n.value,Y.splice(t,1),[--t,--i]):dt(3,t,i);case 3:if("mathchoice"!=n.type)return dt(4,t,i);var o=n.groups[{display:0,text:1,script:2,scriptscript:3}[J]];return Y.splice.bind(Y,t,1).apply(Y,"symbol"==o.nucleus.type?[o]:o.nucleus),i+="symbol"==o.nucleus.type?0:o.nucleus.length-1,[--t,i];case 4:return"atom"==n.type&&2==n.atomType?(ie[0]&&![1,2,3,4,6].includes(ie[ie.length-1].atomType)||(n.atomType=0),dt(10,t,i)):dt(5,t,i);case 5:return"atom"!=n.type||!ie.length||3!=n.atomType&&5!=n.atomType&&6!=n.atomType?dt(6,t,i):(ie[0]&&2==ie[ie.length-1].atomType&&(ie[ie.length-1].atomType=0),dt(10,t,i));case 6:return"atom"==n.type&&[4,"inner","over","under","vcenter","rad","acc"].includes(n.atomType)?dt(10,t,i):dt(7,t,i);case 7:case 8:return dt(9,t,i);case 9:if("table"!=n.type)return dt(10,t,i);var c={type:"atom",atomType:"inner",nucleus:null,superscript:null,subscript:null,style:J,div:document.createElement("div")};te.push(c),ie.push(c),n.style=J,n.div=c.div,n.div.style.display="inline-block",n.div.style.whiteSpace="nowrap";var h=document.createElement("table");h.style.borderCollapse="collapse",h.style.verticalAlign="middle",h.style.display="inline-table";for(var p,d=0,i=n.cellData.length;d<i;d++){n.noAligns[d]&&((p=document.createElement("td")).setAttribute("colspan",n.tabSkips.length-1),p.style.padding=0,$([n.noAligns[d]],J,!1,Q,p),h.appendChild(p),p.firstElementChild.style.width="100%",p.firstElementChild.style.justifyContent="");for(var m=document.createElement("tr"),u=0,f=n.cellData[d].length;u<f;u++){var v=document.createElement("td");v.setAttribute("colspan",n.cellData[d][u].span),v.style.padding=0,v.style.paddingLeft=n.tabSkips[u].start.em.value/65536+n.tabSkips[u].start.sp.value/65536/12+"em",u==n.tabSkips.length-2&&(v.style.paddingRight=n.tabSkips[u+1].start.em.value/65536+n.tabSkips[u+1].start.sp.value/65536/12+"em"),$(n.cellData[d][u].content,J,!1,Q,v),m.appendChild(v),v.firstElementChild.style.width="100%",v.firstElementChild.style.justifyContent=""}h.appendChild(m)}n.div.appendChild(h),mt.appendChild(n.div),n.div.renderedHeight=n.div.offsetHeight/ft/2+bt.fontDimen.heightOf("x",vt)/2,n.div.renderedDepth=n.div.offsetHeight/ft/2-bt.fontDimen.heightOf("x",vt)/2,mt.removeChild(n.div);break;case 10:return dt(11,t,i);case 11:"rule"==n.type&&(s=document.createElement("div"),a=Pe="100%",r="",s.style.background="currentColor",n.height&&((a=new xt(n.height)).em.value+=a.sp.value/65536/6*8/ft*65536,a=a.em.value/65536),n.depth&&((r=new xt(n.depth)).em.value+=r.sp.value/65536/6*8/ft*65536,r=r.em.value/65536),n.width&&((Pe=new xt(n.width)).em.value+=Pe.sp.value/65536/6*8/ft*65536,Pe=Pe.em.value/65536),"v"==n.ruleType?("100%"==a?(s.style.alignSelf="stretch",s.renderedDepth=s.renderedHeight=0):(s.style.height=Math.max(a+r,0)+"em",s.style.marginBottom=s.style.top=r+"em",s.style.marginTop=-r+"em",s.style.position="relative",s.renderedHeight=Math.max(a,0),s.renderedDepth=Math.max(r,0)),Pe<0?te.push({type:"kern",dimen:new xt(0,65536*Pe)}):s.style.width=Pe+"em"):"h"==n.ruleType&&(s.style.width="100%"==Pe?"100%":Pe+"em",s.style.height=Math.max(a+r,0)+"em",s.style.marginBottom=s.style.top=r+"em",s.style.marginTop=-r+"em",s.style.position="relative",te.push({type:"atom",atomType:0,nucleus:{},superscript:null,subscript:null,style:J,isLineBreak:!0,div:document.createElement("div")}),te[te.length-1].div.style.width="100%",ie.push(te[te.length-1])),c={type:"atom",atomType:0,nucleus:null,superscript:null,subscript:null,style:J,div:s,isLineBreak:"h"==n.ruleType,growHeight:"v"==n.ruleType},te.push(c),ie.push(c),"h"==n.ruleType&&(te.push({type:"atom",atomType:0,nucleus:null,superscript:null,subscript:null,isLineBreak:!0,div:document.createElement("div")}),te[te.length-1].div.style.width="100%",ie.push(te[te.length-1])))}}function m(e,t,i){var s,a,r=te[t],n=ie.indexOf(r);switch(e){case 1:return r.italicCorrection&&(r.dimen=new xt(0,65536*bt.fontDimen.italCorrOf(r.italicCorrection,vt))),"glue"==r.type&&"dimension"==r.glue.stretch.type&&0==r.glue.stretch.sp.value&&0==r.glue.stretch.em.value&&"dimension"==r.glue.shrink.type&&0==r.glue.shrink.sp.value&&0==r.glue.shrink.em.value&&(r.type="kern",r.dimen=r.glue.start),"vkern"==r.type&&(r.dimen.sp.value||r.dimen.em.value)?(d+=r.dimen.em.value,d+=r.dimen.sp.value/65536/6*8/ft*65536,p.push(document.createElement("div")),p.last().style.display="inline-flex",p.last().style.flexWrap="nowrap",p.last().style.alignItems="baseline",d&&(p.last().style.position="relative",p.last().style.marginTop=d/65536+"em",p.last().style.marginBottom=-d/65536+"em",p.last().style.top=-d/65536+"em",p.last().verticalRaise=d)):"kern"==r.type&&(r.dimen.sp.value||r.dimen.em.value)?(p.last().lastElementChild&&!p.last().lastElementChild.style.marginRight||((s=document.createElement("div")).style.display="inline-block",p.last().appendChild(s)),p.last().lastElementChild.style.marginRight=r.dimen.sp.value?r.dimen.em.value?"calc("+r.dimen.sp.value/65536+"pt + "+r.dimen.em.value/65536+"em)":r.dimen.sp.value/65536+"pt":r.dimen.em.value/65536+"em"):"glue"==r.type&&((a=document.createElement("div")).style.width=r.glue.start.sp.value?r.glue.start.em.value?"calc("+r.glue.start.sp.value/65536+"pt + "+r.glue.start.em.value/65536+"em)":r.glue.start.sp.value/65536+"pt":r.glue.start.em.value/65536+"em","infinite dimension"==r.glue.stretch.type?a.style.flexGrow=Math.pow(1290,r.glue.stretch.magnitude.value):(r.glue.stretch.sp.value||r.glue.stretch.em.value)&&(a.style.flexGrow=1,a.style.maxWidth="calc("+(r.glue.start.sp.value?r.glue.start.em.value?"("+r.glue.start.sp.value/65536+"pt + "+r.glue.start.em.value/65536+"em)":r.glue.start.sp.value/65536+"pt":r.glue.start.em.value/65536+"em")+" + "+(r.glue.stretch.sp.value?r.glue.stretch.em.value?"("+r.glue.stretch.sp.value/65536+"pt + "+r.glue.stretch.em.value/65536+"em)":r.glue.stretch.sp.value/65536+"pt":r.glue.stretch.em.value/65536+"em")+")"),"infinite dimension"==r.glue.shrink.type?a.style.flexShrink=Math.pow(1290,r.glue.shrink.magnitude.value):(r.glue.shrink.sp.value||r.glue.shrink.em.value)&&(a.style.flexShrink=1,a.style.minWidth="calc("+(r.glue.start.sp.value?r.glue.start.em.value?"("+r.glue.start.sp.value/65536+"pt + "+r.glue.start.em.value/65536+"em)":r.glue.start.sp.value/65536+"pt":r.glue.start.em.value/65536+"em")+" - "+(r.glue.shrink.sp.value?r.glue.shrink.em.value?"("+r.glue.shrink.sp.value/65536+"pt + "+r.glue.shrink.em.value/65536+"em)":r.glue.shrink.sp.value/65536+"pt":r.glue.shrink.em.value/65536+"em")+")"),p.push(a),p.push(document.createElement("div")),p.last().style.display="inline-flex",p.last().style.flexWrap="nowrap",p.last().style.alignItems="baseline",d&&(p.last().style.position="relative",p.last().style.marginTop=d/65536+"em",p.last().style.marginBottom=-d/65536+"em",p.last().style.top=-d/65536+"em",p.last().verticalRaise=d)),m(2,t,i);case 2:if("atom"!=r.type)return m(3,t,i);if(0!=n&&2==r.atomType&&("display"!=J&&"text"!=J||(p.push(document.createElement("div")),p.last().style.flexShrink=1,p.last().style.flexGrow=1,p.last().style.maxWidth=".3333333em",p.last().style.width=".2222222em"),p.push(document.createElement("div")),p.last().style.display="inline-flex",p.last().style.flexWrap="nowrap",p.last().style.alignItems="baseline",d&&(p.last().style.position="relative",p.last().style.marginTop=d/65536+"em",p.last().style.marginBottom=-d/65536+"em",p.last().style.top=-d/65536+"em",p.last().verticalRaise=d)),0!=n&&3==r.atomType&&("display"!=J&&"text"!=J||3==ie[n-1].atomType||4==ie[n-1].atomType||(p.push(document.createElement("div")),6==ie[n-1].atomType?p.last().style.width=".1666667em":(p.last().style.flexGrow=1,p.last().style.maxWidth=".5555555em",p.last().style.minWidth=".2777778em")),p.push(document.createElement("div")),p.last().style.display="inline-flex",p.last().style.flexWrap="nowrap",p.last().style.alignItems="baseline",d&&(p.last().style.position="relative",p.last().style.marginTop=d/65536+"em",p.last().style.marginBottom=-d/65536+"em",p.last().style.top=-d/65536+"em",p.last().verticalRaise=d)),0!=n){var l=ie[n-1].atomType,o=r.atomType,c={0:{0:0,1:1,2:0,3:0,4:0,5:0,6:0,7:0,inner:-1},1:{0:1,1:1,3:0,4:0,5:0,6:0,7:1,inner:-1},2:{0:-2,1:-2,4:-2,7:-2,inner:-2},3:{0:-3,1:-3,3:0,4:-3,5:0,6:0,7:-3,inner:-3},4:{0:0,1:0,3:0,4:0,5:0,6:0,7:0,inner:0},5:{0:0,1:1,2:0,3:0,4:0,5:0,6:0,7:0,inner:-1},6:{0:0,1:0,3:0,4:0,5:0,6:0,7:0,inner:0},7:{0:0,1:1,2:0,3:0,4:0,5:0,6:0,7:0,inner:-1},inner:{0:-1,1:1,2:0,3:0,4:-1,5:0,6:-1,7:-1,inner:-1}}["string"==typeof l&&"inner"!=l?0:l]["string"==typeof o&&"inner"!=o?0:o],h=document.createElement("div");switch(c<0&&(c="script"==r.style||"scriptscript"==r.style?0:-c),c){case 1:h.style.minWidth=".1666667em",h.style.maxWidth=".1666667em";break;case 2:h.style.width=".2222222em",h.style.maxWidth=".3333333em",h.style.flexGrow="1",h.style.flexShrink="1";break;case 3:h.style.minWidth=".2777778em",h.style.maxWidth=".5555555em",h.style.flexGrow="1"}c&&p.last().appendChild(h)}p.last().renderedHeight=Math.max(p.last().renderedHeight||0,r.div.renderedHeight),p.last().renderedDepth=Math.max(p.last().renderedDepth||0,r.div.renderedDepth),p.last().baseline+p.last().baselineOffset>r.div.baseline+r.div.baselineOffset?(p.last().baseline=p.last().baseline||0,p.last().baselineOffset=p.last().baselineOffset||0):(p.last().baseline=r.div.baseline,p.last().baselineOffset=r.div.baselineOffset),r.isLineBreak?(p.push(r.div),p.push(document.createElement("div")),p.last().style.display="inline-flex",p.last().style.flexWrap="nowrap",p.last().style.alignItems="baseline",d&&(p.last().style.position="relative",p.last().style.marginTop=d/65536+"em",p.last().style.marginBottom=-d/65536+"em",p.last().style.top=-d/65536+"em",p.last().verticalRaise=d)):r.growHeight?(p.push(document.createElement("div")),p.last().style.display="inline-flex",p.last().style.flexWrap="nowrap",p.last().style.alignItems="baseline",p.last().style.alignSelf="stretch",d&&(p.last().style.position="relative",p.last().style.marginTop=d/65536+"em",p.last().style.marginBottom=-d/65536+"em",p.last().style.top=-d/65536+"em",p.last().verticalRaise=d),p.last().appendChild(r.div),p.push(document.createElement("div")),p.last().style.display="inline-flex",p.last().style.flexWrap="nowrap",p.last().style.alignItems="baseline",d&&(p.last().style.position="relative",p.last().style.marginTop=d/65536+"em",p.last().style.marginBottom=-d/65536+"em",p.last().style.top=-d/65536+"em",p.last().verticalRaise=d)):p.last().appendChild(r.div),6==r.atomType&&("display"!=J&&"text"!=J||!ie[n+1]||3==ie[n+1].atomType||(p.push(document.createElement("div")),p.last().style.minWidth=".1666667em",p.last().style.maxWidth=".1666667em"),p.push(document.createElement("div")),p.last().style.display="inline-flex",p.last().style.flexWrap="nowrap",p.last().style.alignItems="baseline",d&&(p.last().style.position="relative",p.last().style.marginTop=d/65536+"em",p.last().style.marginBottom=-d/65536+"em",p.last().style.top=-d/65536+"em",p.last().verticalRaise=d))}}for(var n=0,l=p.length;n<l;n++)ee.appendChild(p[n]),ee.renderedHeight=Math.max(ee.renderedHeight||0,(p[n].renderedHeight||0)+(p[n].verticalRaise||0)/65536),ee.renderedDepth=Math.max(ee.renderedDepth||0,(p[n].renderedDepth||0)-(p[n].verticalRaise||0)/65536),ee.baselineOffset+ee.baseline>p[n].baselineOffset+p[n].baseline?(ee.baseline=ee.baseline||0,ee.baselineOffset=ee.baselineOffset||0):(ee.baseline=p[n].baseline,ee.baselineOffset=p[n].baselineOffset);e.appendChild(ee);e.renderedHeight=Math.max(e.renderedHeight||0,ee.renderedHeight);e.renderedDepth=Math.max(e.renderedDepth||0,ee.renderedDepth);e.baselineOffset+e.baseline>ee.baselineOffset+ee.baseline?(e.baseline=e.baseline||0,e.baselineOffset=e.baselineOffset||0):(e.baseline=ee.baseline,e.baselineOffset=ee.baselineOffset);return Z}(e,o,!1,"nm",t),t.firstElementChild.empty&&1==t.children.length&&(t=document.createTextNode("")),t}function x(e,t){this.name=e,this.type="primitive",this.function=t}function k(e,t){this.type="macro",e instanceof x||e instanceof k?(e.proxy&&(e=e.original),this.proxy=!0,this.isLet=!!t,this.original=e):(this.proxy=!1,this.replacement=e||[],this.parameters=t||[])}function G(e,t,i,s){this.type="integer",this.register=!0,this.message=s||"",e instanceof G?(this.value=e.value,this.parent=e,this.min=e.min,this.max=e.max):(this.min=null==t?-9007199254740991:t,this.max=null===i||void 0===t?9007199254740991:i,e=Math.round(e),isFinite(e)||(e=9007199254740991*Math.sign(e)),9007199254740991<e?e=e%9007199254740991-9007199254740991:e<-9007199254740991&&(e=9007199254740991+e%9007199254740991),this.value=isNaN(e)?0:Math.round(e))}function xt(e,t,i){this.type="dimension",this.message=i||"",this.register=!0,e instanceof xt?(this.sp=new G(e.sp),this.em=new G(e.em),this.message=t||"",this.parent=e):e instanceof V?(this.sp=new G(0),this.em=new G(e.mu/18),this.message=t||""):(this.sp=new G(e),this.em=new G(t))}function V(e,t){this.type="mu dimension",this.message=t||"",this.register=!0,e instanceof V?(this.mu=new G(e.mu),this.parent=e):this.mu=new G(e instanceof xt?e.em/18+e.sp/65536/12*18:e)}function _(e,t,i,s){this.type="glue",this.message=s||"",this.register=!0,e instanceof _?(this.start=new xt(e.start),this.stretch=new xt(e.stretch),this.shrink=new xt(e.shrink),this.parent=e):(this.start=new xt(e),this.stretch=t instanceof Y?t:new xt(t),this.shrink=i instanceof Y?i:new xt(i))}function $(e,t,i,s){this.type="mu glue",this.message=s||"",this.register=!0,e instanceof $?(this.start=new V(e.start),this.stretch=new V(e.stretch),this.shrink=new V(e.shrink),this.parent=e):(this.start=new V(e),this.stretch=t instanceof Y?t:new V(t),this.shrink=i instanceof Y?i:new V(i))}function Y(e,t,i){this.type="infinite dimension",this.message=i||"",this.register=!0,this.number=new G(e),this.magnitude=new G(t)}new MutationObserver(e).observe(document,{childList:!0,subtree:!0}),e(),bt.ParsedFontTeX=function(e,t){this.texString=e,this.parsedTokens=t},bt.ParsedFontTeX.prototype={renderIn:function(e){for(var t=y(e),i=this.parsedTokens.slice(),s=t.length-1;0<=s;s--){t[s].innerHTML="";var a,r,n=void 0;if(t[s].hasAttribute("data-fontTeX-container-id")?(a=+t[s].getAttribute("data-fontTeX-container-id"),n=b[a].styles,b[a].oldFontFamily=n.fontFamily,b[a].oldFontSize=n.fontSize,b[a].oldColor=n.color,b[a].parsedTeXInstance=this):(r=b.length,n=getComputedStyle(t[s]),t[s].setAttribute("data-fontTeX-container-id",r),b[r]={elem:t[s],styles:n,parsedTeXInstance:this,oldFontFamily:n.fontFamily,oldFontSize:n.fontSize,oldColor:n.oldColor}),wt.parsehtml[0]){for(var l,o="",c=[],h=0,p=i.length;h<p;h++){"string"==typeof i[h]?o+=i[h]:(l=uuidv4(),c.push([l,w(t[s],i[h][0],i[h][1],n)]),o+="<span data-fontTeX-uuid-"+l+"></span>")}var d=document.createElement("div");d.innerHTML=o;for(var m=!1,h=0,p=c.length;h<p;h++){var u=d.querySelector("[data-fontTeX-uuid-"+c[h][0]+"]");u?(u.parentNode.insertBefore(c[h][1],u),u.parentNode.removeChild(u)):m=!0}m&&console.warn("Malformed HTML was passed into `renderIn`. Some TeX couldn't be rendered.\nPassed in value: "+this.texString);for(h=0,p=d.childNodes.length;h<p;h++)t[s].appendChild(d.firstChild)}else{for(var f=document.createDocumentFragment(),v=0,g=i.length;v<g;v++)"string"==typeof i[v]?f.appendChild(document.createTextNode(i[v])):f.appendChild(w(t[s],i[v][0],i[v][1],n));t[s].appendChild(f)}t[s].setAttribute("data-fontTeX-input",this.texString),t[s].setAttribute("data-fontTeX-is-parsed","true")}},again:function(){return this.parsedTokens=bt.parse(this.texString).parsedTokens,this},reparse:function(){return this.parsedTokens=bt.parse(this.texString).parsedTokens,this},texString:"",parsedTokens:null},bt.format=function(e){var t=c(e+"$","inline",!0);for(var i in J.defs.macros={},J.defs.active={},J.registers.count={},J.registers.dimen={},J.registers.skip={},J.registers.muskip={},J.registers.named={},t.defs.macros)J.defs.macros[i]=t.defs.macros[i];for(var i in t.defs.active)J.defs.active[i]=t.defs.active[i];var s=[];for(var i in t.registers.count)J.registers.count[i]=new G(t.registers.count[i].value);for(var i in t.registers.dimen)J.registers.dimen[i]=new xt(t.registers.dimen[i].sp.value,t.registers.dimen[i].em.value);for(var i in t.registers.skip)J.registers.skip[i]=new _,J.registers.skip[i].start.sp.value=t.registers.skip[i].start.sp.value,J.registers.skip[i].start.em.value=t.registers.skip[i].start.em.value,"infinite dimension"==t.registers.skip[i].stretch.type?J.registers.skip[i].stretch=new Y(t.registers.skip[i].stretch.number.value,t.registers.skip[i].stretch.magnitude.value):J.registers.skip[i].stretch=new xt(t.registers.skip[i].stretch.sp.value,t.registers.skip[i].stretch.em.value),"infinite dimension"==t.registers.skip[i].shrink.type?J.registers.skip[i].shrink=new Y(t.registers.skip[i].shrink.number.value,t.registers.skip[i].shrink.magnitude.value):J.registers.skip[i].shrink=new xt(t.registers.skip[i].shrink.sp.value,t.registers.skip[i].shrink.em.value);for(var i in t.registers.muskip)J.registers.muskip[i]=new $,J.registers.muskip[i].start.mu.value=t.registers.muskip[i].start.mu.value,"infinite dimension"==t.registers.muskip[i].stretch.type?J.registers.muskip[i].stretch=new Y(t.registers.muskip[i].stretch.number.value,t.registers.muskip[i].stretch.magnitude.value):J.registers.muskip[i].stretch=new V(t.registers.muskip[i].stretch.mu.value),"infinite dimension"==t.registers.muskip[i].shrink.type?J.registers.muskip[i].shrink=new Y(t.registers.muskip[i].shrink.number.value,t.registers.muskip[i].shrink.magnitude.value):J.registers.muskip[i].shrink=new V(t.registers.muskip[i].shrink.mu.value);for(var i in t.registers.named)s.includes(t.registers.named[i])?J.registers.named[i]=t.registers.named[i]:"integer"==t.registers.named[i].type?J.registers.named[i]=new G(t.registers.named[i].value):"dimension"==t.registers.named[i].type?J.registers.named[i]=new xt(t.registers.named[i].sp.value,t.registers.named[i].em.value):"mu dimension"==t.registers.named[i].type?J.registers.named[i]=new V(t.registers.named[i].mu.value):"glue"==t.registers.named[i].type?(J.registers.named[i]=new _,J.registers.named[i].start.sp.value=t.registers.named[i].start.sp.value,J.registers.named[i].start.em.value=t.registers.named[i].start.em.value,"infinite dimension"==t.registers.named[i].stretch.type?J.registers.named[i].stretch=new Y(t.registers.named[i].stretch.number.value,t.registers.named[i].stretch.magnitude.value):J.registers.named[i].stretch=new xt(t.registers.named[i].stretch.sp.value,t.registers.named[i].stretch.em.value),"infinite dimension"==t.registers.named[i].shrink.type?J.registers.named[i].shrink=new Y(t.registers.named[i].shrink.number.value,t.registers.named[i].shrink.magnitude.value):J.registers.named[i].shrink=new xt(t.registers.named[i].shrink.sp.value,t.registers.named[i].shrink.em.value)):"mu glue"==t.registers.named[i].type&&(J.registers.named[i]=new $,J.registers.named[i].start.mu.value=t.registers.named[i].start.mu.value,"infinite dimension"==t.registers.named[i].stretch.type?J.registers.named[i].stretch=new Y(t.registers.named[i].stretch.number.value,t.registers.named[i].stretch.magnitude.value):J.registers.named[i].stretch=new V(t.registers.named[i].stretch.mu.value),"infinite dimension"==t.registers.named[i].shrink.type?J.registers.named[i].shrink=new Y(t.registers.named[i].shrink.number.value,t.registers.named[i].shrink.magnitude.value):J.registers.named[i].shrink=new V(t.registers.named[i].shrink.mu.value));for(var i in t.cats)J.cats[i].value=t.cats[i].value;for(var i in t.mathcodes)J.mathcodes[i].value=t.mathcodes[i].value;for(var i in t.uc)J.uc[i].value=t.uc[i].value;for(var i in t.lc)J.lc[i].value=t.lc[i].value};var J={defs:{primitive:{"(":new x("(",function(e){return this.invalid=!0,[this]}),")":new x(")",function(e){return"inline"==e.style?[{type:"character",char:"$",code:36,cat:J.cats.math}]:(this.invalid=!0,[this])}),"/":new x("/",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"kern",dimen:new xt(0),italicCorrection:!0}),[])}),"[":new x("[",function(e){return this.invalid=!0,[this]}),"]":new x("]",function(e){return"display"==e.style?[{type:"character",char:"$",code:36,cat:J.cats.math},{type:"character",char:"$",code:36,cat:J.cats.math}]:(this.invalid=!0,[this])}),above:new x("above",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("dimension");return t?(e.scopes.last().isFrac=!0,e.scopes.last().fracRightDelim=e.scopes.last().fracRightDelim=".",e.scopes.last().barWidth=t,e.scopes.last().root&&(e.scopes.last().root.invalid=!0,e.scopes.last().root=!1),e.scopes.last().fracNumerator=e.scopes.last().tokens,e.scopes.last().tokens=[],[]):(this.invalid=!0,[this])}),abovewithdelims:new x("abovewithdelims",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(i&&("command"==i.type||"character"==i.type&&i.cat==J.cats.active)){var s=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,s)}else{if(!i||"character"!=i.type||!J.delims.includes(i.code)||i.cat!=J.cats.all&&i.cat!=J.cats.letter)return this.invalid=!0,e.mouth.loadState(t),delete e.scopes.last().fracLeftDelim,[this];if(e.scopes.last().fracLeftDelim){e.scopes.last().fracRightDelim=i.char;break}e.scopes.last().fracLeftDelim=i.char}}var a=e.mouth.eat("dimension");return a?(e.scopes.last().isFrac=!0,e.scopes.last().barWidth=a,e.scopes.last().root&&(e.scopes.last().root.invalid=!0,e.scopes.last().root=!1),e.scopes.last().fracNumerator=e.scopes.last().tokens,e.scopes.last().tokens=[],[]):(this.invalid=!0,[this])}),accent:new x("accent",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("integer");return!i||i.value<0?(this.invalid=!0,e.mouth.loadState(t),[this]):(e.tokens.push({type:"accent modifier",char:String.fromCharCode(i.value),code:i.value,token:this}),[])}),advance:new x("advance",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=J.cats.active)){if(i&&i.register){var s=e.mouth.eat();if(!s||"character"!=s.type||"b"!=s.char&&"B"!=s.char||s.cat==J.cats.active){if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert()}else{var a=e.mouth.eat();a&&"character"==a.type&&("y"==a.char||"Y"==a.char)&&a.cat!=J.cats.active||e.mouth.revert(2)}if("integer"==i.type){if(!(s=e.mouth.eat("integer")))return this.invalid=!0,e.mouth.loadState(t),[this];i.value+=s.value;var r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).value=r.value;e.toggles.global=!1}else if("dimension"==i.type){if(!(s=e.mouth.eat("dimension")))return this.invalid=!0,e.mouth.loadState(t),[this];i.sp.value+=s.sp.value,i.em.value+=s.em.value;r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).sp.value=r.sp.value,i.em.value=r.em.value;e.toggles.global=!1}else if("mu dimension"==i.type){if(!(s=e.mouth.eat("mu dimension")))return this.invalid=!0,e.mouth.loadState(t),[this];i.mu.value+=s.mu.value;r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).mu.value=r.mu.value;e.toggles.global=!1}else if("glue"==i.type){if(!(s=e.mouth.eat("glue")))return this.invalid=!0,e.mouth.loadState(t),[this];i.start.sp.value+=s.start.sp.value,i.start.em.value+=s.start.em.value,"infinite dimension"==s.stretch.type?"infinite dimension"==i.stretch.type&&i.stretch.magnitude.value==s.stretch.magnitude.value?i.stretch.value+=s.stretch.value:("infinite dimension"!=i.stretch.type||i.stretch.magnitude.value<s.stretch.magnitude.value)&&(i.stretch=new Y(s.stretch.number.value,s.stretch.magnitude.value)):"infinite dimension"!=i.stretch.type&&(i.stretch.sp.value+=s.stretch.sp.value,i.stretch.em.value+=s.stretch.em.value),"infinite dimension"==s.shrink.type?"infinite dimension"==i.shrink.type&&i.shrink.magnitude.value==s.shrink.magnitude.value?i.shrink.value+=s.shrink.value:("infinite dimension"!=i.shrink.type||i.shrink.magnitude.value<s.shrink.magnitude.value)&&(i.shrink=new Y(s.shrink.number.value,s.shrink.magnitude.value)):"infinite dimension"!=i.shrink.type&&(i.shrink.sp.value+=s.shrink.sp.value,i.shrink.em.value+=s.shrink.em.value);r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.sp.value+=s.start.sp.value,i.start.em.value+=s.start.em.value,"infinite dimension"==r.stretch.type?i.stretch=new Y(r.stretch.number.value,r.stretch.magnitude.value):i.stretch=new xt(r.stretch.sp.value,r.stretch.em.value),"infinite dimension"==r.shrink.type?i.shrink=new Y(r.shrink.number.value,r.shrink.magnitude.value):i.shrink=new xt(r.shrink.sp.value,r.shrink.em.value);e.toggles.global=!1}else if("mu glue"==i.type){if(!(s=e.mouth.eat("mu glue")))return this.invalid=!0,e.mouth.loadState(t),[this];i.start.mu.value+=s.start.mu.value,"infinite dimension"==s.stretch.type?"infinite dimension"==i.stretch.type&&i.stretch.magnitude.value==s.stretch.magnitude.value?i.stretch.value+=s.stretch.value:("infinite dimension"!=i.stretch.type||i.stretch.magnitude.value<s.stretch.magnitude.value)&&(i.stretch=new Y(s.stretch.number.value,s.stretch.magnitude.value)):"infinite dimension"!=i.stretch.type&&(i.stretch.mu.value+=s.stretch.mu.value),"infinite dimension"==s.shrink.type?"infinite dimension"==i.shrink.type&&i.shrink.magnitude.value==s.shrink.magnitude.value?i.shrink.value+=s.shrink.value:("infinite dimension"!=i.shrink.type||i.shrink.magnitude.value<s.shrink.magnitude.value)&&(i.shrink=new Y(s.shrink.number.value,s.shrink.magnitude.value)):"infinite dimension"!=i.shrink.type&&(i.shrink.mu.value+=s.shrink.mu.value);r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.mu.value=r.start.mu.value,"infinite dimension"==r.stretch.type?i.stretch=new Y(r.stretch.number.value,r.stretch.magnitude.value):i.stretch=new V(r.stretch.mu.value),"infinite dimension"==r.shrink.type?i.shrink=new Y(r.shrink.number.value,r.shrink.magnitude.value):i.stretch=new V(r.shrink.mu.value);e.toggles.global=!1}break}return this.invalid=!0,e.mouth.loadState(t),[this]}var n=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,n)}return[]}),atop:new x("atop",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.scopes.last().isFrac=!0,e.scopes.last().fracLeftDelim=e.scopes.last().fracRightDelim=".",e.scopes.last().barWidth=new xt(0),e.scopes.last().root&&(e.scopes.last().root.invalid=!0,e.scopes.last().root=!1),e.scopes.last().fracNumerator=e.scopes.last().tokens,e.scopes.last().tokens=[],[])}),atopwithdelims:new x("atopwithdelims",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(i&&("command"==i.type||"character"==i.type&&i.cat==J.cats.active)){var s=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,s)}else{if(!i||"character"!=i.type||!J.delims.includes(i.code)||i.cat!=J.cats.all&&i.cat!=J.cats.letter)return this.invalid=!0,e.mouth.loadState(t),delete e.scopes.last().fracLeftDelim,[this];if(e.scopes.last().fracLeftDelim){e.scopes.last().fracRightDelim=i.char;break}e.scopes.last().fracLeftDelim=i.char}}return e.scopes.last().isFrac=!0,e.scopes.last().barWidth=new xt(0),e.scopes.last().root&&(e.scopes.last().root.invalid=!0,e.scopes.last().root=!1),e.scopes.last().fracNumerator=e.scopes.last().tokens,e.scopes.last().tokens=[],[]}),begingroup:new x("begingroup",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),new e.Scope,e.scopes.last().semisimple=!0,e.openGroups.push(this),e.contexts.push("scope"),this.ignore=!0,e.scopes.last().tokens.push(this),[]}),bf:new x("bf",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"bf"}),[])}),catcode:new x("catcode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");if(t){if(t.value<0)return e.mouth.revert(),this.invalid=!0,[this];if(!(t.value in J.cats)){J.cats[t.value]=new G(J.cats.all,0,15);for(var i=0,s=e.scopes.length;i<s;i++)e.scopes[i].cats[t.value]=new G((0==i?J:e.scopes[i-1]).cats[t.value])}return[e.scopes.last().cats[t.value]]}return this.invalid=!0,[this]}),char:new x("char",function(e){var t=e.mouth.eat("integer");return!t||t.value<0?(this.invalid=!0,[this]):(e.mouth.queue.unshift({type:"character",cat:J.cats.all,char:String.fromCharCode(t.value),code:t.value}),[])}),chardef:new x("chardef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||"command"!=i.type)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i.name in J.defs.primitive||i.name in J.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var s=e.mouth.eat();s&&"character"==s.type&&"="==s.char&&s.cat==J.cats.all||s&&e.mouth.revert();var a=e.mouth.eat("integer");if(!a||a.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];var r=new k([{type:"character",cat:J.cats.all,char:String.fromCharCode(a.value),code:a.value}],[]);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){J.defs.macros[i.name]=r,delete J.registers.named[i.name];for(var n=0,l=e.scopes.length;n<l;n++)e.scopes[n].defs.macros[i.name]=r,delete e.scopes[n].registers.named[i.name]}else e.scopes.last().defs.macros[i.name]=r,delete e.scopes.last().registers.named[i.name];e.toggles.global=!1}),count:new x("count",function(e){var t=e.mouth.eat("integer");if(!t||t.value<0)return this.invalid=!0,[this];if(!J.registers.count[t.value]){J.registers.count[t.value]=new G(0);for(var i=0,s=e.scopes.length;i<s;i++)e.scopes[i].registers.count[t.value]=new G((i?e.scopes[i-1]:J).registers.count[t.value])}return[e.scopes.last().registers.count[t.value]]}),countdef:new x("countdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if("command"!=i.type)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i.name in J.defs.primitive||i.name in J.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var s=e.mouth.eat();s&&"character"==s.type&&"="==s.char&&s.cat==J.cats.all||s&&e.mouth.revert();var a=e.mouth.eat("integer");if(!a||a.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i=i.name,a=a.value,!J.registers.count[a]){J.registers.count[a]=new G(0);for(var r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.count[a]=new G((r?e.scopes[r-1]:J).registers.count[a])}if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){J.registers.named[i]=J.registers.count[a],delete J.defs.macros[i];for(r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.named[i]=e.scopes[r].registers.count[a],delete e.scopes[r].defs.macros[i]}else e.scopes.last().registers.named[i]=e.scopes.last().registers.count[a],delete e.scopes.last().defs.macros[i]}),cr:new x("cr",function(e){if("scope"!=e.contexts.last)return this.invalid=!0,[this];for(var t=!1,i=e.scopes.length-1;0<=i;i--)if(e.scopes[i].isHalign||e.scopes[i].isHalignCell){t=e.scopes[i];break}if(!t)return this.invalid=!0,[this];var s=t.isHalign?t:t.parentScope;if((h=t.isHalign?null:s.cellData[s.cellData.length-1])&&h[h.length-1].omit&&(this.postPreamble=!0),this.postPreamble&&!e.scopes.last().isHalign&&!e.scopes.last().isHalignCell)return this.invalid=!0,[this];if(t.isHalignCell){if(!this.postPreamble){for(var a=-1,i=0,r=h.length;i<r;i++)a+=h[i].span;if(s.preamble[a])p=s.preamble[a][1];else{if(!~s.repeatPreambleAt)return this.invalid=!0,[this];var n=s.preamble.slice(s.repeatPreambleAt,s.preamble.length);p=n[(a-s.repeatPreambleAt)%n.length][1]}for(var l=[],i=0,r=p.length;i<r;i++){var o={};for(var c in p[i])o[c]=p[i][c];l.push(o)}return this.postPreamble=!0,l.concat(this)}e.scopes.last().root&&(e.scopes.last().root.invalid=!0),e.contexts.pop();var h,p=e.scopes.last().tokens;e.scopes.last().isFrac?(h[h.length-1].content.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:e.scopes.last().fracNumerator,denominator:p,barWidth:e.scopes.last().barWidth,delims:[e.scopes.last().fracLeftDelim,e.scopes.last().fracRightDelim],nullDelimiterSpace:new xt(e.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),e.scopes.pop()):(e.scopes.pop(),(h=e.scopes.last().cellData[e.scopes.last().cellData.length-1])[h.length-1].content=h[h.length-1].content.concat(p))}var d=Symbol(),m=!1;for(e.mouth.saveState(d);;){if(!(o=e.mouth.eat())){e.mouth.loadState(d),e.scopes.last().noAligns.push(null);break}if("character"==o.type&&o.cat!=J.cats.active){e.mouth.loadState(d),e.scopes.last().noAligns.push(null);break}if("command"==o.type||"character"==o.type&&o.cat==J.cats.active){if(o.name in e.scopes.last().registers.named){e.mouth.loadState(d),e.scopes.last().noAligns.push(null);break}if(!(b="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char])){e.mouth.loadState(d),e.scopes.last().noAligns.push(null);break}if(b===J.defs.primitive.the||b.proxy&&b.original===J.defs.primitive.the||b===J.defs.primitive.expandafter||b.proxy&&b.original===J.defs.primitive.expandafter||b===J.defs.primitive.number||b.proxy&&b.original===J.defs.primitive.number||b===J.defs.primitive.romannumeral||b.proxy&&b.original===J.defs.primitive.romannumeral||b===J.defs.primitive.csname||b.proxy&&b.original===J.defs.primitive.csname||b===J.defs.primitive.string||b.proxy&&b.original===J.defs.primitive.string||b===J.defs.primitive.if||b.isLet&&b.original===J.defs.primitive.if||b===J.defs.primitive.ifcase||b.isLet&&b.original===J.defs.primitive.ifcase||b===J.defs.primitive.ifcat||b.isLet&&b.original===J.defs.primitive.ifcat||b===J.defs.primitive.ifdim||b.isLet&&b.original===J.defs.primitive.ifdim||b===J.defs.primitive.ifeof||b.isLet&&b.original===J.defs.primitive.ifeof||b===J.defs.primitive.iffalse||b.isLet&&b.original===J.defs.primitive.iffalse||b===J.defs.primitive.ifodd||b.isLet&&b.original===J.defs.primitive.ifodd||b===J.defs.primitive.ifnum||b.isLet&&b.original===J.defs.primitive.ifnum||b===J.defs.primitive.ifhmode||b.isLet&&b.original===J.defs.primitive.ifhmode||b===J.defs.primitive.ifinner||b.isLet&&b.original===J.defs.primitive.ifinner||b===J.defs.primitive.ifmmode||b.isLet&&b.original===J.defs.primitive.ifmmode||b===J.defs.primitive.iftrue||b.isLet&&b.original===J.defs.primitive.iftrue||b===J.defs.primitive.ifvmode||b.isLet&&b.original===J.defs.primitive.ifvmode||b===J.defs.primitive.ifvoid||b.isLet&&b.original===J.defs.primitive.ifvoid||b===J.defs.primitive.ifx||b.isLet&&b.original===J.defs.primitive.ifx){if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]===o&&o.invalid){e.mouth.loadState(d),e.scopes.last().noAligns.push(null);break}e.mouth.queue.unshift.apply(e.mouth.queue,w);continue}if(b===J.defs.primitive.noalign||b.proxy&&b.original===J.defs.primitive.noalign){e.mouth.preview().cat!=J.cats.open?(e.mouth.loadState(d),e.scopes.last().noAligns.push(null)):m=!0;break}if("primitive"==b.type||b.proxy&&"primitive"==b.original.type){e.mouth.loadState(d),e.scopes.last().noAligns.push(null);break}if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]==-o&&o.invalid){e.mouth.loadState(d),e.scopes.last().noAligns.push(null);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}}var u=Symbol();for(e.mouth.saveState(u);;){if(!(o=e.mouth.eat())){e.mouth.loadState(u);break}if("character"==o.type&&o.cat!=J.cats.active){e.mouth.loadState(u);break}if("command"==o.type||"character"==o.type&&o.cat==J.cats.active){if(o.name in e.scopes.last().registers.named){e.mouth.loadState(u);break}if(!(b="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char])){e.mouth.loadState(u);break}if(b===J.defs.primitive.the||b.proxy&&b.original===J.defs.primitive.the||b===J.defs.primitive.expandafter||b.proxy&&b.original===J.defs.primitive.expandafter||b===J.defs.primitive.number||b.proxy&&b.original===J.defs.primitive.number||b===J.defs.primitive.romannumeral||b.proxy&&b.original===J.defs.primitive.romannumeral||b===J.defs.primitive.csname||b.proxy&&b.original===J.defs.primitive.csname||b===J.defs.primitive.string||b.proxy&&b.original===J.defs.primitive.string||b===J.defs.primitive.if||b.isLet&&b.original===J.defs.primitive.if||b===J.defs.primitive.ifcase||b.isLet&&b.original===J.defs.primitive.ifcase||b===J.defs.primitive.ifcat||b.isLet&&b.original===J.defs.primitive.ifcat||b===J.defs.primitive.ifdim||b.isLet&&b.original===J.defs.primitive.ifdim||b===J.defs.primitive.ifeof||b.isLet&&b.original===J.defs.primitive.ifeof||b===J.defs.primitive.iffalse||b.isLet&&b.original===J.defs.primitive.iffalse||b===J.defs.primitive.ifodd||b.isLet&&b.original===J.defs.primitive.ifodd||b===J.defs.primitive.ifnum||b.isLet&&b.original===J.defs.primitive.ifnum||b===J.defs.primitive.ifhmode||b.isLet&&b.original===J.defs.primitive.ifhmode||b===J.defs.primitive.ifinner||b.isLet&&b.original===J.defs.primitive.ifinner||b===J.defs.primitive.ifmmode||b.isLet&&b.original===J.defs.primitive.ifmmode||b===J.defs.primitive.iftrue||b.isLet&&b.original===J.defs.primitive.iftrue||b===J.defs.primitive.ifvmode||b.isLet&&b.original===J.defs.primitive.ifvmode||b===J.defs.primitive.ifvoid||b.isLet&&b.original===J.defs.primitive.ifvoid||b===J.defs.primitive.ifx||b.isLet&&b.original===J.defs.primitive.ifx){if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]===o&&o.invalid){e.mouth.loadState(u);break}e.mouth.queue.unshift.apply(e.mouth.queue,w);continue}if(b===J.defs.primitive.crcr||b.proxy&&b.original===J.defs.primitive.crcr)break;if("primitive"==b.type||b.proxy&&"primitive"==b.original.type){e.mouth.loadState(u);break}if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]==-o&&o.invalid){e.mouth.loadState(u);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}}var f=Symbol();for(e.mouth.saveState(f);;){if(!(o=e.mouth.eat())){e.mouth.loadState(f);break}if("character"==o.type&&o.cat==J.cats.close){if(~(s=e.scopes.last()).repeatPreambleAt)for(var v=Math.max.apply(Math,s.cellData.map(function(e){for(var t=0,i=0,s=e.length;i<s;i++)t+=e[i].span;return t})),g=s.tabSkips.slice(s.repeatPreambleAt+1,s.tabSkips.length),y=0;s.tabSkips.length<v+1;)s.tabSkips.push(g[y]),y=(y+1)%g.length;return e.scopes.pop(),e.scopes.last().tokens.push({type:"atom",atomType:"inner",nucleus:[{type:"table",cellData:s.cellData,tabSkips:s.tabSkips,noAligns:s.noAligns}],superscript:null,subscript:null}),[]}if("character"==o.type&&o.cat!=J.cats.active){e.mouth.loadState(f);break}if("command"==o.type||"character"==o.type&&o.cat==J.cats.active){if(o.name in e.scopes.last().registers.named){e.mouth.loadState(f);break}if(!(b="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char])){e.mouth.loadState(f);break}if(b===J.defs.primitive.the||b.proxy&&b.original===J.defs.primitive.the||b===J.defs.primitive.expandafter||b.proxy&&b.original===J.defs.primitive.expandafter||b===J.defs.primitive.number||b.proxy&&b.original===J.defs.primitive.number||b===J.defs.primitive.romannumeral||b.proxy&&b.original===J.defs.primitive.romannumeral||b===J.defs.primitive.csname||b.proxy&&b.original===J.defs.primitive.csname||b===J.defs.primitive.string||b.proxy&&b.original===J.defs.primitive.string||b===J.defs.primitive.if||b.isLet&&b.original===J.defs.primitive.if||b===J.defs.primitive.ifcase||b.isLet&&b.original===J.defs.primitive.ifcase||b===J.defs.primitive.ifcat||b.isLet&&b.original===J.defs.primitive.ifcat||b===J.defs.primitive.ifdim||b.isLet&&b.original===J.defs.primitive.ifdim||b===J.defs.primitive.ifeof||b.isLet&&b.original===J.defs.primitive.ifeof||b===J.defs.primitive.iffalse||b.isLet&&b.original===J.defs.primitive.iffalse||b===J.defs.primitive.ifodd||b.isLet&&b.original===J.defs.primitive.ifodd||b===J.defs.primitive.ifnum||b.isLet&&b.original===J.defs.primitive.ifnum||b===J.defs.primitive.ifhmode||b.isLet&&b.original===J.defs.primitive.ifhmode||b===J.defs.primitive.ifinner||b.isLet&&b.original===J.defs.primitive.ifinner||b===J.defs.primitive.ifmmode||b.isLet&&b.original===J.defs.primitive.ifmmode||b===J.defs.primitive.iftrue||b.isLet&&b.original===J.defs.primitive.iftrue||b===J.defs.primitive.ifvmode||b.isLet&&b.original===J.defs.primitive.ifvmode||b===J.defs.primitive.ifvoid||b.isLet&&b.original===J.defs.primitive.ifvoid||b===J.defs.primitive.ifx||b.isLet&&b.original===J.defs.primitive.ifx){if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]===o&&o.invalid){e.mouth.loadState(f);break}e.mouth.queue.unshift.apply(e.mouth.queue,w);continue}if("primitive"==b.type||b.proxy&&"primitive"==b.original.type){e.mouth.loadState(f);break}if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]==-o&&o.invalid){e.mouth.loadState(f);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}}var b,w,x=Symbol();for(e.mouth.saveState(x),e.scopes.last().cellData.push([{type:"cell",content:[],omit:!1,span:1}]);;){if(!(o=e.mouth.eat())){e.mouth.loadState(x);break}if("character"==o.type&&o.cat!=J.cats.active){e.mouth.loadState(x);break}if("command"==o.type||"character"==o.type&&o.cat==J.cats.active){if(o.name in e.scopes.last().registers.named){e.mouth.loadState(x);break}if(!(b="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char])){e.mouth.loadState(x);break}if(b===J.defs.primitive.the||b.proxy&&b.original===J.defs.primitive.the||b===J.defs.primitive.expandafter||b.proxy&&b.original===J.defs.primitive.expandafter||b===J.defs.primitive.number||b.proxy&&b.original===J.defs.primitive.number||b===J.defs.primitive.romannumeral||b.proxy&&b.original===J.defs.primitive.romannumeral||b===J.defs.primitive.csname||b.proxy&&b.original===J.defs.primitive.csname||b===J.defs.primitive.string||b.proxy&&b.original===J.defs.primitive.string||b===J.defs.primitive.if||b.isLet&&b.original===J.defs.primitive.if||b===J.defs.primitive.ifcase||b.isLet&&b.original===J.defs.primitive.ifcase||b===J.defs.primitive.ifcat||b.isLet&&b.original===J.defs.primitive.ifcat||b===J.defs.primitive.ifdim||b.isLet&&b.original===J.defs.primitive.ifdim||b===J.defs.primitive.ifeof||b.isLet&&b.original===J.defs.primitive.ifeof||b===J.defs.primitive.iffalse||b.isLet&&b.original===J.defs.primitive.iffalse||b===J.defs.primitive.ifodd||b.isLet&&b.original===J.defs.primitive.ifodd||b===J.defs.primitive.ifnum||b.isLet&&b.original===J.defs.primitive.ifnum||b===J.defs.primitive.ifhmode||b.isLet&&b.original===J.defs.primitive.ifhmode||b===J.defs.primitive.ifinner||b.isLet&&b.original===J.defs.primitive.ifinner||b===J.defs.primitive.ifmmode||b.isLet&&b.original===J.defs.primitive.ifmmode||b===J.defs.primitive.iftrue||b.isLet&&b.original===J.defs.primitive.iftrue||b===J.defs.primitive.ifvmode||b.isLet&&b.original===J.defs.primitive.ifvmode||b===J.defs.primitive.ifvoid||b.isLet&&b.original===J.defs.primitive.ifvoid||b===J.defs.primitive.ifx||b.isLet&&b.original===J.defs.primitive.ifx){if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]===o&&o.invalid){e.mouth.loadState(x);break}e.mouth.queue.unshift.apply(e.mouth.queue,w);continue}if(b===J.defs.primitive.omit||b.proxy&&b.original===J.defs.primitive.omit){e.scopes.last().cellData[e.scopes.last().cellData.length-1][0].omit=!0;break}if("primitive"==b.type||b.proxy&&"primitive"==b.original.type){e.mouth.loadState(x);break}if(1==(w=e.mouth.expand(o,e.mouth)).length&&w[0]==-o&&o.invalid){e.mouth.loadState(x);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}}s=e.scopes.last();if(e.contexts.push("scope"),new e.Scope,e.scopes.last().isHalignCell=!0,e.scopes.last().noAligned=m,s.cellData[s.cellData.length-1][0].omit)return[];for(l=[],i=0,r=(p=s.preamble[0][0]).length;i<r;i++){o={};for(var c in p[i])o[c]=p[i][c];l.push(o)}return l}),crcr:new x("crcr",null),csname:new x("csname",function(e){var t=Symbol();e.mouth.saveState(t);for(var i=[];;){var s=e.mouth.eat("pre space");if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];if(0!=i.length||s.cat!=J.cats.whitespace)if("command"==s.type||"character"==s.type&&s.cat==J.cats.active){if(s.name in e.scopes.last().registers.named)return this.invalid=!0,e.mouth.loadState(t),[this];var a,r="command"==s.type?e.scopes.last().defs.primitive[s.name]||e.scopes.last().defs.macros[s.name]:e.scopes.last().defs.active[s.char];if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if(r.proxy&&(r=r.original),r===J.defs.primitive.endcsname)break;if(r===J.defs.primitive.the||r===J.defs.primitive.expandafter||r===J.defs.primitive.number||r===J.defs.primitive.romannumeral||r===J.defs.primitive.csname||r===J.defs.primitive.string||r===J.defs.primitive.if||r===J.defs.primitive.ifcase||r===J.defs.primitive.ifcat||r===J.defs.primitive.ifdim||r===J.defs.primitive.ifeof||r===J.defs.primitive.iffalse||r===J.defs.primitive.ifodd||r===J.defs.primitive.ifnum||r===J.defs.primitive.ifhmode||r===J.defs.primitive.ifinner||r===J.defs.primitive.ifmmode||r===J.defs.primitive.iftrue||r===J.defs.primitive.ifvmode||r===J.defs.primitive.ifvoid||r===J.defs.primitive.ifx){if(1==(a=e.mouth.expand(s,e.mouth)).length&&a[0]===s&&a[0].invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,a);continue}if(r instanceof x)return this.invalid=!0,e.mouth.loadState(t),[this];if(1==(a=e.mouth.expand(s,e.mouth)).length&&a[0]===s&&a[0].invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,a)}else i.push(s)}return[{type:"command",nameType:"command",escapeChar:String.fromCharCode(e.scopes.last().registers.named.escapechar.value),name:i.map(function(e){return e.char}).join("")}]}),day:new x("day",function(e){return[new G((new Date).getDate())]}),def:new x("def",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,s=e.mouth.eat();if(!s)return this.invalid=!0,[this];if("character"==s.type){if(e.catOf(s.char)!=J.cats.active)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",s=s.char}else if("command"==s.type&&(i="macro",(s=s.name)in e.scopes.last().defs.primitive||s in J.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];for(var a=[],r=0,n=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if(o.cat==J.cats.open){e.mouth.revert();break}if(o.cat==J.cats.param){var l=e.mouth.eat("pre space");if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.cat==J.cats.open)n=!0,e.mouth.revert(),a.push({type:"character",cat:J.cats.open,char:l.char,code:l.code});else{if(!(48<l.code&&l.code<58&&l.cat==J.cats.all&&+l.char==r+1))return this.invalid=!0,e.mouth.loadState(t),[this];a.push(o),r++}}else a.push(o)}for(var o,c=0,h=[],p=!1;;){if(!(o=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=o.type||o.cat!=J.cats.param||p)if("character"==o.type&&o.cat==J.cats.open)c++;else if("character"==o.type&&o.cat==J.cats.close){if(0==--c)break}else p=p&&!1;else{var d=e.mouth.eat("pre space");if(!d||!(d.cat==J.cats.param||d.cat==J.cats.all&&d.char<=a.length&&1<=d.char))return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert(),d.cat==J.cats.param&&(p=!0)}h.push(o)}h.shift(),n&&h.push(a[a.length-1]);var m=new k(h,a);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)if("macro"==i){J.defs.macros[s]=m,delete J.registers.named[s];for(var u=0,f=e.scopes.length;u<f;u++)e.scopes[u].defs.macros[s]=m,delete e.scopes[u].registers[s]}else{J.defs.active[s]=m,delete J.registers.named[s];for(u=0,f=e.scopes.length;u<f;u++)e.scopes[u].defs.ative[s]=m,delete e.scopes[u].registers[s]}else e.scopes.last().defs["macro"==i?"macros":"active"][s]=m,delete e.scopes.last().registers.named[s];return e.toggles.global=!1,[]}),dimen:new x("dimen",function(e){var t=e.mouth.eat("integer");if(!t||t.value<0)return this.invalid=!0,[this];if(!J.registers.dimen[t.value]){J.registers.dimen[t.value]=new xt(0,0);for(var i=0,s=e.scopes.length;i<s;i++)e.scopes[i].registers.dimen[t.value]=new xt((i?e.scopes[i-1]:J).registers.dimen[t.value])}return[e.scopes.last().registers.dimen[t.value]]}),dimendef:new x("dimendef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if("command"!=i.type)return this.invalid=!0,e.mouth.loadState(countDefSym),[!0];if(i.name in J.defs.primitive||i.name in J.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var s=e.mouth.eat();s&&"character"==s.type&&"="==s.char&&s.cat==J.cats.all||s&&e.mouth.revert();var a=e.mouth.eat("integer");if(!a||a.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i=i.name,a=a.value,!J.registers.dimen[a]){J.registers.dimen[a]=new xt(0,0);for(var r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.dimen[a]=new xt((r?e.scopes[r-1]:J).registers.dimen[a])}if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){J.registers.named[i]=J.registers.dimen[a],delete J.defs.macros[i];for(r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.named[i]=e.scopes[r].registers.dimen[a],delete e.scopes[r].defs.macros[i]}else e.scopes.last().registers.named[i]=e.scopes.last().registers.dimen[a],delete e.scopes.last().defs.macros[i]}),displaylimits:new x("displaylimits",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"limit modifier",value:"display",token:this}),[])}),displaystyle:new x("displaystyle",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"displaystyle"}),[])}),divide:new x("divide",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=J.cats.active)){if(i&&i.register){if(i&&i.register){var s=e.mouth.eat();if(!s||"character"!=s.type||"b"!=s.char&&"B"!=s.char||s.cat==J.cats.active){if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert()}else{var a=e.mouth.eat();a&&"character"==a.type&&("y"==a.char||"Y"==a.char)&&a.cat!=J.cats.active||e.mouth.revert(2)}var r=e.mouth.eat("integer");if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if("integer"==i.type){i.value=~~(i.value/r.value);var n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).value=n.value;e.toggles.global=!1}else if("dimension"==i.type){i.sp.value=~~(i.sp.value/r.value),i.em.value=~~(i.em.value/r.value);n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).sp.value=n.sp.value,i.em.value=n.em.value;e.toggles.global=!1}else if("mu dimension"==i.type){i.mu.value=~~(i.mu.value/r.value);n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).mu.value=n.mu.value;e.toggles.global=!1}else if("glue"==i.type){i.start.sp.value=~~(i.start.sp.value/r.value),i.start.em.value=~~(i.start.em.value/r.value),"infinite dimension"==i.stretch.type?i.stretch.number.value=~~(i.stretch.number.value/r.value):(i.stretch.sp.value=~~(i.stretch.sp.value/r.value),i.stretch.em.value=~~(i.stretch.em.value/r.value)),"infinite dimension"==i.shrink.type?i.shrink.number.value=~~(i.shrink.number.value/r.value):(i.shrink.sp.value=~~(i.shrink.sp.value/r.value),i.shrink.em.value=~~(i.shrink.em.value/r.value));n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.sp.value=n.start.sp.value,i.start.em.value=n.start.em.value,"infinite dimension"==n.stretch.type?i.stretch=new Y(n.stretch.number.value,n.stretch.magnitude.value):i.stretch=new xt(n.stretch.sp.value,n.stretch.em.value),"infinite dimension"==n.shrink.type?i.shrink=new Y(n.shrink.number.value,n.shrink.magnitude.value):i.shrink=new xt(n.shrink.sp.value,n.shrink.em.value);e.toggles.global=!1}else if("mu glue"==i.type){i.start.mu.value=~~(i.start.mu.value/r.value),"infinite dimension"==i.stretch.type?i.stretch.number.value=~~(i.stretch.number.value/r.value):i.stretch.mu.value=~~(i.stretch.mu.value/r.value),"infinite dimension"==i.shrink.type?i.shrink.number.value=~~(i.shrink.number.value/r.value):i.shrink.mu.value=~~(i.shrink.mu.value/r.value);n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.mu.value=n.start.mu.value,"infinite dimension"==n.stretch.type?i.stretch=new Y(n.stretch.number.value,n.stretch.magnitude.value):i.stretch=new V(n.stretch.mu.value),"infinite dimension"==n.shrink.type?i.shrink=new Y(n.shrink.number.value,n.shrink.magnitude.value):i.shrink=new V(n.shrink.mu.value);e.toggles.global=!1}break}return this.invalid=!0,e.mouth.loadState(t),[this]}return this.invalid=!0,e.mouth.loadState(t),[this]}var l=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,l)}return[]}),edef:new x("edef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,s=e.mouth.eat();if(!s)return this.invalid=!0,[this];if("character"==s.type){if(e.catOf(s.char)!=J.cats.active)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",s=s.char}else if("command"==s.type&&(i="macro",(s=s.name)in e.scopes.last().defs.primitive||s in J.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];for(var a=[],r=0,n=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if(o.cat==J.cats.open){e.mouth.revert();break}if(o.cat==J.cats.param){var l=e.mouth.eat("pre space");if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.cat==J.cats.open)n=!0,e.mouth.revert(),a.push({type:"character",cat:J.cats.open,char:l.char,code:l.code});else{if(!(48<l.code&&l.code<58&&l.cat==J.cats.all&&+l.char==r+1))return this.invalid=!0,e.mouth.loadState(t),[this];a.push(o),r++}}else a.push(o)}for(var o,c=0,h=[],p=!1,d=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=o.type||o.cat!=J.cats.param||d)if("character"==o.type&&o.cat==J.cats.open)c++,h.push(o),p=!1;else if("character"==o.type&&o.cat==J.cats.close){if(0==--c)break;h.push(o),p=!1}else if(p)h.push(o),p=!1;else if("command"==o.type||"character"==o.type&&o.cat==J.cats.active){if(o.name in e.scopes.last().registers.named){h.push(o);continue}if(!(f="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char]))return this.invalid=!0,e.mouth.loadState(t),[this];if(f===J.defs.primitive.the||f.proxy&&f.original===J.defs.primitive.the||f===J.defs.primitive.expandafter||f.proxy&&f.original===J.defs.primitive.expandafter||f===J.defs.primitive.number||f.proxy&&f.original===J.defs.primitive.number||f===J.defs.primitive.romannumeral||f.proxy&&f.original===J.defs.primitive.romannumeral||f===J.defs.primitive.csname||f.proxy&&f.original===J.defs.primitive.csname||f===J.defs.primitive.string||f.proxy&&f.original===J.defs.primitive.string||f===J.defs.primitive.if||f.isLet&&f.original===J.defs.primitive.if||f===J.defs.primitive.ifcase||f.isLet&&f.original===J.defs.primitive.ifcase||f===J.defs.primitive.ifcat||f.isLet&&f.original===J.defs.primitive.ifcat||f===J.defs.primitive.ifdim||f.isLet&&f.original===J.defs.primitive.ifdim||f===J.defs.primitive.ifeof||f.isLet&&f.original===J.defs.primitive.ifeof||f===J.defs.primitive.iffalse||f.isLet&&f.original===J.defs.primitive.iffalse||f===J.defs.primitive.ifodd||f.isLet&&f.original===J.defs.primitive.ifodd||f===J.defs.primitive.ifnum||f.isLet&&f.original===J.defs.primitive.ifnum||f===J.defs.primitive.ifhmode||f.isLet&&f.original===J.defs.primitive.ifhmode||f===J.defs.primitive.ifinner||f.isLet&&f.original===J.defs.primitive.ifinner||f===J.defs.primitive.ifmmode||f.isLet&&f.original===J.defs.primitive.ifmmode||f===J.defs.primitive.iftrue||f.isLet&&f.original===J.defs.primitive.iftrue||f===J.defs.primitive.ifvmode||f.isLet&&f.original===J.defs.primitive.ifvmode||f===J.defs.primitive.ifvoid||f.isLet&&f.original===J.defs.primitive.ifvoid||f===J.defs.primitive.ifx||f.isLet&&f.original===J.defs.primitive.ifx){var m=e.mouth.expand(o,e.mouth);if(1==m.length&&m[0]===o&&o.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,m);continue}if(f===J.defs.primitive.noexpand||f.proxy&&f.original===J.defs.primitive.noexpand){p=!0;continue}if(f instanceof x||f.proxy&&f.original instanceof x){h.push(o);continue}e.mouth.queue.unshift.apply(e.mouth.queue,e.mouth.expand(o,e.mouth))}else h.push(o);else{var u=e.mouth.eat("pre space");if(!u||!(u.cat==J.cats.param||u.cat==J.cats.all&&u.char<=a.length&&1<=u.char))return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert(),u.cat==J.cats.param&&(d=!0),h.push(o),p=!1}}h.shift(),n&&h.push(a[a.length-1]);var f=new k(h,a);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)if("macro"==i){J.defs.macros[s]=f,delete J.registers.named[s];for(var v=0,g=e.scopes.length;v<g;v++)e.scopes[v].defs.macros[s]=f,delete e.scopes[v].registers.named[s]}else{J.defs.active[s]=f,delete J.registers.named[s];for(v=0,g=e.scopes.length;v<g;v++)e.scopes[v].defs.ative[s]=f,delete e.scopes[v].registers.named[s]}else e.scopes.last().defs["macro"==i?"macros":"active"][s]=f,delete e.scopes.last().registers.named[s];return e.toggles.global=!1,[]}),else:new x("else",function(e){return this.invalid=!0,[this]}),endcsname:new x("endcsname",function(e){return this.invalid=!0,[this]}),endgroup:new x("endgroup",function(e){if(!e.openGroups.length||e.scopes.last().delimited||e.scopes.last().isHalign||e.scopes.last().isHalignCell||!e.scopes.last().semisimple||"scope"!=e.contexts.last)return this.invalid=!0,[this];e.scopes.last().root&&(e.scopes.last().root.invalid=!0),e.openGroups.pop(),e.contexts.pop();var t=e.scopes.last().tokens;e.scopes.last().isFrac?(e.scopes[e.scopes.length-2].tokens.push({type:"atom",atomType:0,nucleus:[{type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:e.scopes.last().fracNumerator,denominator:t,barWidth:e.scopes.last().barWidth,delims:[e.scopes.last().fracLeftDelim,e.scopes.last().fracRightDelim],nullDelimiterSpace:new xt(e.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}],superscript:null,subscript:null}),e.scopes.pop()):(e.scopes.pop(),e.scopes.last().tokens.push({type:"atom",atomType:0,nucleus:t,superscript:null,subscript:null}))}),Error:new x("Error",function(e){var t=Symbol();if(e.mouth.saveState(t),(i=e.mouth.eat())&&"character"==i.type&&i.cat==J.cats.open){for(var i,s=0,a=[];;){if(!(i=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==i.type&&i.cat==J.cats.open)s++,a.push(i.char);else if("character"==i.type&&i.cat==J.cats.close){if(!s)break;s--,a.push(i.char)}else"command"==i.type?(a.push(i.escapeChar),a.push.apply(a,i.name.split(""))):a.push(i.char)}return a.map(function(e){return{type:"character",char:e,code:e.charCodeAt(0),cat:12,invalid:!0,recognized:!0}})}return this.invalid=!0,[this]}),expandafter:new x("expandafter",function(e){var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i)return this.invalid=!0,[this];var s=e.mouth.eat(),a=e.mouth.expand(s,e.mouth);return 1==a.length&&a[0]===s&&s.invalid?(this.invalid=!0,e.mouth.loadState(t),[this]):[i].concat(a)}),ExpandedError:new x("ExpandedError",function(e){var t=Symbol();if(e.mouth.saveState(t),(i=e.mouth.eat())&&"character"==i.type&&i.cat==J.cats.open){for(var i,s=0,a=[],r=!1;;){if(!(i=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==i.type&&i.cat==J.cats.open)s++,a.push(i.char),r=!1;else if("character"==i.type&&i.cat==J.cats.close){if(!s)break;s--,a.push(i.char),r=!1}else if("command"==i.type||"character"==i.type&&i.cat==J.cats.active){var n,l="command"==i.type?e.scopes.last().defs.primitive[i.name]||e.scopes.last().defs.macros[i.name]:e.scopes.last().defs.active[i.char];if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.proxy&&(l=l.original),l===J.defs.primitive.noexpand){r=!0;continue}if(!(r||l!==J.defs.primitive.the&&l!==J.defs.primitive.expandafter&&l!==J.defs.primitive.number&&l!==J.defs.primitive.romannumeral&&l!==J.defs.primitive.csname&&l!==J.defs.primitive.string&&l!==J.defs.primitive.if&&l!==J.defs.primitive.ifcase&&l!==J.defs.primitive.ifcat&&l!==J.defs.primitive.ifdim&&l!==J.defs.primitive.ifeof&&l!==J.defs.primitive.iffalse&&l!==J.defs.primitive.ifodd&&l!==J.defs.primitive.ifnum&&l!==J.defs.primitive.ifhmode&&l!==J.defs.primitive.ifinner&&l!==J.defs.primitive.ifmmode&&l!==J.defs.primitive.iftrue&&l!==J.defs.primitive.ifvmode&&l!==J.defs.primitive.ifvoid&&l!==J.defs.primitive.ifx)){if(1==(n=e.mouth.expand(i,e.mouth)).length&&n[0]===i&&n[0].invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,n),r=!1;continue}if(l instanceof x){a.push(String.fromCharCode(e.scopes.last().registers.named.escapechar.value)),a.push.apply(a,l.name.split("")),r=!1;continue}if(r)a.push(String.fromCharCode(e.scopes.last().registers.named.escapechar.value)),a.push.apply(a,i.name.split(""));else{if(1==(n=e.mouth.expand(i,e.mouth)).length&&n[0]===i&&n[0].invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,n)}r=!1}else a.push(i.char),r=!1}return a.map(function(e){return{type:"character",char:e,code:e.charCodeAt(0),cat:12,invalid:!0,recognized:!0}})}return this.invalid=!0,[this]}),fi:new x("fi",function(e){return this.invalid=!0,[this]}),futurelet:new x("futurelet",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,s=e.mouth.eat();if(!s)return this.invalid=!0,[this];if("character"==s.type){if(e.catOf(s.char)!=J.cats.active)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",s=s.char}else if("command"==s.type&&(i="macro",(s=s.name)in e.scopes.last().defs.primitive||s in J.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];var a=e.mouth.eat();a&&"character"==a.type&&"="==a.char&&a.cat==J.cats.all||a&&e.mouth.revert();var r=e.mouth.eat();if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];var n=e.mouth.eat();if(!n)return this.invalid=!0,e.mouth.loadState(t),[this];if("command"==n.type||"character"==n.type&&n.cat==J.cats.active){if(h="command"==n.type?e.scopes.last().defs.primitive[n.name]||e.scopes.last().defs.macros[n.name]:e.scopes.last().defs.active[n.name])h=new k(h,"primitive"==h.type||h.isLet);else if("command"==n.type&&"macro"==i){var l=e.scopes.last().registers.named[n.name];if(l){if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){J.registers.named[s]=l,delete J.defs.macros[s];for(var o=0,c=e.scopes.length;o<c;o++)e.scopes[o].registers.named[s]=l,delete e.scopes[o].defs.macros[s]}else e.scopes.last().registers.named[s]=l,delete e.scopes.last().defs.macros[s];return e.toggles.global=!1,[]}}}else var h=new k(new k([n]),!0);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)if("macro"==i){h?J.defs.macros[s]=h:delete J.defs.macros[s],delete J.registers.named[s];for(o=0,c=e.scopes.length;o<c;o++)h?e.scopes[o].defs.macros[s]=h:delete e.scopes[o].defs.macros[s],delete e.scopes[o].registers.named[s]}else{h?J.defs.active[s]=h:delete e.scopes[o].defs.macros[s],delete J.registers.named[s];for(o=0,c=e.scopes.length;o<c;o++)h?e.scopes[o].defs.ative[s]=h:delete e.scopes[o].defs.macros[s],delete e.scopes[o].registers.named[s]}else h?e.scopes.last().defs["macro"==i?"macros":"active"][s]=h:delete e.scopes.last().defs["macro"==i?"macros":"active"][s],delete e.scopes.last().registers.named[s];return e.toggles.global=!1,[r,n]}),gdef:new x("gdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,s=e.mouth.eat();if(!s)return this.invalid=!0,[this];if("character"==s.type){if(e.catOf(s.char)!=J.cats.active)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",s=s.char}else if("command"==s.type&&(i="macro",(s=s.name)in e.scopes.last().defs.primitive||s in J.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];for(var a=[],r=0,n=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if(o.cat==J.cats.open){e.mouth.revert();break}if(o.cat==J.cats.param){var l=e.mouth.eat("pre space");if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.cat==J.cats.open)n=!0,e.mouth.revert(),a.push({type:"character",cat:J.cats.open,char:l.char,code:l.code});else{if(!(48<l.code&&l.code<58&&l.cat==J.cats.all&&+l.char==r+1))return this.invalid=!0,e.mouth.loadState(t),[this];a.push(o),r++}}else a.push(o)}for(var o,c=0,h=[],p=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=o.type||o.cat!=J.cats.param||p){if("character"==o.type&&o.cat==J.cats.open)c++;else if("character"==o.type&&o.cat==J.cats.close&&0==--c)break}else{var d=e.mouth.eat("pre space");if(!d||!(d.cat==J.cats.param||d.cat==J.cats.all&&d.char<=a.length&&1<=d.char))return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert(),d.cat==J.cats.param&&(p=!0)}h.push(o)}h.shift(),n&&h.push(a[a.length-1]);var m=new k(h,a);if(e.scopes.last().registers.named.globaldefs.value<0)e.scopes.last().defs["macro"==i?"macros":"active"][s]=m,delete e.scopes.last().registers.named[s];else if("macro"==i){J.defs.macros[s]=m,delete J.registers.named[s];for(var u=0,f=e.scopes.length;u<f;u++)e.scopes[u].defs.macros[s]=m,delete e.scopes[u].registers.named[s]}else{J.defs.active[s]=m,delete J.registers.named[s];for(u=0,f=e.scopes.length;u<f;u++)e.scopes[u].defs.ative[s]=m,delete e.scopes[u].registers.named[s]}return e.toggles.global=!1,[]}),global:new x("global",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?this.invalid=!0:(e.toggles.global=this).ignore=!0,[this]}),halign:new x("halign",function(e){var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||i.cat!=J.cats.open)return this.invalid=!0,e.mouth.loadState(t),[this];for(var s=[[[]]],a=-1,r=[new _(e.scopes.last().registers.named.tabskip)],n=!1;;){if(!(i=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("command"==i.type||"character"==i.type&&i.cat==J.cats.active){var l="command"==i.type?e.scopes.last().defs.primitive[i.name]||e.scopes.last().defs.macros[i.name]||e.scopes.last().registers.named[i.name]:e.scopes.last().defs.active[i.char];if(!(l=l&&l.isLet?l.original:l)){(s[s.length-1][1]||s[s.length-1][0]).push(i);continue}if(l===J.defs.primitive.cr){if(s[s.length-1][1]){r.push(new _(e.scopes.last().registers.named.tabskip));var o=n||r[0];(h=e.scopes.last().registers.named.tabskip).start.sp.value=o.start.sp.value,h.start.em.value=o.start.em.value,"infinite dimension"==o.stretch.type?h.stretch=new Y(o.stretch.number.value,o.stretch.magnitude.value):h.stretch=new xt(o.stretch.sp.value,o.stretch.em.value),"infinite dimension"==o.shrink.type?h.shrink=new Y(o.shrink.number.value,o.shrink.magnitude.value):h.shrink=new xt(o.shrink.sp.value,o.shrink.em.value);break}return this.invalid=!0,e.mouth.loadState(t),[this]}if(l===e.scopes.last().registers.named.tabskip){var c=Symbol();e.mouth.saveState(c);var h,p=e.mouth.eat();if(p&&"character"==p.type&&"="==p.char&&p.cat==J.cats.all||p&&e.mouth.revert(),!(o=e.mouth.eat("glue"))){e.mouth.loadState(c),(s[s.length-1][1]||s[s.length-1][0]).push(i);continue}if((h=e.scopes.last().registers.named.tabskip).start.sp.value=o.start.sp.value,h.start.em.value=o.start.em.value,"infinite dimension"==o.stretch.type?h.stretch=new Y(o.stretch.number.value,o.stretch.magnitude.value):h.stretch=new xt(o.stretch.sp.value,o.stretch.em.value),"infinite dimension"==o.shrink.type?h.shrink=new Y(o.shrink.number.value,o.shrink.magnitude.value):h.shrink=new xt(o.shrink.sp.value,o.shrink.em.value),0<e.scopes.last().registers.named.globaldefs.value)for(n=new _(h);h.parent;)(h=h.parent).start.sp.value=o.start.sp.value,h.start.em.value=o.start.em.value,"infinite dimension"==o.stretch.type?h.stretch=new Y(o.stretch.number.value,o.stretch.magnitude.value):h.stretch=new xt(o.stretch.sp.value,o.stretch.em.value),"infinite dimension"==o.shrink.type?r.shrink=new Y(o.shrink.number.value,o.shrink.magnitude.value):h.shrink=new xt(o.shrink.sp.value,o.shrink.em.value);continue}if(l===J.defs.primitive.span){var d=e.mouth.eat();if(!d)return this.invalid=!0,e.mouth.loadState(t),[this];var m=e.mouth.expand(d,e.mouth);if(1==m.length&&m[0]===d&&d.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,m);continue}if(l.replacement&&l.replacement[0]&&l.replacement[0].cat==J.cats.param){if(s[s.length-1][1])return this.invalid=!0,e.mouth.loadState(t),[this];s[s.length-1][1]=[];continue}if(l.replacement&&l.replacement[0]&&l.replacement[0].cat==J.cats.alignment){if(~a||s[s.length-1][0].length||s[s.length-1][1]){if(!s[s.length-1][1])return this.invalid=!0,e.mouth.loadState(t),[this];s.push([[]]),r.push(new _(e.scopes.last().registers.named.tabskip))}else a=s.length-1;continue}}else{if(i.cat==J.cats.param){if(s[s.length-1][1])return this.invalid=!0,e.mouth.loadState(t),[this];s[s.length-1][1]=[];continue}if(i.cat==J.cats.alignment){if(~a||s[s.length-1][0].length||s[s.length-1][1]){if(!s[s.length-1][1])return this.invalid=!0,e.mouth.loadState(t),[this];s.push([[]]),r.push(new _(e.scopes.last().registers.named.tabskip))}else a=s.length-1;continue}if(i.cat==J.cats.whitespace&&!s[s.length-1][0].length&&!s[s.length-1][1])continue}(s[s.length-1][1]||s[s.length-1][0]).push(i)}var u={type:"atom",atomType:0,nucleus:("command"==this.type?this.escapeChar+this.name:this.char).split("").map(function(e){return{type:"atom",atomType:0,nucleus:{type:"symbol",char:e,code:e.charCodeAt(0)},superscript:null,subscript:null}}),superscript:null,subscript:null,ignore:!0};return e.openGroups.push(u),e.contexts.push("scope"),new e.Scope,e.scopes.last().tokens.push(u),e.scopes.last().isHalign=!0,e.scopes.last().cellData=[],e.scopes.last().preamble=s,e.scopes.last().repeatPreambleAt=a,e.scopes.last().tabSkips=r,e.scopes.last().noAligns=[],e.mouth.revert(),[]}),hbox:new x("hbox",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t,i,s=Symbol();for(e.mouth.saveState(s);;){var a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("command"!=a.type&&("character"!=a.type||a.cat!=J.cats.active)){if("character"!=a.type||"t"!=a.char&&"T"!=a.char){if("character"!=a.type||"s"!=a.char&&"S"!=a.char){if("character"!=a.type||a.cat!=J.cats.open)return this.invalid=!0,e.mouth.loadState(s),[this];e.mouth.revert();break}var r=e.mouth.eat(),n=e.mouth.eat(),l=e.mouth.eat(),o=e.mouth.eat(),c=e.mouth.eat();if(!r||"character"!=r.type||"p"!=r.char&&"P"!=r.char||r.cat==J.cats.active||!n||"character"!=n.type||"r"!=n.char&&"R"!=n.char||n.cat==J.cats.active||!l||"character"!=l.type||"e"!=l.char&&"E"!=l.char||l.cat==J.cats.active||!o||"character"!=o.type||"a"!=o.char&&"A"!=o.char||o.cat==J.cats.active||!c||"character"!=c.type||"d"!=c.char&&"D"!=c.char||c.cat==J.cats.active)return this.invalid=!0,e.mouth.loadState(s),[this];if(h=e.mouth.eat("dimension")){t=h;break}return this.invalid=!0,e.mouth.loadState(s),[this]}var h,p=e.mouth.eat("pre space");if(!p||"character"!=p.type||"o"!=p.char&&"O"!=a.char||a.cat==J.cats.active)return this.invalid=!0,e.mouth.loadState(s),[this];if(h=e.mouth.eat("dimension")){i=h;break}return this.invalid=!0,e.mouth.loadState(s),[this]}var d="command"==a.type?e.scopes.last().defs.primitive[a.name]||e.scopes.last().defs.macros[a.name]:e.scopes.last().defs.active[a.char];if(d&&(d===J.defs.primitive.relax||d.proxy&&d.original===J.defs.primitive.relax))break;var m=e.mouth.expand(a,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,m)}var u=e.mouth.preview();return u&&"character"==u.type&&u.cat==J.cats.open?(i||t||(t=new xt(0,0)),e.tokens.push({type:"box wrapper",value:"horizontal",to:i,spread:t,token:this}),[]):(this.invalid=!0,e.mouth.loadState(s),[this])}),hfil:new x("hfil",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"glue",glue:new _(new xt(0),new Y(1,1),new xt(0))}),[])}),hfill:new x("hfill",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"glue",glue:new _(new xt(0),new Y(1,2),new xt(0))}),[])}),hrule:new x("hrule",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);for(var i=!1,s=!1,a=!1;;){var r=e.mouth.eat();if(!r){e.mouth.revert();break}if("h"!=r.char&&"H"!=r.char||r.cat==J.cats.active){if("d"!=r.char&&"D"!=r.char||r.cat==J.cats.active){if("w"!=r.char&&"W"!=r.char||r.cat==J.cats.active){e.mouth.revert();break}if(!(r=e.mouth.eat("pre space"))||"i"!=r.char&&"I"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"d"!=r.char&&"D"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?5:4);else{if(r=e.mouth.eat("dimension")){a=r;continue}e.mouth.revert(5)}break}if(!(r=e.mouth.eat("pre space"))||"e"!=r.char&&"E"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"p"!=r.char&&"P"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?5:4);else{if(r=e.mouth.eat("dimension")){s=r;continue}e.mouth.revert(5)}break}if(!(r=e.mouth.eat("pre space"))||"e"!=r.char&&"E"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"i"!=r.char&&"I"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"g"!=r.char&&"G"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?5:4);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?6:5);else{if(r=e.mouth.eat("dimension")){i=r;continue}e.mouth.revert(6)}break}return i=i||new xt(0,65536/30),s=s||new xt(0,0),e.tokens.push({type:"rule",ruleType:"h",height:i,depth:s,width:a}),[]}),hskip:new x("hskip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("glue");return t?(e.tokens.push({type:"glue",glue:t}),[]):(this.invalid=!0,[this])}),if:new x("if",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);for(var i=[],s=!1;i.length<2;){var a=e.mouth.eat("pre space");if(!a)return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=a.type||a.cat!=J.cats.whitespace||0!=i.length)if("character"==a.type&&i.cat!=J.cats.active)i.push(a),s=!1;else if(s)i.push(a),s=!1;else if("command"==a.type||"character"==a.type&&a.cat==J.cats.active){if(a.name in e.scopes.last().registers.named){i.push(a);continue}var r,n="command"==a.type?e.scopes.last().defs.primitive[a.name]||e.scopes.last().defs.macros[a.name]:e.scopes.last().defs.active[a.char];if(!n)return this.invalid=!0,e.mouth.loadState(t),[this];if(n===J.defs.primitive.the||n.proxy&&n.original===J.defs.primitive.the||n===J.defs.primitive.expandafter||n.proxy&&n.original===J.defs.primitive.expandafter||n===J.defs.primitive.number||n.proxy&&n.original===J.defs.primitive.number||n===J.defs.primitive.romannumeral||n.proxy&&n.original===J.defs.primitive.romannumeral||n===J.defs.primitive.csname||n.proxy&&n.original===J.defs.primitive.csname||n===J.defs.primitive.string||n.proxy&&n.original===J.defs.primitive.string||n===J.defs.primitive.if||n.isLet&&n.original===J.defs.primitive.if||n===J.defs.primitive.ifcase||n.isLet&&n.original===J.defs.primitive.ifcase||n===J.defs.primitive.ifcat||n.isLet&&n.original===J.defs.primitive.ifcat||n===J.defs.primitive.ifdim||n.isLet&&n.original===J.defs.primitive.ifdim||n===J.defs.primitive.ifeof||n.isLet&&n.original===J.defs.primitive.ifeof||n===J.defs.primitive.iffalse||n.isLet&&n.original===J.defs.primitive.iffalse||n===J.defs.primitive.ifodd||n.isLet&&n.original===J.defs.primitive.ifodd||n===J.defs.primitive.ifnum||n.isLet&&n.original===J.defs.primitive.ifnum||n===J.defs.primitive.ifhmode||n.isLet&&n.original===J.defs.primitive.ifhmode||n===J.defs.primitive.ifinner||n.isLet&&n.original===J.defs.primitive.ifinner||n===J.defs.primitive.ifmmode||n.isLet&&n.original===J.defs.primitive.ifmmode||n===J.defs.primitive.iftrue||n.isLet&&n.original===J.defs.primitive.iftrue||n===J.defs.primitive.ifvmode||n.isLet&&n.original===J.defs.primitive.ifvmode||n===J.defs.primitive.ifvoid||n.isLet&&n.original===J.defs.primitive.ifvoid||n===J.defs.primitive.ifx||n.isLet&&n.original===J.defs.primitive.ifx){if(1==(r=e.mouth.expand(a,e.mouth)).length&&r[0]===a&&a.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,r);continue}if(n===J.defs.primitive.noexpand||n.proxy&&n.original===J.defs.primitive.noexpand){s=!0;continue}if(n instanceof x||n.proxy&&n.original instanceof x){i.push(a);continue}if(1==(r=e.mouth.expand(a,e.mouth)).length&&r[0]==-a&&a.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,r)}else i.push(a)}return l.call(this,"command"==i[0].type&&"command"==i[1].type||"character"==i[0].type&&i[0].char==i[1].char,e.mouth,e.scopes,t)}),ifcase:new x("ifcase",function(s){if("superscript"==s.contexts.last||"subscript"==s.contexts.last)return this.invalid=!0,[this];var e=Symbol();s.mouth.saveState(e);var t=s.mouth.eat("integer");if(!t)return this.invalid=!0,[this];var i=[],a=!1;if((t=t.value)<0)o("else");else for(;0<t&&!a;t--)o("or");for(;;){var r=s.mouth.eat();if(!r)return this.invalid=!0,s.mouth.loadState(stateSymbol),[this];if("command"==r.type||"character"==r.type&&r.cat==J.cats.active){var n="command"==r.type?s.scopes.last().defs.primitive[r.name]||s.scopes.last().defs.macros[r.name]:s.scopes.last().defs.active[r.char];if(n&&(n===J.defs.primitive.fi||n.isLet&&n.original===J.defs.primitive.fi))return i;if(!a&&n&&(n===J.defs.primitive.or||n.isLet&&n.original===J.defs.primitive.or||n===J.defs.primitive.else||n.isLet&&n.original===J.defs.primitive.else)){o("fi");continue}var l=s.mouth.expand(r,s.mouth);s.mouth.queue.unshift.apply(s.mouth.queue,l)}else i.push(r)}function o(e){for(;;){var t=s.mouth.eat();if(!t)return;if("command"==t.type||"character"==t.type&&t.cat===J.cats.active){var i="command"==t.type?s.scopes.last().defs.primitive[t.name]||s.scopes.last().defs.macros[t.name]:s.scopes.last().defs.active[t.char];if(!i)continue;if(i===J.defs.primitive.if||i.isLet&&i.original===J.defs.primitive.if||i===J.defs.primitive.ifcase||i.isLet&&i.original===J.defs.primitive.ifcase||i===J.defs.primitive.ifcat||i.isLet&&i.original===J.defs.primitive.ifcat||i===J.defs.primitive.ifdim||i.isLet&&i.original===J.defs.primitive.ifdim||i===J.defs.primitive.ifeof||i.isLet&&i.original===J.defs.primitive.ifeof||i===J.defs.primitive.iffalse||i.isLet&&i.original===J.defs.primitive.iffalse||i===J.defs.primitive.ifodd||i.isLet&&i.original===J.defs.primitive.ifodd||i===J.defs.primitive.ifnum||i.isLet&&i.original===J.defs.primitive.ifnum||i===J.defs.primitive.ifhmode||i.isLet&&i.original===J.defs.primitive.ifhmode||i===J.defs.primitive.ifinner||i.isLet&&i.original===J.defs.primitive.ifinner||i===J.defs.primitive.ifmmode||i.isLet&&i.original===J.defs.primitive.ifmmode||i===J.defs.primitive.iftrue||i.isLet&&i.original===J.defs.primitive.iftrue||i===J.defs.primitive.ifvmode||i.isLet&&i.original===J.defs.primitive.ifvmode||i===J.defs.primitive.ifvoid||i.isLet&&i.original===J.defs.primitive.ifvoid||i===J.defs.primitive.ifx||i.isLet&&i.original===J.defs.primitive.ifx){o("fi"),s.mouth.eat();continue}if("or"==e&&(i===J.defs.primitive.or||i.isLet&&i.original===J.defs.primitive.or))return;if(("or"==e||"else"==e)&&(i===J.defs.primitive.else||i.isLet&&i.original===J.defs.primitive.else))return void(a=!0);if(i===J.defs.primitive.fi||i.isLet&&i.original===J.defs.primitive.fi)return void s.mouth.revert()}}}}),ifcat:new x("ifcat",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);for(var i=[],s=!1;i.length<2;){var a=e.mouth.eat("pre space");if(!a)return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=a.type||a.cat!=J.cats.whitespace||0!=i.length)if("character"==a.type&&i.cat!=J.cats.active)i.push(a),s=!1;else if(s)i.push(a),s=!1;else if("command"==a.type||"character"==a.type&&a.cat==J.cats.active){if(a.name in e.scopes.last().registers.named){i.push(a);continue}var r,n="command"==a.type?e.scopes.last().defs.primitive[a.name]||e.scopes.last().defs.macros[a.name]:e.scopes.last().defs.active[a.char];if(!n)return this.invalid=!0,e.mouth.loadState(t),[this];if(n===J.defs.primitive.the||n.proxy&&n.original===J.defs.primitive.the||n===J.defs.primitive.expandafter||n.proxy&&n.original===J.defs.primitive.expandafter||n===J.defs.primitive.number||n.proxy&&n.original===J.defs.primitive.number||n===J.defs.primitive.romannumeral||n.proxy&&n.original===J.defs.primitive.romannumeral||n===J.defs.primitive.csname||n.proxy&&n.original===J.defs.primitive.csname||n===J.defs.primitive.string||n.proxy&&n.original===J.defs.primitive.string||n===J.defs.primitive.if||n.isLet&&n.original===J.defs.primitive.if||n===J.defs.primitive.ifcase||n.isLet&&n.original===J.defs.primitive.ifcase||n===J.defs.primitive.ifcat||n.isLet&&n.original===J.defs.primitive.ifcat||n===J.defs.primitive.ifdim||n.isLet&&n.original===J.defs.primitive.ifdim||n===J.defs.primitive.ifeof||n.isLet&&n.original===J.defs.primitive.ifeof||n===J.defs.primitive.iffalse||n.isLet&&n.original===J.defs.primitive.iffalse||n===J.defs.primitive.ifodd||n.isLet&&n.original===J.defs.primitive.ifodd||n===J.defs.primitive.ifnum||n.isLet&&n.original===J.defs.primitive.ifnum||n===J.defs.primitive.ifhmode||n.isLet&&n.original===J.defs.primitive.ifhmode||n===J.defs.primitive.ifinner||n.isLet&&n.original===J.defs.primitive.ifinner||n===J.defs.primitive.ifmmode||n.isLet&&n.original===J.defs.primitive.ifmmode||n===J.defs.primitive.iftrue||n.isLet&&n.original===J.defs.primitive.iftrue||n===J.defs.primitive.ifvmode||n.isLet&&n.original===J.defs.primitive.ifvmode||n===J.defs.primitive.ifvoid||n.isLet&&n.original===J.defs.primitive.ifvoid||n===J.defs.primitive.ifx||n.isLet&&n.original===J.defs.primitive.ifx){if(1==(r=e.mouth.expand(a,e.mouth)).length&&r[0]===a&&a.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,r);continue}if(n===J.defs.primitive.noexpand||n.proxy&&n.original===J.defs.primitive.noexpand){s=!0;continue}if(n instanceof x||n.proxy&&n.original instanceof x){i.push(a);continue}if(1==(r=e.mouth.expand(a,e.mouth)).length&&r[0]==-a&&a.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,r)}else i.push(a)}return l.call(this,"command"==i[0].type&&"command"==i[1].type||"character"==i[0].type&&i[0].cat==i[1].cat,e.mouth,e.scopes,t)}),ifdim:new x("ifdim",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("dimension");if(!i)return this.invalid=!0,[this];i=i.sp.value+12*i.em.value;var s=e.mouth.eat();if(!s||s.cat==J.cats.active&&("<"==s.char||"="==s.char||">"==s.char))return this.invalid=!0,e.mouth.loadState(t),[this];var a=e.mouth.eat("dimension");return a?(a=a.sp.value+12*a.em.value,l.call(this,"<"==s.char?i<a:"="==s.char?i==a:a<i,e.mouth,e.scopes,t)):(this.invalid=!0,e.mouth.loadState(t),[this])}),ifeof:new x("ifeof",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!0,e.mouth,e.scopes,t)}),iffalse:new x("iffalse",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!1,e.mouth,e.scopes,t)}),ifodd:new x("ifodd",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("integer");return i?l.call(this,i.value%2==1,e.mouth,e.scopes,t):(this.invalid=!0,[this])}),ifnum:new x("ifnum",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("integer");if(!i)return this.invalid=!0,[this];var s=e.mouth.eat();if(!s||s.cat==J.cats.active&&("<"==s.char||"="==s.char||">"==s.char))return this.invalid=!0,e.mouth.loadState(t),[this];var a=e.mouth.eat("integer");return a?l.call(this,"<"==s.char?i.value<a.value:"="==s.char?i.value==a.value:i.value>a.value,e.mouth,e.scopes,t):(this.invalid=!0,e.mouth.loadState(t),[this])}),ifhmode:new x("ifhmode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!1,e.mouth,e.scopes,t)}),ifinner:new x("ifinner",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,"inline"==e.style,e.mouth,e.scopes,t)}),ifmmode:new x("ifmmode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!0,e.mouth,e.scopes,t)}),iftrue:new x("iftrue",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!0,e.mouth,e.scopes,t)}),ifvmode:new x("ifvmode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!1,e.mouth,e.scopes,t)}),ifvoid:new x("ifvoid",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!0,e.mouth,e.scopes,t)}),ifx:new x("ifx",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i)return this.invalid=!0,[this];var s=e.mouth.eat("pre space");if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];if((i="command"==i.type?e.scopes.last().defs.primitive[i.name]||e.scopes.last().defs.macros[i.name]:"character"==i.type&&i.cat==J.cats.active?e.scopes.last().defs.active[i.char]:i)&&i.proxy&&(i=i.original),(s="command"==s.type?e.scopes.last().defs.primitive[s.name]||e.scopes.last().defs.macros[s.name]:"character"==s.type&&s.cat==J.cats.active?e.scopes.last().defs.active[s.char]:s)&&s.proxy&&(s=s.original),!i&&!s)return l.call(this,!0,e.mouth,e.scopes,t);if(!i||!s||i.type!=s.type)return l.call(this,!1,e.mouth,e.scopes,t);if("character"==i.type)return l.call(this,i.char==s.char&&i.cat==s.cat,e.mouth,e.scopes,t);if("primitive"==i.type)return l.call(this,i===s,e.mouth,e.scopes,t);if(i.parameters.length!=s.parameters.length||i.replacement.length!=s.replacement.length)return l.call(this,!1,e.mouth,e.scopes,t);for(var a=0,r=i.parameters.length;a<r;a++)if(!("character"==i.parameters[a].type&&i.parameters[a].char==s.parameters[a].char&&i.parameters[a].cat==s.parameters[a].cat||"command"==i.parameters[a].type&&i.parameters[a].name==s.parameters[a].name))return l.call(this,!1,e.mouth,e.scopes,t);for(a=0,r=i.replacement.length;a<r;a++)if(!("character"==i.replacement[a].type&&i.replacement[a].char==s.replacement[a].char&&i.replacement[a].cat==s.replacement[a].cat||"command"==i.replacement[a].type&&i.replacement[a].name==s.replacement[a].name))return l.call(this,!1,e.mouth,e.scopes,t);return l.call(this,!0,e.mouth,e.scopes,t)}),it:new x("it",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"it"}),[])}),kern:new x("kern",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("dimension");return t?(e.tokens.push({type:"kern",dimen:t}),[]):(this.invalid=!0,[this])}),lccode:new x("lccode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");return t||t.value<0?[e.scopes.last().lc[t.value]=e.scopes.last().lc[t.value]||new G(0)]:(this.invalid=!0,[this])}),left:new x("left",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=J.cats.active)){if(!i||"character"!=i.type||!J.delims.includes(i.code)||i.cat!=J.cats.all&&i.cat!=J.cats.letter)return this.invalid=!0,e.mouth.loadState(t),[this];new e.Scope,e.scopes.last().delimited=!0,e.scopes.last().leftDelimiter=i.char,e.scopes.last().nullDelimiterSpace=new xt(e.scopes.last().registers.named.nulldelimiterspace),e.openGroups.push(this),e.contexts.push("scope"),e.scopes.last().tokens.push(this),e.scopes.last().tokens.push({type:"atom",atomType:0,nucleus:{type:"symbol",char:i.char,code:i.code},subscript:null,superscript:null}),this.ignore=!0;break}var s=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,s)}}),let:new x("let",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,s=e.mouth.eat();if(!s)return this.invalid=!0,[this];if("character"==s.type){if(e.catOf(s.char)!=J.cats.active)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",s=s.char}else if("command"==s.type&&(i="macro",(s=s.name)in e.scopes.last().defs.primitive||s in J.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];var a=e.mouth.eat();a&&"character"==a.type&&"="==a.char&&a.cat==J.cats.all||a&&e.mouth.revert();var r=e.mouth.eat();if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if("command"==r.type||"character"==r.type&&r.cat==J.cats.active){if(c="command"==r.type?e.scopes.last().defs.primitive[r.name]||e.scopes.last().defs.macros[r.name]:e.scopes.last().defs.active[r.name])c=new k(c,"primitive"==c.type||c.isLet);else if("command"==r.type&&"macro"==i){var n=e.scopes.last().registers.named[r.name];if(n){if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){J.registers.named[s]=n,delete J.defs.macros[s];for(var l=0,o=e.scopes.length;l<o;l++)e.scopes[l].registers.named[s]=n,delete e.scopes[l].defs.macros[s]}else e.scopes.last().registers.named[s]=n,delete e.scopes.last().defs.macros[s];return e.toggles.global=!1,[]}}}else var c=new k(new k([r]),!0);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)if("macro"==i){c?J.defs.macros[s]=c:delete J.defs.macros[s],delete J.registers.named[s];for(l=0,o=e.scopes.length;l<o;l++)c?e.scopes[l].defs.macros[s]=c:delete e.scopes[l].defs.macros[s],delete e.scopes[l].registers.named[s]}else{c?J.defs.active[s]=c:delete J.defs.active[s],delete J.registers.named[s];for(l=0,o=e.scopes.length;l<o;l++)c?e.scopes[l].defs.active[s]=c:delete e.scopes[l].defs.active[s],delete e.scopes[l].registers[s]}else c?e.scopes.last().defs["macro"==i?"macros":"active"][s]=c:delete e.scopes.last().defs["macro"==i?"macros":"active"][s],delete e.scopes.last().registers.named[s];return e.toggles.global=!1,[]}),limits:new x("limits",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"limit modifier",value:!0,token:this}),[])}),lower:new x("lower",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("dimension");return t?(t.sp.value*=-1,t.em.value*=-1,e.tokens.push({type:"vkern",dimen:t}),[]):(this.invalid=!0,[this])}),lowercase:new x("lowercase",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("pre space");if(!i||i.cat!=J.cats.open)return this.invalid=!0,e.mouth.loadState(t),[this];for(var s=[],a=1;;){var r=e.mouth.eat("pre space");if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==r.type&&r.cat==J.cats.open)a++,s.push(r);else if("character"==r.type&&r.cat==J.cats.close){if(!(0<--a))break;s.push(r)}else s.push(r)}for(var n=0,l=s.length;n<l;n++)"character"==s[n].type&&e.scopes.last().lc[s[n].code]&&0<e.scopes.last().lc[s[n].code].value&&(s[n].code=e.scopes.last().lc[s[n].code].value,s[n].char=String.fromCharCode(s[n].code));return s}),mathbin:new x("mathbin",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:2,token:this}),[])}),mathchar:new x("mathchar",function(e){var t,i,s=e.mouth.eat("integer");return!s||s.value<0?(this.invalid=!0,[this]):(!(s.value<65536)&&s.value<524288?(t=s.value%65536,i=(s.value-t)/65536,s.value=t):i=0,e.mouth.queue.unshift({type:"character",cat:J.cats.all,char:String.fromCharCode(s.value),code:s.value,forcedMathCode:i}),[])}),mathchardef:new x("mathchardef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||"command"!=i.type)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i.name in J.defs.primitive||i.name in J.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var s=e.mouth.eat();s&&"character"==s.type&&"="==s.char&&s.cat==J.cats.all||s&&e.mouth.revert();var a,r,n=e.mouth.eat("integer");if(!n||n.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];!(n.value<65536)&&n.value<524288?(a=n.value%65536,r=(n.value-a)/65536,n.value=a):r=0;var l=new k([{type:"character",cat:J.cats.all,char:String.fromCharCode(n.value),code:n.value,forcedMathCode:r}],[]);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){J.defs.macros[i.name]=l,delete J.registers.named[i.name];for(var o=0,c=e.scopes.length;o<c;o++)e.scopes[o].defs.macros[i.name]=l,delete e.scopes[o].registers.named[i.name]}else e.scopes.last().defs.macros[i.name]=l,delete e.scopes.last().registers.named[i.name];e.toggles.global=!1}),mathchoice:new x("mathchoice",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t={type:"command",nameType:"command",escapeChar:this.escapeChar,name:"mathchoice",recognized:!0};e.contexts.push({toString:function(){return"mathchoice"},token:t,current:0,failed:function(){this.token.invalid=!0,e.contexts.pop()},succeeded:function(){e.contexts.pop(),this.token.type="mathchoice",this.token.groups=e.scopes.last().tokens.splice(e.scopes.last().tokens.length-4,4),this.token.ignore=!1}}),e.tokens.push(t),t.ignore=!0}),mathclose:new x("mathclose",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:5,token:this}),[])}),mathcode:new x("mathcode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");if(t){if(t.value<0)return e.mouth.revert(),this.invalid=!0,[this];if(!(t.value in J.mathcodes)){J.mathcodes[t.value]=new G(J.mathcodes.ord,0,8);for(var i=0,s=e.scopes.length;i<s;i++)e.scopes[i].mathcodes[t.value]=new G((0==i?J:e.scopes[i-1]).mathcodes[t.value])}return[e.scopes.last().mathcodes[t.value]]}return this.invalid=!0,[this]}),mathinner:new x("mathinner",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"inner",token:this}),[])}),mathop:new x("mathop",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:1,token:this}),[])}),mathopen:new x("mathopen",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:4,token:this}),[])}),mathord:new x("mathord",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:0,token:this}),[])}),mathpunct:new x("mathpunct",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:6,token:this}),[])}),mathrel:new x("mathrel",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:3,token:this}),[])}),message:new x("message",function(e){var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||"character"!=i.type||i.cat!=J.cats.open)return this.invalid=!0,[this];for(var s=0,a=[];;){if(!(i=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==i.type&&i.cat==J.cats.open)s++,a.push(i.char);else if("character"==i.type&&i.cat==J.cats.close){if(!s)break;s--,a.push(i.char)}else"command"==i.type?(a.push(i.escapeChar),a.push.apply(a,i.name.split(""))):a.push(i.char)}o(a.join(""))}),mkern:new x("mkern",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("mu dimension");return t?(e.tokens.push({type:"kern",dimen:t}),[]):(this.invalid=!0,[this])}),month:new x("month",function(e){return[new G((new Date).getMonth()+1)]}),mskip:new x("mskip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("mu glue");return t?(e.tokens.push({type:"glue",glue:t}),[]):(this.invalid=!0,[this])}),multiply:new x("multiply",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=J.cats.active)){if(i&&i.register){if(i&&i.register){var s=e.mouth.eat();if(!s||"character"!=s.type||"b"!=s.char&&"B"!=s.char||s.cat==J.cats.active){if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert()}else{var a=e.mouth.eat();a&&"character"==a.type&&("y"==a.char||"Y"==a.char)&&a.cat!=J.cats.active||e.mouth.revert(2)}var r=e.mouth.eat("integer");if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if("integer"==i.type){i.value*=r.value;var n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).value=n.value;e.toggles.global=!1}else if("dimension"==i.type){i.sp.value*=r.value,i.em.value*=r.value;n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).sp.value=n.sp.value,i.em.value=n.em.value;e.toggles.global=!1}else if("mu dimension"==i.type){i.mu.value*=r.value;n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).mu.value=n.mu.value;e.toggles.global=!1}else if("glue"==i.type){i.start.sp.value*=r.value,i.start.em.value*=r.value,"infinite dimension"==i.stretch.type?i.stretch.number.value*=r.value:(i.stretch.sp.value*=r.value,i.stretch.em.value*=r.value),"infinite dimension"==i.shrink.type?i.shrink.number.value*=r.value:(i.shrink.sp.value*=r.value,i.shrink.em.value*=r.value);n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.sp.value=n.start.sp.value,i.start.em.value=n.start.em.value,"infinite dimension"==n.stretch.type?i.stretch=new Y(n.stretch.number.value,n.stretch.magnitude.value):i.stretch=new xt(n.stretch.sp.value,n.stretch.em.value),"infinite dimension"==n.shrink.type?i.shrink=new Y(n.shrink.number.value,n.shrink.magnitude.value):i.shrink=new xt(n.shrink.sp.value,n.shrink.em.value);e.toggles.global=!1}else if("mu glue"==i.type){i.start.mu.value*=r.value,"infinite dimension"==i.stretch.type?i.stretch.number.value*=r.value:i.stretch.mu.value*=r.value,"infinite dimension"==i.shrink.type?i.shrink.number.value*=r.value:i.shrink.mu.value*=r.value;n=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.mu.value=n.start.mu.value,"infinite dimension"==n.stretch.type?i.stretch=new Y(n.stretch.number.value,n.stretch.magnitude.value):i.stretch=new V(n.stretch.mu.value),"infinite dimension"==n.shrink.type?i.shrink=new Y(n.shrink.number.value,n.shrink.magnitude.value):i.shrink=new V(n.shrink.mu.value);e.toggles.global=!1}break}return this.invalid=!0,e.mouth.loadState(t),[this]}return this.invalid=!0,e.mouth.loadState(t),[this]}var l=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,l)}return[]}),muskip:new x("muskip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");if(!t||t.value<0)return this.invalid=!0,[this];if(!J.registers.muskip[t.value]){J.registers.muskip[t.value]=new $(new V(0,0),new V(0,0),new V(0,0));for(var i=0,s=e.scopes.length;i<s;i++)e.scopes[i].registers.muskip[t.value]=new $((i?e.scopes[i-1]:J).registers.muskip[t.value])}return[e.scopes.last().registers.muskip[t.value]]}),muskipdef:new x("muskipdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if("command"!=i.type)return this.invalid=!0,e.mouth.loadState(countDefSym),[!0];if(i.name in J.defs.primitive||i.name in J.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var s=e.mouth.eat();s&&"character"==s.type&&"="==s.char&&s.cat==J.cats.all||s&&e.mouth.revert();var a=e.mouth.eat("integer");if(!a||a.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i=i.name,a=a.value,!J.registers.muskip[a]){J.registers.muskip[a]=new $(new V(0),new V(0),new V(0));for(var r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.muskip[a]=new $((r?e.scopes[r-1]:J).registers.muskip[a])}if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){J.registers.named[i]=J.registers.muskip[a],delete J.defs.macros[i];for(r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.named[i]=e.scopes[r].registers.muskip[a],delete e.scopes[r].defs.macros[i]}else e.scopes.last().registers.named[i]=e.scopes.last().registers.muskip[a],delete e.scopes.last().defs.macros[i]}),noalign:new x("noalign",function(e){return this.invalid=!0,[this]}),noexpand:new x("noexpand",function(e){var t=e.mouth.eat();return t?(e.mouth.revert(),"command"==t.type||"character"==t.type&&t.cat==J.cats.active?(this.invalid=!0,[this]):[]):(this.invalid=!0,[this])}),nolimits:new x("nolimits",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"limit modifier",value:!1,token:this}),[])}),nonscript:new x("nonscript",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"glue",isNonScript:!0}),[])}),normalfont:new x("normalfont",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"nm"}),[])}),number:new x("number",function(e){var t=e.mouth.eat("integer");return t?t.value.toString().split("").map(function(e){return{type:"character",cat:J.cats.all,char:e,code:e.charCodeAt(0)}}):(this.invalid=!0,[this])}),of:new x("of",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];if(e.scopes.last().root){var t=e.scopes.last().tokens.indexOf(e.scopes.last().root);return e.tokens.push({type:"family modifier",value:"rad",index:e.scopes.last().tokens.splice(t,e.scopes.last().tokens.length-t+1).slice(1),token:this}),e.scopes.last().root=!1,[]}return this.invalid=!0,[this]}),omit:new x("omit",function(e){return this.invalid=!0,[this]}),or:new x("or",function(e){return this.invalid=!0,[this]}),over:new x("over",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.scopes.last().isFrac=!0,e.scopes.last().fracLeftDelim=e.scopes.last().fracRightDelim=".",e.scopes.last().barWidth="from font",e.scopes.last().root&&(e.scopes.last().root.invalid=!0,e.scopes.last().root=!1),e.scopes.last().fracNumerator=e.scopes.last().tokens,e.scopes.last().tokens=[],[])}),overline:new x("overline",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"over",token:this}),[])}),overwithdelims:new x("overwithdelims",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(i&&("command"==i.type||"character"==i.type&&i.cat==J.cats.active)){var s=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,s)}else{if(!i||"character"!=i.type||!J.delims.includes(i.code)||i.cat!=J.cats.all&&i.cat!=J.cats.letter)return this.invalid=!0,e.mouth.loadState(t),delete e.scopes.last().fracLeftDelim,[this];if(e.scopes.last().fracLeftDelim){e.scopes.last().fracRightDelim=i.char;break}e.scopes.last().fracLeftDelim=i.char}}return e.scopes.last().isFrac=!0,e.scopes.last().barWidth="from font",e.scopes.last().root&&(e.scopes.last().root.invalid=!0,e.scopes.last().root=!1),e.scopes.last().fracNumerator=e.scopes.last().tokens,e.scopes.last().tokens=[],[]}),phantom:new x("phantom",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"phantom",index:[],token:this}),[])}),raise:new x("raise",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("dimension");return t?(e.tokens.push({type:"vkern",dimen:t}),[]):(this.invalid=!0,[this])}),relax:new x("relax",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):[]}),right:new x("right",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];if(!e.openGroups.length||!e.scopes.last().delimited||e.scopes.last().isHalign||e.scopes.last().isHalignCell||e.scopes.last().semisimple)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=J.cats.active)){if(!i||"character"!=i.type||!J.delims.includes(i.code)||i.cat!=J.cats.all&&i.cat!=J.cats.letter)return this.invalid=!0,e.mouth.loadState(t),[this];if("scope"!=e.contexts.last)return this.invalid=!0,e.mouth.loadState(t),[this];e.openGroups.pop(),e.contexts.pop();var s,a=e.scopes.last().tokens;e.scopes.last().root&&(e.scopes.last().root.invalid=!0),e.scopes.last().isFrac?(e.scopes.last().fracNumerator.shift(),e.scopes.last().fracNumerator.shift(),e.scopes[e.scopes.length-2].tokens.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:e.scopes.last().fracNumerator,denominator:a,barWidth:e.scopes.last().barWidth,delims:[e.scopes.last().fracLeftDelim,e.scopes.last().fracRightDelim],nullDelimiterSpace:new xt(e.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null,delimited:!0,nullDelimiterSpace:new xt(e.scopes.last().registers.named.nulldelimiterspace),delims:[e.scopes.last().leftDelimiter,i.char]}),e.scopes.pop()):(a.shift(),a.shift(),s=e.scopes.last().leftDelimiter,e.scopes.pop(),e.scopes.last().tokens.push({type:"atom",atomType:"inner",nucleus:a,superscript:null,subscript:null,delimited:!0,nullDelimiterSpace:new xt(e.scopes.last().registers.named.nulldelimiterspace),delims:[s,i.char]}));break}var r=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,r)}}),rm:new x("rm",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"rm"}),[])}),romannumeral:new x("romannumeral",function(e){var t=e.mouth.eat("integer");if(!t)return this.invalid=!0,[this];if(t.value<=0)return this.invalid=!0,e.mouth.revert(),[this];var i="",s=~~((t=t.value)/1e3),a=~~((t%=1e3)/100),r=~~((t%=100)/10),n=t%10,i=new Array(1+s).join("m");return i+=a<3?new Array(1+a).join("c"):4==a?"cd":a<9?"d"+new Array(a%5+1).join("c"):"cm",i+=r<3?new Array(1+r).join("x"):4==r?"xl":r<9?"l"+new Array(r%5+1).join("x"):"xc",(i+=n<3?new Array(1+n).join("i"):4==n?"iv":n<9?"v"+new Array(n%5+1).join("i"):"ix").split("").map(function(e){return{type:"character",cat:J.cats.all,char:e,code:e.charCodeAt(0)}})}),scriptscriptstyle:new x("scriptscriptstyle",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"scriptscriptstyle"}),[])}),scriptstyle:new x("scriptstyle",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"scriptstyle"}),[])}),show:new x("show",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.string,i=e.mouth.eat();if(!i)return this.invalid=!0,[this];var s='"'+this.escapeChar+this.name+t.substring(0,t.length-e.mouth.string.length)+'":\n';if("command"==i.type||"character"==i.type&&i.cat==J.cats.active){var a="command"==i.type?e.scopes.last().defs.primitive[i.name]||e.scopes.last().defs.macros[i.name]:e.scopes.last().defs.active[i.char];if(!a)return o(s+i.escapeChar+i.name+"=undefined."),[];if("primitive"==a.type||a.isLet&&"primitive"==a.original.type)return o(s+i.escapeChar+i.name+"="+String.fromCharCode(e.scopes.last().registers.named.escapechar.value)+(a.original||a).name),[];if(!a.isLet){a.proxy&&(a=a.original),s+=(i.escapeChar+i.name||i.char)+"=macro:\n";for(var r=0,n=0,l=a.parameters.length;n<l;n++)"character"==a.parameters[n].type&&a.parameters[n].cat!=J.cats.param?s+=a.parameters[n].char:"character"==a.parameters[n].type?s+=a.parameters[n].char+ ++r:s+=a.parameters[n].escapeChar+a.parameters[n].name;s+="->";for(n=0,l=a.replacement.length;n<l;n++)"character"==a.replacement[n].type?s+=a.replacement[n].char:s+=a.replacement[n].escapeChar+a.replacement[n].name;return o(s),[]}s+=(i.escapeChar+i.name||i.char)+"=",i=a.original.replacement[0]}switch(i.cat){case J.cats.open:o(s+"begin-group character "+i.char+".");break;case J.cats.close:o(s+"end-group character "+i.char+".");break;case J.cats.math:o(s+"math shift character "+i.char+".");break;case J.cats.alignment:o(s+"alignment tab character "+i.char+".");break;case J.cats.param:o(s+"macro parameter character "+i.char+".");break;case J.cats.super:o(s+"superscript character "+i.char+".");break;case J.cats.sub:o(s+"subscript character "+i.char+".");break;case J.cats.whitespace:o(s+"blank space "+i.char+".");break;case J.cats.letter:o(s+"the letter "+i.char+".");break;case J.cats.all:default:o(s+"the character "+i.char+".")}return[]}),showthe:new x("showthe",function(e){var t=Symbol();for(e.mouth.saveState(t);;){var i,s,a,r,n=e.mouth.eat();if(!n||"command"!=n.type&&("character"!=n.type||n.cat!=J.cats.active))return n&&n.register?("integer"==n.type?o(n.value+"."):"dimension"==n.type?(i=Math.round(n.sp.value/65536*1e5)/1e5,o((i+=Math.round(n.em.value/65536*1e5)/1e5*12)+(Number.isInteger(i)?".0pt.":"pt."))):"mu dimension"==n.type?o((a=Math.round(n.mu.value/65536*1e5)/1e5)+(Number.isInteger(a)?".0mu.":"mu.")):"glue"==n.type?(s="",i=Math.round(n.start.sp.value/65536*1e5)/1e5,s=(i+=Math.round(n.start.em.value/65536*1e5)/1e5*12)+(Number.isInteger(i)?".0pt":"pt"),n.stretch instanceof xt&&(n.stretch.sp.value||n.stretch.em.value)?(i=Math.round(n.stretch.sp.value/65536*1e5)/1e5,s+=" plus "+(i+=Math.round(n.stretch.em.value/65536*1e5)/1e5*12)+(Number.isInteger(i)?".0pt":"pt")):n.stretch instanceof Y&&n.stretch.number.value&&(s+=" plus "+(r=Math.round(n.stretch.number.value/65536*1e5)/1e5)+(Number.isInteger(r)?".0":"")+"fil"+new Array(n.stretch.magnitude.value).join("l")),n.shrink instanceof xt&&(n.shrink.sp.value||n.shrink.em.value)?(i=Math.round(n.shrink.sp.value/65536*1e5)/1e5,s+=" minus "+(i+=Math.round(n.shrink.em.value/65536*1e5)/1e5*12)+(Number.isInteger(i)?".0pt":"pt")):n.shrink instanceof Y&&n.shrink.number.value&&(s+=" minus "+(r=Math.round(n.shrink.number.value/65536*1e5)/1e5)+(Number.isInteger(r)?".0":"")+"fil"+new Array(n.shrink.magnitude.value).join("l")),o(s+".")):"mu glue"==n.type&&(s="",s=(a=Math.round(n.start.mu.value/65536*1e5)/1e5)+(Number.isInteger(a)?".0mu":"mu"),n.stretch instanceof V&&n.stretch.mu.value?s+=" plus "+(a=Math.round(n.stretch.mu.value/65536*1e5)/1e5)+(Number.isInteger(a)?".0mu":"mu"):n.stretch instanceof Y&&n.stretch.number.value&&(s+=" plus "+(r=Math.round(n.stretch.number.value/65536*1e5)/1e5)+(Number.isInteger(r)?".0":"")+"fil"+new Array(n.stretch.magnitude.value).join("l")),n.shrink instanceof V&&n.shrink.mu.value?s+=" minus "+(a=Math.round(n.shrink.mu.value/65536*1e5)/1e5)+(Number.isInteger(a)?".0mu":"mu"):n.shrink instanceof Y&&n.shrink.number.value&&(s+=" minus "+(r=Math.round(n.shrink.number.value/65536*1e5)/1e5)+(Number.isInteger(r)?".0":"")+"fil"+new Array(n.shrink.magnitude.value).join("l")),o(s+".")),[]):(this.invalid=!0,e.mouth.loadState(t),[this]);var l=e.mouth.expand(n,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,l)}}),skip:new x("skip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");if(!t||t.value<0)return this.invalid=!0,[this];if(!J.registers.skip[t.value]){J.registers.skip[t.value]=new _(new xt(0,0),new xt(0,0),new xt(0,0));for(var i=0,s=e.scopes.length;i<s;i++)e.scopes[i].registers.skip[t.value]=new _((i?e.scopes[i-1]:J).registers.skip[t.value])}return[e.scopes.last().registers.skip[t.value]]}),skipdef:new x("skipdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if("command"!=i.type)return this.invalid=!0,e.mouth.loadState(countDefSym),[!0];if(i.name in J.defs.primitive||i.name in J.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var s=e.mouth.eat();s&&"character"==s.type&&"="==s.char&&s.cat==J.cats.all||s&&e.mouth.revert();var a=e.mouth.eat("integer");if(!a||a.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i=i.name,a=a.value,!J.registers.skip[a]){J.registers.skip[a]=new _(new xt(0,0),new xt(0,0),new xt(0,0));for(var r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.skip[a]=new _((r?e.scopes[r-1]:J).registers.skip[a])}if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){J.registers.named[i]=J.registers.skip[a],delete J.defs.macros[i];for(r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.named[i]=e.scopes[r].registers.skip[a],delete e.scopes[r].defs.macros[i]}else e.scopes.last().registers.named[i]=e.scopes.last().registers.skip[a],delete e.scopes.last().defs.macros[i]}),sl:new x("sl",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"sl"}),[])}),span:new x("span",function(e){"mathchoice"==e.contexts.last&&e.contexts.last.failed();for(var t=!1,i=e.scopes.length-1;0<=i;i--)if(e.scopes[i].isHalignCell){t=e.scopes[i];break}if(!t)return this.invalid=!0,[this];var s=t.parentScope,a=s.cellData[s.cellData.length-1];if(a[a.length-1].omit&&(this.postPreamble=!0),this.postPreamble&&!e.scopes.last().isHalignCell||"scope"!=e.contexts.last)return this.invalid=!0,[this];if(!this.postPreamble){for(var r=-1,i=0,n=a.length;i<n;i++)r+=a[i].span;if(s.preamble[r])h=s.preamble[r][1];else{if(!~s.repeatPreambleAt)return this.invalid=!0,[this];h=(u=s.preamble.slice(s.repeatPreambleAt,s.preamble.length))[(r-s.repeatPreambleAt)%u.length][1]}if(!s.preamble[++r]&&!~s.repeatPreambleAt)return this.invalid=!0,[this];for(var l=[],i=0,n=h.length;i<n;i++){var o={};for(var c in h[i])o[c]=h[i][c];l.push(o)}return this.postPreamble=!0,l.concat(this)}e.scopes.last().root&&(e.scopes.last().root.invalid=!0),e.contexts.pop();var h=e.scopes.last().tokens;e.scopes.last().isFrac?(a[a.length-1].content.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:e.scopes.last().fracNumerator,denominator:h,barWidth:e.scopes.last().barWidth,delims:[e.scopes.last().fracLeftDelim,e.scopes.last().fracRightDelim],nullDelimiterSpace:new xt(e.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),e.scopes.pop()):(e.scopes.pop(),a[a.length-1].content=a[a.length-1].content.concat(h));var p=Symbol();for(e.mouth.saveState(p),a[a.length-1].omit=!1,a[a.length-1].span++;;){if(!(o=e.mouth.eat())){e.mouth.loadState(p);break}if("character"==o.type&&o.cat!=J.cats.active){e.mouth.loadState(p);break}if("command"==o.type||"character"==o.type&&o.cat==J.cats.active){if(o.name in e.scopes.last().registers.named){e.mouth.loadState(p);break}var d,m="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char];if(!m){e.mouth.loadState(p);break}if(m===J.defs.primitive.the||m.proxy&&m.original===J.defs.primitive.the||m===J.defs.primitive.expandafter||m.proxy&&m.original===J.defs.primitive.expandafter||m===J.defs.primitive.number||m.proxy&&m.original===J.defs.primitive.number||m===J.defs.primitive.romannumeral||m.proxy&&m.original===J.defs.primitive.romannumeral||m===J.defs.primitive.csname||m.proxy&&m.original===J.defs.primitive.csname||m===J.defs.primitive.string||m.proxy&&m.original===J.defs.primitive.string||m===J.defs.primitive.if||m.isLet&&m.original===J.defs.primitive.if||m===J.defs.primitive.ifcase||m.isLet&&m.original===J.defs.primitive.ifcase||m===J.defs.primitive.ifcat||m.isLet&&m.original===J.defs.primitive.ifcat||m===J.defs.primitive.ifdim||m.isLet&&m.original===J.defs.primitive.ifdim||m===J.defs.primitive.ifeof||m.isLet&&m.original===J.defs.primitive.ifeof||m===J.defs.primitive.iffalse||m.isLet&&m.original===J.defs.primitive.iffalse||m===J.defs.primitive.ifodd||m.isLet&&m.original===J.defs.primitive.ifodd||m===J.defs.primitive.ifnum||m.isLet&&m.original===J.defs.primitive.ifnum||m===J.defs.primitive.ifhmode||m.isLet&&m.original===J.defs.primitive.ifhmode||m===J.defs.primitive.ifinner||m.isLet&&m.original===J.defs.primitive.ifinner||m===J.defs.primitive.ifmmode||m.isLet&&m.original===J.defs.primitive.ifmmode||m===J.defs.primitive.iftrue||m.isLet&&m.original===J.defs.primitive.iftrue||m===J.defs.primitive.ifvmode||m.isLet&&m.original===J.defs.primitive.ifvmode||m===J.defs.primitive.ifvoid||m.isLet&&m.original===J.defs.primitive.ifvoid||m===J.defs.primitive.ifx||m.isLet&&m.original===J.defs.primitive.ifx){if(1==(d=e.mouth.expand(o,e.mouth)).length&&d[0]===o&&o.invalid){e.mouth.loadState(p);break}e.mouth.queue.unshift.apply(e.mouth.queue,d);continue}if(m===J.defs.primitive.omit||m.proxy&&m.original===J.defs.primitive.omit){a[a.length-1].omit=!0;break}if("primitive"==m.type||m.proxy&&"primitive"==m.original.type){e.mouth.loadState(p);break}if(1==(d=e.mouth.expand(o,e.mouth)).length&&d[0]==-o&&o.invalid){e.mouth.loadState(p);break}e.mouth.queue.unshift.apply(e.mouth.queue,d)}}if(e.contexts.push("scope"),new e.Scope,e.scopes.last().isHalignCell=!0,!a[a.length-1].omit){for(var u,r=-1,i=0,n=a.length;i<n;i++)r+=a[i].span;s.preamble[r]?h=s.preamble[r][0]:~s.repeatPreambleAt&&(h=(u=s.preamble.slice(s.repeatPreambleAt,s.preamble.length))[(r-s.repeatPreambleAt)%u.length][0]);for(l=[],i=0,n=h.length;i<n;i++){o={};for(var c in h[i])o[c]=h[i][c];l.push(o)}return l}}),radical:new x("sqrt",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"rad",index:[],token:this}),[])}),root:new x("root",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last||e.scopes.last().root?(this.invalid=!0,[this]):(this.ignore=!0,[e.scopes.last().root=this])}),string:new x("string",function(e){var t=e.mouth.eat();return t?"character"==t.type?[{type:"character",cat:J.cats.all,char:t.char,code:t.code}]:"command"==t.type?(String.fromCharCode(e.scopes.last().registers.named.escapechar.value)+t.name).split("").map(function(e){return{type:"character",cat:J.cats.all,char:e,code:e.charCodeAt(0)}}):(this.invalid=!0,e.mouth.revert(),[this]):(this.invalid=!0,[this])}),textstyle:new x("textstyle",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"textstyle"}),[])}),the:new x("the",function(e){var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(i&&("command"==i.type||"character"==i.type&&i.cat==J.cats.active)){var s=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,s)}else{if(!i||!i.register)return this.invalid=!0,e.mouth.loadState(t),[this];if("integer"==i.type)return i.value.toString().split("").map(function(e){return{type:"character",cat:J.cats.all,char:e,code:e.charCodeAt(0)}});if("dimension"==i.type){var a=Math.round(i.sp.value/65536*1e5)/1e5;return((a+=Math.round(i.em.value/65536*1e5)/1e5*12)+(Number.isInteger(a)?".0pt":"pt")).split("").map(function(e){return{type:"character",cat:J.cats.all,char:e,code:e.charCodeAt(0)}})}if("mu dimension"==i.type)return((n=Math.round(i.mu.value/65536*1e5)/1e5)+(Number.isInteger(n)?".0mu":"mu")).split("").map(function(e){return{type:"character",cat:J.cats.all,char:e,code:e.charCodeAt(0)}});if("glue"==i.type){var r="",a=Math.round(i.start.sp.value/65536*1e5)/1e5;return r=(a+=Math.round(i.start.em.value/65536*1e5)/1e5*12)+(Number.isInteger(a)?".0pt":"pt"),i.stretch instanceof xt&&(i.stretch.sp.value||i.stretch.em.value)?(a=Math.round(i.stretch.sp.value/65536*1e5)/1e5,r+=" plus "+(a+=Math.round(i.stretch.em.value/65536*1e5)/1e5*12)+(Number.isInteger(a)?".0pt":"pt")):i.stretch instanceof Y&&i.stretch.number.value&&(r+=" plus "+(l=Math.round(i.stretch.number.value/65536*1e5)/1e5)+(Number.isInteger(l)?".0":"")+"fil"+new Array(i.stretch.magnitude.value).join("l")),i.shrink instanceof xt&&(i.shrink.sp.value||i.shrink.em.value)?(a=Math.round(i.shrink.sp.value/65536*1e5)/1e5,r+=" minus "+(a+=Math.round(i.shrink.em.value/65536*1e5)/1e5*12)+(Number.isInteger(a)?".0pt":"pt")):i.shrink instanceof Y&&i.shrink.number.value&&(r+=" minus "+(l=Math.round(i.shrink.number.value/65536*1e5)/1e5)+(Number.isInteger(l)?".0":"")+"fil"+new Array(i.shrink.magnitude.value).join("l")),r.split("").map(function(e){return{type:"character",cat:J.cats.all,char:e,code:e.charCodeAt(0)}})}if("mu glue"==i.type){var n,l,r="";return r=(n=Math.round(i.start.mu.value/65536*1e5)/1e5)+(Number.isInteger(n)?".0mu":"mu"),i.stretch instanceof V&&i.stretch.mu.value?r+=" plus "+(n=Math.round(i.stretch.mu.value/65536*1e5)/1e5)+(Number.isInteger(n)?".0mu":"mu"):i.stretch instanceof Y&&i.stretch.number.value&&(r+=" plus "+(l=Math.round(i.stretch.number.value/65536*1e5)/1e5)+(Number.isInteger(l)?".0":"")+"fil"+new Array(i.stretch.magnitude.value).join("l")),i.shrink instanceof V&&i.shrink.mu.value?r+=" minus "+(n=Math.round(i.shrink.mu.value/65536*1e5)/1e5)+(Number.isInteger(n)?".0mu":"mu"):i.shrink instanceof Y&&i.shrink.number.value&&(r+=" minus "+(l=Math.round(i.shrink.number.value/65536*1e5)/1e5)+(Number.isInteger(l)?".0":"")+"fil"+new Array(i.shrink.magnitude.value).join("l")),r.split("").map(function(e){return{type:"character",cat:J.cats.all,char:e,code:e.charCodeAt(0)}})}}}}),time:new x("time",function(e){var t=new Date;return[new G(60*t.getHours()+t.getMinutes())]}),uccode:new x("uccode",function(e){var t=e.mouth.eat("integer");return t||t.value<0?[e.scopes.last().uc[t.value]=e.scopes.last().uc[t.value]||new G(0)]:(this.invalid=!0,[this])}),underline:new x("underline",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"under",token:this}),[])}),uppercase:new x("uppercase",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||i.cat!=J.cats.open)return this.invalid=!0,e.mouth.loadState(t),[this];for(var s=[],a=1;;){var r=e.mouth.eat("pre space");if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==r.type&&r.cat==J.cats.open)a++,s.push(r);else if("character"==r.type&&r.cat==J.cats.close){if(!(0<--a))break;s.push(r)}else s.push(r)}for(var n=0,l=s.length;n<l;n++)"character"==s[n].type&&e.scopes.last().uc[s[n].code]&&0<e.scopes.last().uc[s[n].code].value&&(s[n].code=e.scopes.last().uc[s[n].code].value,s[n].char=String.fromCharCode(s[n].code));return s}),vbox:new x("vbox",function(e){var t,i,s=Symbol();for(e.mouth.saveState(s);;){var a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("command"!=a.type&&("character"!=a.type||a.cat!=J.cats.active)){if("character"!=a.type||"t"!=a.char&&"T"!=a.char){if("character"!=a.type||"s"!=a.char&&"S"!=a.char){if("character"!=a.type||a.cat!=J.cats.open)return this.invalid=!0,e.mouth.loadState(s),[this];e.mouth.revert();break}var r=e.mouth.eat(),n=e.mouth.eat(),l=e.mouth.eat(),o=e.mouth.eat(),c=e.mouth.eat();if(!r||"character"!=r.type||"p"!=r.char&&"P"!=r.char||r.cat==J.cats.active||!n||"character"!=n.type||"r"!=n.char&&"R"!=n.char||n.cat==J.cats.active||!l||"character"!=l.type||"e"!=l.char&&"E"!=l.char||l.cat==J.cats.active||!o||"character"!=o.type||"a"!=o.char&&"A"!=o.char||o.cat==J.cats.active||!c||"character"!=c.type||"d"!=c.char&&"D"!=c.char||c.cat==J.cats.active)return this.invalid=!0,e.mouth.loadState(s),[this];if(h=e.mouth.eat("dimension")){t=h;break}return this.invalid=!0,e.mouth.loadState(s),[this]}var h,p=e.mouth.eat("pre space");if(!p||"character"!=p.type||"o"!=p.char&&"O"!=a.char||a.cat==J.cats.active)return this.invalid=!0,e.mouth.loadState(s),[this];if(h=e.mouth.eat("dimension")){i=h;break}return this.invalid=!0,e.mouth.loadState(s),[this]}var d="command"==a.type?e.scopes.last().defs.primitive[a.name]||e.scopes.last().defs.macros[a.name]:e.scopes.last().defs.active[a.char];if(d&&(d===J.defs.primitive.relax||d.proxy&&d.original===J.defs.primitive.relax))break;var m=e.mouth.expand(a,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,m)}var u=e.mouth.preview();return u&&"character"==u.type&&u.cat==J.cats.open?(i||t||(t=new xt(0,0)),e.tokens.push({type:"box wrapper",value:"vertical",to:i,spread:t,token:this}),[]):(this.invalid=!0,e.mouth.loadState(s),[this])}),vcenter:new x("vcenter",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"vcenter",token:this}),[])}),vfil:new x("vfil",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"vglue",glue:new _(new xt(0),new Y(1,1),new xt(0))}),[])}),vfill:new x("vfill",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"vglue",glue:new _(new xt(0),new Y(1,2),new xt(0))}),[])}),vrule:new x("vrule",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);for(var i=!1,s=!1,a=!1;;){var r=e.mouth.eat();if(!r){e.mouth.revert();break}if("h"!=r.char&&"H"!=r.char||r.cat==J.cats.active){if("d"!=r.char&&"D"!=r.char||r.cat==J.cats.active){if("w"!=r.char&&"W"!=r.char||r.cat==J.cats.active){e.mouth.revert();break}if(!(r=e.mouth.eat("pre space"))||"i"!=r.char&&"I"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"d"!=r.char&&"D"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?5:4);else{if(r=e.mouth.eat("dimension")){a=r;continue}e.mouth.revert(5)}break}if(!(r=e.mouth.eat("pre space"))||"e"!=r.char&&"E"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"p"!=r.char&&"P"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?5:4);else{if(r=e.mouth.eat("dimension")){s=r;continue}e.mouth.revert(5)}break}if(!(r=e.mouth.eat("pre space"))||"e"!=r.char&&"E"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"i"!=r.char&&"I"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"g"!=r.char&&"G"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?5:4);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==J.cats.active)e.mouth.revert(r?6:5);else{if(r=e.mouth.eat("dimension")){i=r;continue}e.mouth.revert(6)}break}return a=a||new xt(0,65536/30),e.tokens.push({type:"rule",ruleType:"v",height:i,depth:s,width:a}),[]}),vskip:new x("vskip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("glue");return t?(e.tokens.push({type:"vglue",glue:t}),[]):(this.invalid=!0,[this])}),xdef:new x("xdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,s=e.mouth.eat();if(!s)return this.invalid=!0,[this];if("character"==s.type){if(e.catOf(s.char)!=J.cats.active)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",s=s.char}else if("command"==s.type&&(i="macro",(s=s.name)in e.scopes.last().defs.primitive||s in J.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];for(var a=[],r=0,n=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if(o.cat==J.cats.open){e.mouth.revert();break}if(o.cat==J.cats.param){var l=e.mouth.eat("pre space");if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.cat==J.cats.open)n=!0,e.mouth.revert(),a.push({type:"character",cat:J.cats.open,char:l.char,code:l.code});else{if(!(48<l.code&&l.code<58&&l.cat==J.cats.all&&+l.char==r+1))return this.invalid=!0,e.mouth.loadState(t),[this];a.push(o),r++}}else a.push(o)}for(var o,c=0,h=[],p=!1,d=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=o.type||o.cat!=J.cats.param||d)if("character"==o.type&&o.cat==J.cats.open)c++,h.push(o),p=!1;else if("character"==o.type&&o.cat==J.cats.close){if(0==--c)break;h.push(o),p=!1}else if(p)h.push(o),p=!1;else if("command"==o.type||"character"==o.type&&o.cat==J.cats.active){if(o.name in e.scopes.last().registers.named){h.push(o);continue}if(!(f="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char]))return this.invalid=!0,e.mouth.loadState(t),[this];if(f===J.defs.primitive.the||f.proxy&&f.original===J.defs.primitive.the||f===J.defs.primitive.expandafter||f.proxy&&f.original===J.defs.primitive.expandafter||f===J.defs.primitive.number||f.proxy&&f.original===J.defs.primitive.number||f===J.defs.primitive.romannumeral||f.proxy&&f.original===J.defs.primitive.romannumeral||f===J.defs.primitive.csname||f.proxy&&f.original===J.defs.primitive.csname||f===J.defs.primitive.string||f.proxy&&f.original===J.defs.primitive.string||f===J.defs.primitive.if||f.isLet&&f.original===J.defs.primitive.if||f===J.defs.primitive.ifcase||f.isLet&&f.original===J.defs.primitive.ifcase||f===J.defs.primitive.ifcat||f.isLet&&f.original===J.defs.primitive.ifcat||f===J.defs.primitive.ifdim||f.isLet&&f.original===J.defs.primitive.ifdim||f===J.defs.primitive.ifeof||f.isLet&&f.original===J.defs.primitive.ifeof||f===J.defs.primitive.iffalse||f.isLet&&f.original===J.defs.primitive.iffalse||f===J.defs.primitive.ifodd||f.isLet&&f.original===J.defs.primitive.ifodd||f===J.defs.primitive.ifnum||f.isLet&&f.original===J.defs.primitive.ifnum||f===J.defs.primitive.ifhmode||f.isLet&&f.original===J.defs.primitive.ifhmode||f===J.defs.primitive.ifinner||f.isLet&&f.original===J.defs.primitive.ifinner||f===J.defs.primitive.ifmmode||f.isLet&&f.original===J.defs.primitive.ifmmode||f===J.defs.primitive.iftrue||f.isLet&&f.original===J.defs.primitive.iftrue||f===J.defs.primitive.ifvmode||f.isLet&&f.original===J.defs.primitive.ifvmode||f===J.defs.primitive.ifvoid||f.isLet&&f.original===J.defs.primitive.ifvoid||f===J.defs.primitive.ifx||f.isLet&&f.original===J.defs.primitive.ifx){var m=e.mouth.expand(o,e.mouth);if(1==m.length&&m[0]===o&&o.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,m);continue}if(f===J.defs.primitive.noexpand||f.proxy&&f.original===J.defs.primitive.noexpand){p=!0;continue}if(f instanceof x||f.proxy&&f.original instanceof x){h.push(o);continue}e.mouth.queue.unshift.apply(e.mouth.queue,e.mouth.expand(o,e.mouth))}else h.push(o);else{var u=e.mouth.eat("pre space");if(!u||!(u.cat==J.cats.param||u.cat==J.cats.all&&u.char<=a.length&&1<=u.char))return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert(),u.cat==J.cats.param&&(d=!0),h.push(o),p=!1}}h.shift(),n&&h.push(a[a.length-1]);var f=new k(h,a);if(e.scopes.last().registers.named.globaldefs.value<0)e.scopes.last().defs["macro"==i?"macros":"active"][s]=f,delete e.scopes.last().registers.named[s];else if("macro"==i){J.defs.macros[s]=f,delete J.registers.named[s];for(var v=0,g=e.scopes.length;v<g;v++)e.scopes[v].defs.macros[s]=f,delete e.scopes.last().registers.named[s]}else{J.defs.active[s]=f,delete J.registers.named[s];for(v=0,g=e.scopes.length;v<g;v++)e.scopes[v].defs.ative[s]=f,delete e.scopes.last().registers.named[s]}return e.toggles.global=!1,[]}),year:new x("year",function(e){return[new G((new Date).getFullYear())]}),"@debug":new x("@debug",function(e){}),"@exec@JavaScript":new x("@exec@JavaScript",function(e){})},macros:{},active:{}},registers:{count:{},dimen:{},skip:{},muskip:{},named:{pretolerance:new G(100),tolerance:new G(200),hbadness:new G(1e3),vbadness:new G(1e3),linepenalty:new G(10),hypenpenalty:new G(50),exhyphenpenalty:new G(50),binoppenalty:new G(700),relpenalty:new G(500),clubpenalty:new G(150),widowpenalty:new G(150),displaywidowpenalty:new G(50),brokenpenalty:new G(100),predisplaypenalty:new G(1e4),postdisplaypenalty:new G(0),floatingpenalty:new G(0),interlinepenalty:new G(0),outputpenalty:new G(-10001),doublehyphendemerits:new G(1e4),finalhyphendemerits:new G(5e3),adjdemerits:new G(1e4),looseness:new G(0),pausing:new G(0),holdinginserts:new G(0),tracingonline:new G(0),tracingmacros:new G(0),tracingstats:new G(0),tracingparagraphs:new G(0),tracingpages:new G(0),tracingoutput:new G(0),tracinglostchars:new G(0),tracingcommands:new G(0),tracingrestores:new G(0),language:new G(0),uchyph:new G(1),lefthyphenmin:new G(2),righthyphenmin:new G(3),globaldefs:new G(0),defaulthyphenchar:new G(45),defaultskewchar:new G(-1),escapechar:new G(92),endlinechar:new G(13),newlinechar:new G(10),maxdeadcycles:new G(100),hangafter:new G(1),fam:new G(0),mag:new G(1e3),delimiterfactor:new G(901),showboxbreadth:new G(-1),showboxdepth:new G(-1),errorcontextlines:new G(-1),hfuzz:new xt(6553.6,0),vfuzz:new xt(6553.6,0),overfullrule:new xt(0,0),emergencystetch:new xt(0,0),hsize:new xt(22609920,0),vsize:new xt(36044800,0),maxdepth:new xt(327680,0),splitmaxdepth:new xt(1074397184,-65536),boxmaxdepth:new xt(1074397184,-65536),lineskiplimit:new xt(0,0),delimitershortfall:new xt(327680,0),nulldelimiterspace:new xt(0,6553.6),scriptspace:new xt(32768,0),mathsurround:new xt(0,0),predisplaystyle:new xt(0,0),displaywidth:new xt(0,0),displayindent:new xt(0,0),parindent:new xt(983040,0),hangindent:new xt(0,0),hoffset:new xt(0,0),voffset:new xt(0,0),baselineskip:new _(new xt(786432,0)),lineskip:new _(new xt(65536,0)),parskip:new _(new xt(0,0),new xt(65536,0)),abovedisplayskip:new _(new xt(655360,0),new xt(131072,0),new xt(327680,0)),abovedisplayshortskip:new _(new xt(0,0),new xt(196608,0)),belowdisplayskip:new _(new xt(0,0),new xt(196608,0)),belowdisplayshortskip:new _(new xt(393216,0),new xt(196608,0),new xt(196608,0)),leftskip:new _(new xt(0,0)),rightskip:new _(new xt(0,0)),topskip:new _(new xt(655360,0)),splittopskip:new _(new xt(655360,0)),tabskip:new _(new xt(0,0)),spaceskip:new _(new xt(0,0)),xspaceskip:new _(new xt(0,0)),parfillskip:new _(new xt(0,0),new Y(65536,1)),thinmuskip:new $(new V(196608)),medmuskip:new $(new V(262144),new V(131072),new V(262144)),thickmuskip:new $(new V(327680),new V(327680))}},cats:function(){for(var e={92:new G(0,0,15),123:new G(1,0,15),125:new G(2,0,15),36:new G(3,0,15),38:new G(4,0,15),10:new G(5,0,15),35:new G(6,0,15),94:new G(7,0,15),95:new G(8,0,15),0:new G(9,0,15),9:new G(10,0,15),32:new G(10,0,15),126:new G(13,0,15),37:new G(14,0,15),127:new G(15,0,15),escape:0,open:1,close:2,math:3,alignment:4,eol:5,param:6,super:7,sub:8,ignored:9,whitespace:10,letter:11,all:12,active:13,comment:14,invalid:15},t=0;t<52;t++)e["abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charCodeAt(t)]=new G(11);return e}(),mathcodes:function(){for(var e={ord:0,op:1,bin:2,rel:3,open:4,close:5,punct:6,variable:7,active:8},t="+-*±∓∖×∗⋆⋄∘∙÷∩∪⊎⊓⊔◃▹≀◯△▽∨∧⊕⊖⊗⊘⊙†‡⨿",i='<>=:"≤≺⪯≪⊂⊆⊏⊑∈⊢⌣⌢≥≻⪰≫⊃⊇⊐⊒∋⊣≡∼≃≍≈≅⋈∝⊨≐⊥≮≰⊀⊄⊈⋢≯≱⊁⊅⊉⋣≠≢≁≄≆≭',s="abcdefghħijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZαβγδϵεζηθϑικλμνξπϖρϱσςτυϕφχψω",a=0,r="".length;a<r;a++)e["".charCodeAt(a)]=new G(1,0,8);for(a=0,r=t.length;a<r;a++)e[t.charCodeAt(a)]=new G(2,0,8);for(a=0,r=i.length;a<r;a++)e[i.charCodeAt(a)]=new G(3,0,8);for(a=0,r="([{`".length;a<r;a++)e["([{`".charCodeAt(a)]=new G(4,0,8);for(a=0,r="}])!?".length;a<r;a++)e["}])!?".charCodeAt(a)]=new G(5,0,8);for(a=0,r=",;".length;a<r;a++)e[",;".charCodeAt(a)]=new G(6,0,8);for(a=0,r=s.length;a<r;a++)e[s.charCodeAt(a)]=new G(7,0,8);return e}(),delims:[40,41,46,60,62,47,91,92,93,123,124,125,8214,8593,8595,8597,8657,8659,8661,8741,8968,8969,8970,8971,9130,9136,9137,9168,10216,10217,10222,10223],parameters:["pretolerance","tolerance","hbadness","vbadness","linepenalty","hypenpenalty","exhyphenpenalty","binoppenalty","relpenalty","clubpenalty","widowpenalty","displaywidowpenalty","brokenpenalty","predisplaypenalty","postdisplaypenalty","floatingpenalty","interlinepenalty","outputpenalty","doublehyphendemerits","finalhyphendemerits","adjdemerits","looseness","pausing","holdinginserts","tracingonline","tracingmacros","tracingstats","tracingparagraphs","tracingpages","tracingoutput","tracinglostchars","tracingcommands","tracingrestores","language","uchyph","lefthyphenmin","righthyphenmin","globaldefs","defaulthyphenchar","defaultskewchar","escapechar","endlinechar","newlinechar","maxdeadcycles","hangafter","fam","mag","delimiterfactor","showboxbreadth","showboxdepth","errorcontextlines","hfuzz","vfuzz","overfullrule","emergencystetch","hsize","vsize","maxdepth","splitmaxdepth","boxmaxdepth","lineskiplimit","delimitershortfall","nulldelimiterfall","scriptspace","mathsurround","predisplaystyle","displaywidth","displayindent","parindent","hangindent","hoffset","voffset","baselineskip","lineskip","parskip","abovedisplayskip","abovedisplayshortskip","belowdisplayskip","belowdisplayshortskip","leftskip","rightskip","topskip","splittopskip","tabskip","spaceskip","xspaceskip","parfillskip","thinmuskip","medmuskip","thickmuskip"],lc:{65:new G(97),66:new G(98),67:new G(99),68:new G(100),69:new G(101),70:new G(102),71:new G(103),72:new G(104),73:new G(105),74:new G(106),75:new G(107),76:new G(108),77:new G(109),78:new G(110),79:new G(111),80:new G(112),81:new G(113),82:new G(114),83:new G(115),84:new G(116),85:new G(117),86:new G(118),87:new G(119),88:new G(120),89:new G(121),90:new G(122),97:new G(97),98:new G(98),99:new G(99),100:new G(100),101:new G(101),102:new G(102),103:new G(103),104:new G(104),105:new G(105),106:new G(106),107:new G(107),108:new G(108),109:new G(109),110:new G(110),111:new G(111),112:new G(112),113:new G(113),114:new G(114),115:new G(115),116:new G(116),117:new G(117),118:new G(118),119:new G(119),120:new G(120),121:new G(121),122:new G(122),913:new G(945),914:new G(946),915:new G(947),916:new G(948),917:new G(949),918:new G(950),919:new G(951),920:new G(952),921:new G(953),922:new G(954),923:new G(955),924:new G(956),925:new G(957),926:new G(958),927:new G(959),928:new G(960),929:new G(961),931:new G(963),932:new G(964),933:new G(965),934:new G(966),935:new G(967),936:new G(968),937:new G(969),945:new G(945),946:new G(946),947:new G(947),948:new G(948),949:new G(949),950:new G(950),951:new G(951),952:new G(952),953:new G(953),954:new G(954),955:new G(955),956:new G(956),957:new G(957),958:new G(958),959:new G(959),960:new G(960),961:new G(961),963:new G(963),964:new G(964),965:new G(965),966:new G(966),967:new G(967),968:new G(968),969:new G(969)},uc:{65:new G(65),66:new G(66),67:new G(67),68:new G(68),69:new G(69),70:new G(70),71:new G(71),72:new G(72),73:new G(73),74:new G(74),75:new G(75),76:new G(76),77:new G(77),78:new G(78),79:new G(79),80:new G(80),81:new G(81),82:new G(82),83:new G(83),84:new G(84),85:new G(85),86:new G(86),87:new G(87),88:new G(88),89:new G(89),90:new G(90),97:new G(65),98:new G(66),99:new G(67),100:new G(68),101:new G(69),102:new G(70),103:new G(71),104:new G(72),105:new G(73),106:new G(74),107:new G(75),108:new G(76),109:new G(77),110:new G(78),111:new G(79),112:new G(80),113:new G(81),114:new G(82),115:new G(83),116:new G(84),117:new G(85),118:new G(86),119:new G(87),120:new G(88),121:new G(89),122:new G(90),913:new G(913),914:new G(914),915:new G(915),916:new G(916),917:new G(917),918:new G(918),919:new G(919),920:new G(920),921:new G(921),922:new G(922),923:new G(923),924:new G(924),925:new G(925),926:new G(926),927:new G(927),928:new G(928),929:new G(929),931:new G(931),932:new G(932),933:new G(933),934:new G(934),935:new G(935),936:new G(936),937:new G(937),945:new G(913),946:new G(914),947:new G(915),948:new G(916),949:new G(917),950:new G(918),951:new G(919),952:new G(920),953:new G(921),954:new G(922),955:new G(923),956:new G(924),957:new G(925),958:new G(926),959:new G(927),960:new G(928),961:new G(929),963:new G(931),964:new G(932),965:new G(933),966:new G(934),967:new G(935),968:new G(936),969:new G(937)}};function l(e,a,r,t){var i,s,n,l=[];if(e)for(;;){if(!(i=a.eat()))return this.invalid=!0,a.loadState(t),[this];if("command"==i.type||"character"==i.type&&i.cat==J.cats.active){if(!(s="command"==i.type?r.last().defs.primitive[i.name]||r.last().defs.macros[i.name]:r.last().defs.active[i.char])){l.push(i);continue}if(s===J.defs.primitive.if||s.isLet&&s.original===J.defs.primitive.if||s===J.defs.primitive.ifcase||s.isLet&&s.original===J.defs.primitive.ifcase||s===J.defs.primitive.ifcat||s.isLet&&s.original===J.defs.primitive.ifcat||s===J.defs.primitive.ifdim||s.isLet&&s.original===J.defs.primitive.ifdim||s===J.defs.primitive.ifeof||s.isLet&&s.original===J.defs.primitive.ifeof||s===J.defs.primitive.iffalse||s.isLet&&s.original===J.defs.primitive.iffalse||s===J.defs.primitive.ifodd||s.isLet&&s.original===J.defs.primitive.ifodd||s===J.defs.primitive.ifnum||s.isLet&&s.original===J.defs.primitive.ifnum||s===J.defs.primitive.ifhmode||s.isLet&&s.original===J.defs.primitive.ifhmode||s===J.defs.primitive.ifinner||s.isLet&&s.original===J.defs.primitive.ifinner||s===J.defs.primitive.ifmmode||s.isLet&&s.original===J.defs.primitive.ifmmode||s===J.defs.primitive.iftrue||s.isLet&&s.original===J.defs.primitive.iftrue||s===J.defs.primitive.ifvmode||s.isLet&&s.original===J.defs.primitive.ifvmode||s===J.defs.primitive.ifvoid||s.isLet&&s.original===J.defs.primitive.ifvoid||s===J.defs.primitive.ifx||s.isLet&&s.original===J.defs.primitive.ifx){if(n=c()){l.push(i),l.push.apply(l,n);continue}return this.invalid=!0,a.loadState(t),[this]}if(s===J.defs.primitive.else||s.proxy&&s.original===J.defs.primitive.else){o("fi");continue}if(s===J.defs.primitive.fi||s.proxy&&s.original===J.defs.primitive.fi)break;l.push(i)}else l.push(i)}else for(o("else");;){if(!(i=a.eat()))return this.invalid=!0,a.loadState(t),[this];if("command"==i.type||"character"==i.type&&i.cat==J.cats.active){if(!(s="command"==i.type?r.last().defs.primitive[i.name]||r.last().defs.macros[i.name]:r.last().defs.active[i.char])){l.push(i);continue}if(s===J.defs.primitive.if||s.isLet&&s.original===J.defs.primitive.if||s===J.defs.primitive.ifcase||s.isLet&&s.original===J.defs.primitive.ifcase||s===J.defs.primitive.ifcat||s.isLet&&s.original===J.defs.primitive.ifcat||s===J.defs.primitive.ifdim||s.isLet&&s.original===J.defs.primitive.ifdim||s===J.defs.primitive.ifeof||s.isLet&&s.original===J.defs.primitive.ifeof||s===J.defs.primitive.iffalse||s.isLet&&s.original===J.defs.primitive.iffalse||s===J.defs.primitive.ifodd||s.isLet&&s.original===J.defs.primitive.ifodd||s===J.defs.primitive.ifnum||s.isLet&&s.original===J.defs.primitive.ifnum||s===J.defs.primitive.ifhmode||s.isLet&&s.original===J.defs.primitive.ifhmode||s===J.defs.primitive.ifinner||s.isLet&&s.original===J.defs.primitive.ifinner||s===J.defs.primitive.ifmmode||s.isLet&&s.original===J.defs.primitive.ifmmode||s===J.defs.primitive.iftrue||s.isLet&&s.original===J.defs.primitive.iftrue||s===J.defs.primitive.ifvmode||s.isLet&&s.original===J.defs.primitive.ifvmode||s===J.defs.primitive.ifvoid||s.isLet&&s.original===J.defs.primitive.ifvoid||s===J.defs.primitive.ifx||s.isLet&&s.original===J.defs.primitive.ifx){if(n=c()){l.push(i),l.push.apply(l,n);continue}return this.invalid=!0,a.loadState(t),[this]}if(s&&(s===J.defs.primitive.fi||s.proxy&&s.original===J.defs.primitive.fi))break;l.push(i)}else l.push(i)}return l;function o(e){for(;;){var t=a.eat();if(!t)return;if("command"==t.type||"character"==t.type&&t.cat===J.cats.active){var i="command"==t.type?r.last().defs.primitive[t.name]||r.last().defs.macros[t.name]:r.last().defs.active[t.char];if(!i)continue;if(i===J.defs.primitive.if||i.isLet&&i.original===J.defs.primitive.if||i===J.defs.primitive.ifcase||i.isLet&&i.original===J.defs.primitive.ifcase||i===J.defs.primitive.ifcat||i.isLet&&i.original===J.defs.primitive.ifcat||i===J.defs.primitive.ifdim||i.isLet&&i.original===J.defs.primitive.ifdim||i===J.defs.primitive.ifeof||i.isLet&&i.original===J.defs.primitive.ifeof||i===J.defs.primitive.iffalse||i.isLet&&i.original===J.defs.primitive.iffalse||i===J.defs.primitive.ifodd||i.isLet&&i.original===J.defs.primitive.ifodd||i===J.defs.primitive.ifnum||i.isLet&&i.original===J.defs.primitive.ifnum||i===J.defs.primitive.ifhmode||i.isLet&&i.original===J.defs.primitive.ifhmode||i===J.defs.primitive.ifinner||i.isLet&&i.original===J.defs.primitive.ifinner||i===J.defs.primitive.ifmmode||i.isLet&&i.original===J.defs.primitive.ifmmode||i===J.defs.primitive.iftrue||i.isLet&&i.original===J.defs.primitive.iftrue||i===J.defs.primitive.ifvmode||i.isLet&&i.original===J.defs.primitive.ifvmode||i===J.defs.primitive.ifvoid||i.isLet&&i.original===J.defs.primitive.ifvoid||i===J.defs.primitive.ifx||i.isLet&&i.original===J.defs.primitive.ifx){o("fi"),a.eat();continue}if("else"==e&&(i===J.defs.primitive.else||i.isLet&&i.original===J.defs.primitive.else))return;if(i===J.defs.primitive.fi||i.isLet&&i.original===J.defs.primitive.fi)return void a.revert()}}}function c(){for(var e=[];;){var t=a.eat();if(!t)return null;if("command"==t.type||"character"==t.type&&t.cat===J.cats.active){var i="command"==t.type?r.last().defs.primitive[t.name]||r.last().defs.macros[t.name]:r.last().defs.active[t.char];if(!i){e.push(t);continue}if(i===J.defs.primitive.if||i.isLet&&i.original===J.defs.primitive.if||i===J.defs.primitive.ifcase||i.isLet&&i.original===J.defs.primitive.ifcase||i===J.defs.primitive.ifcat||i.isLet&&i.original===J.defs.primitive.ifcat||i===J.defs.primitive.ifdim||i.isLet&&i.original===J.defs.primitive.ifdim||i===J.defs.primitive.ifeof||i.isLet&&i.original===J.defs.primitive.ifeof||i===J.defs.primitive.iffalse||i.isLet&&i.original===J.defs.primitive.iffalse||i===J.defs.primitive.ifodd||i.isLet&&i.original===J.defs.primitive.ifodd||i===J.defs.primitive.ifnum||i.isLet&&i.original===J.defs.primitive.ifnum||i===J.defs.primitive.ifhmode||i.isLet&&i.original===J.defs.primitive.ifhmode||i===J.defs.primitive.ifinner||i.isLet&&i.original===J.defs.primitive.ifinner||i===J.defs.primitive.ifmmode||i.isLet&&i.original===J.defs.primitive.ifmmode||i===J.defs.primitive.iftrue||i.isLet&&i.original===J.defs.primitive.iftrue||i===J.defs.primitive.ifvmode||i.isLet&&i.original===J.defs.primitive.ifvmode||i===J.defs.primitive.ifvoid||i.isLet&&i.original===J.defs.primitive.ifvoid||i===J.defs.primitive.ifx||i.isLet&&i.original===J.defs.primitive.ifx){var s=c();if(s){e.push(t),e.push.apply(e,s);continue}return null}if(e.push(t),i===J.defs.primitive.fi||i.isLet&&i.original===J.defs.primitive.fi)return e}else e.push(t)}}}return J.defs.primitive.crcr.function=J.defs.primitive.cr.function,bt.format('    \\def\\makeatletter{\\catcode `\\@=11\\relax}\n    \\def\\makeatother{\\catcode `\\@=12\\relax}\n    \\makeatletter\n    \\count10=23\n    \\count11=9\n    \\count12=9\n    \\count13=9\n    \\countdef\\insc@unt=20\n    \\countdef\\allocationnumber=21\n    \\countdef\\m@ne=22 \\m@ne=-1\n    \\countdef\\count@=255\n    \\dimendef\\dimen@=0\n    \\dimendef\\dimen@i=1\n    \\dimendef\\dimen@ii=2\n    \\skipdef\\skip@=0\n    \\def\\newcount{\\alloc@0\\count\\countdef}\n    \\def\\newdimen{\\alloc@1\\dimen\\dimendef}\n    \\def\\newskip{\\alloc@2\\skip\\skipdef}\n    \\def\\newmuskip{\\alloc@3\\muskip\\muskipdef}\n    \\def\\alloc@#1#2#3#4{\n      \\advance\\count1#1by1\n      \\allocationnumber=\\count1#1\n      #3#4=\\allocationnumber\n    }\n    \\newdimen\\maxdimen \\maxdimen=137438953471.99998pt\n    \\newskip\\hideskip \\hideskip=-1000pt plus 1fil\n    \\newskip\\centering \\centering=0pt plus 1000pt minus 1000pt\n    \\def\\newif#1{\n      {\\lccode`9=`i \\lccode`8=`f \\lowercase{\\gdef\\@remove@if##198##2{##2}}}\n      \\expandafter\\expandafter\\expandafter\n      \\def\\expandafter\\expandafter\\expandafter\n      \\@if@name\\expandafter\\expandafter\\expandafter{\\expandafter\\@remove@if\\string#1}\n      \\expandafter\\def\\expandafter\\@if@name@bool\\expandafter##\\expandafter1\\expandafter{\\@if@name##1}\n      \\expandafter\\def\\csname\\@if@name@bool{true}\\endcsname{\n        \\let#1=\\iftrue\n      }\n      \\expandafter\\def\\csname\\@if@name@bool{false}\\endcsname{\n        \\let#1=\\iffalse\n      }\n      \\let#1=\\iffalse\n      \\let\\@if@name=\\undefined\n      \\let\\@if@name@bool=\\undefined\n      \\let\\@remove@if=\\undefined\n    }\n    \\newcount\\active \\active=13\n    \\newskip\\smallskipamount \\smallskipamount=3pt plus 1pt minus 1pt\n    \\newskip\\medskipamount \\medskipamount=6pt plus 2pt minus 2pt\n    \\newskip\\bigskipamount \\bigskipamount=12pt plus 4pt minus 4pt\n    \\newskip\\normalbaselineskip \\normalbaselineskip=12pt\n    \\newskip\\normallineskip \\normallineskip=1pt\n    \\newdimen\\normallineskiplimit \\normallineskiplimit=0pt\n    \\newdimen\\jot \\jot=3pt\n    \\newcount\\interdisplaylinepenalty \\interdisplaylinepenalty=100\n    \\newcount\\interfootnotelinepenalty \\interfootnotelinepenalty=100\n    \\mathchardef\\\\="0000A\n    \\mathchardef\\ ="0020\n    \\mathchardef\\{=`\\{\n    \\mathchardef\\}=`\\}\n    \\mathchardef\\$=`\\$\n    \\mathchardef\\#=`\\#\n    \\mathchardef\\%=`\\%\n    \\mathchardef\\&=`\\&\n    \\mathchardef\\_=`\\_\n    \\mathchardef\\aa="700E5\n    \\mathchardef\\ae="700E6\n    \\mathchardef\\aleph="02135\n    \\mathchardef\\alpha="703B1\n    \\mathchardef\\amalg="22A3F\n    \\mathchardef\\angle="02220\n    \\mathchardef\\approx="32248\n    \\mathchardef\\arrowvert="023D0\n    \\mathchardef\\ast="2002A\n    \\mathchardef\\asymp="3224D\n    \\mathchardef\\backslash=`\\\\\n    \\mathchardef\\beta="703B2\n    \\mathchardef\\bigcap="122C2\n    \\mathchardef\\bigcirc="225EF\n    \\mathchardef\\bigcup="122C3\n    \\mathchardef\\bigodot="12A00\n    \\mathchardef\\bigoplus="12A01\n    \\mathchardef\\bigotimes="12A02\n    \\mathchardef\\bigtriangleup="225B3\n    \\mathchardef\\bigtriangledown="225BD\n    \\mathchardef\\bigsqcup="12A06\n    \\mathchardef\\biguplus="12A04\n    \\mathchardef\\bigvee="122C1\n    \\mathchardef\\bigwedge="122C0\n    \\mathchardef\\bot="022A5\n    \\mathchardef\\bracevert="023AA\n    \\mathchardef\\bowtie="322C8\n    \\mathchardef\\bullet="22022\n    \\mathchardef\\cap="22229\n    \\mathchardef\\cdot="222C5\n    \\mathchardef\\cdotp="622C5\n    \\mathchardef\\chi="703C7\n    \\mathchardef\\circ="225CB\n    \\mathchardef\\clubsuit="02663\n    \\mathchardef\\colon="6003A\n    \\mathchardef\\cong="32245\n    \\mathchardef\\coprod="12210\n    \\mathchardef\\cup="2222A\n    \\mathchardef\\dag="02020\n    \\mathchardef\\dagger="22020\n    \\mathchardef\\dashv="322A3\n    \\mathchardef\\ddag="02021\n    \\mathchardef\\ddagger="22021\n    \\mathchardef\\delta="703B4\n    \\mathchardef\\diamond="222C4\n    \\mathchardef\\diamondsuit="02662\n    \\mathchardef\\div="200F7\n    \\mathchardef\\doteq="32250\n    \\mathchardef\\downarrow="2193\n    \\mathchardef\\ell="02113\n    \\mathchardef\\emptyset="02205\n    \\mathchardef\\epsilon="703F5\n    \\mathchardef\\equiv="32261\n    \\mathchardef\\eta="703B7\n    \\mathchardef\\exists="02203\n    \\mathchardef\\flat="0266D\n    \\mathchardef\\forall="02200\n    \\mathchardef\\frown="32322\n    \\mathchardef\\gamma="703B3\n    \\mathchardef\\ge="32265 \\let\\geq=\\ge\n    \\mathchardef\\gg="3226B\n    \\mathchardef\\hbar="70127\n    \\mathchardef\\heartsuit="02661\n    \\mathchardef\\hookleftarrow="321AA\n    \\mathchardef\\hookrightarrow="321A9\n    \\mathchardef\\imath="70131\n    \\mathchardef\\in="32208\n    \\mathchardef\\infty="0221E\n    \\mathchardef\\intop="1222B \\def\\int{\\intop\\nolimits}\n    \\mathchardef\\iota="703B9\n    \\mathchardef\\jmath="70237\n    \\mathchardef\\kappa="703BA\n    \\mathchardef\\l="00142\n    \\mathchardef\\lambda="703BB\n    \\mathchardef\\langle="027E8\n    \\mathchardef\\lbrace=`\\{\n    \\mathchardef\\lceil="02308\n    \\mathchardef\\ldotp="6002E\n    \\mathchardef\\le="32264 \\let\\leq=\\le\n    \\mathchardef\\leftarrow="32190 \\let\\gets=\\leftarrow\n    \\mathchardef\\leftharpoondown="321BD\n    \\mathchardef\\leftharpoonup="321BC\n    \\mathchardef\\leftrightarrow="32194\n    \\mathchardef\\lfloor="0230A\n    \\mathchardef\\lgroup="027EE\n    \\mathchardef\\ll="3226A\n    \\mathchardef\\lmoustache="023B0\n    \\mathchardef\\longleftarrow="327F5\n    \\mathchardef\\longleftrightarrow="327F7\n    \\mathchardef\\longmapsto="327FC\n    \\mathchardef\\longrightarrow="327F6\n    \\mathchardef\\mapsto="321A6\n    \\mathchardef\\mid="32223\n    \\mathchardef\\models="322A7\n    \\mathchardef\\mp="22213\n    \\mathchardef\\mu="703BC\n    \\mathchardef\\nabla="02207\n    \\mathchardef\\natural="0266E\n    \\mathchardef\\nearrow="32197\n    \\mathchardef\\neg="000AC \\let\\lnot=\\neg\n    \\mathchardef\\ne="32260 \\let\\neq=\\ne\n    \\mathchardef\\ni="3220B \\let\\owns=\\ni\n    \\mathchardef\\notin="32209\n    \\mathchardef\\nu="703BD\n    \\mathchardef\\nwarrow="32196\n    \\mathchardef\\o="700F8\n    \\mathchardef\\odot="22299\n    \\mathchardef\\oe="70153\n    \\mathchardef\\ointop="1222E \\def\\oint{\\ointop\\nolimits}\n    \\mathchardef\\omega="703C9\n    \\mathchardef\\ominus="22296\n    \\mathchardef\\oplus="22295\n    \\mathchardef\\oslash="22298\n    \\mathchardef\\otimes="22297\n    \\mathchardef\\parallel="32225\n    \\mathchardef\\partial="02202\n    \\mathchardef\\perp="322A5\n    \\mathchardef\\phi="703D5\n    \\mathchardef\\pi="703C0\n    \\mathchardef\\pm="200B1\n    \\mathchardef\\prec="3227A\n    \\mathchardef\\preceq="3227C\n    \\mathchardef\\prime="02032\n    \\mathchardef\\prod="1220F\n    \\mathchardef\\propto="3221D\n    \\mathchardef\\psi="703C8\n    \\mathchardef\\rangle="027E9\n    \\mathchardef\\rbrace=`\\}\n    \\mathchardef\\rceil="02309\n    \\mathchardef\\relbar="3002D\n    \\mathchardef\\rfloor="0230B\n    \\mathchardef\\rgroup="027EF\n    \\mathchardef\\rho="703C1\n    \\mathchardef\\rightarrow="32192 \\let\\to=\\rightarrow\n    \\mathchardef\\rightharpoondown="321C1\n    \\mathchardef\\rightharpoonup="321C0\n    \\mathchardef\\rightleftharpoons="321CC\n    \\mathchardef\\rmoustache="023B1\n    \\mathchardef\\searrow="32198\n    \\mathchardef\\setminus="22216\n    \\mathchardef\\sharp="0266F\n    \\mathchardef\\sim="3223C\n    \\mathchardef\\simeq="32243\n    \\mathchardef\\sigma="703C3\n    \\mathchardef\\smile="32323\n    \\mathchardef\\sqcap="22293\n    \\mathchardef\\sqcup="22294\n    \\mathchardef\\sqsubseteq="32291\n    \\mathchardef\\sqsupseteq="32292\n    \\mathchardef\\ss="000DF\n    \\mathchardef\\star="222C6\n    \\mathchardef\\subset="32282\n    \\mathchardef\\subseteq="32286\n    \\mathchardef\\succ="3227B\n    \\mathchardef\\succeq="3227D\n    \\mathchardef\\sum="12211\n    \\mathchardef\\supset="32283\n    \\mathchardef\\supseteq="32287\n    \\mathchardef\\swarrow="32199\n    \\mathchardef\\tau="703C4\n    \\mathchardef\\theta="703B8\n    \\mathchardef\\times="200D7\n    \\mathchardef\\top="022A4\n    \\mathchardef\\triangle="025B3\n    \\mathchardef\\triangleleft="225C1\n    \\mathchardef\\triangleright="225B7\n    \\mathchardef\\ucup="2228E\n    \\mathchardef\\uparrow="02191\n    \\mathchardef\\updownarrow="02195\n    \\mathchardef\\upsilon="703C5\n    \\mathchardef\\varepsilon="703B5\n    \\mathchardef\\varphi="703C6\n    \\mathchardef\\varpi="703D6\n    \\mathchardef\\varrho="703F1\n    \\mathchardef\\varsigma="703C2\n    \\mathchardef\\vartheta="703D1\n    \\mathchardef\\vdash="322A2\n    \\mathchardef\\vee="22228 \\let\\lor=\\vee\n    \\mathchardef\\vert=`\\|\n    \\mathchardef\\wedge="22227 \\let\\land=\\wedge\n    \\mathchardef\\wp="02118\n    \\mathchardef\\wr="22240\n    \\mathchardef\\xi="703BE\n    \\mathchardef\\zeta="703B6\n    \\mathchardef\\AA="700C5\n    \\mathchardef\\AE="700C6\n    \\mathchardef\\Arrowvert="02225\n    \\mathchardef\\Delta="00394\n    \\mathchardef\\Downarrow="21D3\n    \\mathchardef\\Gamma="00393\n    \\mathchardef\\Im="02111\n    \\mathchardef\\L="00141\n    \\mathchardef\\Lambda="0039B\n    \\mathchardef\\Leftarrow="321D0\n    \\mathchardef\\Leftrightarrow="321D4\n    \\mathchardef\\Longleftarrow="327F8\n    \\mathchardef\\Longleftrightarrow="327FA\n    \\mathchardef\\Longrightarrow="327F9\n    \\mathchardef\\O="700D8\n    \\mathchardef\\OE="70152\n    \\mathchardef\\Omega="003A9\n    \\mathchardef\\Orb="225EF\n    \\mathchardef\\P="000B6\n    \\mathchardef\\Phi="003A6\n    \\mathchardef\\Pi="003A0\n    \\mathchardef\\Psi="003A8\n    \\mathchardef\\Re="0211C\n    \\mathchardef\\Relbar="3003D\n    \\mathchardef\\Rightarrow="321D2\n    \\mathchardef\\S="000A7\n    \\mathchardef\\Sigma="003A3\n    \\mathchardef\\spadesuit="02660\n    \\mathchardef\\Theta="00398\n    \\mathchardef\\Uparrow="021D1\n    \\mathchardef\\Updownarrow="021D5\n    \\mathchardef\\Upsilon="003A5\n    \\mathchardef\\Vert="02016 \\let\\|=\\Vert\n    \\mathchardef\\Xi="0039E\n    \\def\\~{\\accent"02DC }\n    \\def\\,{\\mskip\\thinmuskip}\n    \\def\\>{\\mskip\\medmuskip}\n    \\def\\;{\\mskip\\thickmuskip}\n    \\def\\!{\\mskip-\\thinmuskip}\n    \\def\\"{\\accent"A8 }\n    \\def\\={\\accent"AF }\n    \\def\\^{\\accent"5E }\n    \\def\\.{\\accent"02D9 }\n    \\def\\acute{\\accent"B4 }\n    \\def\\arccos{\\mathop{\\rm arccos}\\nolimits}\n    \\def\\arcsin{\\mathop{\\rm arcsin}\\nolimits}\n    \\def\\arctan{\\mathop{\\rm arctan}\\nolimits}\n    \\def\\arg{\\mathop{\\rm arg}\\nolimits}\n    \\def\\bar{\\accent"AF }\n    \\def\\big#1{{\\n@space\\left#1\\vbox to 1em{}\\right.}}\n    \\def\\bigl{\\mathopen\\big}\n    \\def\\bigm{\\mathrel\\big}\n    \\def\\bigr{\\mathclose\\big}\n    \\def\\bigg#1{{\\n@space\\left#1\\vbox to 1.6em{}\\right.}}\n    \\def\\biggl{\\mathopen\\bigg}\n    \\def\\biggm{\\mathrel\\bigg}\n    \\def\\biggr{\\mathclose\\bigg}\n    \\def\\bmod{      \\nonscript\\mskip-\\medmuskip\\mkern5mu\\mathbin{\\rm mod}\\mkern5mu\\nonscript\\mskip-\\medmuskip}\n    \\def\\brace{\\atopwithdelims\\{\\}}\n    \\def\\brack{\\atopwithdelims[]}\n    \\def\\breve{\\accent"02D8 }\n    \\def\\buildrel#1\\over#2{\\mathrel{\\mathop{\\kern0pt#2}\\limits^{#1}}}\n    \\def\\cases#1{      \\left\\{\\,{\\halign{##\\hfil&\\quad##\\hfil\\cr#1\\crcr}}\\right.}\n    \\def\\cdots{\\mathinner{\\cdotp\\cdotp\\cdotp}}\n    \\def\\check{\\accent"02C7 }\n    \\def\\choose{\\atopwithdelims()}\n    \\def\\cong{\\mathrel{\\tilde=}}\n    \\def\\cos{\\mathop{\\rm cos}\\nolimits}\n    \\def\\cosh{\\mathop{\\rm cosh}\\nolimits}\n    \\def\\cot{\\mathop{\\rm cot}\\nolimits}\n    \\def\\coth{\\mathop{\\rm coth}\\nolimits}\n    \\def\\csc{\\mathop{\\rm csc}\\nolimits}\n    \\def\\ddot{\\accent"A8 }\n    \\def\\ddots{\\mathinner{\\char"22F1}}\n    \\def\\deg{\\mathop{\\rm deg}\\nolimits}\n    \\def\\det{\\mathop{\\rm det}}\n    \\def\\dim{\\mathop{\\rm dim}\\nolimits}\n    \\def\\dot{\\accent"02D9 }\n    \\def\\empty{}\n    \\def\\exp{\\mathop{\\rm exp}\\nolimits}\n    \\def\\gcd{\\mathop{\\rm gcd}}\n    \\def\\grave{\\accent"60 }\n    \\def\\hat{\\accent"5E }\n    \\def\\hom{\\mathop{\\rm hom}\\nolimits}\n    \\def\\hphantom#1{\\vbox to0pt{\\phantom#1}}\n    \\def\\iff{\\;\\Longleftrightarrow\\;}\n    \\def\\inf{\\mathop{\\rm inf}}\n    \\def\\iterate{\\body \\let\\next=\\iterate\\else\\let\\next=\\relax\\fi\\next}\n    \\def\\joinrel{\\mathrel{\\mkern-3mu}}\n    \\def\\ker{\\mathop{\\rm ker}\\nolimits}\n    \\def\\lbrack{[}\n    \\def\\ldots{\\mathinner{\\ldotp\\ldotp\\ldotp}}\n    \\def\\lg{\\mathop{\\rm lg}\\nolimits}\n    \\def\\lim{\\mathop{\\rm lim}}\n    \\def\\liminf{\\mathop{\\rm lim\\,inf}}\n    \\def\\limsup{\\mathop{\\rm lim\\,sup}}\n    \\def\\ln{\\mathop{\\rm ln}\\nolimits}\n    \\def\\log{\\mathop{\\rm log}\\nolimits}\n    \\def\\loop#1\\repeat{\\def\\body{#1}\\iterate}\n    \\def\\lq{`}\n    \\def\\mathstrut{\\vphantom(}\n    \\def\\matrix#1{\\,\\halign{\\hfil##\\hfil&&\\quad\\hfil##\\hfil\\cr        #1\\crcr}\\,}\n    \\def\\max{\\mathop{\\rm max}}\n    \\def\\min{\\mathop{\\rm min}}\n    \\def\\n@space{\\nulldelimiterspace=0pt\\relax}\n    \\def\\not{\\@ifnextchar={\\mathchar"32260\\@gobble}{\\hbox to 0pt{/}}}}\n    \\def\\null{\\hbox{}}\n    \\def\\pmatrix#1{\\left(\\matrix{#1}\\right)}\n    \\def\\pmod#1{\\mkern18mu({\\rm mod}\\,\\,#1)}\n    \\def\\rbrack{]}\n    \\def\\rq{\'}\n    \\def\\sec{\\mathop{\\rm sec}\\nolimits}\n    \\def\\sin{\\mathop{\\rm sin}\\nolimits}\n    \\def\\sinh{\\mathop{\\rm sinh}\\nolimits}\n    \\def\\skew#1#2#3{      {\\muskip0 #1mu\\divide\\muskip0by2 \\mkern\\muskip0%\n      #2{\\mkern-\\muskip0{#3}\\mkern\\muskip0}\\mkern-\\muskip0}{}}\n    \\def\\strut{\\vrule height.708333333emdepth.291666666emwidth0pt\\relax}\n    \\def\\sup{\\mathop{\\rm sup}}\n    \\def\\surd{{\\mathchar"1221A}}\n    \\def\\t{\\accent"0311 }\n    \\def\\tan{\\mathop{\\rm tan}\\nolimits}\n    \\def\\tanh{\\mathop{\\rm tanh}\\nolimits}\n    \\def\\thinspace{\\kern.1667em}\n    \\def\\tilde{\\accent"02DC }\n    \\def\\u{\\accent"02D8 }\n    \\def\\v{\\accent"02C7 }\n    \\def\\vdots{\\mathinner{\\char"22EE}}\n    \\def\\vphantom#1{\\hbox to0pt{\\phantom#1}}\n    \\def\\Big#1{{\\n@space\\left#1\\vbox to 1.3em{}\\right.}}\n    \\def\\Bigl{\\mathopen\\Big}\n    \\def\\Bigm{\\mathrel\\Big}\n    \\def\\Bigr{\\mathclose\\Big}\n    \\def\\Bigg#1{{\\n@space\\left#1\\vbox to 1.9em{}\\right.}}\n    \\def\\Biggl{\\mathopen\\Bigg}\n    \\def\\Biggm{\\mathrel\\Bigg}\n    \\def\\Biggr{\\mathclose\\Bigg}\n    \\def\\H{\\accent"02DD }\n    \\def\\Pr{\\mathop{\\rm Pr}}\n    \\def\\TeX{T\\kern-.1667em{\\lower.5exE}\\kern-.125emX}\n    \\let\\bgroup={\n    \\let\\displaymath=\\[\n    \\let\\enddisplaymath=\\]\n    \\let\\egroup=}\n    \\let\\endline=\\cr\n    \\let\\math=\\(\n    \\let\\endmath=\\)\n    \\let\\sb=^\n    \\let\\sp=_\n    \\let\\repeat=\\fi\n    \\def\\negthinspace{\\kern-.1667em}\n    \\def\\enspace{\\kern.5em}\n    \\def\\enskip{\\hskip.5em\\relax}\n    \\def\\quad{\\hskip1em\\relax}\n    \\def\\qquad{\\hskip2em\\relax}\n    \\def\\smallskip{\\vskip\\smallskipamount}\n    \\def\\medskip{\\vskip\\medskipamount}\n    \\def\\bigskip{\\vskip\\bigskipamount}\n    \\def~{\\char"00A0\\relax}\n    \\def\\obeyspaces{\\catcode`\\ =13\\relax}\n    \\catcode`\\ =12\\def\\space{ }\\obeyspaces\\let =\\space\n    \\catcode`\\ =10\n    \\newcount\\mscount\n    \\def\\multispan#1{\\omit \\mscount#1\\relax\\loop\\ifnum\\mscount>1\\sp@n\\repeat}\n    \\def\\sp@n{\\span\\omit\\advance\\mscount-1}\n    \\def\\two@digits#1{\\ifnum#1<10 0\\fi\\the#1}\n    \\def\\dospecials{      \\do\\ \\do\\\\\\do\\{\\do\\}\\do\\$\\do\\&\\do\\#\\do\\^\\do\\^^K\\do\\_\\do\\^^A\\do\\%\\do\\~}\n    \\def\\mathpalette#1#2{      \\mathchoice{#1\\displaystyle{#2}}{#1\\textstyle{#2}}{#1\\scriptstyle{#2}}{#1\\scriptscriptstyle{#2}}}\n    \\def\\binom#1#2{{{#1}\\atopwithdelims(){#2}}}\n    \\def\\frac#1#2{{{#1}\\over{#2}}}\n    \\def\\mathrm#1{{\\rm#1}}\n    \\def\\textrm#1{{\\rm#1}}\n    \\def\\mathbf#1{{\\bf#1}}\n    \\def\\textbf#1{{\\bf#1}}\n    \\def\\mathit#1{{\\it#1}}\n    \\def\\textit#1{{\\it#1}}\n    \\def\\mathsl#1{{\\sl#1}}\n    \\def\\textsl#1{{\\sl#1}}\n    \\def\\@gobble#1{}\n    \\def\\@ifnextchar#1#2#3{      \\let\\@ifnextchar@charone=#1\n      \\def\\@ifnextchar@true{#2}\n      \\def\\@ifnextchar@false{#3}\n      \\futurelet\\@ifnextchar@chartwo\\@ifnextchar@check}\n    \\def\\@ifnextchar@check{      \\ifx\\@ifnextchar@charone\\@ifnextchar@chartwo\\@ifnextchar@true\\else\\@ifnextchar@false\\fi    }\n    \\def\\newcommand#1{\\@ifnextchar[{\\@newcommand#1}{\\@newcommand#1[0]}}\n    \\def\\@newcommand#1[#2]{      \\count0=#2      \\ifnum\\count0<0        \\Error{NotEnoughParameters}      \\else        \\ifnum\\count0>9          \\Error{TooManyParameters}        \\else          \\@ifnextchar[{\\ifnum\\count0<1            \\Error{ParameterNumberMustBe>0}          \\else            \\@newcommand@optarg#1[#2]          \\fi}{\\@newcommand@nooptarg#1[#2]}        \\fi      \\fi    }\n    \\def\\@paramnums#1{      \\ifcase#1      \\or####1      \\or####1####2      \\or####1####2####3      \\or####1####2####3####4      \\or####1####2####3####4####5      \\or####1####2####3####4####5####6      \\or####1####2####3####4####5####6####7      \\or####1####2####3####4####5####6####7####8      \\or####1####2####3####4####5####6####7####8####9\\fi}\n    \\def\\@paramnums@bracket#1{      \\ifcase#1      \\or[####1]      \\or[####1]####2      \\or[####1]####2####3      \\or[####1]####2####3####4      \\or[####1]####2####3####4####5      \\or[####1]####2####3####4####5####6      \\or[####1]####2####3####4####5####6####7      \\or[####1]####2####3####4####5####6####7####8      \\or[####1]####2####3####4####5####6####7####8####9\\fi}\n    \\def\\@newcommand@nooptarg#1[#2]#{      \\edef\\@newcommand@make{\\def\\noexpand#1\\@paramnums#2}\n      \\@newcommand@make}\n    \\def\\@newcommand@optarg#1[#2][#3]#{      \\def#1{        \\@ifnextchar[{\\csname\\string#1\\endcsname}{\\csname\\string#1\\endcsname[#3]}}      \\edef\\@newcommand@make{        \\noexpand\\expandafter\\def        \\noexpand\\csname\\noexpand\\string\\noexpand#1\\endcsname\\@paramnums@bracket#2}\n      \\@newcommand@make}\n    \\newcommand\\sqrt[1][]{\\root #1\\of }}\n    \\makeatother  ',"display"),bt.fontDimen={widthOf:function(e,t,i){return this.isInit||this.init(),i={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[i||"nm"],this.cache[t]&&this.cache[t][i]&&this.cache[t][i][e]&&!isNaN(this.cache[t][i][e].width)?this.cache[t][i][e].width:(this.context.font=(i||"")+" 500px "+t,this.cache[t]=this.cache[t]||{},this.cache[t][i]=this.cache[t][i]||{},this.cache[t][i][e]=this.cache[t][i][e]||{},this.cache[t][i][e].width=this.context.measureText(e).width/500)},visibleWidthOf:function(h,p,d){if(this.isInit||this.init(),d={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[d||"nm"],this.cache[p]&&this.cache[p][d]&&this.cache[p][d][h]&&!isNaN(this.cache[p][d][h].vWidth))return this.cache[p][d][h].vWidth;function m(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var s=Math.pow(2,i);this.context.font=(d||"")+" "+100*s+"px "+p,this.context.fillText(h,75+150*s*(.5-e),75+150*s*(.5-t));for(var a=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=0;l<150;l++){for(var o=0;o<150;o++){var c=a[4*l+600*o+3];r<c&&(r=c,n=o)}if(r)break}return!1===r&&0==i?-1:250<c?e+(l/150-.5)/Math.pow(2,i):m.call(this,e+(l/150-.5)/Math.pow(2,i),t+(n/150-.5)/Math.pow(2,i),i+1)}this.context.textBaseline="middle",this.context.textAlign="center";var e=m.call(this,.5,.5,0);if(-1==e)return this.cache[p]=this.cache[p]||{},this.cache[p][d]=this.cache[p][d]||{},this.cache[p][d][h]=this.cache[p][d][h]||{},this.cache[p][d][h].vWidth=0;function u(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var s=Math.pow(2,i);this.context.font=(d||"")+" "+100*s+"px "+p,this.context.fillText(h,75+150*s*(.5-e),75+150*s*(.5-t));for(var a=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=149;0<=l;l--){for(var o=0;o<150;o++){var c=a[4*l+600*o+3];r<c&&(r=c,n=o)}if(r)break}return 250<c?e+(l/150-.5)/Math.pow(2,i):u.call(this,e+(l/150-.5)/Math.pow(2,i),t+(n/150-.5)/Math.pow(2,i),i+1)}var t=u.call(this,.5,.5,0);return this.cache[p]=this.cache[p]||{},this.cache[p][d]=this.cache[p][d]||{},this.cache[p][d][h]=this.cache[p][d][h]||{},this.cache[p][d][h].vWidth=1.5*(t-e)+.021},heightOf:function(h,p,d){if(this.isInit||this.init(),d={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[d||"nm"],this.cache[p]&&this.cache[p][d]&&this.cache[p][d][h]&&!isNaN(this.cache[p][d][h].height))return this.cache[p][d][h].height;function m(e,t,i){if(7==i)return t;this.context.clearRect(0,0,150,150);var s=Math.pow(2,i);this.context.font=(d||"")+" "+100*s+"px "+p,this.context.fillText(h,75+150*s*(.5-e),75+150*s*(1-t));for(var a=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=0;l<150;l++){for(var o=0;o<150;o++){var c=a[4*l*150+4*o+3];r<c&&(r=c,n=o)}if(r)break}return!1===r&&0==i?1:250<c?t+(l/150-.5)/Math.pow(2,i):m.call(this,e+(n/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}return this.context.textBaseline="alphabetic",this.context.textAlign="center",this.cache[p]=this.cache[p]||{},this.cache[p][d]=this.cache[p][d]||{},this.cache[p][d][h]=this.cache[p][d][h]||{},this.cache[p][d][h].height=1.5*(1-m.call(this,.5,.5,0))},depthOf:function(h,p,d){if(this.isInit||this.init(),d={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[d||"nm"],this.cache[p]&&this.cache[p][d]&&this.cache[p][d][h]&&!isNaN(this.cache[p][d][h].depth))return Math.max(0,this.cache[p][d][h].depth);function m(e,t,i){if(7==i)return t;this.context.clearRect(0,0,150,150);var s=Math.pow(2,i);this.context.font=(d||"")+" "+100*s+"px "+p,this.context.fillText(h,75+150*s*(.5-e),75+150*s*(.5-t));for(var a=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=149;0<=l;l--){for(var o=0;o<150;o++){var c=a[4*l*150+4*o+3];r<c&&(r=c,n=o)}if(r)break}return!1===r&&0==i?.5:250<c?t+(l/150-.5)/Math.pow(2,i):m.call(this,e+(n/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}return this.context.textBaseline="alphabetic",this.context.textAlign="center",this.cache[p]=this.cache[p]||{},this.cache[p][d]=this.cache[p][d]||{},this.cache[p][d][h]=this.cache[p][d][h]||{},Math.max(0,this.cache[p][d][h].depth=1.5*(m.call(this,.5,.5,0)-.5))},trueDepthOf:function(e,t,i){return this.depthOf(e,t,i),this.cache[t][i={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[i||"nm"]][e].depth},italCorrOf:function(h,p){if(this.isInit||this.init(),this.cache[p]&&this.cache[p].italic&&this.cache[p].italic[h]&&!isNaN(this.cache[p].italic[h].italCorr))return this.cache[p].italic[h].italCorr;function d(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var s=Math.pow(2,i);this.context.font="italic "+100*s+"px "+p,this.context.fillText(h,75+150*s*-e,75+150*s*(.5-t));for(var a=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=149;0<=l;l--){for(var o=0;o<150;o++){var c=a[4*l+600*o+3];r<c&&(r=c,n=o)}if(r)break}return!1===r&&0==i?0:250<c?e+(l/150-.5)/Math.pow(2,i):d.call(this,e+(l/150-.5)/Math.pow(2,i),t+(n/150-.5)/Math.pow(2,i),i+1)}return this.context.textBaseline="middle",this.context.textAlign="left",this.cache[p]=this.cache[p]||{},this.cache[p].italic=this.cache[p].italic||{},this.cache[p].italic[h]=this.cache[p].italic[h]||{},this.cache[p].italic[h].italCorr=Math.max(0,1.5*d.call(this,.5,.5,0)-bt.fontDimen.widthOf(h,p,"it"))},scriptOffsetOf:function(h,p,d){if(this.isInit||this.init(),d={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[d||"nm"],this.cache[p]&&this.cache[p][d]&&this.cache[p][d][h]&&!isNaN(this.cache[p][d][h].scriptOffset))return this.cache[p][d][h].scriptOffset;function m(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var s=Math.pow(2,i);this.context.font=(d||"")+" "+100*s+"px "+p,this.context.fillText(h,75+150*s*(.5-e),75+150*s*(.5-t));for(var a=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=149;0<=l;l--){for(var o=0;o<Math.max(150,Math.min(0,o<75+150*s*(.5-t)));o++){var c=a[4*l+600*o+3];r<c&&(r=c,n=o)}if(r)break}return!1===r&&0==i?0:250<c?e+(l/150-.5)/Math.pow(2,i):m.call(this,e+(l/150-.5)/Math.pow(2,i),t+(n/150-.5)/Math.pow(2,i),i+1)}function u(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var s=Math.pow(2,i);this.context.font=(d||"")+" "+100*s+"px "+p,this.context.fillText(h,75+150*s*(.5-e),75+150*s*(.5-t));for(var a=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=149;0<=l;l--){for(var o=75;o<Math.max(150,o<75+150*s*(1-e));o++){var c=a[4*l+600*o+3];r<c&&(r=c,n=o)}if(r)break}return!1===r&&0==i?1:250<c?e+(l/150-.5)/Math.pow(2,i):u.call(this,e+(l/150-.5)/Math.pow(2,i),t+(n/150-.5)/Math.pow(2,i),i+1)}this.context.textBaseline="middle",this.context.textAlign="left";var e=m.call(this,.5,.5,0),t=u.call(this,.5,.5,0);return this.cache[p]=this.cache[p]||{},this.cache[p][d]=this.cache[p][d]||{},this.cache[p][d][h]=this.cache[p][d][h]||{},this.cache[p][d][h].scriptOffset=1.5*Math.max(e-t,0)},leftOffsetOf:function(h,p,d){if(this.isInit||this.init(),d={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[d||"nm"],this.cache[p]&&this.cache[p][d]&&this.cache[p][d][h]&&!isNaN(this.cache[p][d][h].leftOffset))return this.cache[p][d][h].leftOffset;function m(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var s=Math.pow(2,i);this.context.font=(d||"")+" "+100*s+"px "+p,this.context.fillText(h,75+150*s*(.5-e),75+150*s*(.5-t));for(var a=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=0;l<150;l++){for(var o=0;o<150;o++){var c=a[4*l+600*o+3];r<c&&(r=c,n=o)}if(r)break}return!1===r&&0==i?-1:250<c?e+(l/150-.5)/Math.pow(2,i):m.call(this,e+(l/150-.5)/Math.pow(2,i),t+(n/150-.5)/Math.pow(2,i),i+1)}return this.context.textBaseline="middle",this.context.textAlign="start",this.cache[p]=this.cache[p]||{},this.cache[p][d]=this.cache[p][d]||{},this.cache[p][d][h]=this.cache[p][d][h]||{},this.cache[p][d][h].leftOffset=-1.5*(m.call(this,.5,.5,0)-.5)},baselineHeightOf:function(h){if(this.isInit||this.init(),this.cache[h]&&!isNaN(this.cache[h].baseline))return this.cache[h].baseline;function p(e,t,i){if(this.context.textBaseline="bottom",7==i)return t;this.context.clearRect(0,0,150,150);var s=Math.pow(2,i);this.context.font=100*s+"px "+h,this.context.fillText("A",75+150*s*(.5-e),75+150*s*(1-t));for(var a=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=0;l<150;l++){for(var o=0;o<150;o++){var c=a[4*l*150+4*o+3];r<c&&(r=c,n=o)}if(r)break}return!1===r&&0==i?1:250<c?t+(l/150-.5)/Math.pow(2,i):p.call(this,e+(n/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}function d(e,t,i){if(this.context.textBaseline="alphabetic",7==i)return t;this.context.clearRect(0,0,150,150);var s=Math.pow(2,i);this.context.font=100*s+"px "+h,this.context.fillText("A",75+150*s*(.5-e),75+150*s*(1-t));for(var a=this.context.getImageData(0,0,150,150).data,r=!1,n=0,l=0;l<150;l++){for(var o=0;o<150;o++){var c=a[4*l*150+4*o+3];r<c&&(r=c,n=o)}if(r)break}return!1===r&&0==i?1:250<c?t+(l/150-.5)/Math.pow(2,i):d.call(this,e+(n/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}return this.context.textAlign="center",this.cache[h]=this.cache[h]||{},this.cache[h].baseline=1.5*(d.call(this,.5,.5,0)-p.call(this,.5,.5,0))},init:function(){this.canvas=document.createElement("canvas"),this.canvas.style.position="fixed",this.canvas.style.top="100vh",this.canvas.style.left="100vw",this.canvas.style.pointerEvents="none",this.canvas.style.opacity=0,this.canvas.width=150,this.canvas.height=150,this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.isInit=!0},isInit:!1,cache:{}},bt._debug={data:J,clearFontCache:function(e,t){if(e&&!t)delete bt.fontDimen.cache[e];else if(t&&!e){if((t=t.split(",").filter(function(e){return/^\\?(?:normalfont|nm|rm|it|sl|bf)$/.test(e.trim())}).map(function(e){return"\\normalfont"==e.trim()||"normalfont"==e.trim()?"nm":"\\"==e.trim()[0]?e.trim().substring(1):e.trim()})).length)for(var e in bt.fontDimen.cache)for(var i=t.length-1;0<=i;i--)delete bt.fontDimen.cache[e][i]}else if(e&&t){if((t=t.split(",").filter(function(e){return/^\\?(?:normalfont|nm|rm|it|sl|bf)$/.test(e.trim())}).map(function(e){return"\\normalfont"==e.trim()||"normalfont"==e.trim()?"nm":"\\"==e.trim()[0]?e.trim().substring(1):e.trim()})).length&&bt.fontDimen.cache[e])for(i=t.length-1;0<=i;i--)delete bt.fontDimen.cache[e][i]}else bt.fontDimen.cache={}}},bt}();