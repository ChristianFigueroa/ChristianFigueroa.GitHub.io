var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(ba){var ha=0;return function(){return ha<ba.length?{done:!1,value:ba[ha++]}:{done:!0}}};$jscomp.arrayIterator=function(ba){return{next:$jscomp.arrayIteratorImpl(ba)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(ba,ha,Ga){if(ba==Array.prototype||ba==Object.prototype)return ba;ba[ha]=Ga.value;return ba};$jscomp.getGlobal=function(ba){ba=["object"==typeof globalThis&&globalThis,ba,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var ha=0;ha<ba.length;++ha){var Ga=ba[ha];if(Ga&&Ga.Math==Math)return Ga}throw Error("Cannot find global object");};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(ba,ha){var Ga=$jscomp.propertyToPolyfillSymbol[ha];if(null==Ga)return ba[ha];Ga=ba[Ga];return void 0!==Ga?Ga:ba[ha]};
$jscomp.polyfill=function(ba,ha,Ga,va){ha&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(ba,ha,Ga,va):$jscomp.polyfillUnisolated(ba,ha,Ga,va))};$jscomp.polyfillUnisolated=function(ba,ha,Ga,va){Ga=$jscomp.global;ba=ba.split(".");for(va=0;va<ba.length-1;va++){var Na=ba[va];if(!(Na in Ga))return;Ga=Ga[Na]}ba=ba[ba.length-1];va=Ga[ba];ha=ha(va);ha!=va&&null!=ha&&$jscomp.defineProperty(Ga,ba,{configurable:!0,writable:!0,value:ha})};
$jscomp.polyfillIsolated=function(ba,ha,Ga,va){var Na=ba.split(".");ba=1===Na.length;va=Na[0];va=!ba&&va in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var H=0;H<Na.length-1;H++){var Va=Na[H];if(!(Va in va))return;va=va[Va]}Na=Na[Na.length-1];Ga=$jscomp.IS_SYMBOL_NATIVE&&"es6"===Ga?va[Na]:null;ha=ha(Ga);null!=ha&&(ba?$jscomp.defineProperty($jscomp.polyfills,Na,{configurable:!0,writable:!0,value:ha}):ha!==Ga&&($jscomp.propertyToPolyfillSymbol[Na]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(Na):
$jscomp.POLYFILL_PREFIX+Na,Na=$jscomp.propertyToPolyfillSymbol[Na],$jscomp.defineProperty(va,Na,{configurable:!0,writable:!0,value:ha})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(ba){if(ba)return ba;var ha=function(Na,H){this.$jscomp$symbol$id_=Na;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:H})};ha.prototype.toString=function(){return this.$jscomp$symbol$id_};var Ga=0,va=function(Na){if(this instanceof va)throw new TypeError("Symbol is not a constructor");return new ha("jscomp_symbol_"+(Na||"")+"_"+Ga++,Na)};return va},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(ba){if(ba)return ba;ba=Symbol("Symbol.iterator");for(var ha="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Ga=0;Ga<ha.length;Ga++){var va=$jscomp.global[ha[Ga]];"function"===typeof va&&"function"!=typeof va.prototype[ba]&&$jscomp.defineProperty(va.prototype,ba,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return ba},
"es6","es3");$jscomp.iteratorPrototype=function(ba){ba={next:ba};ba[Symbol.iterator]=function(){return this};return ba};
function _templateObject(){var ba=_taggedTemplateLiteral(["\n    defmakeatletter{catcode","@=11\relax}\n    defmakeatother{catcode","@=12\relax}\n    makeatletter\n    count10=23\n    count11=9\n    count12=9\n    count13=9\n    countdefinsc@unt=20\n    countdefallocationnumber=21\n    countdefm@ne=22 m@ne=-1\n    countdefcount@=255\n    dimendefdimen@=0\n    dimendefdimen@i=1\n    dimendefdimen@ii=2\n    skipdefskip@=0\n    def\newcount{alloc@0countcountdef}\n    def\newdimen{alloc@1dimendimendef}\n    def\newskip{alloc@2skipskipdef}\n    def\newmuskip{alloc@3muskipmuskipdef}\n    defalloc@#1#2#3#4{\n      advancecount1#1by1\n      allocationnumber=count1#1\n      #3#4=allocationnumber\n    }\n    \newdimenmaxdimen maxdimen=137438953471.99998pt\n    \newskiphideskip hideskip=-1000pt plus 1fil\n    \newskipcentering centering=0pt plus 1000pt minus 1000pt\n    def\newif#1{\n      {lccode","9=",
"i lccode","8=",void 0,"{\n    mathchardef}=","}\n    mathchardef$=","$\n    mathchardef#=","#\n    mathchardef%=","%\n    mathchardef&=","&\n    mathchardef_=",'_\n    mathchardefaa="700E5\n    mathchardefae="700E6\n    mathchardefaleph="02135\n    mathchardefalpha="703B1\n    mathchardefamalg="22A3F\n    mathchardefangle="02220\n    mathchardefapprox="32248\n    mathchardefarrowvert="023D0\n    mathchardefast="2002A\n    mathchardefasymp="3224D\n    mathchardef\backslash=','\\\n    mathchardef\beta="703B2\n    mathchardef\bigcap="122C2\n    mathchardef\bigcirc="225EF\n    mathchardef\bigcup="122C3\n    mathchardef\bigodot="12A00\n    mathchardef\bigoplus="12A01\n    mathchardef\bigotimes="12A02\n    mathchardef\bigtriangleup="225B3\n    mathchardef\bigtriangledown="225BD\n    mathchardef\bigsqcup="12A06\n    mathchardef\biguplus="12A04\n    mathchardef\bigvee="122C1\n    mathchardef\bigwedge="122C0\n    mathchardef\bot="022A5\n    mathchardef\bracevert="023AA\n    mathchardef\bowtie="322C8\n    mathchardef\bullet="22022\n    mathchardefcap="22229\n    mathchardefcdot="222C5\n    mathchardefcdotp="622C5\n    mathchardefchi="703C7\n    mathchardefcirc="225CB\n    mathchardefclubsuit="02663\n    mathchardefcolon="6003A\n    mathchardefcong="32245\n    mathchardefcoprod="12210\n    mathchardefcup="2222A\n    mathchardefdag="02020\n    mathchardefdagger="22020\n    mathchardefdashv="322A3\n    mathchardefddag="02021\n    mathchardefddagger="22021\n    mathchardefdelta="703B4\n    mathchardefdiamond="222C4\n    mathchardefdiamondsuit="02662\n    mathchardefdiv="200F7\n    mathchardefdoteq="32250\n    mathchardefdownarrow="02193\n    mathchardefell="02113\n    mathchardefemptyset="02205\n    mathchardefepsilon="703F5\n    mathchardefequiv="32261\n    mathchardefeta="703B7\n    mathchardefexists="02203\n    mathchardef\flat="0266D\n    mathchardef\forall="02200\n    mathchardef\frown="32322\n    mathchardefgamma="703B3\n    mathchardefge="32265 letgeq=ge\n    mathchardefgg="3226B\n    mathchardefhbar="70127\n    mathchardefheartsuit="02661\n    mathchardefhookleftarrow="321AA\n    mathchardefhookrightarrow="321A9\n    mathchardefimath="70131\n    mathchardefin="32208\n    mathchardefinfty="0221E\n    mathchardefintop="1222B defint{intop\nolimits}\n    mathchardefiota="703B9\n    mathchardefjmath="70237\n    mathchardefkappa="703BA\n    mathchardefl="00142\n    mathchardeflambda="703BB\n    mathchardeflangle="027E8\n    mathchardeflbrace=',
'{\n    mathchardeflceil="02308\n    mathchardefldotp="6002E\n    mathchardefle="32264 letleq=le\n    mathchardefleftarrow="32190 letgets=leftarrow\n    mathchardefleftharpoondown="321BD\n    mathchardefleftharpoonup="321BC\n    mathchardefleftrightarrow="32194\n    mathchardeflfloor="0230A\n    mathchardeflgroup="027EE\n    mathchardefll="3226A\n    mathchardeflmoustache="023B0\n    mathchardeflongleftarrow="327F5\n    mathchardeflongleftrightarrow="327F7\n    mathchardeflongmapsto="327FC\n    mathchardeflongrightarrow="327F6\n    mathchardefmapsto="321A6\n    mathchardefmid="32223\n    mathchardefmodels="322A7\n    mathchardefmp="22213\n    mathchardefmu="703BC\n    mathchardef\nabla="02207\n    mathchardef\natural="0266E\n    mathchardef\nearrow="32197\n    mathchardef\neg="000AC letlnot=\neg\n    mathchardef\ne="32260 let\neq=\ne\n    mathchardef\ni="3220B letowns=\ni\n    mathchardef\notin="32209\n    mathchardef\nu="703BD\n    mathchardef\nwarrow="32196\n    mathchardefo="700F8\n    mathchardefodot="22299\n    mathchardefoe="70153\n    mathchardefointop="1222E defoint{ointop\nolimits}\n    mathchardefomega="703C9\n    mathchardefominus="22296\n    mathchardefoplus="22295\n    mathchardefoslash="22298\n    mathchardefotimes="22297\n    mathchardefparallel="32225\n    mathchardefpartial="02202\n    mathchardefperp="322A5\n    mathchardefphi="703D5\n    mathchardefpi="703C0\n    mathchardefpm="200B1\n    mathchardefprec="3227A\n    mathchardefpreceq="3227C\n    mathchardefprime="02032\n    mathchardefprod="1220F\n    mathchardefpropto="3221D\n    mathchardefpsi="703C8\n    mathchardef\rangle="027E9\n    mathchardef\rbrace=',
void 0,void 0,void 0," =13\relax}\n    catcode"," =12defspace{ }obeyspaceslet =space\n    catcode"," =10\n    \newcountmscount\n    defmultispan#1{omit mscount#1\relaxloopifnummscount>1sp@n\repeat}\n    defsp@n{spanomitadvancemscount-1}\n    def\two@digits#1{ifnum#1<10 0\fi\the#1}\n    defdospecials{do do\\do{do}do$do&do#do^do^^Kdo_do^^Ado%do~}\n    defmathpalette#1#2{      mathchoice{#1displaystyle{#2}}{#1\textstyle{#2}}{#1scriptstyle{#2}}{#1scriptscriptstyle{#2}}}\n    def\binom#1#2{{{#1}atopwithdelims(){#2}}}\n    def\frac#1#2{{{#1}over{#2}}}\n    defmathrm#1{{\rm#1}}\n    def\textrm#1{{\rm#1}}\n    defmathbf#1{{\bf#1}}\n    def\textbf#1{{\bf#1}}\n    defmathit#1{{it#1}}\n    def\textit#1{{it#1}}\n    defmathsl#1{{sl#1}}\n    def\textsl#1{{sl#1}}\n    def@gobble#1{}\n    def@ifnextchar#1#2#3{\n      let@ifnextchar@charone=#1\n      def@ifnextchar@true{#2}\n      def@ifnextchar@false{#3}\n      \futurelet@ifnextchar@chartwo@ifnextchar@check}\n    def@ifnextchar@check{\n      ifx@ifnextchar@charone@ifnextchar@chartwo@ifnextchar@trueelse@ifnextchar@false\fi}\n    def\newcommand#1{@ifnextchar[{@newcommand#1}{@newcommand#1[0]}}\n    def@newcommand#1[#2]{\n      count0=#2\n      ifnumcount0<0\n        Error{Not Enough Parameters}\n      else\n        ifnumcount0>9\n          Error{TooManyParameters}\n        else\n          @ifnextchar[{ifnumcount0<1\n            Error{ParameterNumberMustBe>0}\n          else\n            @newcommand@optarg#1[#2]\n          \fi}{@newcommand@nooptarg#1[#2]}\n        \fi\n      \fi\n    }\n    def@paramnums#1{\n      ifcase#1\n      or####1\n      or####1####2\n      or####1####2####3\n      or####1####2####3####4\n      or####1####2####3####4####5\n      or####1####2####3####4####5####6\n      or####1####2####3####4####5####6####7\n      or####1####2####3####4####5####6####7####8\n      or####1####2####3####4####5####6####7####8####9\fi}\n    def@paramnums@bracket#1{\n      ifcase#1\n      or[####1]\n      or[####1]####2\n      or[####1]####2####3\n      or[####1]####2####3####4\n      or[####1]####2####3####4####5\n      or[####1]####2####3####4####5####6\n      or[####1]####2####3####4####5####6####7\n      or[####1]####2####3####4####5####6####7####8\n      or[####1]####2####3####4####5####6####7####8####9\fi}\n    def@newcommand@nooptarg#1[#2]#{\n      edef@newcommand@make{def\noexpand#1@paramnums#2}\n      @newcommand@make}\n    def@newcommand@optarg#1[#2][#3]#{\n      def#1{\n        @ifnextchar[{csnamestring#1endcsname}{csnamestring#1endcsname[#3]}}\n      edef@newcommand@make{\n        \noexpandexpandafterdef\n        \noexpandcsname\noexpandstring\noexpand#1endcsname@paramnums@bracket#2}\n      @newcommand@make}\n    \newcommandsqrt[1][]{\root #1of }}\n    makeatother\n  "],
["\n    \\def\\makeatletter{\\catcode","\\@=11\\relax}\n    \\def\\makeatother{\\catcode","\\@=12\\relax}\n    \\makeatletter\n    \\count10=23\n    \\count11=9\n    \\count12=9\n    \\count13=9\n    \\countdef\\insc@unt=20\n    \\countdef\\allocationnumber=21\n    \\countdef\\m@ne=22 \\m@ne=-1\n    \\countdef\\count@=255\n    \\dimendef\\dimen@=0\n    \\dimendef\\dimen@i=1\n    \\dimendef\\dimen@ii=2\n    \\skipdef\\skip@=0\n    \\def\\newcount{\\alloc@0\\count\\countdef}\n    \\def\\newdimen{\\alloc@1\\dimen\\dimendef}\n    \\def\\newskip{\\alloc@2\\skip\\skipdef}\n    \\def\\newmuskip{\\alloc@3\\muskip\\muskipdef}\n    \\def\\alloc@#1#2#3#4{\n      \\advance\\count1#1by1\n      \\allocationnumber=\\count1#1\n      #3#4=\\allocationnumber\n    }\n    \\newdimen\\maxdimen \\maxdimen=137438953471.99998pt\n    \\newskip\\hideskip \\hideskip=-1000pt plus 1fil\n    \\newskip\\centering \\centering=0pt plus 1000pt minus 1000pt\n    \\def\\newif#1{\n      {\\lccode",
"9=","i \\lccode","8=",'f \\lowercase{\\gdef\\@remove@if##198##2{##2}}}\n      \\expandafter\\expandafter\\expandafter\n      \\def\\expandafter\\expandafter\\expandafter\n      \\@if@name\\expandafter\\expandafter\\expandafter{\\expandafter\\@remove@if\\string#1}\n      \\expandafter\\def\\expandafter\\@if@name@bool\\expandafter##\\expandafter1\\expandafter{\\@if@name##1}\n      \\expandafter\\def\\csname\\@if@name@bool{true}\\endcsname{\n        \\let#1=\\iftrue\n      }\n      \\expandafter\\def\\csname\\@if@name@bool{false}\\endcsname{\n        \\let#1=\\iffalse\n      }\n      \\let#1=\\iffalse\n      \\let\\@if@name=\\undefined\n      \\let\\@if@name@bool=\\undefined\n      \\let\\@remove@if=\\undefined\n    }\n    \\newcount\\active \\active=13\n    \\newskip\\smallskipamount \\smallskipamount=3pt plus 1pt minus 1pt\n    \\newskip\\medskipamount \\medskipamount=6pt plus 2pt minus 2pt\n    \\newskip\\bigskipamount \\bigskipamount=12pt plus 4pt minus 4pt\n    \\newskip\\normalbaselineskip \\normalbaselineskip=12pt\n    \\newskip\\normallineskip \\normallineskip=1pt\n    \\newdimen\\normallineskiplimit \\normallineskiplimit=0pt\n    \\newdimen\\jot \\jot=3pt\n    \\newcount\\interdisplaylinepenalty \\interdisplaylinepenalty=100\n    \\newcount\\interfootnotelinepenalty \\interfootnotelinepenalty=100\n    \\mathchardef\\\\="0000A\n    \\mathchardef\\ ="0020\n    \\mathchardef\\{=',
"\\{\n    \\mathchardef\\}=","\\}\n    \\mathchardef\\$=","\\$\n    \\mathchardef\\#=","\\#\n    \\mathchardef\\%=","\\%\n    \\mathchardef\\&=","\\&\n    \\mathchardef\\_=",'\\_\n    \\mathchardef\\aa="700E5\n    \\mathchardef\\ae="700E6\n    \\mathchardef\\aleph="02135\n    \\mathchardef\\alpha="703B1\n    \\mathchardef\\amalg="22A3F\n    \\mathchardef\\angle="02220\n    \\mathchardef\\approx="32248\n    \\mathchardef\\arrowvert="023D0\n    \\mathchardef\\ast="2002A\n    \\mathchardef\\asymp="3224D\n    \\mathchardef\\backslash=',
'\\\\\n    \\mathchardef\\beta="703B2\n    \\mathchardef\\bigcap="122C2\n    \\mathchardef\\bigcirc="225EF\n    \\mathchardef\\bigcup="122C3\n    \\mathchardef\\bigodot="12A00\n    \\mathchardef\\bigoplus="12A01\n    \\mathchardef\\bigotimes="12A02\n    \\mathchardef\\bigtriangleup="225B3\n    \\mathchardef\\bigtriangledown="225BD\n    \\mathchardef\\bigsqcup="12A06\n    \\mathchardef\\biguplus="12A04\n    \\mathchardef\\bigvee="122C1\n    \\mathchardef\\bigwedge="122C0\n    \\mathchardef\\bot="022A5\n    \\mathchardef\\bracevert="023AA\n    \\mathchardef\\bowtie="322C8\n    \\mathchardef\\bullet="22022\n    \\mathchardef\\cap="22229\n    \\mathchardef\\cdot="222C5\n    \\mathchardef\\cdotp="622C5\n    \\mathchardef\\chi="703C7\n    \\mathchardef\\circ="225CB\n    \\mathchardef\\clubsuit="02663\n    \\mathchardef\\colon="6003A\n    \\mathchardef\\cong="32245\n    \\mathchardef\\coprod="12210\n    \\mathchardef\\cup="2222A\n    \\mathchardef\\dag="02020\n    \\mathchardef\\dagger="22020\n    \\mathchardef\\dashv="322A3\n    \\mathchardef\\ddag="02021\n    \\mathchardef\\ddagger="22021\n    \\mathchardef\\delta="703B4\n    \\mathchardef\\diamond="222C4\n    \\mathchardef\\diamondsuit="02662\n    \\mathchardef\\div="200F7\n    \\mathchardef\\doteq="32250\n    \\mathchardef\\downarrow="02193\n    \\mathchardef\\ell="02113\n    \\mathchardef\\emptyset="02205\n    \\mathchardef\\epsilon="703F5\n    \\mathchardef\\equiv="32261\n    \\mathchardef\\eta="703B7\n    \\mathchardef\\exists="02203\n    \\mathchardef\\flat="0266D\n    \\mathchardef\\forall="02200\n    \\mathchardef\\frown="32322\n    \\mathchardef\\gamma="703B3\n    \\mathchardef\\ge="32265 \\let\\geq=\\ge\n    \\mathchardef\\gg="3226B\n    \\mathchardef\\hbar="70127\n    \\mathchardef\\heartsuit="02661\n    \\mathchardef\\hookleftarrow="321AA\n    \\mathchardef\\hookrightarrow="321A9\n    \\mathchardef\\imath="70131\n    \\mathchardef\\in="32208\n    \\mathchardef\\infty="0221E\n    \\mathchardef\\intop="1222B \\def\\int{\\intop\\nolimits}\n    \\mathchardef\\iota="703B9\n    \\mathchardef\\jmath="70237\n    \\mathchardef\\kappa="703BA\n    \\mathchardef\\l="00142\n    \\mathchardef\\lambda="703BB\n    \\mathchardef\\langle="027E8\n    \\mathchardef\\lbrace=',
'\\{\n    \\mathchardef\\lceil="02308\n    \\mathchardef\\ldotp="6002E\n    \\mathchardef\\le="32264 \\let\\leq=\\le\n    \\mathchardef\\leftarrow="32190 \\let\\gets=\\leftarrow\n    \\mathchardef\\leftharpoondown="321BD\n    \\mathchardef\\leftharpoonup="321BC\n    \\mathchardef\\leftrightarrow="32194\n    \\mathchardef\\lfloor="0230A\n    \\mathchardef\\lgroup="027EE\n    \\mathchardef\\ll="3226A\n    \\mathchardef\\lmoustache="023B0\n    \\mathchardef\\longleftarrow="327F5\n    \\mathchardef\\longleftrightarrow="327F7\n    \\mathchardef\\longmapsto="327FC\n    \\mathchardef\\longrightarrow="327F6\n    \\mathchardef\\mapsto="321A6\n    \\mathchardef\\mid="32223\n    \\mathchardef\\models="322A7\n    \\mathchardef\\mp="22213\n    \\mathchardef\\mu="703BC\n    \\mathchardef\\nabla="02207\n    \\mathchardef\\natural="0266E\n    \\mathchardef\\nearrow="32197\n    \\mathchardef\\neg="000AC \\let\\lnot=\\neg\n    \\mathchardef\\ne="32260 \\let\\neq=\\ne\n    \\mathchardef\\ni="3220B \\let\\owns=\\ni\n    \\mathchardef\\notin="32209\n    \\mathchardef\\nu="703BD\n    \\mathchardef\\nwarrow="32196\n    \\mathchardef\\o="700F8\n    \\mathchardef\\odot="22299\n    \\mathchardef\\oe="70153\n    \\mathchardef\\ointop="1222E \\def\\oint{\\ointop\\nolimits}\n    \\mathchardef\\omega="703C9\n    \\mathchardef\\ominus="22296\n    \\mathchardef\\oplus="22295\n    \\mathchardef\\oslash="22298\n    \\mathchardef\\otimes="22297\n    \\mathchardef\\parallel="32225\n    \\mathchardef\\partial="02202\n    \\mathchardef\\perp="322A5\n    \\mathchardef\\phi="703D5\n    \\mathchardef\\pi="703C0\n    \\mathchardef\\pm="200B1\n    \\mathchardef\\prec="3227A\n    \\mathchardef\\preceq="3227C\n    \\mathchardef\\prime="02032\n    \\mathchardef\\prod="1220F\n    \\mathchardef\\propto="3221D\n    \\mathchardef\\psi="703C8\n    \\mathchardef\\rangle="027E9\n    \\mathchardef\\rbrace=',
'\\}\n    \\mathchardef\\rceil="02309\n    \\mathchardef\\relbar="3002D\n    \\mathchardef\\rfloor="0230B\n    \\mathchardef\\rgroup="027EF\n    \\mathchardef\\rho="703C1\n    \\mathchardef\\rightarrow="32192 \\let\\to=\\rightarrow\n    \\mathchardef\\rightharpoondown="321C1\n    \\mathchardef\\rightharpoonup="321C0\n    \\mathchardef\\rightleftharpoons="321CC\n    \\mathchardef\\rmoustache="023B1\n    \\mathchardef\\searrow="32198\n    \\mathchardef\\setminus="22216\n    \\mathchardef\\sharp="0266F\n    \\mathchardef\\sim="3223C\n    \\mathchardef\\simeq="32243\n    \\mathchardef\\sigma="703C3\n    \\mathchardef\\smile="32323\n    \\mathchardef\\sqcap="22293\n    \\mathchardef\\sqcup="22294\n    \\mathchardef\\sqsubseteq="32291\n    \\mathchardef\\sqsupseteq="32292\n    \\mathchardef\\ss="000DF\n    \\mathchardef\\star="222C6\n    \\mathchardef\\subset="32282\n    \\mathchardef\\subseteq="32286\n    \\mathchardef\\succ="3227B\n    \\mathchardef\\succeq="3227D\n    \\mathchardef\\sum="12211\n    \\mathchardef\\supset="32283\n    \\mathchardef\\supseteq="32287\n    \\mathchardef\\swarrow="32199\n    \\mathchardef\\tau="703C4\n    \\mathchardef\\theta="703B8\n    \\mathchardef\\times="200D7\n    \\mathchardef\\top="022A4\n    \\mathchardef\\triangle="025B3\n    \\mathchardef\\triangleleft="225C1\n    \\mathchardef\\triangleright="225B7\n    \\mathchardef\\ucup="2228E\n    \\mathchardef\\uparrow="02191\n    \\mathchardef\\updownarrow="02195\n    \\mathchardef\\upsilon="703C5\n    \\mathchardef\\varepsilon="703B5\n    \\mathchardef\\varphi="703C6\n    \\mathchardef\\varpi="703D6\n    \\mathchardef\\varrho="703F1\n    \\mathchardef\\varsigma="703C2\n    \\mathchardef\\vartheta="703D1\n    \\mathchardef\\vdash="322A2\n    \\mathchardef\\vee="22228 \\let\\lor=\\vee\n    \\mathchardef\\vert=',
'\\|\n    \\mathchardef\\wedge="22227 \\let\\land=\\wedge\n    \\mathchardef\\wp="02118\n    \\mathchardef\\wr="22240\n    \\mathchardef\\xi="703BE\n    \\mathchardef\\zeta="703B6\n    \\mathchardef\\AA="700C5\n    \\mathchardef\\AE="700C6\n    \\mathchardef\\Arrowvert="02225\n    \\mathchardef\\Delta="00394\n    \\mathchardef\\Downarrow="21D3\n    \\mathchardef\\Gamma="00393\n    \\mathchardef\\Im="02111\n    \\mathchardef\\L="00141\n    \\mathchardef\\Lambda="0039B\n    \\mathchardef\\Leftarrow="321D0\n    \\mathchardef\\Leftrightarrow="321D4\n    \\mathchardef\\Longleftarrow="327F8\n    \\mathchardef\\Longleftrightarrow="327FA\n    \\mathchardef\\Longrightarrow="327F9\n    \\mathchardef\\O="700D8\n    \\mathchardef\\OE="70152\n    \\mathchardef\\Omega="003A9\n    \\mathchardef\\Orb="225EF\n    \\mathchardef\\P="000B6\n    \\mathchardef\\Phi="003A6\n    \\mathchardef\\Pi="003A0\n    \\mathchardef\\Psi="003A8\n    \\mathchardef\\Re="0211C\n    \\mathchardef\\Relbar="3003D\n    \\mathchardef\\Rightarrow="321D2\n    \\mathchardef\\S="000A7\n    \\mathchardef\\Sigma="003A3\n    \\mathchardef\\spadesuit="02660\n    \\mathchardef\\Theta="00398\n    \\mathchardef\\Uparrow="021D1\n    \\mathchardef\\Updownarrow="021D5\n    \\mathchardef\\Upsilon="003A5\n    \\mathchardef\\Vert="02016 \\let\\|=\\Vert\n    \\mathchardef\\Xi="0039E\n    \\def\\~{\\accent"02DC }\n    \\def\\,{\\mskip\\thinmuskip}\n    \\def\\>{\\mskip\\medmuskip}\n    \\def\\;{\\mskip\\thickmuskip}\n    \\def\\!{\\mskip-\\thinmuskip}\n    \\def\\"{\\accent"A8 }\n    \\def\\={\\accent"AF }\n    \\def\\^{\\accent"5E }\n    \\def\\.{\\accent"02D9 }\n    \\def\\acute{\\accent"B4 }\n    \\def\\arccos{\\mathop{\\rm arccos}\\nolimits}\n    \\def\\arcsin{\\mathop{\\rm arcsin}\\nolimits}\n    \\def\\arctan{\\mathop{\\rm arctan}\\nolimits}\n    \\def\\arg{\\mathop{\\rm arg}\\nolimits}\n    \\def\\bar{\\accent"AF }\n    \\def\\big#1{{\\n@space\\left#1\\vbox to 1em{}\\right.}}\n    \\def\\bigl{\\mathopen\\big}\n    \\def\\bigm{\\mathrel\\big}\n    \\def\\bigr{\\mathclose\\big}\n    \\def\\bigg#1{{\\n@space\\left#1\\vbox to 1.6em{}\\right.}}\n    \\def\\biggl{\\mathopen\\bigg}\n    \\def\\biggm{\\mathrel\\bigg}\n    \\def\\biggr{\\mathclose\\bigg}\n    \\def\\bmod{\\\n      \\nonscript\\mskip-\\medmuskip\\mkern5mu\\mathbin{\\rm mod}\\mkern5mu\\nonscript\\mskip-\\medmuskip}\n    \\def\\brace{\\atopwithdelims\\{\\}}\n    \\def\\brack{\\atopwithdelims[]}\n    \\def\\breve{\\accent"02D8 }\n    \\def\\buildrel#1\\over#2{\\mathrel{\\mathop{\\kern0pt#2}\\limits^{#1}}}\n    \\def\\cases#1{\n      \\left\\{\\,{\\halign{##\\hfil&\\quad##\\hfil\\cr#1\\crcr}}\\right.}\n    \\def\\cdots{\\mathinner{\\cdotp\\cdotp\\cdotp}}\n    \\def\\check{\\accent"02C7 }\n    \\def\\choose{\\atopwithdelims()}\n    \\def\\cong{\\mathrel{\\tilde=}}\n    \\def\\cos{\\mathop{\\rm cos}\\nolimits}\n    \\def\\cosh{\\mathop{\\rm cosh}\\nolimits}\n    \\def\\cot{\\mathop{\\rm cot}\\nolimits}\n    \\def\\coth{\\mathop{\\rm coth}\\nolimits}\n    \\def\\csc{\\mathop{\\rm csc}\\nolimits}\n    \\def\\ddot{\\accent"A8 }\n    \\def\\ddots{\\mathinner{\\char"22F1}}\n    \\def\\deg{\\mathop{\\rm deg}\\nolimits}\n    \\def\\det{\\mathop{\\rm det}}\n    \\def\\dim{\\mathop{\\rm dim}\\nolimits}\n    \\def\\dot{\\accent"02D9 }\n    \\def\\empty{}\n    \\def\\exp{\\mathop{\\rm exp}\\nolimits}\n    \\def\\gcd{\\mathop{\\rm gcd}}\n    \\def\\grave{\\accent"60 }\n    \\def\\hat{\\accent"5E }\n    \\def\\hom{\\mathop{\\rm hom}\\nolimits}\n    \\def\\hphantom#1{\\vbox to0pt{\\phantom#1}}\n    \\def\\iff{\\;\\Longleftrightarrow\\;}\n    \\def\\inf{\\mathop{\\rm inf}}\n    \\def\\iterate{\\body \\let\\next=\\iterate\\else\\let\\next=\\relax\\fi\\next}\n    \\def\\joinrel{\\mathrel{\\mkern-3mu}}\n    \\def\\ker{\\mathop{\\rm ker}\\nolimits}\n    \\def\\lbrack{[}\n    \\def\\ldots{\\mathinner{\\ldotp\\ldotp\\ldotp}}\n    \\def\\lg{\\mathop{\\rm lg}\\nolimits}\n    \\def\\lim{\\mathop{\\rm lim}}\n    \\def\\liminf{\\mathop{\\rm lim\\,inf}}\n    \\def\\limsup{\\mathop{\\rm lim\\,sup}}\n    \\def\\ln{\\mathop{\\rm ln}\\nolimits}\n    \\def\\log{\\mathop{\\rm log}\\nolimits}\n    \\def\\loop#1\\repeat{\\def\\body{#1}\\iterate}\n    \\def\\lq{',
'}\n    \\def\\mathstrut{\\vphantom(}\n    \\def\\matrix#1{\\,\\halign{\\hfil##\\hfil&&\\quad\\hfil##\\hfil\\cr#1\\crcr}\\,}\n    \\def\\max{\\mathop{\\rm max}}\n    \\def\\min{\\mathop{\\rm min}}\n    \\def\\n@space{\\nulldelimiterspace=0pt\\relax}\n    \\def\\not{\\@ifnextchar={\\mathchar"32260\\@gobble}{\\hbox to 0pt{/}}}}\n    \\def\\null{\\hbox{}}\n    \\def\\pmatrix#1{\\left(\\matrix{#1}\\right)}\n    \\def\\pmod#1{\\mkern18mu({\\rm mod}\\,\\,#1)}\n    \\def\\rbrack{]}\n    \\def\\rq{\\\'}\n    \\def\\sec{\\mathop{\\rm sec}\\nolimits}\n    \\def\\sin{\\mathop{\\rm sin}\\nolimits}\n    \\def\\sinh{\\mathop{\\rm sinh}\\nolimits}\n    \\def\\skew#1#2#3{{\\muskip0 #1mu\\divide\\muskip0by2 \\mkern\\muskip0%\n      #2{\\mkern-\\muskip0{#3}\\mkern\\muskip0}\\mkern-\\muskip0}{}}\n    \\def\\strut{\\vrule height.708333333emdepth.291666666emwidth0pt\\relax}\n    \\def\\sup{\\mathop{\\rm sup}}\n    \\def\\surd{{\\mathchar"1221A}}\n    \\def\\t{\\accent"0311 }\n    \\def\\tan{\\mathop{\\rm tan}\\nolimits}\n    \\def\\tanh{\\mathop{\\rm tanh}\\nolimits}\n    \\def\\thinspace{\\kern.1667em}\n    \\def\\tilde{\\accent"02DC }\n    \\def\\u{\\accent"02D8 }\n    \\def\\v{\\accent"02C7 }\n    \\def\\vdots{\\mathinner{\\char"22EE}}\n    \\def\\vphantom#1{\\hbox to0pt{\\phantom#1}}\n    \\def\\Big#1{{\\n@space\\left#1\\vbox to 1.3em{}\\right.}}\n    \\def\\Bigl{\\mathopen\\Big}\n    \\def\\Bigm{\\mathrel\\Big}\n    \\def\\Bigr{\\mathclose\\Big}\n    \\def\\Bigg#1{{\\n@space\\left#1\\vbox to 1.9em{}\\right.}}\n    \\def\\Biggl{\\mathopen\\Bigg}\n    \\def\\Biggm{\\mathrel\\Bigg}\n    \\def\\Biggr{\\mathclose\\Bigg}\n    \\def\\H{\\accent"02DD }\n    \\def\\Pr{\\mathop{\\rm Pr}}\n    \\def\\TeX{T\\kern-.1667em{\\lower.5exE}\\kern-.125emX}\n    \\let\\bgroup={\n    \\let\\displaymath=\\[\n    \\let\\enddisplaymath=\\]\n    \\let\\egroup=}\n    \\let\\endline=\\cr\n    \\let\\math=\\(\n    \\let\\endmath=\\)\n    \\let\\sb=^\n    \\let\\sp=_\n    \\let\\repeat=\\fi\n    \\def\\negthinspace{\\kern-.1667em}\n    \\def\\enspace{\\kern.5em}\n    \\def\\enskip{\\hskip.5em\\relax}\n    \\def\\quad{\\hskip1em\\relax}\n    \\def\\qquad{\\hskip2em\\relax}\n    \\def\\smallskip{\\vskip\\smallskipamount}\n    \\def\\medskip{\\vskip\\medskipamount}\n    \\def\\bigskip{\\vskip\\bigskipamount}\n    \\def~{\\char"00A0\\relax}\n    \\def\\obeyspaces{\\catcode',
"\\ =13\\relax}\n    \\catcode","\\ =12\\def\\space{ }\\obeyspaces\\let =\\space\n    \\catcode","\\ =10\n    \\newcount\\mscount\n    \\def\\multispan#1{\\omit \\mscount#1\\relax\\loop\\ifnum\\mscount>1\\sp@n\\repeat}\n    \\def\\sp@n{\\span\\omit\\advance\\mscount-1}\n    \\def\\two@digits#1{\\ifnum#1<10 0\\fi\\the#1}\n    \\def\\dospecials{\\do\\ \\do\\\\\\do\\{\\do\\}\\do\\$\\do\\&\\do\\#\\do\\^\\do\\^^K\\do\\_\\do\\^^A\\do\\%\\do\\~}\n    \\def\\mathpalette#1#2{\\\n      \\mathchoice{#1\\displaystyle{#2}}{#1\\textstyle{#2}}{#1\\scriptstyle{#2}}{#1\\scriptscriptstyle{#2}}}\n    \\def\\binom#1#2{{{#1}\\atopwithdelims(){#2}}}\n    \\def\\frac#1#2{{{#1}\\over{#2}}}\n    \\def\\mathrm#1{{\\rm#1}}\n    \\def\\textrm#1{{\\rm#1}}\n    \\def\\mathbf#1{{\\bf#1}}\n    \\def\\textbf#1{{\\bf#1}}\n    \\def\\mathit#1{{\\it#1}}\n    \\def\\textit#1{{\\it#1}}\n    \\def\\mathsl#1{{\\sl#1}}\n    \\def\\textsl#1{{\\sl#1}}\n    \\def\\@gobble#1{}\n    \\def\\@ifnextchar#1#2#3{\n      \\let\\@ifnextchar@charone=#1\n      \\def\\@ifnextchar@true{#2}\n      \\def\\@ifnextchar@false{#3}\n      \\futurelet\\@ifnextchar@chartwo\\@ifnextchar@check}\n    \\def\\@ifnextchar@check{\n      \\ifx\\@ifnextchar@charone\\@ifnextchar@chartwo\\@ifnextchar@true\\else\\@ifnextchar@false\\fi}\n    \\def\\newcommand#1{\\@ifnextchar[{\\@newcommand#1}{\\@newcommand#1[0]}}\n    \\def\\@newcommand#1[#2]{\n      \\count0=#2\n      \\ifnum\\count0<0\n        \\Error{Not Enough Parameters}\n      \\else\n        \\ifnum\\count0>9\n          \\Error{TooManyParameters}\n        \\else\n          \\@ifnextchar[{\\ifnum\\count0<1\n            \\Error{ParameterNumberMustBe>0}\n          \\else\n            \\@newcommand@optarg#1[#2]\n          \\fi}{\\@newcommand@nooptarg#1[#2]}\n        \\fi\n      \\fi\n    }\n    \\def\\@paramnums#1{\n      \\ifcase#1\n      \\or####1\n      \\or####1####2\n      \\or####1####2####3\n      \\or####1####2####3####4\n      \\or####1####2####3####4####5\n      \\or####1####2####3####4####5####6\n      \\or####1####2####3####4####5####6####7\n      \\or####1####2####3####4####5####6####7####8\n      \\or####1####2####3####4####5####6####7####8####9\\fi}\n    \\def\\@paramnums@bracket#1{\n      \\ifcase#1\n      \\or[####1]\n      \\or[####1]####2\n      \\or[####1]####2####3\n      \\or[####1]####2####3####4\n      \\or[####1]####2####3####4####5\n      \\or[####1]####2####3####4####5####6\n      \\or[####1]####2####3####4####5####6####7\n      \\or[####1]####2####3####4####5####6####7####8\n      \\or[####1]####2####3####4####5####6####7####8####9\\fi}\n    \\def\\@newcommand@nooptarg#1[#2]#{\n      \\edef\\@newcommand@make{\\def\\noexpand#1\\@paramnums#2}\n      \\@newcommand@make}\n    \\def\\@newcommand@optarg#1[#2][#3]#{\n      \\def#1{\n        \\@ifnextchar[{\\csname\\string#1\\endcsname}{\\csname\\string#1\\endcsname[#3]}}\n      \\edef\\@newcommand@make{\n        \\noexpand\\expandafter\\def\n        \\noexpand\\csname\\noexpand\\string\\noexpand#1\\endcsname\\@paramnums@bracket#2}\n      \\@newcommand@make}\n    \\newcommand\\sqrt[1][]{\\root #1\\of }}\n    \\makeatother\n  "]);
_templateObject=function(){return ba};return ba}function _taggedTemplateLiteral(ba,ha){ha||(ha=ba.slice(0));return Object.freeze(Object.defineProperties(ba,{raw:{value:Object.freeze(ha)}}))}function _instanceof(ba,ha){return null!=ha&&"undefined"!==typeof Symbol&&ha[Symbol.hasInstance]?!!ha[Symbol.hasInstance](ba):ba instanceof ha}
function _typeof(ba){"@babel/helpers - typeof";_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(ha){return typeof ha}:function(ha){return ha&&"function"===typeof Symbol&&ha.constructor===Symbol&&ha!==Symbol.prototype?"symbol":typeof ha};return _typeof(ba)}
!function(ba,ha){"object"==("undefined"===typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=ha():"function"==typeof define&&define.amd?define(ha):(ba=ba||self).uuidv4=ha()}(void 0,function(){function ba(){if(!ha)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ha(Ga)}for(var ha="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&
"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),Ga=new Uint8Array(16),va=[],Na=0;256>Na;++Na)va.push((Na+256).toString(16).substr(1));return function(H,Va,q){"string"==typeof H&&(Va="binary"===H?new Uint8Array(16):null,H=null);var I=(H=H||{}).random||(H.rng||ba)();if(I[6]=15&I[6]|64,I[8]=63&I[8]|128,Va){H=q||0;for(q=0;16>q;++q)Va[H+q]=I[q];return Va}return(va[I[0]]+va[I[1]]+va[I[2]]+va[I[3]]+"-"+va[I[4]]+va[I[5]]+"-"+va[I[6]]+va[I[7]]+"-"+va[I[8]]+va[I[9]]+"-"+
va[I[10]]+va[I[11]]+va[I[12]]+va[I[13]]+va[I[14]]+va[I[15]]).toLowerCase()}});
window.fontTeX=function(){function ba(a){return"string"==typeof a?ba(document.querySelectorAll(a)):_instanceof(a,HTMLElement)?[a]:_instanceof(a,NodeList)||_instanceof(a,HTMLCollection)?Array.prototype.slice.call(a):Array.isArray(a)?a.filter(function(c){return _instanceof(c,Node)}):[]}function ha(a){if("string"==typeof a)return ha(document.querySelectorAll(a));if(_instanceof(a,HTMLCollection)||_instanceof(a,NodeList))return ha(Array.prototype.slice.call(a));if(_instanceof(a,HTMLElement))return ha([a]);
if(_instanceof(a,A.ParsedFontTeX))return[a];if(Array.isArray(a)){for(var c=[],b=ob.map(function(z){return z.elem}),f=0,e=a.length;f<e;f++)if(_instanceof(a[f],A.ParsedFontTeX))c.push(a[f]);else if(_instanceof(a[f],HTMLElement)){var l=b.indexOf(a[f]);~l&&c.push(ob[l].parsedTeXInstance)}return c}return ob.map(function(z){return z.parsedTeXInstance})}function Ga(){for(var a=yc.length-1;0<=a;a--)"true"!=yc[a].getAttribute("data-fontTeX-is-parsed")&&(A.render(yc[a]),yc[a].setAttribute("data-fontTeX-is-parsed",
"true"))}function va(a,c,b){function f(m,r){function xa(p,u){u||(u=this);if(p&&("command"==p.type||"character"==p.type&&p.cat==k.ACTIVE)){if(p.invalid){var t=("command"==p.type?p.escapeChar+p.name:p["char"]).split("");t=t.map(function(Ib){return{type:"character",cat:k.OTHER,"char":Ib,code:Ib.codePointAt(0),invalid:!0,recognized:p.recognized}});return[{type:"character",cat:k.OPEN,"char":"{",code:"{".codePointAt(0),invalid:!0}].concat(t).concat({type:"character",cat:k.CLOSE,"char":"}",code:"}".codePointAt(0),
invalid:!0})}if(p.ignore)return[{type:"ignored command",token:p}];var K=B[B.length-1];if("command"==p.type){if(p.name in K.defs.macros){var aa=K.defs.macros[p.name];aa.proxy&&(aa=aa.original);if("primitive"==aa.type)return t=aa["function"].call(p,{mouth:u,tokens:K.tokens,toggles:da,catOf:l,mathCodeOf:z,scopes:B,lastScope:B[B.length-1],openGroups:ka,contexts:fa,lastContext:fa[fa.length-1]||{},Scope:e,style:c}),p.recognized=!0,Array.isArray(t)?t:[];p.recognized=!0;var R=Symbol();u.saveState(R);K=[];
for(var O=0,S=aa.parameters.length;O<S;O++){var P=aa.parameters[O];if(P.cat==k.PARAMETER)if(aa.parameters[O+1]&&aa.parameters[O+1].cat!=k.PARAMETER){P=aa.parameters.map(function(Ib){return Ib.cat==k.PARAMETER}).indexOf(!0,O+1);P=aa.parameters.slice(O+1,~P?P:Infinity);K.push([]);for(var Q=0;;){var V=u.eat("argument");if(!V)return p.invalid=!0,u.loadState(R),[p];if(1==V.length){var E=V,M=Symbol(),Ha=!1;u.saveState(M);for(var Sa=0;Sa<P.length&&E&&(1==E.length||P[Sa].cat==k.OPEN&&Sa==P.length-1)&&E[0].type==
P[Sa].type&&E[0].cat==P[Sa].cat&&E[0].code==P[Sa].code&&E[0].name==P[Sa].name;Sa++){if(Sa==P.length-1){Ha=!0;break}E=u.eat("argument")}u.loadState(M);if(Ha){u.revert();break}}K[K.length-1]=K[K.length-1].concat(V);Q++}1==Q&&K[K.length-1][0].cat==k.OPEN&&K[K.length-1][K[K.length-1].length-1].cat==k.CLOSE&&(K[K.length-1].shift(),K[K.length-1].pop())}else{P=u.eat("argument");if(!P)return p.invalid=!0,u.loadState(R),[p];2<P.length&&(P.shift(),P.pop());K.push(P)}else if(Q=u.eat(),!P||!Q||P.type!=Q.type||
P.cat!=Q.cat||P.code!=Q.code||P.name!=Q.name)return p.invalid=!0,u.loadState(R),[p]}R=[];O=0;for(S=aa.replacement.length;O<S;O++)if(aa.replacement[O].cat==k.PARAMETER)aa.replacement[O+1].cat==k.PARAMETER?(R.push(aa.replacement[O+1]),O++):(P=aa.replacement[O+1]["char"]-1,P>K.length?R=R.concat({type:"character",cat:k.OTHER,"char":aa.replacement[O]["char"],code:macros.replacement[O].code,invalid:!0}):(R=R.concat(K[P]),O++));else{P={};for(t in aa.replacement[O])P[t]=aa.replacement[O][t];R.push(P)}return R}if(p.name in
K.defs.primitive)return t=K.defs.primitive[p.name]["function"].call(p,{mouth:u,tokens:K.tokens,toggles:da,catOf:l,scopes:B,lastScope:B[B.length-1],openGroups:ka,contexts:fa,lastContext:fa[fa.length-1]||{},Scope:e,style:c}),p.recognized=!0,Array.isArray(t)?t:[];if(p.name in K.registers.named)return[K.registers.named[p.name]];p.invalid=!0;return[p]}if("character"==p.type){if(p["char"]in K.defs.active){t=K.defs.active[p["char"]];t.proxy&&(t=t.original);if("primitive"==t.type)return t=t["function"].call(p,
{mouth:u,tokens:K.tokens,toggles:da,catOf:l,scopes:B,lastScope:B[B.length-1],openGroups:ka,contexts:fa,lastContext:fa[fa.length-1]||{},Scope:e,style:c}),p.recognized=!0,Array.isArray(t)?t:[];p.recognized=!0;R=Symbol();u.saveState(R);K=[];O=0;for(S=t.parameters.length;O<S;O++)if(P=t.parameters[O],P.cat==k.PARAMETER)if(t.parameters[O+1]&&t.parameters[O+1].cat!=k.PARAMETER){P=t.parameters.map(function(Ib){return Ib.cat==k.PARAMETER}).indexOf(!0,O+1);P=t.parameters.slice(O+1,~P?P:Infinity);K.push([]);
for(Q=0;;){V=u.eat("argument");if(!V)return p.invalid=!0,u.loadState(R),[p];if(1==V.length){E=V;M=Symbol();Ha=!1;u.saveState(M);for(Sa=0;Sa<P.length&&E&&(1==E.length||P[Sa].cat==k.OPEN&&Sa==P.length-1)&&E[0].type==P[Sa].type&&E[0].cat==P[Sa].cat&&E[0].code==P[Sa].code&&E[0].name==P[Sa].name;Sa++){if(Sa==P.length-1){Ha=!0;break}E=u.eat("argument")}u.loadState(M);if(Ha){u.revert();break}}K[K.length-1]=K[K.length-1].concat(V);Q++}1==Q&&K[K.length-1][0].cat==k.OPEN&&K[K.length-1][K[K.length-1].length-
1].cat==k.CLOSE&&(K[K.length-1].shift(),K[K.length-1].pop())}else{P=u.eat("argument");if(!P)return p.invalid=!0,u.loadState(R),[p];2<P.length&&(P.shift(),P.pop());K.push(P)}else if(Q=u.eat(),!P||!Q||P.type!=Q.type||P.cat!=Q.cat||P.code!=Q.code||P.name!=Q.name)return p.invalid=!0,u.loadState(R),[p];R=[];O=0;for(S=t.replacement.length;O<S;O++)if(t.replacement[O].cat==k.PARAMETER)t.replacement[O+1].cat==k.PARAMETER?(R.push(t.replacement[O+1]),O++):(P=t.replacement[O+1]["char"]-1,P>K.length?R=R.concat({type:"character",
cat:k.OTHER,"char":t.replacement[O]["char"],code:macros.replacement[O].code,invalid:!0}):(R=R.concat(K[P]),O++));else{P={};for(aa in t.replacement[O])P[aa]=t.replacement[O][aa];R.push(P)}return R}p.invalid=!0;return[p]}}else return[p]}this.queue=(r||ua).slice();this.string="string"==typeof m?m:Aa;this.history=[];this.savedStates={};this.eat=function(p){var u,t,K,aa,R;switch(p){default:if(this.queue.length){if(this.queue[0].cat==k.WHITESPACE&&"pre space"!=p)return this.queue.shift(),this.eat(p);this.history.push({queue:this.queue.slice(),
string:this.string,history:this.history.slice()});return this.queue.shift()}if(0==this.string.length)return null;if(l(this.string[0])==k.ESCAPE){if(!this.string[1]||"\n"==this.string[1])return this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),this.string=this.string.substring(2),{type:"command",escapeChar:this.string[0],name:"",nameType:"command"};this.string[1]==this.string[2]&&l(this.string[1])==k.SUPERSCRIPT&&this.string[4]&&"0123456789abcdef".includes(this.string[3])&&
"0123456789abcdef".includes(this.string[4])?this.string=this.string[0]+String.fromCodePoint(parseInt(this.string.substring(3,5),16))+this.string.substring(5):this.string[1]==this.string[2]&&l(this.string[1])==k.SUPERSCRIPT&&128>this.string.codePointAt(3)&&(this.string=this.string[0]+String.fromCharCode((this.string.codePointAt(3)+64)%128)+this.string.substring(4));if(l(this.string[1])==k.LETTER){p="";for(u=1;;u++)if(l(this.string[u])==k.LETTER)p+=this.string[u];else if(this.string[u]==this.string[u+
1]&&l(this.string[u])==k.SUPERSCRIPT&&"0123456789abcdef".includes(this.string[u+2])&&"0123456789abcdef".includes(this.string[u+3]))this.string=this.string.substring(0,u)+String.fromCodePoint(parseInt(this.string.substring(u+2,u+4),16))+this.string.substring(u+4),u--;else if(this.string[u]==this.string[u+1]&&l(this.string[u])==k.SUPERSCRIPT&&128>this.string.codePointAt(u+2))this.string=this.string.substring(0,u)+String.fromCodePoint((this.string.codePointAt(u+2)+64)%128)+this.string.substring(u+3),
u--;else break;this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});u={type:"command",escapeChar:this.string[0],name:p,nameType:"command"};this.string=this.string.substring(1+p.length);return u}this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});p={type:"command",escapeChar:this.string[0],name:this.string[1],nameType:"symbol"};this.string=this.string.substring(2);return p}if(this.string[0]==this.string[1]&&l(this.string[0])==
k.SUPERSCRIPT&&"0123456789abcdef".includes(this.string[2])&&"0123456789abcdef".includes(this.string[3]))return this.string=String.fromCodePoint(parseInt(this.string.substring(2,4),16))+this.string.substring(4),this.eat(p);if(this.string[0]==this.string[1]&&l(this.string[0])==k.SUPERSCRIPT&&128>this.string.codePointAt(2))return this.string=String.fromCodePoint((this.string.codePointAt(2)+64)%128)+this.string.substring(3),this.eat(p);if([k.OPEN,k.CLOSE,k.MATHSHIFT,k.ALIGN,k.PARAMETER,k.SUPERSCRIPT,
k.SUBSCRIPT,k.LETTER,k.OTHER,k.ACTIVE].includes(l(this.string[0])))return this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),p=this.string[0],this.string=this.string.substring(1),{type:"character","char":p,code:p.codePointAt(0),cat:l(p)};if(l(this.string[0])==k.ENDOFLINE){u=this.string.indexOf("\n");for(this.string=this.string.substring(~u?u+1:this.string.length);l(this.string[0])==k.WHITESPACE;)this.string=this.string.substring(1);"pre space"==p&&this.queue.unshift({type:"character",
"char":" ",code:" ".codePointAt(0),cat:k.WHITESPACE});return this.eat(p)}if(l(this.string[0])==k.COMMENT)return u=this.string.indexOf("\n"),this.string=this.string.substring(~u?u+1:this.string.length),this.eat(p);if(l(this.string[0])==k.WHITESPACE&&"pre space"!=p||l(this.string[0])==k.IGNORE)return this.string=this.string.substring(1),this.eat(p);if(l(this.string[0])==k.WHITESPACE&&"pre space"==p)return this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),
p=this.string[0],this.string=this.string.substring(1),{type:"character","char":p,code:p.codePointAt(0),cat:k.WHITESPACE};if(l(this.string[0])==k.INVALID)return this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),p=this.string[0],this.string=this.string.substring(1),{type:"character","char":p,code:p.codePointAt(0),cat:k.OTHER,invalid:!0};break;case "argument":p=new f(this.string,this.queue);u=0;var O=[];do{if(t=p.eat())t.cat==k.OPEN?u++:t.cat==k.CLOSE&&u--;
else break;O.push(t)}while(0<u);if(0<u||0==O.length)return null;this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});p.finalize();this.string=p.string;return O;case "integer":p=new f(this.string,this.queue);t="start";O=1;var S=0;var P=!1;for(u="pre space";;){var Q=p.eat(u);if(!Q)break;if("start"==t&&("command"==Q.type||"character"==Q.type&&Q.cat==k.ACTIVE))if((K="command"==Q.type?B[B.length-1].defs.primitive[Q.name]||B[B.length-1].defs.macros[Q.name]||B[B.length-
1].registers.named[Q.name]:B[B.length-1].defs.active[Q["char"]])&&K.proxy&&(K=K.original),K&&(K.register||Ob.includes(K))){K=xa(Q,p);if(1==K.length&&K[0]===Q&&Q.invalid){p.revert();break}p.queue.unshift.apply(p.queue,K)}else{K!==d.defs.primitive.relax&&p.revert();break}else if("start"!=t||Q.cat!=k.WHITESPACE)if("start"==t&&Q.cat==k.OTHER&&"-"==Q["char"])O*=-1;else if("start"!=t||Q.cat!=k.OTHER||"+"!=Q["char"])if("start"==t&&Q.register){"integer"==Q.type?S=Q.value:"dimension"==Q.type?S=Q.sp.value+
12*Q.em.value:"mu dimension"==Q.type?S=12*Q.mu.value/18:"glue"==Q.type?S=Q.start.sp.value+12*Q.start.em.value:"mu glue"==Q.type&&(S=12*Q.start.mu.value/18);P=!0;break}else if("start"==t)u="unsigned int",p.revert();else{p.revert();break}}if(!P)return null;S*=O;this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});p.finalize();this.string=p.string;return new q(S);case "dimension":p=new f(this.string,this.queue);t="start";O=1;S=" ";Q=P=!1;u="pre space";var V=K=
0;for(aa=!1;!Q;){var E=p.eat(u);if(!E)break;if("start"==t&&("command"==E.type||"character"==E.type&&E.cat==k.ACTIVE))if((R="command"==E.type?B[B.length-1].defs.primitive[E.name]||B[B.length-1].defs.macros[E.name]||B[B.length-1].registers.named[E.name]:B[B.length-1].defs.active[E["char"]])&&R.proxy&&(R.original=R),R&&(R.register||Ob.includes(R))){R=xa(E,p);if(1==R.length&&R[0]===E&&E.invalid){p.revert();break}p.queue.unshift.apply(p.queue,R)}else{R!==d.defs.primitive.relax&&p.revert();break}else if("start"!=
t||E.cat!=k.WHITESPACE)if("start"==t&&E.cat==k.OTHER&&"-"==E["char"])O*=-1;else if("start"!=t||E.cat!=k.OTHER||"+"!=E["char"])if("start"==t&&!P&&E.register){if("integer"==E.type?(S=E.value,"decimal"==E.message&&(S/=65536),S=" "+S,u="pre space",t="unit start"):"dimension"==E.type?(K=E.sp.value,V=E.em.value,Q=!0):"mu dimension"==E.type?(V=E.mu.value/18,Q=!0):"glue"==E.type?(K=E.start.sp.value,V=E.start.em.value,Q=!0):"mu glue"==E.type&&(V=E.start.mu.value/18,Q=!0),P=!0,Q)break}else if(P&&"unit start"==
t&&E.cat==k.WHITESPACE)t="unit start";else if(P&&E.register){S=parseFloat((S+" ").replace(" .",".").replace(". ","")||"0");"integer"==E.type?K=S*E.value:"dimension"==E.type?(K=S*E.sp.value,V=S*E.em.value):"mu dimension"==E.type?V=S*E.mu.value/18:"glue"==E.type?(K=S*E.start.sp.value,V=S*E.start.em.value):"mu glue"==E.type&&(V=S*E.start.mu.value);Q=!0;break}else if(!P||aa||"t"!=E["char"]&&"T"!=E["char"])if(!P||aa||"e"!=E["char"]&&"E"!=E["char"])if(!P||"p"!=E["char"]&&"P"!=E["char"])if(!P||"i"!=E["char"]&&
"I"!=E["char"])if(!P||"b"!=E["char"]&&"B"!=E["char"])if(!P||"c"!=E["char"]&&"C"!=E["char"])if(!P||"m"!=E["char"]&&"M"!=E["char"])if(!P||"d"!=E["char"]&&"D"!=E["char"])if(!P||"s"!=E["char"]&&"S"!=E["char"])if("start"!=t||P){p.revert();break}else u="factor",p.revert();else if(E=p.eat("pre space"),!E||"p"!=E["char"]&&"P"!=E["char"]||E.cat==k.ACTIVE){p.revert(2);break}else K=parseFloat((S+" ").replace(" .",".").replace(". ","")||"0"),Q=!0;else if(E=p.eat("pre space"),!E||"d"!=E["char"]&&"D"!=E["char"]||
E.cat==k.ACTIVE){p.revert(2);break}else K=81133568*parseFloat((S+" ").replace(" .",".").replace(". ","")||"0")/1157,Q=!0;else if(E=p.eat("pre space"),!E||"m"!=E["char"]&&"M"!=E["char"]||E.cat==k.ACTIVE){p.revert(2);break}else K=4718592*parseFloat((S+" ").replace(" .",".").replace(". ","")||"0")/2.54/10,Q=!0;else if(E=p.eat("pre space"),!E||"m"!=E["char"]&&"M"!=E["char"]||E.cat==k.ACTIVE)if(!E||"c"!=E["char"]&&"C"!=E["char"]||E.cat==k.ACTIVE){p.revert(2);break}else K=81133568*parseFloat((S+" ").replace(" .",
".").replace(". ","")||"0")/1157*12,Q=!0;else K=4718592*parseFloat((S+" ").replace(" .",".").replace(". ","")||"0")/2.54,Q=!0;else if(E=p.eat("pre space"),!E||"p"!=E["char"]&&"P"!=E["char"]||E.cat==k.ACTIVE){p.revert(2);break}else K=65536*parseFloat((S+" ").replace(" .",".").replace(". ","")||"0"),Q=!0;else if(E=p.eat("pre space"),!E||"n"!=E["char"]&&"N"!=E["char"]||E.cat==k.ACTIVE){p.revert(2);break}else K=4718592*parseFloat((S+" ").replace(" .",".").replace(". ","")||"0"),Q=!0;else if(E=p.eat("pre space"),
!E||"t"!=E["char"]&&"T"!=E["char"]||E.cat==k.ACTIVE)if(!E||"c"!=E["char"]&&"C"!=E["char"]||E.cat==k.ACTIVE)if(!E||"x"!=E["char"]&&"X"!=E["char"]||E.cat==k.ACTIVE){p.revert(2);break}else K=786432*parseFloat((S+" ").replace(" .",".").replace(". ","")||"0")/16,Q=!0;else K=786432*parseFloat((S+" ").replace(" .",".").replace(". ","")||"0"),Q=!0;else K=65536*parseFloat((S+" ").replace(" .",".").replace(". ","")||"0"),Q=!0;else{E=p.eat("pre space");if(!E||"m"!=E["char"]&&"M"!=E["char"]||E.cat==k.ACTIVE)if(!E||
"x"!=E["char"]&&"X"!=E["char"]||E.cat==k.ACTIVE){p.revert(2);break}else V=9719*parseFloat((S+" ").replace(" .",".").replace(". ","")||"0")/19200*65536;else V=65536*parseFloat((S+" ").replace(" .",".").replace(". ","")||"0");Q=!0}else{t=p.eat("pre space");if(!t||"r"!=t["char"]&&"R"!=t["char"]||t.cat==k.ACTIVE)p.revert(2);else if(E=p.eat("pre space"),!E||"u"!=E["char"]&&"U"!=t["char"]||E.cat==k.ACTIVE)p.revert(3);else if(t=p.eat("pre space"),!t||"e"!=t["char"]&&"E"!=t["char"]||t.cat==k.ACTIVE)p.revert(4);
else{aa=!0;t="unit start";continue}break}}if(!P||!Q)return null;K*=O;V*=O;this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});p.finalize();this.string=p.string;return aa?new I(1E3*K/B[B.length-1].registers.named.mag.value,1E3*V/B[B.length-1].registers.named.mag.value):new I(K,V);case "mu dimension":p=new f(this.string,this.queue);t="start";O=1;S=" ";Q=P=!1;u="pre space";for(K=0;!Q;){V=p.eat(u);if(!V)break;if("start"==t&&("command"==V.type||"character"==V.type&&
V.cat==k.ACTIVE))if((aa="command"==V.type?B[B.length-1].defs.primitive[V.name]||B[B.legnth-1].defs.macros[V.name]||B[B.length-1].registers.named[V.name]:B[B.length-1].defs.active[V["char"]])&&aa.proxy&&(aa=aa.original),aa&&(aa.register||Ob.includes(aa))){aa=xa(V,p);if(1==aa.length&&aa[0]===V&&V.invalid){p.revert();break}p.queue.unshift.apply(p.queue,aa)}else{aa!==d.defs.primitive.relax&&p.revert();break}else if("start"!=t||V.cat!=k.WHITESPACE)if("start"==t&&V.cat==k.OTHER&&"-"==V["char"])O*=-1;else if("start"!=
t||V.cat!=k.OTHER||"+"!=V["char"])if("start"==t&&!P&&V.register){if("integer"==V.type?(S=V.value,"decimal"==V.message&&(S/=65536),S=" "+S,u="pre space",t="unit start"):"dimension"==V.type?(K=V.em.value/65536*18,Q=!0):"mu dimension"==V.type?(K=V.mu.value/65536,Q=!0):"glue"==V.type?(K=V.start.em.value/65536*18,Q=!0):"mu glue"==V.type&&(K=V.start.mu.value/65536,Q=!0),P=!0,Q)break}else if(P&&"unit start"==t&&V.cat==k.WHITESPACE)t="unit start";else if(P&&V.register&&"mu glue"==V.type){S=parseFloat((S+
" ").replace(" .",".").replace(". ","")||"0");K=S*V.start.mu.value/65536;Q=!0;break}else if(!P||"m"!=V["char"]&&"M"!=V["char"])if("start"!=t||P){p.revert();break}else u="factor",p.revert();else{V=p.eat("pre space");if(!V||"u"!=V["char"]&&"U"!=V["char"]||V.cat==k.ACTIVE){p.revert(2);break}else K=parseFloat((S+" ").replace(" .",".").replace(". ","")||"0");Q=!0}}if(!P||!Q)return null;K*=O;this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});p.finalize();this.string=
p.string;return new Ba(65536*K);case "glue":p=new f(this.string,this.queue);t="start";O=1;u="pre space";V=aa=1;for(E=R=!1;;){var M=p.eat(u);if(!M&&("post start"!=t&&"stretch signs"!=t||"dimension"!=u)&&("post stretch"!=t&&"shrink signs"!=t||"dimension"!=u)){S&&p.loadState(S);break}if(M||"dimension"!=u)if("start"!=t&&"signs"!=t&&"post start"!=t&&"stretch signs"!=t&&"post stretch"!=t&&"shrink signs"!=t||"command"!=M.type&&("character"!=M.type||M.cat!=k.ACTIVE)){if("start"!=t&&"signs"!=t&&"post start"!=
t&&"post stretch"!=t&&"stretch signs"!=t&&"shrink signs"!=t||M.cat!=k.WHITESPACE)if("start"!=t&&"signs"!=t||M.cat!=k.OTHER||"-"!=M["char"])if("start"!=t&&"signs"!=t||M.cat!=k.OTHER||"+"!=M["char"])if("start"!=t&&"signs"!=t||!M.register||"glue"!=M.type)if("start"!=t&&"signs"!=t||!M.register||"dimension"!=M.type)if("start"==t||"signs"==t)u="dimension",p.revert();else if("post start"!=t||!P||E||R||"p"!=M["char"])if("post start"==t&&E&&M.cat==k.OTHER&&"-"==M["char"])aa*=-1,t="stretch signs";else if("post start"==
t&&E&&M.cat==k.OTHER&&"+"==M["char"])t="stretch signs";else if(("post start"==t||"stretch signs"==t)&&E&&M.register&&"dimension"==M.type)Q=new I(M.sp.value*aa,M.em.value*V),t="post stretch",u="pre space",p.saveState(S=Symbol());else if(("post start"==t||"stretch signs"==t)&&E&&M.register&&"integer"==M.type){u="pre space";if((t=p.eat())&&("f"==t["char"]||"F"==t["char"])&&t.cat!=k.ACTIVE&&(t=p.eat("pre space"))&&("i"==t["char"]||"I"==t["char"])&&t.cat!=k.ACTIVE&&(t=p.eat("pre space"))&&("l"==t["char"]||
"L"==t["char"])&&t.cat!=k.ACTIVE){t=p.eat("pre space");!t||"l"!=t["char"]&&"L"!=t["char"]||t.cat==k.ACTIVE?(t&&p.revert(),Q=new oa(M.value*aa,1)):(t=p.eat("pre space"),!t||"l"!=t["char"]&&"L"!=t["char"]||t.cat==k.ACTIVE?(t&&p.revert(),Q=new oa(M.value*aa,2)):Q=new oa(M.value*aa,3));t="post stretch";p.saveState(S=Symbol());continue}p.loadState(S);break}else if("post start"!=t&&"stretch signs"!=t||!E)if(("post start"!=t||E)&&"post stretch"!=t||R||"m"!=M["char"])if("post stretch"==t&&R&&M.cat==k.OTHER&&
"-"==M["char"])V*=-1,t="shrink signs";else if("post stretch"==t&&R&&M.cat==k.OTHER&&"+"==M["char"])t="shrink signs";else if(("post stretch"==t||"shrink signs"==t||"post start"==t)&&R&&M.register&&"dimension"==M.type){K=new I(M.sp.value*V,M.em.value*V);break}else if(("post stretch"==t||"shrink signs"==t||"post start"==t)&&R&&M.register&&"integer"==M.type){if((u=p.eat())&&("f"==u["char"]||"F"==u["char"])&&u.cat!=k.ACTIVE&&(u=p.eat("pre space"))&&("i"==u["char"]||"I"==u["char"])&&u.cat!=k.ACTIVE&&(u=
p.eat("pre space"))&&("l"==u["char"]||"L"==u["char"])&&u.cat!=k.ACTIVE){u=p.eat("pre space");!u||"l"!=u["char"]&&"L"!=u["char"]||u.cat==k.ACTIVE?(u&&p.revert(),K=new oa(M.value*V,1)):(u=p.eat("pre space"),!u||"l"!=u["char"]&&"L"!=u["char"]||u.cat==k.ACTIVE?(u&&p.revert(),K=new oa(M.value*V,2)):K=new oa(M.value*V,3));break}p.loadState(S);break}else if("post stretch"!=t&&"shrink signs"!=t&&"post start"!=t||!R){S?p.loadState(S):p.revert();break}else u="dimension",p.revert();else{if(!(!(R=p.eat("pre space"))||
"i"!=R["char"]&&"I"!=R["char"]||R.cat==k.ACTIVE||!(R=p.eat("pre space"))||"n"!=R["char"]&&"N"!=R["char"]||R.cat==k.ACTIVE||!(R=p.eat("pre space"))||"u"!=R["char"]&&"U"!=R["char"]||R.cat==k.ACTIVE||!(R=p.eat("pre space"))||"s"!=R["char"]&&"S"!=R["char"])&&R.cat!=k.ACTIVE){R=!0;continue}p.loadState(S);break}else u="dimension",p.revert();else{if((E=p.eat("pre space"))&&("l"==E["char"]||"L"==E["char"])&&E.cat!=k.ACTIVE&&(E=p.eat("pre space"))&&("u"==E["char"]||"U"==E["char"])&&E.cat!=k.ACTIVE&&(E=p.eat("pre space"))&&
("s"==E["char"]||"S"==E["char"])&&E.cat!=k.ACTIVE){E=!0;continue}p.loadState(S);break}else P=new I(M.sp.value*O,M.em.value*O),t="post start",u="pre space",p.saveState(S=Symbol());else{P=new I(M.start.sp.value*O,M.start.em.value*O);Q=new I(M.stretch.sp.value*O,M.stretch.em.value*O);K=new I(M.shrink.sp.value*O,M.shrink.em.value*O);break}else t="signs";else O*=-1,t="signs"}else{var Ha="command"==M.type?B[B.length-1].defs.primitive[M.name]||B[B.length-1].defs.macros[M.name]||B[B.length-1].registers.named[M.name]:
B[B.length-1].defs.active[M["char"]];Ha&&Ha.proxy&&(Ha=Ha.original);if(Ha&&(Ha.register||Ob.includes(Ha))){Ha=xa(M,p);if(1==Ha.length&&Ha[0]===M&&M.invalid){p.revert();break}p.queue.unshift.apply(p.queue,Ha)}else{Ha!==d.defs.primitive.relax&&p.revert();break}}else u="factor"}if(!P)return null;this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});p.finalize();this.string=p.string;return new Ia(P,Q,K);case "mu glue":p=new f(this.string,this.queue);t="start";O=
1;u="pre space";V=aa=1;for(E=R=!1;;){M=p.eat(u);if(!M&&("post start"!=t&&"stretch signs"!=t||"mu dimension"!=u)&&("post stretch"!=t&&"shrink signs"!=t||"mu dimension"!=u)){S&&p.loadState(S);break}if(M||"mu dimension"!=u)if("start"!=t&&"signs"!=t&&"post start"!=t&&"stretch signs"!=t&&"post stretch"!=t&&"shrink signs"!=t||"command"!=M.type&&("character"!=M.type||M.cat!=k.ACTIVE)){if("start"!=t&&"signs"!=t&&"post start"!=t&&"post stretch"!=t&&"stretch signs"!=t&&"shrink signs"!=t||M.cat!=k.WHITESPACE)if("start"!=
t&&"signs"!=t||M.cat!=k.OTHER||"-"!=M["char"])if("start"!=t&&"signs"!=t||M.cat!=k.OTHER||"+"!=M["char"])if("start"!=t&&"signs"!=t||!M.register||"mu glue"!=M.type)if("start"!=t&&"signs"!=t||!M.register||"mu dimension"!=M.type)if("start"==t||"signs"==t)u="mu dimension",p.revert();else if("post start"!=t||!P||E||R||"p"!=M["char"])if("post start"==t&&E&&M.cat==k.OTHER&&"-"==M["char"])aa*=-1,t="stretch signs";else if("post start"==t&&E&&M.cat==k.OTHER&&"+"==M["char"])t="stretch signs";else if(("post start"==
t||"stretch signs"==t)&&E&&M.register&&"mu dimension"==M.type)Q=new Ba(M.mu.value*aa),t="post stretch",u="pre space",p.saveState(S=Symbol());else if(("post start"==t||"stretch signs"==t)&&E&&M.register&&"integer"==M.type){u="pre space";if((t=p.eat())&&("f"==t["char"]||"F"==t["char"])&&t.cat!=k.ACTIVE&&(t=p.eat("pre space"))&&("i"==t["char"]||"I"==t["char"])&&t.cat!=k.ACTIVE&&(t=p.eat("pre space"))&&("l"==t["char"]||"L"==t["char"])&&t.cat!=k.ACTIVE){t=p.eat("pre space");!t||"l"!=t["char"]&&"L"!=t["char"]||
t.cat==k.ACTIVE?(p.revert(),Q=new oa(M.value*aa,1)):(t=p.eat("pre space"),!t||"l"!=t["char"]&&"L"!=t["char"]||t.cat==k.ACTIVE?(p.revert(),Q=new oa(M.value*aa,2)):Q=new oa(M.value*aa,3));t="post stretch";p.saveState(S=Symbol());continue}p.loadState(S);break}else if("post start"!=t&&"stretch signs"!=t||!E)if(("post start"!=t||E)&&"post stretch"!=t||R||"m"!=M["char"])if("post stretch"==t&&R&&M.cat==k.OTHER&&"-"==M["char"])V*=-1,t="shrink signs";else if("post stretch"==t&&R&&M.cat==k.OTHER&&"+"==M["char"])t=
"shrink signs";else if(("post stretch"==t||"shrink signs"==t||"post start"==t)&&R&&M.register&&"mu dimension"==M.type){K=new Ba(M.mu.value*V);break}else if(("post stretch"==t||"shrink signs"==t||"post start"==t)&&R&&M.register&&"integer"==M.type){if((u=p.eat())&&("f"==u["char"]||"F"==u["char"])&&u.cat!=k.ACTIVE&&(u=p.eat("pre space"))&&("i"==u["char"]||"I"==u["char"])&&u.cat!=k.ACTIVE&&(u=p.eat("pre space"))&&("l"==u["char"]||"L"==u["char"])&&u.cat!=k.ACTIVE){u=p.eat("pre space");!u||"l"!=u["char"]&&
"L"!=u["char"]||u.cat==k.ACTIVE?K=new oa(M.value*V,1):(u=p.eat("pre space"),K=!u||"l"!=u["char"]&&"L"!=u["char"]||u.cat==k.ACTIVE?new oa(M.value*V,2):new oa(M.value*V,3));break}p.loadState(S);break}else if("post stretch"!=t&&"shrink signs"!=t&&"post start"!=t||!R){S?p.loadState(S):p.revert();break}else u="mu dimension",p.revert();else{if(!(!(R=p.eat("pre space"))||"i"!=R["char"]&&"I"!=R["char"]||R.cat==k.ACTIVE||!(R=p.eat("pre space"))||"n"!=R["char"]&&"N"!=R["char"]||R.cat==k.ACTIVE||!(R=p.eat("pre space"))||
"u"!=R["char"]&&"U"!=R["char"]||R.cat==k.ACTIVE||!(R=p.eat("pre space"))||"s"!=R["char"]&&"S"!=R["char"])&&R.cat!=k.ACTIVE){R=!0;continue}p.loadState(S);break}else u="mu dimension",p.revert();else{if((E=p.eat("pre space"))&&("l"==E["char"]||"L"==E["char"])&&E.cat!=k.ACTIVE&&(E=p.eat("pre space"))&&("u"==E["char"]||"U"==E["char"])&&E.cat!=k.ACTIVE&&(E=p.eat("pre space"))&&("s"==E["char"]||"S"==E["char"])&&E.cat!=k.ACTIVE){E=!0;continue}p.loadState(S);break}else P=new Ba(M.mu.value*O),t="post start",
u="pre space",p.saveState(S=Symbol());else{P=new Ba(M.start.mu.value*O);Q=new Ba(M.stretch.mu.value*O);K=new Ba(M.shrink.mu.value*O);break}else t="signs";else O*=-1,t="signs"}else if((Ha="command"==M.type?B[B.length-1].defs.primitive[M.name]||B[B.length-1].defs.macros[M.name]||B[B.length-1].registers.named[M.name]:B[B.length-1].defs.active[M["char"]])&&Ha.proxy&&(Ha=Ha.original),Ha&&(Ha.register||Ob.includes(Ha))){Ha=xa(M,p);if(1==Ha.length&&Ha[0]===M&&M.invalid){p.revert();break}p.queue.unshift.apply(p.queue,
Ha)}else{Ha!==d.defs.primitive.relax&&p.revert();break}else u="factor"}if(!P)return null;this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});p.finalize();this.string=p.string;return new jb(P,Q,K);case "unsigned int":p=new f(this.string,this.queue);t="start";S=0;for(P=!1;;){u=p.eat("pre space");if(!u)break;if("grave"==t){if("command"==u.type&&1==u.name.length)S=u.name.codePointAt(0);else if("character"==u.type)S=u["char"].codePointAt(0);else return null;P=
!0;break}else if("start"==t&&("command"==u.type||"character"==u.type&&u.cat==k.ACTIVE))if((O="command"==u.type?B[B.length-1].defs.primitive[u.name]||B[B.length-1].defs.macros[u.name]||B[B.length-1].registers.named[u.name]:B[B.length-1].defs.active[u["char"]])&&O.proxy&&(O=O.original),O&&(O.register||Ob.includes(O))){O=xa(u,p);if(1==O.length&&O[0]===u&&u.invalid){p.revert();break}p.queue.unshift.apply(p.queue,O)}else{O!==d.defs.primitive.relax&&p.revert();break}else if("start"!=t||u.cat!=k.WHITESPACE)if("start"==
t&&u.register&&"integer"==u.type){S=u.value;P=!0;break}else if(("decimal"==t||"start"==t)&&u.cat==k.OTHER&&47<u.code&&58>u.code)S=10*S+parseInt(u["char"],10),t="decimal",P=!0;else if("start"==t&&u.cat==k.OTHER&&"'"==u["char"])t="octal";else if("start"==t&&u.cat==k.OTHER&&'"'==u["char"])t="hexadecimal";else if("start"==t&&u.cat==k.OTHER&&"`"==u["char"])t="grave";else if("octal"==t&&u.cat==k.OTHER&&47<u.code&&56>u.code)S=8*S+parseInt(u["char"],8),P=!0;else if("hexadecimal"==t&&(u.cat==k.OTHER&&47<u.code&&
58>u.code||(u.cat==k.OTHER||u.cat==k.LETTER)&&64<u.code&&71>u.code))S=16*S+parseInt(u["char"],16),P=!0;else{p.revert();break}}if(!P)return null;this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});p.finalize();this.string=p.string;return new q(S);case "factor":p=new f(this.string,this.queue);t="start";S="";P=!1;for(u="pre space";;){O=p.eat(u);if(!O)break;if("start"==t&&("command"==O.type||"character"==O.type&&O.cat==k.ACTIVE))if((Q="command"==O.type?B[B.length-
1].defs.primitive[O.name]||B[B.length-1].defs.macros[O.name]||B[B.length-1].registers.named[O.name]:B[B.length-1].defs.active[O["char"]])&&Q.proxy&&(Q=Q.original),Q&&(Q.register||Ob.includes(Q))){Q=xa(O,p);if(1==Q.length&&Q[0]===O&&O.invalid){p.revert();break}p.queue.unshift.apply(p.queue,Q)}else{Q!==d.defs.primitive.relax&&p.revert();break}else if("start"!=t||O.cat!=k.WHITESPACE)if("start"==t&&O.register&&"integer"==O.type){S=O.value.toString();P=!0;break}else if(("pre decimal"==t||"start"==t)&&
O.cat==k.OTHER&&47<O.code&&58>O.code)S+=O["char"],t="pre decimal",P=!0;else if("pre decimal"!=t&&"start"!=t||O.cat!=k.OTHER||"."!=O["char"]&&","!=O["char"])if("post decimal"==t&&O.cat==k.OTHER&&47<O.code&&58>O.code)S+=O["char"];else if("start"==t)u="unsigned int",p.revert();else{p.revert();break}else S+=".",t="post decimal",P=!0}if(!P)return null;this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});p.finalize();this.string=p.string;return new q(65536*S,null,
null,"decimal")}};this.preview=function(p){(p=this.eat(p))&&this.revert();return p};this.revert=function(p){for(p="number"==typeof p?p:1;0<p&&0!=this.history.length;p--){this.string=this.history[this.history.length-1].string;for(var u=0,t=this.history[this.history.length-1].queue.length;u<t;u++)this.queue[u]=this.history[this.history.length-1].queue[u];this.queue.length=this.history[this.history.length-1].queue.length;this.history=this.history[this.history.length-1].history}};this.finalize=function(){for(var p=
0,u=this.queue.length;p<u;p++)(r||ua)[p]=this.queue[p];(r||ua).length=this.queue.length;"string"!=typeof m&&(Aa=this.string)};this.saveState=function(p){this.savedStates[p]={queue:this.queue.slice(),string:this.string,history:this.history.slice()}};this.loadState=function(p){this.string=this.savedStates[p].string;this.history=this.savedStates[p].history;for(var u=0,t=this.savedStates[p].queue.length;u<t;u++)this.queue[u]=this.savedStates[p].queue[u];this.queue.length=this.savedStates[p].queue.length};
this.expand=xa}function e(){var m=B[B.length-1]||d;this.parentScope=m;this.defs={primitive:{},macros:{},active:{}};this.registers={count:{},dimen:{},skip:{},muskip:{},named:{}};this.cats={};this.mathcodes={};this.lc={};this.uc={};this.font={};for(var r in m.defs.primitive)this.defs.primitive[r]=m.defs.primitive[r];for(var xa in m.defs.macros)this.defs.macros[xa]=m.defs.macros[xa];for(var p in m.defs.active)this.defs.active[p]=m.defs.active[p];for(var u in m.lc)this.lc[u]=new q(m.lc[u]);for(var t in m.uc)this.uc[t]=
new q(m.uc[t]);for(var K in m.font)this.font[K]=m.font[K];for(var aa in m.cats)isNaN(aa)||(this.cats[aa]=new q(m.cats[aa]));for(var R in m.mathcodes)isNaN(R)||(this.mathcodes[R]=new q(m.mathcodes[R]));for(var O in m.registers.count)this.registers.count[O]=new q(m.registers.count[O]);for(var S in m.registers.dimen)this.registers.dimen[S]=new I(m.registers.dimen[S]);for(var P in m.registers.skip)this.registers.skip[P]=new Ia(m.registers.skip[P]);for(var Q in m.registers.muskip)this.registers.muskip[Q]=
new jb(m.registers.muskip[Q]);for(var V in m.registers.named)if(r=m.registers.named[V],xa="integer"==r.type?"count":"dimension"==r.type?"dimen":"glue"==r.type?"skip":"muskip",Object.values(m.registers[xa]).includes(r))for(var E in m.registers[xa])m.registers.named[V]===m.registers[xa][E]&&(this.registers.named[V]=this.registers[xa][E]);else this.registers.named[V]=new ("integer"==r.type?q:"dimension"==r.type?I:"glue"==r.type?Ia:jb)(r);this.tokens=[];this.split=!1;B.push(this)}function l(m){if(!m)return null;
m=m.codePointAt(0);return m in B[B.length-1].cats?B[B.length-1].cats[m].value:k.OTHER}function z(m){if(!m)return null;m=m.codePointAt(0);return m in B[B.length-1].mathcodes?B[B.length-1].mathcodes[m].value:L.ORD}function g(m){for(var r=function(u,t){if(m[u]&&m[u].ignore&&"command"==m[u].type){if(m[u].invalid){var K=(m[u].escapeChar+m[u].name).split("").map(function(S){return{type:"atom",atomType:m[u].recognized?L.ORD:L.VARIABLE,nucleus:{type:"symbol","char":S,code:S.codePointAt(0),invalid:!0},superscript:null,
subscript:null}});m.splice(u,1,{type:"atom",atomType:L.ORD,nucleus:K,superscript:null,subscript:null})}else m.splice(u,1);t=m.length;u--}else if(m[u]&&m[u].ignore&&!m[u].invalid)m.splice(u,1),t=m.length,u--;else if(m[u]&&"fraction"==m[u].type)g(m[u].numerator),g(m[u].denominator);else if(m[u]&&"table"==m[u].type){g(m[u].noAligns);K=0;for(var aa=m[u].cellData.length;K<aa;K++)for(var R=0,O=m[u].cellData[K].length;R<O;R++)g(m[u].cellData[K][R].content)}else m[u]&&"atom"==m[u].type?(Array.isArray(m[u].nucleus)&&
g(m[u].nucleus),Array.isArray(m[u].superscript)&&g(m[u].superscript),Array.isArray(m[u].subscript)&&g(m[u].subscript)):m[u]&&"mathchoice"==m[u].type?g(m[u].groups):m[u]&&"box"==m[u].type?g([m[u].content]):m[u]&&"family modifier"==m[u].type&&"rad"==m[u].value&&g(m[u].index);xa=u;p=t},xa=0,p=m.length;xa<p;xa++)r(xa,p)}function n(m){for(var r=0,xa=m.length;r<xa;r++)if(m[r]&&"family modifier"==m[r].type)if(m[r+1]&&"atom"==m[r+1].type)"phantom"==m[r].value?(m.splice(r,1),m[r].phantom=!0):(m.splice(r,2,
{type:"atom",atomType:m[r].value,nucleus:[m[r+1]],superscript:m[r+1].superscript,subscript:m[r+1].subscript,invalid:m[r+1].invalid,index:m[r].index,phantom:m[r+1].phantom}),m[r].nucleus[0].superscript=null,m[r].nucleus[0].subscript=null,r--),xa=m.length;else{var p=("command"==m[r].token.type?m[r].token.escapeChar+m[r].token.name:m[r].token["char"]).split("").map(function(aa){return{type:"atom",atomType:L.ORD,nucleus:{type:"symbol","char":aa,code:aa.codePointAt(0),invalid:!0},superscript:null,subscript:null}});
m[r]={type:"atom",atomType:L.ORD,nucleus:p,superscript:null,subscript:null}}else if(m[r]&&"fraction"==m[r].type)n(m[r].numerator),n(m[r].denominator);else if(m[r]&&"table"==m[r].type){n(m[r].noAligns);p=0;for(var u=m[r].cellData.length;p<u;p++)for(var t=0,K=m[r].cellData[p].length;t<K;t++)n(m[r].cellData[p][t].content)}else m[r]&&"atom"==m[r].type?(Array.isArray(m[r].nucleus)&&n(m[r].nucleus),Array.isArray(m[r].superscript)&&n(m[r].superscript),Array.isArray(m[r].subscript)&&n(m[r].subscript),Array.isArray(m[r].index)&&
n(m[r].index)):m[r]&&"mathchoice"==m[r].type?n(m[r].groups):m[r]&&"box"==m[r].type&&n([m[r].content])}function x(m){for(var r=0,xa=m.length;r<xa;r++)if(m[r]&&"accent modifier"==m[r].type)if(m[r+1]&&"atom"==m[r+1].type)m.splice(r,2,{type:"atom",atomType:L.ACC,nucleus:[m[r+1]],superscript:m[r+1].superscript,subscript:m[r+1].subscript,accChar:m[r]["char"],accCode:m[r].code,invalid:m[r+1].invalid,phantom:m[r+1].phantom}),m[r].nucleus[0].superscript=null,m[r].nucleus[0].subscript=null,xa=m.length,r--;
else{var p=("command"==m[r].token.type?m[r].token.escapeChar+m[r].token.name:m[r].token["char"]).split("").map(function(aa){return{type:"atom",atomType:L.ORD,nucleus:{type:"symbol","char":aa,code:aa.codePointAt(0),invalid:!0},superscript:null,subscript:null}});m[r]={type:"atom",atomType:L.ORD,nucleus:p,superscript:null,subscript:null}}else if(m[r]&&"fraction"==m[r].type)x(m[r].numerator),x(m[r].denominator);else if(m[r]&&"table"==m[r].type){x(m[r].noAligns);p=0;for(var u=m[r].cellData.length;p<u;p++)for(var t=
0,K=m[r].cellData[p].length;t<K;t++)x(m[r].cellData[p][t].content)}else m[r]&&"atom"==m[r].type?(Array.isArray(m[r].nucleus)&&x(m[r].nucleus),Array.isArray(m[r].superscript)&&x(m[r].superscript),Array.isArray(m[r].subscript)&&x(m[r].subscript),Array.isArray(m[r].index)&&x(m[r].index)):m[r]&&"mathchoice"==m[r].type?x(m[r].groups):m[r]&&"box"==m[r].type&&x([m[r].content])}function w(m){for(var r=0,xa=m.length;r<xa;r++)if(m[r]&&"limit modifier"==m[r].type)if(m[r-1]&&"atom"==m[r-1].type&&m[r-1].atomType==
L.OP)m[r-1].limits=m[r].value,m.splice(r,1),xa=m.length,r--;else{var p=("command"==m[r].token.type?m[r].token.escapeChar+m[r].token.name:m[r].token["char"]).split("").map(function(aa){return{type:"atom",atomType:L.ORD,nucleus:{type:"symbol","char":aa,code:aa.codePointAt(0),invalid:!0},superscript:null,subscript:null}});m[r]={type:"atom",atomType:L.ORD,nucleus:p,superscript:null,subscript:null}}else if(m[r]&&"fraction"==m[r].type)w(m[r].numerator),w(m[r].denominator);else if(m[r]&&"table"==m[r].type){w(m[r].noAligns);
p=0;for(var u=m[r].cellData.length;p<u;p++)for(var t=0,K=m[r].cellData[p].length;t<K;t++)w(m[r].cellData[p][t].content)}else m[r]&&"atom"==m[r].type?(m[r].atomType==L.OP&&(m[r].limits="display"),Array.isArray(m[r].nucleus)&&w(m[r].nucleus),Array.isArray(m[r].superscript)&&w(m[r].superscript),Array.isArray(m[r].subscript)&&w(m[r].subscript),Array.isArray(m[r].index)&&w(m[r].index)):m[r]&&"mathchoice"==m[r].type?w(m[r].groups):m[r]&&"box"==m[r].type&&w([m[r].content])}function v(m){for(var r=0,xa=m.length;r<
xa;r++)if(m[r]&&"box wrapper"==m[r].type)if(m[r+1]&&"atom"==m[r+1].type)m.splice(r,2,{type:"box",boxType:m[r].value,to:m[r].to,spread:m[r].spread,content:m[r+1],superscript:null,subscript:null}),xa=m.length,r--;else{var p=("command"==m[r].token.type?m[r].token.escapeChar+m[r].token.name:m[r].token["char"]).split("").map(function(aa){return{type:"atom",atomType:L.ORD,nucleus:{type:"symbol","char":aa,code:aa.codePointAt(0),invalid:!0},superscript:null,subscript:null}});m[r]={type:"atom",atomType:L.ORD,
nucleus:p,superscript:null,subscript:null}}else if(m[r]&&"fraction"==m[r].type)v(m[r].numerator),v(m[r].denominator);else if(m[r]&&"table"==m[r].type){v(m[r].noAligns);p=0;for(var u=m[r].cellData.length;p<u;p++)for(var t=0,K=m[r].cellData[p].length;t<K;t++)v(m[r].cellData[p][t].content)}else m[r]&&"atom"==m[r].type?(Array.isArray(m[r].nucleus)&&v(m[r].nucleus),Array.isArray(m[r].superscript)&&v(m[r].superscript),Array.isArray(m[r].subscript)&&v(m[r].subscript),Array.isArray(m[r].index)&&v(m[r].index)):
m[r]&&"mathchoice"==m[r].type?v(m[r].groups):m[r]&&"box"==m[r].type&&v([m[r].content])}function W(m){for(var r=0,xa=m.length;r<xa;r++)if(m[r]&&"atom"==m[r].type){if(Array.isArray(m[r].nucleus)&&W(m[r].nucleus),Array.isArray(m[r].superscript)&&W(m[r].superscript),Array.isArray(m[r].subscript)&&W(m[r].subscript),Array.isArray(m[r].index)&&W(m[r].index),Array.isArray(m[r].nucleus)&&1==m[r].nucleus.length&&!m[r].nucleus[0].delimited)[L.ORD,L.BIN,L.REL,L.OPEN,L.CLOSE,L.PUNCT,L.INNER].includes(m[r].nucleus[0].atomType)&&
![L.OVER,L.UNDER,L.RAD].includes(m[r].atomType)?m[r].nucleus[0].superscript||m[r].nucleus[0].subscript?m[r].superscript||m[r].subscript||(m[r].phantom=m[r].phantom||m[r].nucleus[0].phantom,m[r].superscript=m[r].nucleus[0].superscript,m[r].subscript=m[r].nucleus[0].subscript,m[r].nucleus=m[r].nucleus[0].nucleus,r--):(m[r].phantom=m[r].phantom||m[r].nucleus[0].phantom,m[r].nucleus=m[r].nucleus[0].nucleus,r--):m[r].nucleus[0].atomType==L.VARIABLE&&m[r].atomType==L.ORD?m[r].nucleus[0].superscript||m[r].nucleus[0].subscript?
m[r].superscript||m[r].subscript||(m[r].phantom=m[r].phantom||m[r].nucleus[0].phantom,m[r].superscript=m[r].nucleus[0].superscript,m[r].subscript=m[r].nucleus[0].subscript,m[r].nucleus=m[r].nucleus[0].nucleus,m[r].atomType=L.VARIABLE,r--):(m[r].phantom=m[r].phantom||m[r].nucleus[0].phantom,m[r].nucleus=m[r].nucleus[0].nucleus,m[r].atomType=L.VARIABLE,r--):m[r].nucleus[0].atomType==L.VARIABLE||![L.OVER,L.UNDER,L.RAD,L.ACC].includes(m[r].atomType)||m[r].nucleus[0].superscript||m[r].nucleus[0].subscript||
(m[r].phantom=m[r].phantom||m[r].nucleus[0].phantom,m[r].nucleus=m[r].nucleus[0].nucleus)}else if(m[r]&&"fraction"==m[r].type)m[r].numerator&&Array.isArray(m[r].numerator)&&1==m[r].numerator.length&&!m[r].numerator.subscript&&!m[r].numerator.superscript&&Array.isArray(m[r].numerator[0].nucleus)&&(m[r].numerator=m[r].numerator[0].nucleus),m[r].denominator&&Array.isArray(m[r].denominator)&&1==m[r].denominator.length&&!m[r].denominator.subscript&&!m[r].denominator.superscript&&Array.isArray(m[r].denominator[0].nucleus)&&
(m[r].denominator=m[r].denominator[0].nucleus),W(m[r].numerator),W(m[r].denominator);else if(m[r]&&"table"==m[r].type){W(m[r].noAligns);for(var p=0,u=m[r].cellData.length;p<u;p++)for(var t=0,K=m[r].cellData[p].length;t<K;t++)W(m[r].cellData[p][t].content)}else m[r]&&"mathchoice"==m[r].type?W(m[r].groups):m[r]&&"box"==m[r].type&&W(m[r].content.nucleus)}var ua=[],Aa=a,B=[];B.last=function(){return B[B.length-1]};var da={global:!1},fa=[];Object.defineProperty(fa,"last",{get:function(){return this[this.length-
1]}});var X=new f;new e;for(var ka=[];;){var G=X.eat();if(null===G)if("standalone"==c)break;else return[[],a,!1];var na=fa[fa.length-1]||{},D=B[B.length-1];if("command"==G.type||"character"==G.type&&G.cat==k.ACTIVE)"mathchoice"==na.type&&na.failed(),G=X.expand(G,X),X.queue.unshift.apply(X.queue,G);else{if("character"==G.type&&G.cat==k.PARAMETER)"mathchoice"==na.type&&na.failed(),X.queue.unshift({type:"character",cat:k.OTHER,"char":G["char"],code:G.code,invalid:!0});else if("character"==G.type&&G.cat==
k.MATHSHIFT)if("mathchoice"==na.type&&na.failed(),"display"==c){D=new f(X.string,X.queue);for(var T=!1;;){var y=D.eat();if(!y)break;if("command"==y.type||"character"==y.type&&y.cat==k.ACTIVE)y=D.expand(y,D),D.queue.unshift.apply(D.queue,y);else{"character"==y.type&&y.cat==k.MATHSHIFT&&(T=!0,D.finalize(),X.string=D.string);break}}if(T)break;else X.queue.unshift({type:"character",cat:k.OTHER,"char":G["char"],code:G.code,invalid:!0})}else if("inline"==c)break;else X.queue.unshift({type:"character",cat:k.OTHER,
"char":G["char"],code:G.code,invalid:!0});else if("character"==G.type&&G.cat==k.SUPERSCRIPT){"mathchoice"==na.type&&na.failed();T=null;for(y=D.tokens.length-1;0<=y;y--)if("atom"==D.tokens[y].type&&!D.tokens[y].ignore){T=D.tokens[y];break}T||(T={type:"atom",atomType:L.ORD,nucleus:null,superscript:null,subscript:null},D.tokens.push(T));T.superscript?D.tokens.push({type:"atom",atomType:L.ORD,nucleus:{type:"symbol","char":G["char"],code:G.code,invalid:!0},superscript:null,subscript:null}):"superscript"==
na.type||"subscript"==na.type?(T[na]=[{type:"atom",atomType:L.ORD,nucleus:{type:"symbol","char":G["char"],code:G.code,invalid:!0},superscript:null,subscript:null}],fa.pop()):(G={type:"atom",atomType:L.ORD,nucleus:{type:"symbol","char":G["char"],code:G.code},superscript:null,subscript:null,ignore:!0},D.tokens.push(G),fa.push({toString:function(){return"superscript"},type:"superscript",token:G}))}else if("character"==G.type&&G.cat==k.SUBSCRIPT){"mathchoice"==na.type&&na.failed();T=null;for(y=D.tokens.length-
1;0<=y;y--)if("atom"==D.tokens[y].type&&!D.tokens[y].ignore){T=B.last().tokens[y];break}T||(T={type:"atom",atomType:L.ORD,nucleus:null,superscript:null,subscript:null},D.tokens.push(T));T.subscript?D.tokens.push({type:"atom",atomType:L.ORD,nucleus:{type:"symbol","char":G["char"],code:G.code,invalid:!0},superscript:null,subscript:null}):"superscript"==na.type||"subscript"==na.type?(T[na]=[{type:"atom",atomType:L.ORD,nucleus:{type:"symbol","char":G["char"],code:G.code,invalid:!0},superscript:null,subscript:null}],
fa.pop()):(G={type:"atom",atomType:L.ORD,nucleus:{type:"symbol","char":G["char"],code:G.code},superscript:null,subscript:null,ignore:!0},D.tokens.push(G),fa.push({toString:function(){return"subscript"},type:"subscript",token:G}))}else if("character"==G.type&&G.cat==k.OPEN)G={type:"atom",atomType:L.ORD,nucleus:{type:"symbol","char":G["char"],code:G.code},superscript:null,subscript:null,ignore:!0},ka.push(G),fa.push({toString:function(){return"scope"},type:"scope"}),new e,B[B.length-1].tokens.push(G);
else if("character"==G.type&&G.cat==k.CLOSE)if(1==B.length||!ka.length||D.delimited||D.semisimple||D.isHalign||D.isHalignCell||"scope"!=na)X.queue.unshift({type:"character",cat:k.OTHER,"char":G["char"],code:G.code,invalid:!0});else if(ka.pop(),fa.pop(),na=fa[fa.length-1]||{},G=void 0,G=D.isFrac?[{type:"atom",atomType:L.INNER,nucleus:[{type:"fraction",numerator:D.fracNumerator,denominator:D.tokens,barWidth:D.barWidth,delims:[D.fracLeftDelim,D.fracRightDelim],nullDelimiterSpace:new I(D.registers.named.nulldelimiterspace)}],
superscript:null,subscript:null}]:D.tokens,D.root&&(D.root.invalid=!0),B[B.length-2]&&B[B.length-2].noAligned)B[B.length-3].noAligns.push({type:"atom",atomType:L.ORD,nucleus:G,superscript:null,subscript:null}),B.pop();else if("superscript"==na.type){B.pop();D=B[B.length-1];for(T=D.tokens.length-1;0<=T;T--)if("atom"==D.tokens[T].type&&!D.tokens[T].ignore){D.tokens[T].superscript=G;break}fa.pop()}else if("subscript"==na.type){B.pop();D=B[B.length-1];for(T=D.tokens.length-1;0<=T;T--)if("atom"==D.tokens[T].type&&
!D.tokens[T].ignore){D.tokens[T].subscript=G;break}fa.pop()}else D.isFrac?(B.pop(),B[B.length-1].tokens.push(G[0])):(B.pop(),B[B.length-1].tokens.push({type:"atom",atomType:L.ORD,nucleus:G,superscript:null,subscript:null})),"mathchoice"==na.type&&4==++na.current&&na.succeeded();else if("character"==G.type&&G.cat==k.ALIGN){"mathchoice"==na.type&&na.failed();T=!1;for(y=B.length-1;0<=y;y--)if(B[y].isHalignCell){T=B[y];break}if(!T){X.queue.unshift({type:"character",cat:k.OTHER,"char":G["char"],code:G.code,
invalid:!0});continue}T=T.parentScope;y=T.cellData[T.cellData.length-1];y[y.length-1].omit&&(G.postPreamble=!0);if(G.postPreamble&&!D.isHalignCell||"scope"!=na){X.queue.unshift({type:"character",cat:k.OTHER,"char":G["char"],code:G.code,invalid:!0});continue}if(!G.postPreamble){D=-1;na=0;for(var za=y.length;na<za;na++)D+=y[na].span;y=void 0;if(T.preamble[D])y=T.preamble[D][1];else if(~T.repeatPreambleAt)y=T.preamble.slice(T.repeatPreambleAt,T.preamble.length),y=y[(D-T.repeatPreambleAt)%y.length][1];
else{X.queue.unshift({type:"character",cat:k.OTHER,"char":G["char"],code:G.code,invalid:!0});continue}if(!T.preamble[++D]&&!~T.repeatPreambleAt){X.queue.unshift({type:"character",cat:k.OTHER,"char":G["char"],code:G.code,invalid:!0});continue}D=[];T=0;for(na=y.length;T<na;T++){za={};for(var fb in y[T])za[fb]=y[T][fb];D.push(za)}X.queue.unshift.apply(X.queue,D.concat(G));G.postPreamble=!0;continue}D.root&&(D.root.invalid=!0);fa.pop();na=fa[fa.length-1]||{};G=D.tokens;D.isFrac?(y[y.length-1].content.push({type:"atom",
atomType:"inner",nucleus:[{type:"fraction",numerator:D.fracNumerator,denominator:G,barWidth:D.barWidth,delims:[D.fracLeftDelim,D.fracRightDelim],nullDelimiterSpace:new I(D.registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),B.pop()):(B.pop(),y[y.length-1].content=y[y.length-1].content.concat(G));D=B[B.length-1];na=Symbol();X.saveState(na);for(y.push({type:"cell",content:[],omit:!1,span:1});;)if(za=X.eat(),!za){X.loadState(na);break}else if("character"==za.type&&za.cat!=k.ACTIVE){X.loadState(na);
break}else if("command"==za.type||"character"==za.type&&za.cat==k.ACTIVE){if(za.name in D.registers.named){X.loadState(na);break}var h="command"==za.type?D.defs.primitive[za.name]||D.defs.macros[za.name]:D.defs.active[za["char"]];if(!h){X.loadState(na);break}h.proxy&&(h=h.original);if(td.includes(h)){h=X.expand(za,X);if(1==h.length&&h[0]===za&&za.invalid){X.loadState(na);break}X.queue.unshift.apply(X.queue,h)}else{if(h===d.defs.primitive.omit){y[y.length-1].omit=!0;break}if("primitive"==h.type){X.loadState(na);
break}h=X.expand(za,X);if(1==h.length&&h[0]==-za&&za.invalid){X.loadState(na);break}X.queue.unshift.apply(X.queue,h)}}fa.push({toString:function(){return"scope"},type:"scope"});new e;B[B.length-1].isHalignCell=!0;if(!y[y.length-1].omit){D=-1;na=0;for(za=y.length;na<za;na++)D+=y[na].span;T.preamble[D]?G=T.preamble[D][0]:~T.repeatPreambleAt&&(G=T.preamble.slice(T.repeatPreambleAt,T.preamble.length),G=G[(D-T.repeatPreambleAt)%G.length][0]);D=[];T=0;for(y=G.length;T<y;T++){na={};for(var Wa in G[T])na[Wa]=
G[T][Wa];D.push(na)}X.queue.unshift.apply(X.queue,D)}}else if("character"==G.type){"mathchoice"==na.type&&na.failed();T={type:"symbol","char":G["char"],code:G.code,invalid:G.invalid};y=G.forcedMathCode+1?G.forcedMathCode:z(T["char"]);G.invalid&&G.recognized&&(y=0);if(y==k.ACTIVE)if(D.defs.active[G["char"]]){X.queue.unshift.apply(X.queue,(D.defs.active[G["char"]].replacement||D.defs.active[G["char"]].original.replacement).slice());continue}else G.invalid=T.invalid=!0,y=0;if("superscript"==na.type){for(G=
D.tokens.length-1;0<=G;G--)if("atom"==D.tokens[G].type&&!D.tokens[G].ignore){D.tokens[G].superscript=[{type:"atom",atomType:y,nucleus:T,superscript:null,subscript:null}];break}fa.pop()}else if("subscript"==na.type){for(G=D.tokens.length-1;0<=G;G--)if("atom"==D.tokens[G].type&&!D.tokens[G].ignore){D.tokens[G].subscript=[{type:"atom",atomType:y,nucleus:T,superscript:null,subscript:null}];break}fa.pop()}else D.tokens.push({type:"atom",atomType:y,nucleus:T,superscript:null,subscript:null})}else if(G.register)if("mathchoice"==
na.type&&na.failed(),T=Symbol(),X.saveState(T),y=X.eat(),!y||"character"==y.type&&"="==y["char"]&&y.cat==k.OTHER||X.revert(),"integer"==G.type)if(y=X.eat("integer")){if(y.value<G.min||G.max<y.value){X.loadState(T);continue}T=G;if(da.global&&0<=D.registers.named.globaldefs.value||0<D.registers.named.globaldefs.value)for(;G.parent;)G=G.parent,G.value=y.value;T.value=y.value;da.global=!1}else X.loadState(T);else if("dimension"==G.type)if(y=X.eat("dimension")){G.sp.value=y.sp.value;G.em.value=y.em.value;
if(da.global&&0<=D.registers.named.globaldefs.value||0<D.registers.named.globaldefs.value)for(;G.parent;)G=G.parent,G.sp.value=y.sp.value,G.em.value=y.em.value;da.global=!1}else X.loadState(T);else if("mu dimension"==G.type)if(y=X.eat("mu dimension")){G.mu.value=y.mu.value;if(da.global&&0<=D.registers.named.globaldefs.value||0<D.registers.named.globaldefs.value)for(;G.parent;)G=G.parent,G.mu.value=integer.mu.value;da.global=!1}else X.loadState(T);else if("glue"==G.type)if(y=X.eat("glue")){G.start.sp.value=
y.start.sp.value;G.start.em.value=y.start.em.value;G.stretch="infinite dimension"==y.stretch.type?new oa(y.stretch.number.value,y.stretch.magnitude.value):new I(y.stretch.sp.value,y.stretch.em.value);G.shrink="infinite dimension"==y.shrink.type?new oa(y.shrink.number.value,y.shrink.magnitude.value):new I(y.shrink.sp.value,y.shrink.em.value);if(da.global&&0<=D.registers.named.globaldefs.value||0<D.registers.named.globaldefs.value)for(;G.parent;)G=G.parent,G.start.sp.value=y.start.sp.value,G.start.em.value=
y.start.em.value,G.stretch="infinite dimension"==y.stretch.type?new oa(y.stretch.number.value,y.stretch.magnitude.value):new I(y.stretch.sp.value,y.stretch.em.value),G.shrink="infinite dimension"==y.shrink.type?new oa(y.shrink.number.value,y.shrink.magnitude.value):new I(y.shrink.sp.value,y.shrink.em.value);da.global=!1}else X.loadState(T);else{if("mu glue"==G.type)if(y=X.eat("mu glue")){G.start.mu.value=y.start.mu.value;G.stretch="infinite dimension"==y.stretch.type?new oa(y.stretch.number.value,
y.stretch.magnitude.value):new Ba(y.stretch.mu.value);G.shrink="infinite dimension"==y.shrink.type?new oa(y.shrink.number.value,y.shrink.magnitude.value):new Ba(y.shrink.mu.value);if(da.global&&0<=D.registers.named.globaldefs.value||0<D.registers.named.globaldefs.value)for(;G.parent;)G=G.parent,G.start.mu.value=y.start.mu.value,G.stretch="infinite dimension"==y.stretch.type?new oa(y.stretch.number.value,y.stretch.magnitude.value):new Ba(y.stretch.mu.value),G.shrink="infinite dimension"==y.shrink.type?
new oa(y.shrink.number.value,y.shrink.magnitude.value):new Ba(y.shrink.mu.value);da.global=!1}else X.loadState(T)}else if("ignored command"==G.type){D.tokens.push(G.token);continue}for(var Pb in da)da[Pb]&&(da[Pb].invalid=!0,da[Pb]=!1)}}a=fa[fa.length-1]||{};if("superscript"==a||"subscript"==a)a.token.invalid=!0,a.token.ignore=!1;for(;1<B.length;)if(fa.pop(),Wa=fa[fa.length-1]||{},a=B[B.length-1],fb=a.tokens,a.root&&(a.root.invalid=!0),"superscript"==Wa.type){B.pop();a=B[B.length-1];for(Wa=a.tokens.length-
1;0<=Wa;Wa--)if("atom"==a.tokens[Wa].type&&!a.tokens[Wa].ignore){a.tokens[Wa].superscript=fb;break}fa.pop();Wa=fa[fa.length-1]||{}}else if("subscript"==Wa.type){B.pop();a=B[B.length-1];for(Wa=a.tokens.length-1;0<=Wa;Wa--)if("atom"==a.tokens[Wa].type&&!a.tokens[Wa].ignore){a.tokens[Wa].subscript=fb;break}fa.pop();Wa=fa[fa.length-1]||{}}else a.isFrac?(B[B.length-2].tokens.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:a.fracNumerator,denominator:fb,barWidth:a.barWidth,delims:[a.fracLeftDelim,
a.fracRightDelim],nullDelimiterSpace:new I(a.registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),B.pop(),a=B[B.length-1]):(B.pop(),a=B[B.length-1],a.tokens.push({type:"atom",atomType:L.ORD,nucleus:fb,superscript:null,subscript:null}));B[0].isFrac&&(B[0].tokens=[{type:"atom",atomType:L.INNER,nucleus:[{type:"fraction",numerator:B[0].fracNumerator,denominator:B[0].tokens,barWidth:B[0].barWidth,delims:[B[0].fracLeftDelim,B[0].fracRightDelim],nullDelimiterSpace:new I(B[0].registers.named.nulldelimiterspace)}],
superscript:null,subscript:null}]);a=0;for(fb=ka.length;a<fb;a++)ka[a].invalid=!0;g(B[0].tokens);n(B[0].tokens);x(B[0].tokens);w(B[0].tokens);v(B[0].tokens);W(B[0].tokens);X.finalize();return b&&b?B[0]:[B[0].tokens,Aa,!0]}function Na(a,c,b,f){function e(x){for(var w=0,v=x.children.length;w<v;w++)e(x.children[w]);x.style.flexWrap&&(x.style.flexWrap="nowrap");return x}function l(x,w,v,W,ua){x=x.slice();if(x.length){var Aa=null,B=document.createElement("div");B.style.display="inline-flex";B.style.flexWrap=
"wrap";B.style.alignItems="baseline";B.displayedStyle=w;B.crampedStyle=v;B.style.justifyContent="display"==b?"center":"initial";var da=[document.createElement("div")];da[0].style.display="inline-flex";da[0].style.flexWrap="nowrap";da[0].style.alignItems="baseline";for(var fa=[],X=[],ka=0,G=function(fb){var h=x[fb],Wa=x[fb+1]||{};if(["glue","kern","vglue","vkern"].includes(h.type)){h.italicCorrection&&(h.italicCorrection=Aa||"");if("glue"==h.type&&h.isNonScript&&("script"==w||"scriptscript"==w)&&["glue",
"vglue","kern","vkern"].includes(Wa.type))return x.splice(fb+1,1),"continue";"glue"==h.type&&"mu glue"==h.glue.type?h.glue=new Ia(new I(0,h.glue.start.mu.value/18),"infinite dimension"==h.glue.stretch.type?h.glue.stretch:new I(0,Math.floor(h.glue.stretch.mu.value/18)),"infinite dimension"==h.glue.shrink.type?h.glue.shrink:new I(0,~~(h.glue.shrink.mu.value/18))):"kern"==h.type&&"mu dimension"==h.dimen.type?h.dimen=new I(0,Math.floor(h.dimen.mu.value/18)):"vglue"==h.type&&(h.type="vkern",h.dimen=h.glue.start,
delete h.glue);fa.push(h);return"continue"}if("font modifier"==h.type)return["displaystyle","textstyle","scriptstyle","scriptscriptstyle"].includes(h.value)?w=h.value.substring(0,h.value.length-5):W=h.value,"continue";if("mathchoice"==h.type){var Pb=h.groups[["display","text","script","scriptscript"].indexOf(w)];x.splice.apply(x,[fb+1,0].concat("symbol"==Pb.nucleus.type?[Pb]:Pb.nucleus));return"continue"}"atom"!=h.type||h.atomType!=L.BIN||X.length&&![L.OP,L.BIN,L.REL,L.OPEN,L.PUNCT].includes(X[X.length-
1].atomType)||(h.atomType=L.ORD);"atom"!=h.type||!X.length||h.atomType!=L.REL&&h.atomType!=L.CLOSE&&h.atomType!=L.PUNCT||X[X.length-1].atomType!=L.BIN||(X[X.length-1].atomType=L.ORD);"atom"==h.type&&h.atomType==L.OP&&"display"==h.limits&&(h.limits="display"==w);if("fraction"==h.type){var m=function(C,F,tb,J){var ta;switch(F){default:fa.splice(fa.length-(tb?1:0),0,{type:"kern",dimen:h.nullDelimiterSpace});break;case "|":case "/":case "\\":case "\u2016":case "\u23aa":case "\u23d0":case "\u27e8":case "\u27e9":var N=
Math.max(zc,A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n));C.style.height="".concat(N,"em");C.style.width="".concat(A.fontDimen.widthOf(F,n),"em");C.style.verticalAlign="middle";C.height=J;C.width=A.fontDimen.widthOf(F,n)/(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n))*J;N=C.getContext("2d");N.textAlign="center";N.fillStyle=f.color;N.font="".concat(J/(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n)),"px ").concat(n);N.fillText(F,C.width/2,J-A.fontDimen.depthOf(F,n)*J/(A.fontDimen.heightOf(F,
n)+A.fontDimen.depthOf(F,n)));h.div.insertBefore(C,tb?h.div.firstElementChild:null);break;case "(":case ")":N=Math.max(zc,A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n));C.style.height="".concat(N,"em");C.style.width="".concat(A.fontDimen.widthOf(F,n),"em");C.style.verticalAlign="middle";if(0>=Math.floor(Math.floor(J/2*N)-J))C.height=J,C.width=A.fontDimen.widthOf(F,n)/(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n))*J,N=C.getContext("2d"),N.textAlign="center",N.fillStyle=f.color,N.font="".concat(J/
(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n)),"px ").concat(n),N.fillText(F,C.width/2,J-A.fontDimen.depthOf(F,n)*J/(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n)));else{var Z=A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n);C.height=Math.max(N,1)*J;C.width=A.fontDimen.widthOf(F,n)/A.fontDimen.heightOf(F,n)*J*(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n));N=C.getContext("2d");N.textAlign="center";N.fillStyle=f.color;N.font="".concat(J/Z,"px ").concat(n);N.fillText(F,C.width/2,J/
2-A.fontDimen.depthOf(F,n)*J*Z);var Y=N.getImageData(0,0,C.width,J/2);N.clearRect(0,0,C.width,C.height);N.fillText(F,C.width/2,J-A.fontDimen.depthOf(F,n)*J/Z);N.clearRect(0,J/2,C.width,C.height);N.putImageData(Y,0,C.height-J/2);if(C.height>J){var ca=N.createImageData(C.width,C.height-J);F=N.getImageData(0,J/2-1,C.width,1).data;Z=Y.data.slice(0,4*C.width);Y=0;for(ta=ca.height/2;Y<ta;Y++)for(var pa=0,qa=C.width;pa<qa;pa++){var wa=Y*C.width*4+4*pa;ca.data[wa+0]=F[4*pa];ca.data[wa+1]=F[4*pa+1];ca.data[wa+
2]=F[4*pa+2];ca.data[wa+3]=F[4*pa+3];wa=~~(Y+ca.height/2)*C.width*4+4*pa;ca.data[wa+0]=Z[4*pa];ca.data[wa+1]=Z[4*pa+1];ca.data[wa+2]=Z[4*pa+2];ca.data[wa+3]=Z[4*pa+3]}N.putImageData(ca,0,J/2)}}h.div.insertBefore(C,tb?h.div.firstElementChild:null);break;case "[":case "]":case "\u27ee":case "\u27ef":case "\u2191":case "\u2193":case "\u2195":case "\u21d1":case "\u21d3":case "\u21d5":case "\u2308":case "\u2309":case "\u230a":case "\u230b":case "\u23b0":case "\u23b1":xa=A.fontDimen.heightOf("x",n)/2;N=
Math.max(zc,A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n));C.style.height="".concat(N,"em");C.style.width="".concat(A.fontDimen.widthOf(F,n),"em");C.style.verticalAlign="middle";Z=A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n);C.height=Math.max(N,1)*J;C.width=A.fontDimen.widthOf(F,n)/A.fontDimen.heightOf(F,n)*J*(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n));N=C.getContext("2d");N.textAlign="center";N.fillStyle=f.color;N.font="".concat(J/Z,"px ").concat(n);N.fillText(F,C.width/2,J/2-
A.fontDimen.depthOf(F,n)*J*Z);Y=N.getImageData(0,0,C.width,J/2);N.clearRect(0,0,C.width,C.height);N.fillText(F,C.width/2,J-A.fontDimen.depthOf(F,n)*J/Z);N.clearRect(0,J/2,C.width,C.height);N.putImageData(Y,0,C.height-J/2);if(C.height>J){ca=N.createImageData(C.width,C.height-J);F=N.getImageData(0,J/2-1,C.width,1).data;Z=Y.data.slice(0,4*C.width);Y=0;for(ta=ca.height/2;Y<ta;Y++)for(pa=0,qa=C.width;pa<qa;pa++)wa=Y*C.width*4+4*pa,ca.data[wa+0]=F[4*pa],ca.data[wa+1]=F[4*pa+1],ca.data[wa+2]=F[4*pa+2],ca.data[wa+
3]=F[4*pa+3],wa=~~(Y+ca.height/2)*C.width*4+4*pa,ca.data[wa+0]=Z[4*pa],ca.data[wa+1]=Z[4*pa+1],ca.data[wa+2]=Z[4*pa+2],ca.data[wa+3]=Z[4*pa+3];N.putImageData(ca,0,J/2)}h.div.insertBefore(C,tb?h.div.firstElementChild:null);break;case "{":case "}":N=Math.max(zc,A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n));C.style.height="".concat(N,"em");C.style.width="".concat(A.fontDimen.widthOf(F,n),"em");C.style.verticalAlign="middle";Z=J/(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n));C.height=Math.max(N,
1)*J;C.width=A.fontDimen.widthOf(F,n)/A.fontDimen.heightOf(F,n)*J*(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n));N=C.getContext("2d");N.textAlign="center";N.fillStyle=f.color;N.font="".concat(Z,"px ").concat(n);if(3<=J&&(N.fillText(F,C.width/2,Math.floor(J/3)-A.fontDimen.depthOf(F,n)*Z),Y=N.getImageData(0,0,C.width,Math.floor(J/3)),N.clearRect(0,0,C.width,C.height),N.fillText(F,C.width/2,J-A.fontDimen.depthOf(F,n)*Z),ta=N.getImageData(0,0,C.width,Math.floor(J/3)),N.clearRect(0,0,C.width,C.height),
N.fillText(F,C.width/2,C.height/2+J/2-A.fontDimen.depthOf(F,n)*Z),N.clearRect(0,0,C.width,Math.floor(C.height/2)-Math.floor(J/2)+Math.floor(J/3)),N.clearRect(0,Math.ceil(C.height/2)+Math.floor(J/2)-Math.floor(J/3),C.width,C.height),N.putImageData(ta,0,0),N.putImageData(Y,0,C.height-Math.floor(J/3)),C.height>J)){ca=N.createImageData(C.width,Math.ceil((C.height-J)/2));F=ta.data.slice((Math.floor(J/3)-1)*C.width*4,Math.floor(J/3)*C.width*4);Z=N.getImageData(0,Math.floor(C.height/2)-Math.floor(J/2)+Math.floor(J/
3),C.width,1).data;ta=0;for(pa=ca.height/2;ta<pa;ta++)for(qa=0,wa=C.width;qa<wa;qa++){var Fa=ta*C.width*4+4*qa;ca.data[Fa+0]=F[4*qa];ca.data[Fa+1]=F[4*qa+1];ca.data[Fa+2]=F[4*qa+2];ca.data[Fa+3]=F[4*qa+3];Fa=~~(ta+ca.height/2)*C.width*4+4*qa;ca.data[Fa+0]=Z[4*qa];ca.data[Fa+1]=Z[4*qa+1];ca.data[Fa+2]=Z[4*qa+2];ca.data[Fa+3]=Z[4*qa+3]}ta=N.createImageData(C.width,Math.floor(C.height/2)-Math.floor(J/2)+1);F=N.getImageData(0,Math.ceil(C.height/2)+Math.floor(J/2)-Math.floor(J/3)-1,C.width,1).data;Z=Y.data.slice(0,
4*C.width);Y=0;for(pa=ta.height/2;Y<pa;Y++)for(qa=0,wa=C.width;qa<wa;qa++)Fa=Y*C.width*4+4*qa,ta.data[Fa+0]=F[4*qa],ta.data[Fa+1]=F[4*qa+1],ta.data[Fa+2]=F[4*qa+2],ta.data[Fa+3]=F[4*qa+3],Fa=~~(Y+ta.height/2)*C.width*4+4*qa,ta.data[Fa+0]=Z[4*qa],ta.data[Fa+1]=Z[4*qa+1],ta.data[Fa+2]=Z[4*qa+2],ta.data[Fa+3]=Z[4*qa+3];N.putImageData(ca,0,Math.floor(J/3));N.putImageData(ta,0,C.height/2+Math.floor(J/2)-Math.floor(J/3))}h.div.insertBefore(C,tb?h.div.firstElementChild:null)}},r={type:"atom",atomType:L.INNER,
nucleus:null,superscript:null,subscript:null,style:w,div:document.createElement("div")};fa.push(r);X.push(r);h.style=w;h.div=r.div;h.div.style.display="inline-block";h.div.style.whiteSpace="nowrap";var xa=A.fontDimen.heightOf("x",n)/2+A.fontDimen.baselineHeightOf(n),p=document.createElement("div"),u=document.createElement("div");p.style.display=u.style.display="inline-block";p.style.verticalAlign="text-bottom";p.style.position="relative";u.style.verticalAlign="text-bottom";u.style.position="relative";
var t="display"==w?"text":"text"==w?"script":"scriptscript";l(h.numerator,t,v,W,p);l(h.denominator,t,!0,W,u);p.firstElementChild.style.justifyContent="center";u.firstElementChild.style.justifyContent="center";var K="from font"==h.barWidth?new I(0,65536*A.fontDimen.visibleWidthOf("|",n)):new I(h.barWidth);K.em.value+=K.sp.value/12*16/g;K.sp.value=0;var aa="text"==w||"script"==w,R=aa?ia:1,O="".concat(K.em.value/65536,"em"),S="".concat(K.em.value*R/65536,"em"),P=K.em.value*("script"==w||"scriptscript"==
w?ia:1)/65536;a.appendChild(u);a.appendChild(p);var Q=p.offsetWidth+1,V=p.offsetHeight/g,E=Q*R,M=u.offsetHeight/g,Ha=u.offsetWidth+1,Sa=M*R,Ib=Ha*R;a.removeChild(u);a.removeChild(p);aa?(p.style.fontSize=u.style.fontSize=Qb,p.style.paddingTop="calc(".concat(xa/ia,"em + ").concat(O," / 2)"),p.style.top="calc(".concat(-xa/ia,"em - ").concat(O," / 2)"),u.style.top="calc(".concat(M-xa/ia,"em + ").concat(O," / 2 - ").concat(M,"em)"),h.div.style.paddingBottom="calc(".concat(Sa-xa,"em + ").concat(S," / 2)")):
(p.style.fontSize=u.style.fontSize="",p.style.paddingTop="calc(".concat(xa,"em + ").concat(S," / 2)"),p.style.top="calc(".concat(-xa,"em - ").concat(S," / 2)"),u.style.top="calc(".concat(M-xa,"em + ").concat(S," / 2 - ").concat(M,"em)"),h.div.style.paddingBottom="calc(".concat(M-xa,"em + ").concat(S," / 2)"));u.style.height=0;var Ac=Q>Ha?u:p,ud=Q>Ha?p:u,pb=document.createElement("div"),Jb=document.createElement("div"),Bc=document.createElement("div");pb.style.display="inline-block";pb.style.position=
"relative";pb.style.verticalAlign="text-bottom";pb.style.top="".concat(-xa,"em");pb.style.width=".05em";pb.style.height=0;Jb.style.borderTop="".concat(S," solid currentColor");Jb.style.padding="0 .05em";Jb.style.position="relative";Jb.style.top="calc(".concat(S," / -2)");Jb.style.display="inline-block";Jb.style.height=0;Bc.style.display="inline-block";Bc.style.visibility="hidden";pb.style.webkitUserSelect=pb.style.mozUserSelect=pb.style.msUserSelect=pb.style.userSelect="none";Bc.style.width="".concat(Math.max(E,
Ib)/g,"em");Jb.appendChild(Bc);pb.appendChild(Jb);h.div.appendChild(pb);var sc=document.createElement("div"),fc=document.createElement("div"),tc=document.createElement("div"),Kc=Ac.firstElementChild;Kc&&(Kc.style.width="100%",fc.appendChild(Kc));sc.style.position="relative";sc.style.display="inline-block";tc.style.display="inline-block";tc.style.height="".concat(Q>Ha?M:V,"em");tc.textContent="\u00a0";tc.style.width="".concat((Math.max(Q,Ha)+1)/g,"em");fc.style.position="absolute";Ac.style.width=0;
fc.style.left="".concat(-1/g,"em");fc.style.right="".concat(1/g,"em");fc.style.top=0;sc.appendChild(fc);sc.appendChild(tc);Ac.appendChild(sc);h.div.appendChild(Ac);h.div.appendChild(ud);var Lc=document.createElement("div");Lc.style.display="inline-block";Lc.style.width=".05em";h.div.appendChild(Lc);var $c=document.createElement("canvas"),ad=document.createElement("canvas"),zc="display"==w?2.416666666:"text"==w?1.416666666:0;$c.style.display=ad.style.display="inline-block";">"==h.delims[0]&&(h.delims[0]=
"\u27e9");">"==h.delims[1]&&(h.delims[1]="\u27e9");"<"==h.delims[0]&&(h.delims[0]="\u27e8");"<"==h.delims[1]&&(h.delims[1]="\u27e8");m($c,h.delims[0],!0,g);m(ad,h.delims[1],!1,g);var Cc={display:{display:1,text:1,script:ia,scriptscript:.5},text:{display:1,text:1,script:ia,scriptscript:.5},script:{display:gc,text:gc,script:1,scriptscript:ia},scriptscript:{display:2,text:2,script:gc,scriptscript:1}}[B.displayedStyle][w],Mc=A.fontDimen.heightOf("x",n)/2;h.div.renderedDepth=(Sa-Mc+P/2+(u.renderedDepth-
u.baseline-u.baselineOffset)*R)*Cc;h.div.renderedHeight=(Mc+P/2+(p.baseline+p.baselineOffset+p.renderedHeight)*R)*Cc;h.div.baseline=u.baseline*Cc*R;h.div.baselineOffset=(Sa-Mc+P/2-u.baseline*R)*Cc;Aa=" ";return"continue"}if("table"==h.type){var Nc={type:"atom",atomType:L.INNER,nucleus:null,superscript:null,subscript:null,style:w,div:document.createElement("div")};fa.push(Nc);X.push(Nc);h.style=w;h.div=Nc.div;h.div.style.display="inline-block";h.div.style.whiteSpace="nowrap";var hc=document.createElement("table");
hc.style.borderCollapse="collapse";hc.style.verticalAlign="middle";hc.style.display="inline-table";for(var Rb=0,vd=h.cellData.length;Rb<vd;Rb++){if(h.noAligns[Rb]){var ic=document.createElement("td");ic.setAttribute("colspan",h.tabSkips.length-1);ic.style.padding=0;l([h.noAligns[Rb]],w,!1,W,ic);hc.appendChild(ic);ic.firstElementChild.style.width="100%";ic.firstElementChild.style.justifyContent=""}for(var bd=document.createElement("tr"),zb=0,wd=h.cellData[Rb].length;zb<wd;zb++){var Kb=document.createElement("td");
Kb.setAttribute("colspan",h.cellData[Rb][zb].span);Kb.style.padding=0;Kb.style.paddingLeft="".concat(h.tabSkips[zb].start.em.value/65536+h.tabSkips[zb].start.sp.value/65536/12,"em");zb==h.tabSkips.length-2&&(Kb.style.paddingRight="".concat(h.tabSkips[zb+1].start.em.value/65536+h.tabSkips[zb+1].start.sp.value/65536/12,"em"));l(h.cellData[Rb][zb].content,w,!1,W,Kb);bd.appendChild(Kb);Kb.firstElementChild.style.width="100%";Kb.firstElementChild.style.justifyContent=""}hc.appendChild(bd)}h.div.appendChild(hc);
a.appendChild(h.div);h.div.renderedHeight=h.div.offsetHeight/g/2+A.fontDimen.heightOf("x",n)/2;h.div.renderedDepth=h.div.offsetHeight/g/2-A.fontDimen.heightOf("x",n)/2;a.removeChild(h.div);return"continue"}if("atom"==h.type||"box"==h.type&&"atom"==h.content.type){var qb=!1;"box"==h.type&&(qb=h,h=h.content);var sa={display:{display:1,text:1,script:ia,scriptscript:.5},text:{display:1,text:1,script:ia,scriptscript:.5},script:{display:gc,text:gc,script:1,scriptscript:ia},scriptscript:{display:2,text:2,
script:gc,scriptscript:1}}[B.displayedStyle][w];if([L.OVER,L.UNDER,L.RAD].includes(h.atomType)&&(h.subscript||h.superscript)||h.atomType==L.RAD&&1!=sa)h.nucleus=[{type:"atom",atomType:h.atomType,nucleus:h.nucleus,superscript:null,subscript:null,index:h.index,invalid:h.invalid,phantom:h.phantom}],h.atomType=L.ORD;fa.push(h);X.push(h);h.style=w;h.div=document.createElement("div");h.div.style.display="inline-block";h.div.style.whiteSpace="nowrap";h.div.renderedHeight=0;h.div.renderedDepth=-.5;h.div.baselineOffset=
0;if(h.invalid){if(h.nucleus)if("symbol"==h.nucleus.type)h.nucleus.invalid=!0;else for(var Oc=h.nucleus.length-1;0<=Oc;Oc--)h.nucleus[Oc].invalid=!0;h.superscript&&(h.superscript[0].invalid=!0);h.subscript&&(h.subscript[0].invalid=!0)}![L.ORD,L.OP,L.BIN,L.REL,L.OPEN,L.CLOSE,L.PUNCT,L.INNER].includes(h.atomType)||!h.nucleus||1!=h.nucleus.length||h.nucleus[0].atomType!=L.OP||h.nucleus[0].delimited||h.nucleus[0].limits||h.superscript||h.subscript||h.nucleus[0].nucleus&&("symbol"==h.nucleus[0].nucleus.type&&
Ta["operator.growchars"][0].includes(h.nucleus[0].nucleus["char"])||1==h.nucleus[0].nucleus.length&&h.nucleus[0].nucleus[0].atomType==L.VARIABLE&&Ta["operator.growchars"][0].includes(h.nucleus[0].nucleus[0].nucleus[0]["char"]))||(h.superscript=h.nucleus[0].superscript,h.subscript=h.nucleus[0].subscript,h.nucleus=h.nucleus[0].nucleus);var jc=0;if(h.nucleus&&"symbol"==h.nucleus.type){if(10==h.nucleus.code)h.isLineBreak=!0,h.div.style.width="100%";else{h.div.innerHTML='<div style="white-space:pre;display:inline-block;'.concat(h.nucleus.invalid?
"color:".concat(Ta["invalid.color"][0],";"):"").concat({nm:h.atomType==L.VARIABLE?'font-style:italic"><div style="display:inline-block;margin:0 '.concat(A.fontDimen.italCorrOf(h.nucleus["char"],n),"em 0 ").concat(A.fontDimen.leftOffsetOf(h.nucleus["char"],n,"it"),"em"):"",rm:"",bf:"font-weight:bold;",it:"font-style:italic;",sl:"font-style:oblique;"}[W],'">').concat(45==h.nucleus.code?"\u2212":h.nucleus["char"],"</div>").concat("nm"==W&&h.atomType==L.VARIABLE?"</div>":"");var cd="nm"==W?h.atomType==
L.VARIABLE?"it":"nm":W;h.div.renderedHeight=A.fontDimen.heightOf(h.nucleus["char"],n,cd)*sa;h.div.renderedDepth=A.fontDimen.trueDepthOf(h.nucleus["char"],n,cd)*sa;h.div.baseline=A.fontDimen.baselineHeightOf(n)*sa;jc=A.fontDimen.scriptOffsetOf(h.nucleus["char"],n,"nm"==W&&h.atomType==L.VARIABLE?"it":W)}Aa=h.nucleus["char"]}else Array.isArray(h.nucleus)&&(Aa=l(h.nucleus,w,v||h.atomType==L.OVER||h.atomType==L.RAD,W,h.div)||Aa,h.div.renderedHeight*=sa,h.div.renderedDepth*=sa,h.div.baseline*=sa,h.div.baselineOffset*=
sa,!h.div.firstElementChild.empty||h.superscript||h.subscript||h.delimited||[L.RAD,L.ACC,L.OVER,L.UNDER].includes(h.atomType)||(h.div.empty=!0));h.phantom&&(h.div.firstElementChild.style.visibility="hidden");h.div.style.fontSize="".concat(sa,"em");if("display"==w&&h.atomType==L.OP&&h.nucleus&&("symbol"==h.nucleus.type||1==h.nucleus.length&&h.nucleus[0].nucleus&&"symbol"==h.nucleus[0].nucleus.type&&h.nucleus[0].atomType==L.VARIABLE)){var Lb=1;Ta["operator.growchars"][0].includes(h.nucleus["char"]||
h.nucleus[0].nucleus["char"])&&(Lb=Ta["operator.growamount"][0],h.div.renderedHeight*=Lb,h.div.renderedDepth*=Lb,h.div.firstElementChild.style.fontSize="".concat(Lb,"em"),jc*=Lb);var dd=A.fontDimen.heightOf("x",n)/2,uc=(h.div.renderedHeight-dd-h.div.renderedDepth-dd)/2;h.div.firstElementChild.style.top="".concat(uc/Lb,"em");h.div.renderedHeight-=uc;h.div.renderedDepth+=uc;h.div.firstElementChild.style.position="relative";h.div.firstElementChild.style.marginTop="".concat(-uc/Lb,"em");h.div.firstElementChild.style.marginBottom=
"".concat(uc/Lb,"em")}if(h.delimited){var ed=function(C,F,tb,J){var ta;switch(F){default:fa.splice(fa.length-(tb?1:0),0,{type:"kern",dimen:h.nullDelimiterSpace});break;case "|":case "/":case "\\":case "\u2016":case "\u23aa":case "\u23d0":case "\u27e8":case "\u27e9":var N=A.fontDimen.heightOf("x",n)/2;var Z=2*Math.max(h.div.renderedHeight-N,h.div.renderedDepth+N,(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n))/2);C.style.height="".concat(Z,"em");C.style.width="".concat(A.fontDimen.visibleWidthOf(F,
n),"em");C.style.marginLeft="".concat(-A.fontDimen.leftOffsetOf(F,n),"em");C.style.marginRight="".concat(A.fontDimen.widthOf(F,n)-A.fontDimen.visibleWidthOf(F,n)+A.fontDimen.leftOffsetOf(F,n),"em");C.style.verticalAlign="middle";h.div.renderedHeight=Math.max(Z/2+N,h.div.renderedHeight);h.div.renderedDepth=Math.max(Z/2-N,h.div.renderedDepth);C.height=J;C.width=A.fontDimen.visibleWidthOf(F,n)/(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n))*J;var Y=C.getContext("2d");Y.fillStyle=f.color;Y.font=
"".concat(J/(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n)),"px ").concat(n);Y.fillText(F,A.fontDimen.leftOffsetOf(F,n)*J,J-A.fontDimen.depthOf(F,n)*J/(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n)));h.div.insertBefore(C,tb?h.div.firstElementChild:null);break;case "(":case ")":N=A.fontDimen.heightOf("x",n)/2;Z=2*Math.max(h.div.renderedHeight-N,h.div.renderedDepth+N,(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n))/2);C.style.height="".concat(Z,"em");C.style.width="".concat(A.fontDimen.widthOf(F,
n),"em");C.style.verticalAlign="middle";h.div.renderedHeight=Math.max(Z/2+N,h.div.renderedHeight);h.div.renderedDepth=Math.max(Z/2-N,h.div.renderedDepth);if(0>=Math.floor(Math.floor(J/2*Z)-J))C.height=J,C.width=A.fontDimen.widthOf(F,n)/(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n))*J,Y=C.getContext("2d"),Y.textAlign="center",Y.fillStyle=f.color,Y.font="".concat(J/(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n)),"px ").concat(n),Y.fillText(F,C.width/2,J-A.fontDimen.depthOf(F,n)*J/(A.fontDimen.heightOf(F,
n)+A.fontDimen.depthOf(F,n)));else{var ca=A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n);C.height=J/2*Z;C.width=A.fontDimen.widthOf(F,n)/A.fontDimen.heightOf(F,n)*J*(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n));Y=C.getContext("2d");Y.textAlign="center";Y.fillStyle=f.color;Y.font="".concat(J/ca,"px ").concat(n);Y.fillText(F,C.width/2,J/2-A.fontDimen.depthOf(F,n)*J/ca);Z=Y.getImageData(0,0,C.width,J/2);Y.clearRect(0,0,C.width,C.height);Y.fillText(F,C.width/2,J-A.fontDimen.depthOf(F,n)*J/
ca);Y.clearRect(0,J/2,C.width,C.height);Y.putImageData(Z,0,C.height-J/2);N=Y.createImageData(C.width,C.height-J);F=Y.getImageData(0,J/2-1,C.width,1).data;ca=Z.data.slice(0,4*C.width);Z=0;for(ta=N.height/2;Z<ta;Z++)for(var pa=0,qa=C.width;pa<qa;pa++){var wa=Z*C.width*4+4*pa;N.data[wa+0]=F[4*pa];N.data[wa+1]=F[4*pa+1];N.data[wa+2]=F[4*pa+2];N.data[wa+3]=F[4*pa+3];wa=~~(Z+N.height/2)*C.width*4+4*pa;N.data[wa+0]=ca[4*pa];N.data[wa+1]=ca[4*pa+1];N.data[wa+2]=ca[4*pa+2];N.data[wa+3]=ca[4*pa+3]}Y.putImageData(N,
0,J/2)}h.div.insertBefore(C,tb?h.div.firstElementChild:null);break;case "[":case "]":case "\u27ee":case "\u27ef":case "\u2191":case "\u2193":case "\u2195":case "\u21d1":case "\u21d3":case "\u21d5":case "\u2308":case "\u2309":case "\u230a":case "\u230b":case "\u23b0":case "\u23b1":N=A.fontDimen.heightOf("x",n)/2;Z=2*Math.max(h.div.renderedHeight-N,h.div.renderedDepth+N,(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n))/2);C.style.height="".concat(Z,"em");C.style.width="".concat(A.fontDimen.widthOf(F,
n),"em");C.style.verticalAlign="middle";h.div.renderedHeight=Math.max(Z/2+N,h.div.renderedHeight);h.div.renderedDepth=Math.max(Z/2-N,h.div.renderedDepth);ca=A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n);C.height=J*Z;C.width=A.fontDimen.widthOf(F,n)/A.fontDimen.heightOf(F,n)*J*(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n));Y=C.getContext("2d");Y.textAlign="center";Y.fillStyle=f.color;Y.font="".concat(J/ca,"px ").concat(n);Y.fillText(F,C.width/2,J/2-A.fontDimen.depthOf(F,n)*J/ca);Z=Y.getImageData(0,
0,C.width,J/2);Y.clearRect(0,0,C.width,C.height);Y.fillText(F,C.width/2,J-A.fontDimen.depthOf(F,n)*J/ca);Y.clearRect(0,J/2,C.width,C.height);Y.putImageData(Z,0,C.height-J/2);if(C.height>J){N=Y.createImageData(C.width,C.height-J);F=Y.getImageData(0,J/2-1,C.width,1).data;ca=Z.data.slice(0,4*C.width);Z=0;for(ta=N.height/2;Z<ta;Z++)for(pa=0,qa=C.width;pa<qa;pa++)wa=Z*C.width*4+4*pa,N.data[wa+0]=F[4*pa],N.data[wa+1]=F[4*pa+1],N.data[wa+2]=F[4*pa+2],N.data[wa+3]=F[4*pa+3],wa=~~(Z+N.height/2)*C.width*4+
4*pa,N.data[wa+0]=ca[4*pa],N.data[wa+1]=ca[4*pa+1],N.data[wa+2]=ca[4*pa+2],N.data[wa+3]=ca[4*pa+3];Y.putImageData(N,0,J/2)}h.div.insertBefore(C,tb?h.div.firstElementChild:null);break;case "{":case "}":N=A.fontDimen.heightOf("x",n)/2;Z=2*Math.max(h.div.renderedHeight-N,h.div.renderedDepth+N,(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n))/2);C.style.height="".concat(Z,"em");C.style.width="".concat(A.fontDimen.widthOf(F,n),"em");C.style.verticalAlign="middle";ca=J/(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,
n));C.height=Math.max(Z,1)*J;C.width=A.fontDimen.widthOf(F,n)/A.fontDimen.heightOf(F,n)*J*(A.fontDimen.heightOf(F,n)+A.fontDimen.depthOf(F,n));Y=C.getContext("2d");Y.textAlign="center";Y.fillStyle=f.color;Y.font="".concat(ca,"px ").concat(n);h.div.renderedHeight=Math.max(Z/2+N,h.div.renderedHeight);h.div.renderedDepth=Math.max(Z/2-N,h.div.renderedDepth);if(3<=J&&(Y.fillText(F,C.width/2,Math.floor(J/3)-A.fontDimen.depthOf(F,n)*ca),Z=Y.getImageData(0,0,C.width,Math.floor(J/3)),Y.clearRect(0,0,C.width,
C.height),Y.fillText(F,C.width/2,J-A.fontDimen.depthOf(F,n)*ca),ta=Y.getImageData(0,0,C.width,Math.floor(J/3)),Y.clearRect(0,0,C.width,C.height),Y.fillText(F,C.width/2,C.height/2+J/2-A.fontDimen.depthOf(F,n)*ca),Y.clearRect(0,0,C.width,Math.floor(C.height/2)-Math.floor(J/2)+Math.floor(J/3)),Y.clearRect(0,Math.ceil(C.height/2)+Math.floor(J/2)-Math.floor(J/3),C.width,C.height),Y.putImageData(ta,0,0),Y.putImageData(Z,0,C.height-Math.floor(J/3)),C.height>J)){N=Y.createImageData(C.width,Math.ceil((C.height-
J)/2));F=ta.data.slice((Math.floor(J/3)-1)*C.width*4,Math.floor(J/3)*C.width*4);ca=Y.getImageData(0,Math.floor(C.height/2)-Math.floor(J/2)+Math.floor(J/3),C.width,1).data;ta=0;for(pa=N.height/2;ta<pa;ta++)for(qa=0,wa=C.width;qa<wa;qa++){var Fa=ta*C.width*4+4*qa;N.data[Fa+0]=F[4*qa];N.data[Fa+1]=F[4*qa+1];N.data[Fa+2]=F[4*qa+2];N.data[Fa+3]=F[4*qa+3];Fa=~~(ta+N.height/2)*C.width*4+4*qa;N.data[Fa+0]=ca[4*qa];N.data[Fa+1]=ca[4*qa+1];N.data[Fa+2]=ca[4*qa+2];N.data[Fa+3]=ca[4*qa+3]}ta=Y.createImageData(C.width,
Math.floor(C.height/2)-Math.floor(J/2)+1);F=Y.getImageData(0,Math.ceil(C.height/2)+Math.floor(J/2)-Math.floor(J/3)-1,C.width,1).data;ca=Z.data.slice(0,4*C.width);Z=0;for(pa=ta.height/2;Z<pa;Z++)for(qa=0,wa=C.width;qa<wa;qa++)Fa=Z*C.width*4+4*qa,ta.data[Fa+0]=F[4*qa],ta.data[Fa+1]=F[4*qa+1],ta.data[Fa+2]=F[4*qa+2],ta.data[Fa+3]=F[4*qa+3],Fa=~~(Z+ta.height/2)*C.width*4+4*qa,ta.data[Fa+0]=ca[4*qa],ta.data[Fa+1]=ca[4*qa+1],ta.data[Fa+2]=ca[4*qa+2],ta.data[Fa+3]=ca[4*qa+3];Y.putImageData(N,0,Math.floor(J/
3));Y.putImageData(ta,0,C.height/2+Math.floor(J/2)-Math.floor(J/3))}h.div.insertBefore(C,tb?h.div.firstElementChild:null)}},fd=document.createElement("canvas"),gd=document.createElement("canvas");fd.style.display=gd.style.display="inline-block";">"==h.delims[0]&&(h.delims[0]="\u27e9");">"==h.delims[1]&&(h.delims[1]="\u27e9");"<"==h.delims[0]&&(h.delims[0]="\u27e8");"<"==h.delims[1]&&(h.delims[1]="\u27e8");ed(fd,h.delims[0],!0,g);ed(gd,h.delims[1],!1,g)}if(h.superscript||h.subscript)if(h.atomType==
L.OP&&h.limits){var bb=h.div.firstElementChild;a.appendChild(h.div);var rb=h.div.offsetWidth+1;a.removeChild(h.div);if(h.subscript&&!h.superscript){h.div.renderedDepth=Math.max(h.div.renderedDepth,0);var Ra=document.createElement("div");Ra.style.display="inline-block";Ra.style.verticalAlign="text-bottom";Ra.style.position="relative";var Sb=document.createElement("div");Sb.innerText="\u00a0";Sb.style.verticalAlign="text-top";Sb.style.display="inline-block";Sb.style.width=0;l(h.subscript,"display"==
w||"text"==w?"script":"scriptscript",!0,W,Ra);Ra.style.fontSize="scriptscript"==w?h.div.style.fontSize:"calc(".concat(h.div.style.fontSize," * ").concat(ia,")");a.appendChild(Ra);var Pc=Ra.offsetWidth+1;Ra.style.fontSize="50px";var Qc=Ra.offsetHeight/50;a.removeChild(Ra);"scriptscript"==w?(Ra.style.fontSize="",Ra.style.top="".concat(-Ra.baseline-Ra.baselineOffset-h.div.renderedDepth,"em"),Sb.style.paddingBottom="".concat(Qc-h.div.baseline+h.div.baselineOffset+h.div.renderedDepth,"em")):(Ra.style.fontSize=
Qb,Ra.style.top=(-h.div.baseline-h.div.baselineOffset+h.div.renderedDepth)/ia+"em",Sb.style.paddingBottom=Qc*ia-h.div.baseline-h.div.baselineOffset+h.div.renderedDepth+"em");Ra.style.height=0;if(Pc<rb){var Rc=Ra.firstElementChild;var hd=bb;h.div.insertBefore(Ra,bb);Ra.style.width=0}else Rc=bb,hd=Ra.firstElementChild,h.div.appendChild(Ra);var Tb=document.createElement("div");Tb.style.display="inline-block";Tb.style.position="relative";var Ab=document.createElement("div");Ab.style.display="inline-block";
Ab.style.width=0;Ab.style.visibility="hidden";Ab.style.webkitUserSelect=Ab.style.mozUserSelect=Ab.style.msUserSelect=Ab.style.userSelect="none";Ab.appendChild(e(Rc.cloneNode(!0)));Tb.appendChild(Ab);var Ub=document.createElement("div");Ub.style.position="absolute";Ub.style.left=Ub.style.right=0;Ub.style.textAlign="center";Ub.style.display="inline-block";Ub.appendChild(Rc);Tb.appendChild(Ub);Tb.style.width="".concat(Math.max(Pc,rb)/g/("scriptscript"!=w&&hd==bb?ia:1),"em");if(Pc<rb)Ra.appendChild(Tb);
else{var Dc=document.createElement("div");Dc.style.display="inline-block";Dc.style.width=0;Dc.appendChild(Tb);h.div.insertBefore(Dc,Ra)}h.div.insertBefore(Sb,h.div.firstElementChild);h.div.renderedDepth+=(Qc*("scriptscript"==w?1:ia)-Ra.baseline-Ra.baselineOffset+Ra.renderedDepth)*sa}else if(h.superscript&&!h.subscript){var Ua=document.createElement("div");Ua.style.display="inline-block";Ua.style.verticalAlign="text-bottom";l(h.superscript,"display"==w||"text"==w?"script":"scriptscript",v,W,Ua);Ua.style.fontSize=
"scriptscript"==w?h.div.style.fontSize:"calc(".concat(h.div.style.fontSize," * ").concat(ia,")");a.appendChild(Ua);var Sc=Ua.offsetWidth+1;Ua.style.fontSize="50px";a.removeChild(Ua);"scriptscript"==w?(Ua.style.fontSize="",Ua.style.marginBottom="".concat(h.div.baseline+h.div.baselineOffset+h.div.renderedHeight,"em")):(Ua.style.fontSize=Qb,Ua.style.marginBottom="".concat((h.div.baseline+h.div.baselineOffset+h.div.renderedHeight)/ia,"em"));if(Sc<rb){var Tc=Ua.firstElementChild;var id=bb;h.div.insertBefore(Ua,
bb);Ua.style.width=0}else Tc=bb,id=Ua.firstElementChild,h.div.appendChild(Ua);var Vb=document.createElement("div");Vb.style.display="inline-block";Vb.style.position="relative";var Bb=document.createElement("div");Bb.style.display="inline-block";Bb.style.width=0;Bb.style.visibility="hidden";Bb.style.webkitUserSelect=Bb.style.mozUserSelect=Bb.style.msUserSelect=Bb.style.userSelect="none";Bb.appendChild(e(Tc.cloneNode(!0)));Vb.appendChild(Bb);var Wb=document.createElement("div");Wb.style.position="absolute";
Wb.style.left=Wb.style.right=0;Wb.style.textAlign="center";Wb.style.display="inline-block";Wb.appendChild(Tc);Vb.appendChild(Wb);Vb.style.width="".concat(Math.max(Sc,rb)/g/("scriptscript"!=w&&id==bb?ia:1),"em");if(Sc<rb)Ua.appendChild(Vb);else{var Ec=document.createElement("div");Ec.style.display="inline-block";Ec.style.width=0;Ec.appendChild(Vb);h.div.insertBefore(Ec,Ua)}h.div.renderedHeight+=(Ua.baseline+Ua.baselineOffset+Ua.renderedHeight)*("scriptscript"==w?1:ia)*sa}else if(h.superscript&&h.subscript){h.div.renderedDepth=
Math.max(h.div.renderedDepth,0);var Ja=document.createElement("div");Ja.style.display="inline-block";Ja.style.verticalAlign="text-bottom";Ja.style.position="relative";l(h.subscript,"display"==w||"text"==w?"script":"scriptscript",!0,W,Ja);Ja.style.fontSize="scriptscript"==w?h.div.style.fontSize:"calc(".concat(h.div.style.fontSize," * ").concat(ia,")");a.appendChild(Ja);var kc=Ja.offsetWidth+1;Ja.style.fontSize="50px";var jd=Ja.offsetHeight/50;a.removeChild(Ja);var Pa=document.createElement("div");
Pa.style.display="inline-block";Pa.style.verticalAlign="text-bottom";Pa.style.position="relative";l(h.superscript,"display"==w||"text"==w?"script":"scriptscript",v,W,Pa);Pa.style.fontSize="scriptscript"==w?h.div.style.fontSize:"calc(".concat(h.div.style.fontSize," * ").concat(ia,")");a.appendChild(Pa);var lc=Pa.offsetWidth+1;Pa.style.fontSize="50px";a.removeChild(Pa);var Xb=document.createElement("div");Xb.innerText="\u00a0";Xb.style.verticalAlign="text-top";Xb.style.display="inline-block";Xb.style.width=
0;"scriptscript"==w?(Ja.style.fontSize=Pa.style.fontSize="",Ja.style.top="".concat(-Ja.baseline-Ja.baselineOffset-h.div.renderedDepth,"em"),Xb.style.paddingBottom="".concat(height-h.div.baseline+h.div.baselineOffset+h.div.renderedDepth,"em"),Pa.style.marginBottom="".concat(h.div.baseline+h.div.baselineOffset+h.div.renderedHeight,"em")):(Ja.style.fontSize=Pa.style.fontSize=Qb,Ja.style.top="".concat((-h.div.baseline-h.div.baselineOffset+h.div.renderedDepth)/ia,"em"),Xb.style.paddingBottom="".concat(jd*
ia-h.div.baseline+h.div.baselineOffset+h.div.renderedDepth,"em"),Pa.style.marginBottom="".concat((h.div.baseline+h.div.baselineOffset+h.div.renderedHeight)/ia,"em"));Ja.style.height=0;if(kc<=lc&&rb<=lc){h.div.insertBefore(Ja,bb);h.div.appendChild(Pa);Ja.style.width=0;var mc=document.createElement("div"),nc=document.createElement("div");mc.style.display=nc.style.display="inline-block";mc.style.position=nc.style.position="relative";var Cb=document.createElement("div"),Db=document.createElement("div");
Cb.style.display=Db.style.display="inline-block";Cb.style.width=Db.style.width=0;Cb.style.visibility=Db.style.visibility="hidden";Cb.style.webkitUserSelect=Cb.style.mozUserSelect=Cb.style.msUserSelect=Cb.style.userSelect=Db.style.webkitUserSelect=Db.style.mozUserSelect=Db.style.msUserSelect=Db.style.userSelect="none";Cb.appendChild(e(Ja.firstElementChild.cloneNode(!0)));Db.appendChild(e(bb.cloneNode(!0)));mc.appendChild(Cb);nc.appendChild(Db);var Yb=document.createElement("div"),Zb=document.createElement("div");
Yb.style.position=Zb.style.position="absolute";Yb.style.left=Yb.style.right=0;Zb.style.left=Zb.style.right=0;Yb.style.textAlign=Zb.style.textAlign="center";Yb.style.display=Zb.style.display="inline-block";Yb.appendChild(Ja.firstElementChild);Zb.appendChild(bb);mc.appendChild(Yb);nc.appendChild(Zb);mc.style.width="".concat(lc/g/("scriptscript"!=w?ia:1),"em");nc.style.width="".concat(lc/g,"em");Ja.appendChild(mc);var Fc=document.createElement("div");Fc.style.display="inline-block";Fc.style.width=0;
Fc.appendChild(nc);h.div.insertBefore(Fc,Pa)}else if(kc<=rb&&lc<=rb){h.div.insertBefore(Ja,bb);h.div.insertBefore(Pa,bb);Ja.style.width=Pa.style.width=0;var oc=document.createElement("div"),pc=document.createElement("div");oc.style.display=pc.style.display="inline-block";oc.style.position=pc.style.position="relative";var Eb=document.createElement("div"),Fb=document.createElement("div");Eb.style.display=Fb.style.display="inline-block";Eb.style.width=Fb.style.width=0;Eb.style.visibility=Fb.style.visibility=
"hidden";Eb.style.webkitUserSelect=Eb.style.mozUserSelect=Eb.style.msUserSelect=Eb.style.userSelect=Fb.style.webkitUserSelect=Fb.style.mozUserSelect=Fb.style.msUserSelect=Fb.style.userSelect="none";Eb.appendChild(e(Ja.firstElementChild.cloneNode(!0)));Fb.appendChild(e(Pa.firstElementChild.cloneNode(!0)));oc.appendChild(Eb);pc.appendChild(Fb);var $b=document.createElement("div"),ac=document.createElement("div");$b.style.position=ac.style.position="absolute";$b.style.left=$b.style.right=0;ac.style.left=
ac.style.right=0;$b.style.textAlign=ac.style.textAlign="center";$b.style.display=ac.style.display="inline-block";$b.appendChild(Ja.firstElementChild);ac.appendChild(Pa.firstElementChild);oc.appendChild($b);pc.appendChild(ac);oc.style.width="".concat(rb/g/("scriptscript"!=w?ia:1),"em");pc.style.width="".concat(rb/g/("scriptscript"!=w?ia:1),"em");Ja.appendChild(oc);Pa.appendChild(pc)}else if(rb<=kc&&lc<=kc){h.div.insertBefore(Pa,bb);h.div.appendChild(Ja);Pa.style.width=0;var qc=document.createElement("div"),
rc=document.createElement("div");qc.style.display=rc.style.display="inline-block";qc.style.position=rc.style.position="relative";var Gb=document.createElement("div"),Hb=document.createElement("div");Gb.style.display=Hb.style.display="inline-block";Gb.style.width=Hb.style.width=0;Gb.style.visibility=Hb.style.visibility="hidden";Gb.style.webkitUserSelect=Gb.style.mozUserSelect=Gb.style.msUserSelect=Gb.style.userSelect=Hb.style.webkitUserSelect=Hb.style.mozUserSelect=Hb.style.msUserSelect=Hb.style.userSelect=
"none";Gb.appendChild(e(Pa.firstElementChild.cloneNode(!0)));Hb.appendChild(e(bb.cloneNode(!0)));qc.appendChild(Gb);rc.appendChild(Hb);var bc=document.createElement("div"),cc=document.createElement("div");bc.style.position=cc.style.position="absolute";bc.style.left=bc.style.right=0;cc.style.left=cc.style.right=0;bc.style.textAlign=cc.style.textAlign="center";bc.style.display=cc.style.display="inline-block";bc.appendChild(Pa.firstElementChild);cc.appendChild(bb);qc.appendChild(bc);rc.appendChild(cc);
qc.style.width="".concat(kc/g/("scriptscript"!=w?ia:1),"em");rc.style.width="".concat(kc/g,"em");Pa.appendChild(qc);var Gc=document.createElement("div");Gc.style.display="inline-block";Gc.style.width=0;Gc.appendChild(rc);h.div.insertBefore(Gc,Ja)}h.div.insertBefore(Xb,h.div.firstElementChild);h.div.renderedDepth+=(jd*("scriptscript"==w?1:ia)-Ja.baseline-Ja.baselineOffset+Ja.renderedDepth)*sa;h.div.renderedHeight+=(Pa.baseline+Pa.baselineOffset+Pa.renderedHeight)*("scriptscript"==w?1:ia)*sa}}else if(h.subscript&&
!h.superscript){var Oa=document.createElement("div");Oa.style.display="inline-block";Oa.style.verticalAlign="text-bottom";Oa.style.position="relative";var dc=document.createElement("div");dc.style.verticalAlign="text-top";dc.textContent="\u00a0";dc.style.display="inline-block";dc.style.width=0;l(h.subscript,"display"==w||"text"==w?"script":"scriptscript",!0,W,Oa);Oa.style.fontSize="50px";a.appendChild(Oa);var Uc=Oa.offsetHeight/50;a.removeChild(Oa);"scriptscript"==w?(Oa.style.fontSize="",Oa.style.top=
"".concat(Math.max(Oa.baseline,Oa.renderedDepth)-A.fontDimen.baselineHeightOf(n)+Math.max(Math.max(h.div.renderedDepth,0)/sa+.2,Oa.renderedHeight-A.fontDimen.heightOf("x",n))-Uc,"em"),dc.style.paddingBottom="".concat(Math.max(Oa.baseline,Oa.renderedDepth)-A.fontDimen.baselineHeightOf(n)+Math.max(Math.max(h.div.renderedDepth,0)/sa+.2,Oa.renderedHeight-A.fontDimen.heightOf("x",n))-Uc,"em")):(Oa.style.fontSize=Qb,Oa.style.top="".concat(Math.max(Oa.baseline,Oa.renderedDepth)-A.fontDimen.baselineHeightOf(n)/
ia+Math.max(Math.max(h.div.renderedDepth,0)/sa/ia+.2,Oa.renderedHeight-A.fontDimen.heightOf("x",n))-Uc,"em"),dc.style.paddingBottom="".concat(Math.max(Oa.baseline,Oa.renderedDepth)*ia-A.fontDimen.baselineHeightOf(n)+Math.max(Math.max(h.div.renderedDepth,0)/sa/ia+.2,Oa.renderedHeight-A.fontDimen.heightOf("x",n))*ia,"em"),h.div.renderedDepth=Math.max(h.div.renderedDepth,(Oa.renderedDepth*ia+Math.max(Math.max(h.div.renderedDepth,0)/sa/ia+.2,Oa.renderedHeight-A.fontDimen.heightOf("x",n))*ia)*sa));Oa.style.height=
0;h.div.appendChild(Oa);h.div.insertBefore(dc,Oa)}else if(h.superscript&&!h.subscript){var Ka=document.createElement("div");l(h.superscript,"display"==w||"text"==w?"script":"scriptscript",v,W,Ka);Ka.style.display="inline-block";Ka.style.verticalAlign="text-bottom";Ka.style.position="relative";"scriptscript"==w?(Ka.style.top="".concat(Math.max(Ka.baseline,Ka.renderedDepth)-A.fontDimen.baselineHeightOf(n)-Math.max(h.div.renderedHeight/sa+(v?.1:.2)-Ka.renderedHeight,Ka.renderedDepth+(v?.9:1)*A.fontDimen.heightOf("x",
n)),"em"),Ka.style.paddingTop="".concat(-Math.max(Ka.baseline,Ka.renderedDepth)+A.fontDimen.baselineHeightOf(n)+Math.max(h.div.renderedHeight/sa+(v?.1:.2)-Ka.renderedHeight,Ka.renderedDepth+(v?.9:1)*A.fontDimen.heightOf("x",n)),"em"),h.div.renderedHeight=Math.max(h.div.renderedHeight,(Ka.renderedHeight+Math.max(h.div.renderedHeight/sa+(v?.1:.2)-Ka.renderedHeight,Ka.renderedDepth+(v?.9:1)*A.fontDimen.heightOf("x",n)))*sa)):(Ka.style.fontSize=Qb,Ka.style.top="".concat(Math.max(Ka.baseline,Ka.renderedDepth)-
A.fontDimen.baselineHeightOf(n)/ia-Math.max(h.div.renderedHeight/sa/ia+(v?.1:.2)-Ka.renderedHeight,Ka.renderedDepth+(v?.9:1)*A.fontDimen.heightOf("x",n)),"em"),Ka.style.paddingTop="".concat(-Math.max(Ka.baseline,Ka.renderedDepth)+A.fontDimen.baselineHeightOf(n)/ia+Math.max(h.div.renderedHeight/sa/ia+(v?.1:.2)-Ka.renderedHeight,Ka.renderedDepth+(v?.9:1)*A.fontDimen.heightOf("x",n)),"em"),h.div.renderedHeight=Math.max(h.div.renderedHeight,(Ka.renderedHeight+Math.max(h.div.renderedHeight/sa/ia+(v?.1:
.2)-Ka.renderedHeight,Ka.renderedDepth+(v?.9:1)*A.fontDimen.heightOf("x",n)))*ia*sa));h.div.appendChild(Ka)}else if(h.subscript&&h.superscript){var La=document.createElement("div"),ec=document.createElement("div");La.style.display="inline-block";ec.style.verticalAlign="text-top";ec.innerText="\u00a0";ec.style.display="inline-block";ec.style.width=0;l(h.subscript,"display"==w||"text"==w?"script":"scriptscript",!0,W,La);La.style.fontSize="50px";a.appendChild(La);var xd=La.offsetHeight,kd=La.offsetWidth+
1;a.removeChild(La);var Ca=document.createElement("div");Ca.style.display="inline-block";l(h.superscript,"display"==w||"text"==w?"script":"scriptscript",v,W,Ca);Ca.style.fontSize="50px";a.appendChild(Ca);var yd=Ca.offsetHeight,ld=Ca.offsetWidth+1;a.removeChild(Ca);var Vc=ld+jc*g>kd?La:Ca,zd=ld+jc*g>kd?Ca:La,Ad=yd/50,md=xd/50;Ca.style.marginLeft="".concat(jc,"em");Vc==Ca&&(Ca.style.marginRight="".concat(-jc,"em"));La.style.verticalAlign=Ca.style.verticalAlign="text-bottom";Ca.style.position=La.style.position=
"relative";var sb=A.fontDimen.heightOf("x",n);"scriptscript"==w?(La.style.fontSize=Ca.style.fontSize="",Ca.style.top="".concat(Math.max(Ca.baseline,Ca.renderedDepth)-A.fontDimen.baselineHeightOf(n)-Math.max(h.div.renderedHeight/sa+(v?.1:.2)-Ca.renderedHeight,Ca.renderedDepth+(v?.9:1)*sb),"em"),Ca.style.paddingTop="".concat(-Math.max(Ca.baseline,Ca.renderedDepth)+A.fontDimen.baselineHeightOf(n)+Math.max(h.div.renderedHeight/sa+(v?.1:.2)-Ca.renderedHeight,Ca.renderedDepth+(v?.9:1)*sb),"em"),h.div.renderedHeight=
Math.max(h.div.renderedHeight,(Ca.renderedHeight+Math.max(h.div.renderedHeight/sa+(v?.1:.2)-Ca.renderedHeight,Ca.renderedDepth+(v?.9:1)*sb))*sa),La.style.top="".concat(Math.max(La.baseline,La.renderedDepth)-A.fontDimen.baselineHeightOf(n)+Math.max(Math.max(h.div.renderedDepth,0)/sa+.2,La.renderedHeight-.8*sb)-md,"em"),ec.style.paddingBottom="".concat(Math.max(La.baseline,La.renderedDepth)-A.fontDimen.baselineHeightOf(n)+Math.max(Math.max(h.div.renderedDepth,0)/sa+.2,La.renderedHeight-.8*sb)-Ad,"em"),
h.div.renderedDepth=Math.max(h.div.renderedDepth,(La.renderedDepth+Math.max(Math.max(h.div.renderedDepth,0)/sa+.2,La.renderedHeight-.8*sb))*sa)):(La.style.fontSize=Ca.style.fontSize=Qb,Ca.style.top="".concat(Math.max(Ca.baseline,Ca.renderedDepth)-A.fontDimen.baselineHeightOf(n)/ia-Math.max(h.div.renderedHeight/sa/ia+(v?.1:.2)-Ca.renderedHeight,Ca.renderedDepth+(v?.9:1)*sb),"em"),Ca.style.paddingTop="".concat(-Math.max(Ca.baseline,Ca.renderedDepth)+A.fontDimen.baselineHeightOf(n)/ia+Math.max(h.div.renderedHeight/
sa/ia+(v?.1:.2)-Ca.renderedHeight,Ca.renderedDepth+(v?.9:1)*sb),"em"),h.div.renderedHeight=Math.max(h.div.renderedHeight,(Ca.renderedHeight+Math.max(h.div.renderedHeight/sa/ia+(v?.1:.2)-Ca.renderedHeight,Ca.renderedDepth+(v?.9:1)*sb))*ia*sa),La.style.top="".concat(Math.max(La.baseline,La.renderedDepth)-A.fontDimen.baselineHeightOf(n)/ia+Math.max(Math.max(h.div.renderedDepth,0)/sa/ia+.2,La.renderedHeight-.8*sb)-md,"em"),ec.style.paddingBottom="".concat(Math.max(La.baseline,La.renderedDepth)*ia-A.fontDimen.baselineHeightOf(n)+
Math.max(Math.max(h.div.renderedDepth,0)/sa/ia+.2,La.renderedHeight-.8*sb)*ia,"em"),h.div.renderedDepth=Math.max(h.div.renderedDepth,(La.renderedDepth*ia+Math.max(Math.max(h.div.renderedDepth,0)/sa/ia+.2,La.renderedHeight-.8*sb)*ia)*sa));La.style.height=0;Vc.style.width=0;h.div.appendChild(ec);h.div.appendChild(Vc);h.div.appendChild(zd)}if(qb){if("horizontal"==qb.boxType){if(qb.to){var eb=new I(qb.to);eb.em.value+=eb.sp.value/12*16/g;eb.sp.value=0}else if(qb.spread){eb=new I(qb.spread);eb.em.value+=
eb.sp.value/12*16/g;eb.sp.value=0;var Bd=h.div.style.fontSize;h.div.style.fontSize="50px";a.appendChild(h.div);var Cd=(h.div.offsetWidth+1)/50;a.removeChild(h.div);h.div.style.fontSize=Bd;eb.em.value+=65536*Cd}0>eb.em.value?(fa.splice(fa.length-1,0,{type:"kern",dimen:eb}),h.div.firstElementChild.style.width="0.0001px"):h.div.firstElementChild.style.width=0==eb.em.value?"0.0001px":"".concat(eb.em.value/65536,"em");h.div.firstElementChild.style.flexWrap=""}else if("vertical"==qb.boxType){if(qb.to){var cb=
new I(qb.to);cb.em.value+=cb.sp.value/12*16/g;cb.sp.value=0}else if(qb.spread){cb=new I(qb.spread);cb.em.value+=cb.sp.value/12*16/g;cb.sp.value=0;var Dd=h.div.style.fontSize;h.div.style.fontSize="50px";a.appendChild(h.div);var Ed=h.div.offsetHeight/50;a.removeChild(h.div);h.div.style.fontSize=Dd;cb.em.value+=65536*Ed}if(0>cb.em.value)h.div.firstElementChild.style.height=0,h.div.firstElementChild.style.verticalAlign="text-bottom",h.div.firstElementChild.style.position="relative",h.div.firstElementChild.style.top=
"".concat(-cb.em.value/65536,"em"),h.div.renderedHeight=0,h.div.renderedDepth=0;else{h.div.firstElementChild.style.height="".concat(cb.em.value/65536,"em");h.div.firstElementChild.style.verticalAlign="text-bottom";var nd=A.fontDimen.baselineHeightOf(n);h.div.renderedDepth=Math.min(nd,cb.em.value/65536);h.div.renderedHeight=Math.max(cb.em.value/65536-nd,0)}h.div.firstElementChild.style.flexWrap=""}h.div.firstElementChild.style.justifyContent="initial"}switch(h.atomType){case L.OVER:h.div.renderedHeight=
Math.max(h.div.renderedHeight||0,A.fontDimen.heightOf("x",n)/2);var gb=A.fontDimen.visibleWidthOf("|",n);var Ma=document.createElement("div");Ma.style.display="inline-block";Ma.style.width=Ma.style.height=0;Ma.style.position="relative";Ma.style.top="".concat(-A.fontDimen.baselineHeightOf(n)-h.div.renderedHeight/sa-gb-.12,"em");Ma.style.verticalAlign="text-bottom";Ma.style.pointerEvents="none";var Ya=document.createElement("div");Ya.style.display="inline-block";Ya.style.webkitUserSelect=Ya.style.mozUserSelect=
Ya.style.msUserSelect=Ya.style.userSelect="none";Ya.style.position="relative";var ub=document.createElement("div");ub.style.position="absolute";ub.style.left=ub.style.right=0;ub.style.borderTop="".concat(gb,"em solid currentColor");Ya.appendChild(ub);var Mb=e(h.div.cloneNode(!0));Mb.style.visibility="hidden";Mb.style.fontSize="";Ya.appendChild(Mb);Ma.appendChild(Ya);h.div.insertBefore(Ma,h.div.firstElementChild);var ab=document.createElement("div");ab.style.height="".concat(h.div.renderedHeight/sa+
gb+.16,"em");ab.style.display="inline-block";ab.style.width=0;h.div.insertBefore(ab,Ma);h.div.renderedHeight+=gb+.16;break;case L.UNDER:h.div.renderedDepth=Math.max(h.div.renderedDepth||0,0);gb=A.fontDimen.visibleWidthOf("|",n);Ma=document.createElement("div");Ma.style.display="inline-block";Ma.style.width=Ma.style.height=0;Ma.style.position="relative";Ma.style.top="".concat(-A.fontDimen.baselineHeightOf(n)+h.div.renderedDepth/sa+.12,"em");Ma.style.verticalAlign="text-bottom";Ma.style.pointerEvents=
"none";Ya=document.createElement("div");Ya.style.display="inline-block";Ya.style.webkitUserSelect=Ya.style.mozUserSelect=Ya.style.msUserSelect=Ya.style.userSelect="none";Ya.style.position="relative";var vc=document.createElement("div");vc.style.position="absolute";vc.style.left=vc.style.right=0;vc.style.borderTop="".concat(gb,"em solid currentColor");Ya.appendChild(vc);Mb=e(h.div.cloneNode(!0));Mb.style.visibility="hidden";Mb.style.fontSize="";Mb.style.height=0;Ya.appendChild(Mb);Ma.appendChild(Ya);
h.div.insertBefore(Ma,h.div.firstElementChild);ab=document.createElement("div");ab.style.verticalAlign="text-top";ab.innerText="\u00a0";ab.style.paddingBottom="".concat(gb+.16-A.fontDimen.baselineHeightOf(n)+h.div.renderedDepth/sa,"em");ab.style.display="inline-block";ab.style.width=0;h.div.insertBefore(ab,Ma);h.div.renderedDepth+=gb+.16;break;case L.ACC:var hb=document.createElement("div");hb.style.display="inline-block";hb.style.position="relative";"it"==W?hb.style.fontStyle="italic":"sl"==W?hb.style.fontStyle=
"oblique":"bf"==W&&(hb.style.fontWeight="bold");hb.style.top="".concat(Math.min(A.fontDimen.heightOf("x",n),h.div.renderedHeight)-h.div.renderedHeight,"em");hb.style.width=0;hb.style.lineHeight=1.1;hb.style.height="1.1em";hb.style.verticalAlign="text-bottom";hb.textContent=h.accChar;var Nb=(Nb=!h.nucleus||"symbol"!=h.nucleus.type||"it"!=W&&"sl"!=W?0:A.fontDimen.italCorrOf(h.accChar,n))||(h.nucleus&&1==h.nucleus.length&&h.nucleus[0].nucleus&&"symbol"==h.nucleus[0].nucleus.type&&h.nucleus[0].atomType==
L.VARIABLE&&"nm"==W?A.fontDimen.italCorrOf(h.accChar,n):0);var Fd=h.div.style.fontSize;h.div.style.fontSize="50px";a.appendChild(h.div);hb.style.left="".concat(((h.div.offsetWidth+1)/50-A.fontDimen.widthOf(h.accChar,n,W))/2+Nb,"em");a.removeChild(h.div);h.div.style.fontSize=Fd;h.div.insertBefore(hb,h.div.firstElementChild);var Hc=document.createElement("div");Hc.style.display="inline-block";Hc.style.width=0;Hc.style.height="".concat(h.div.renderedHeight-Math.min(A.fontDimen.heightOf("x",n),h.div.renderedHeight)+
A.fontDimen.heightOf(h.accChar,n,W),"em");h.div.insertBefore(Hc,hb);h.div.renderedHeight=h.div.renderedHeight-Math.min(A.fontDimen.heightOf("x",n),h.div.renderedHeight)+A.fontDimen.heightOf(h.accChar,n,W);break;case L.VCENT:var od=A.fontDimen.heightOf("x",n)/2;Nb=h.div.renderedHeight-od-(h.div.renderedDepth+od);h.div.style.position="relative";h.div.style.top="".concat(Nb/2,"em");h.div.style.marginTop="".concat(-Nb/2,"em");h.div.style.marginBottom="".concat(Nb/2,"em");h.div.renderedHeight-=Nb/2;h.div.renderedDepth+=
Nb/2;break;case L.RAD:gb=A.fontDimen.visibleWidthOf("|",n);h.div.renderedHeight=Math.max(h.div.renderedHeight||0,A.fontDimen.heightOf("x",n)/2);h.div.renderedDepth=Math.max(h.div.renderedDepth||0,0);a.appendChild(h.div);var Gd=(h.div.offsetWidth+1)/g;a.removeChild(h.div);Ma=document.createElement("div");Ma.style.display="inline-block";Ma.style.width=Ma.style.height=0;Ma.style.position="relative";Ma.style.top="".concat(-A.fontDimen.baselineHeightOf(n)-h.div.renderedHeight/sa-gb-.12,"em");Ma.style.verticalAlign=
"text-bottom";Ma.style.pointerEvents="none";var wb=document.createElement("div");wb.style.display="inline-block";wb.style.webkitUserSelect=wb.style.mozUserSelect=wb.style.msUserSelect=wb.style.userSelect="none";wb.style.position="relative";wb.style.width="".concat(Gd,"em");ub=document.createElement("div");ub.style.position="absolute";ub.style.left=ub.style.right=0;ub.style.borderTop="".concat(gb,"em solid currentColor");wb.appendChild(ub);wb.appendChild(document.createTextNode("\u00a0"));Ma.appendChild(wb);
h.div.insertBefore(Ma,h.div.firstElementChild);ab=document.createElement("div");ab.style.height="".concat(h.div.renderedHeight/sa+gb+.16,"em");ab.style.display="inline-block";ab.style.width=0;h.div.insertBefore(ab,Ma);h.div.renderedHeight+=(gb+.16)*sa;var Da=document.createElement("canvas"),Ic=0,Jc=0;if(Ta["radical.build"][0]){Da.height=(h.div.renderedDepth+h.div.renderedHeight)*g;Da.style.height="".concat(h.div.renderedDepth+h.div.renderedHeight,"em");Da.style.position="relative";Da.style.top="".concat(h.div.renderedDepth,
"em");Da.style.marginLeft=".1em";Da.style.marginTop="".concat(-h.div.renderedDepth,"em");var ja=gb,ya=h.div.renderedHeight+h.div.renderedDepth-.04-ja/2,ma=Ta["radical.w"][0],Ea=Math.max(0,Math.min(ma,Ta["radical.t"][0])),la=Math.max(0,Ta["radical.h"][0]),U=ya/Math.max(0,Ta["radical.verticalthreshold"][0]),kb=Math.sqrt(U),ea=Math.sqrt(3);if(h.div.renderedHeight+h.div.renderedDepth<Math.max(0,Ta["radical.verticalthreshold"][0])){la=Math.min(h.div.renderedHeight+h.div.renderedDepth,la/Math.max(Ta["radical.verticalthreshold"][0],
0));var Qa=ja*U*ea/(6*U*U+2);Da.width=(-ja*(Ea*(U-1)-U*ma-ya*kb+ma)/(2*ya)+Qa+ma)*g;Da.style.width="".concat((-ja*Ea*(U-1)+ja*U*ma-ma*(ja-2*ya)+ya*(ja+2*Qa))/(2*ya),"em");var ib=Da.getContext("2d");ib.fillStyle=f.color;var wc=[Math.max(-ja*(Ea*(U-1)-U*ma-ya*kb+ma)/(2*ya),0)+Qa+ma,ya-ja/2],xb=[Math.min(-ja*(-Ea*(U-1)+U*ma+ya*kb-ma)/(2*ya)+Qa+ma,wc[0]),ya+ja/2],db=[-(4*Ea*Ea*U*ea*(U-1)*(U-1)-Ea*(U-1)*(4*U*U*ma*ea+3*ja*ea*Math.pow(U,1.5)-4*U*(ya*(la-1)-Qa*ea)+4*ya*la)-ya*(4*U*U*ma*(la-1)+ja*Math.pow(U,
1.5)*(3*la+2)-4*U*(la*ma-Qa*(la-1))-3*ja*la*kb-4*la*Qa))/(4*(ea*Ea*U*(U-1)+ya*(U*(la-1)-la))),-(la*ya+U*Ea*ea)/(U*(ma-Ea))*(-(4*Ea*Ea*U*ea*(U-1)*(U-1)-Ea*(U-1)*(4*U*U*ma*ea+3*ja*ea*Math.pow(U,1.5)-4*U*(ya*(la-1)-Qa*ea)+4*ya*la)-ya*(4*U*U*ma*(la-1)+ja*Math.pow(U,1.5)*(3*la+2)-4*U*(la*ma-Qa*(la-1))-3*ja*la*kb-4*la*Qa))/(4*(ea*Ea*U*(U-1)+ya*(U*(la-1)-la)))-U*(ma-Ea)-Ea-3*ja*kb/4-Qa)],Hd=[Math.max(-Ea*(U-1)+U*ma+ja/2*kb+Qa,-db[1]*(xb[0]-db[0])/(xb[1]-db[1])+db[0]+wc[0]-(xb[0]-db[0])/(xb[1]-db[1])*(wc[1]-
db[1]+(xb[1]-db[1])/(xb[0]-db[0])*db[0])),0];ib.beginPath();ib.moveTo(wc[0]*g,Da.height-wc[1]*g);ib.lineTo((-ja*(Ea*(U-1)-U*ma-ya*kb+ma)/(2*ya)+Qa+ma)*g,Da.height-(ya+ja/2)*g);ib.lineTo(xb[0]*g,Da.height-xb[1]*g);ib.lineTo(db[0]*g,Da.height-db[1]*g);ib.lineTo((8*Ea*Ea*U*ea*(U-1)-Ea*(8*U*U*ma*ea+6*ja*Math.pow(U,1.5)*ea+U*(ja+8*Qa*ea)+8*ya*la)+ja*U*ma-6*ja*ya*la*kb-8*ya*la*Qa)/(8*(Ea*U*ea*(U-1)-U*U*ma*ea-ya*la))*g,Da.height-(Jc=U*ea*(8*Ea*Ea*U*ea*(U-1)-Ea*(8*U*U*ma*ea+6*ja*Math.pow(U,1.5)*ea+U*(ja+
8*Qa*ea)+8*ya*la)+ja*U*ma-6*ja*ya*la*kb-8*ya*la*Qa)/(8*(Ea*U*ea*(U-1)-U*U*ma*ea-ya*la))+la*ya+ja/8)*g);ib.lineTo(0,Da.height-(la*ya+ja/8)*g);ib.lineTo(2*Qa*g,Da.height-(la*ya-ja/8)*g);ib.lineTo((8*Ea*Ea*U*ea*(U-1)-Ea*(8*U*U*ea*(ma-2*Qa)-6*ja*Math.pow(U,1.5)*ea-U*(ja-8*Qa*ea)+8*ya*la)-16*Qa*U*U*ma*ea-ja*U*ma+6*ja*ya*la*kb-8*ya*la*Qa)/(8*(Ea*U*ea*(U-1)-U*U*ma*ea-ya*la))*g,Da.height-(U*ea*((8*Ea*Ea*U*ea*(U-1)-Ea*(8*U*U*ea*(ma-2*Qa)-6*ja*Math.pow(U,1.5)*ea-U*(ja-8*Qa*ea)+8*ya*la)-16*Qa*U*U*ma*ea-ja*U*
ma+6*ja*ya*la*kb-8*ya*la*Qa)/(8*(Ea*U*ea*(U-1)-U*U*ma*ea-ya*la))-2*Qa)+la*ya-ja/8)*g);ib.lineTo((-Ea*(U-1)+U*ma-.75*ja*kb+Qa)*g,Da.height);ib.lineTo(Hd[0]*g,Da.height);ib.closePath();ib.fill();Ic=(xb[0]-db[0])/(xb[1]-db[1])*(Jc-db[1])+db[0]}else{la=Math.max(0,Math.min(ya,Ta["radical.h"][0]));Da.width=(8*ma+ja*(4+ea))/8*g;Da.style.width="".concat((8*ma+ja*(4+ea))/8,"em");var lb=Da.getContext("2d");lb.fillStyle=f.color;lb.beginPath();lb.moveTo((ma+ja*(ea+4)/8)*g,.04*g);lb.lineTo((ma+ja*(ea-4)/8)*g,
.04*g);lb.lineTo((ma+ja*(ea-4)/8)*g,Da.height-5*ja*(la+Ea*ea)/(4*(ma-Ea))*g);lb.lineTo((Ea*(4*ma*ea+ja*(3*ea+2)+4*la)-ja*(2*ma-3*la-1.5*ma-la/2*ea))/(4*(ma*ea+la))*g,Da.height-(Jc=(Ea*(4*ma*ea+ja*(3*ea+2)+4*la)-ja*(2*ma-3*la))/(4*(ma*ea+la))*ea+la+ja/2)*g);lb.lineTo(0,Da.height-(ja/8+la)*g);lb.lineTo(ja*ea/4*g,Da.height-(-ja/8+la)*g);lb.lineTo((Ea*(4*ma*ea-ja*(3*ea+2)+4*la)+ja*(2*ma-3*la+1.5*ma+la/2*ea))/(4*(ma*ea+la))*g,Da.height-((Ea*(4*ma*ea-ja*(3*ea+2)+4*la)+ja*(2*ma-3*la))/(4*(ma*ea+la))*ea+
la-ja/2)*g);lb.lineTo((ma-ja*(6-ea)/8)*g,Da.height);lb.lineTo((ma+ja*(ea+4)/8)*g,Da.height);lb.closePath();lb.fill();Ic=ma+ja*(ea-4)/8}}else{Da.height=(A.fontDimen.heightOf("\u221a",n)+A.fontDimen.depthOf("\u221a",n))*g;Da.width=A.fontDimen.widthOf("\u221a",n)*g;var Wc=Da.getContext("2d");Da.style.height="".concat(h.div.renderedHeight+h.div.renderedDepth,"em");Da.style.width="".concat(A.fontDimen.widthOf("\u221a",n),"em");Da.style.position="relative";Da.style.top="".concat(h.div.renderedDepth,"em");
Da.style.marginTop="".concat(-h.div.renderedDepth,"em");Wc.textAlign="center";Wc.font="".concat(g,"px ").concat(n);Wc.fillText("\u221a",Da.width/2,Da.height*(1-A.fontDimen.depthOf("\u221a",n)))}h.div.insertBefore(Da,ab);if(h.index.length){var mb=document.createElement("div");mb.style.display="inline-block";mb.style.position="relative";l(h.index,"scriptscript",!1,W,mb);mb.style.fontSize="50px";a.appendChild(mb);mb.style.marginLeft="".concat(Math.max(-(mb.offsetWidth+1)/50,-(Ic+.05)/("script"==w?ia:
"scriptscript"==w?1:.5)),"em");a.removeChild(mb);mb.style.fontSize="".concat("script"==w?ia:"scriptscript"==w?1:.5,"em");mb.style.top="".concat(-Math.max(Jc-h.div.renderedDepth,A.fontDimen.heightOf("x",n)/2)/("script"==w?ia:"scriptscript"==w?1:.5)-mb.renderedDepth-.1,"em");mb.style.left="".concat((.05+Ic)/("script"==w?ia:"scriptscript"==w?1:.5),"em");h.div.insertBefore(mb,Da)}}return"continue"}if("rule"==h.type){var Za=document.createElement("div"),yb="100%",vb="100%",nb="";Za.style.background="currentColor";
h.height&&(yb=new I(h.height),yb.em.value+=yb.sp.value/65536/6*8/g*65536,yb=yb.em.value/65536);h.depth&&(nb=new I(h.depth),nb.em.value+=nb.sp.value/65536/6*8/g*65536,nb=nb.em.value/65536);h.width&&(vb=new I(h.width),vb.em.value+=vb.sp.value/65536/6*8/g*65536,vb=vb.em.value/65536);"v"==h.ruleType?("100%"==yb?(Za.style.alignSelf="stretch",Za.renderedDepth=0,Za.renderedHeight=0):(Za.style.height="".concat(Math.max(yb+nb,0),"em"),Za.style.marginBottom=Za.style.top="".concat(nb,"em"),Za.style.marginTop=
"".concat(-nb,"em"),Za.style.position="relative",Za.renderedHeight=Math.max(yb,0),Za.renderedDepth=Math.max(nb,0)),0>vb?fa.push({type:"kern",dimen:new I(0,65536*vb)}):Za.style.width="".concat(vb,"em")):"h"==h.ruleType&&(Za.style.width="100%"==vb?"100%":"".concat(vb,"em"),Za.style.height="".concat(Math.max(yb+nb,0),"em"),Za.style.marginBottom=Za.style.top="".concat(nb,"em"),Za.style.marginTop="".concat(-nb,"em"),Za.style.position="relative",fa.push({type:"atom",atomType:L.ORD,nucleus:{},superscript:null,
subscript:null,style:w,isLineBreak:!0,div:document.createElement("div")}),fa[fa.length-1].div.style.width="100%",X.push(fa[fa.length-1]));var pd={type:"atom",atomType:L.ORD,nucleus:null,superscript:null,subscript:null,style:w,div:Za,isLineBreak:"h"==h.ruleType,growHeight:"v"==h.ruleType};fa.push(pd);X.push(pd);"h"==h.ruleType&&(fa.push({type:"atom",atomType:L.ORD,nucleus:null,superscript:null,subscript:null,isLineBreak:!0,div:document.createElement("div")}),fa[fa.length-1].div.style.width="100%",
X.push(fa[fa.length-1]));return"continue"}},na=0;na<x.length;na++)G(na);X.length&&X[X.length-1].atomType==L.BIN&&(X[X.length-1].atomType=L.ORD);fa.length||(B.empty=!0);G=0;for(na=fa.length;G<na;G++){var D=fa[G],T=X.indexOf(D);D.italicCorrection&&(D.dimen=new I(0,65536*A.fontDimen.italCorrOf(D.italicCorrection,n)));"glue"==D.type&&"dimension"==D.glue.stretch.type&&0==D.glue.stretch.sp.value&&0==D.glue.stretch.em.value&&"dimension"==D.glue.shrink.type&&0==D.glue.shrink.sp.value&&0==D.glue.shrink.em.value&&
(D.type="kern",D.dimen=D.glue.start);if("vkern"==D.type&&(D.dimen.sp.value||D.dimen.em.value))ka+=D.dimen.em.value,ka+=D.dimen.sp.value/12*16/g,D=document.createElement("div"),D.style.display="inline-flex",D.style.flexWrap="nowrap",D.style.alignItems="baseline",ka&&(D.style.position="relative",D.style.marginTop="".concat(ka/65536,"em"),D.style.marginBottom="".concat(-ka/65536,"em"),D.style.top="".concat(-ka/65536,"em"),D.verticalRaise=ka),da.push(D);else if("kern"==D.type&&(D.dimen.sp.value||D.dimen.em.value)){T=
da[da.length-1];if(!T.lastElementChild||T.lastElementChild.style.marginRight){var y=document.createElement("div");y.style.display="inline-block";T.appendChild(y)}T.lastElementChild.style.marginRight="".concat((D.dimen.sp.value/12*16/g+D.dimen.em.value)/65536,"em")}else if("glue"==D.type){T=document.createElement("div");y=(D.glue.start.sp.value/12*16/g+D.glue.start.em.value)/65536;T.style.width="".concat(y,"em");if("infinite dimension"==D.glue.stretch.type)T.style.flexGrow=D.glue.stretch.number.value/
65536*Math.pow(1290,D.glue.stretch.magnitude.value);else if(D.glue.stretch.sp.value||D.glue.stretch.em.value)T.style.flexGrow=1,T.style.maxWidth="".concat(y+(D.glue.stretch.sp.value/12*16/g+D.glue.stretch.em.value)/65536,"em");if("infinite dimension"==D.glue.shrink.type)T.style.flexShrink=D.glue.shrink.number.value/65536*Math.pow(1290,D.glue.shrink.magnitude.value);else if(D.glue.shrink.sp.value||D.glue.shrink.em.value)T.style.flexShrink=1,T.style.minWidth="".concat(y-(D.glue.shrink.sp.value/12*16/
g+D.glue.shrink.em.value)/65536,"em");da.push(T);D=document.createElement("div");D.style.display="inline-flex";D.style.flexWrap="nowrap";D.style.alignItems="baseline";ka&&(D.style.position="relative",D.style.marginTop="".concat(ka/65536,"em"),D.style.marginBottom="".concat(-ka/65536,"em"),D.style.top="".concat(-ka/65536,"em"),D.verticalRaise=ka);da.push(D)}else if("atom"==D.type){if(0!=T&&D.atomType==L.BIN){if("display"==w||"text"==w)y=document.createElement("div"),y.style.flexShrink=1,y.style.flexGrow=
1,y.style.maxWidth="".concat(6/18,"em"),y.style.width="".concat(4/18,"em"),da.push(y);y=document.createElement("div");y.style.display="inline-flex";y.style.flexWrap="nowrap";y.style.alignItems="baseline";ka&&(y.style.position="relative",y.style.marginTop="".concat(ka/65536,"em"),y.style.marginBottom="".concat(-ka/65536,"em"),y.style.top="".concat(-ka/65536,"em"),y.verticalRaise=ka);da.push(y)}0!=T&&D.atomType==L.REL&&("display"!=w&&"text"!=w||X[T-1].atomType==L.REL||X[T-1].atomType==L.OPEN||(y=document.createElement("div"),
6==X[T-1].atomType?y.style.width="".concat(3/18,"em"):(y.style.flexGrow=1,y.style.maxWidth="".concat(10/18,"em"),y.style.minWidth="".concat(5/18,"em")),da.push(y)),y=document.createElement("div"),y.style.display="inline-flex",y.style.flexWrap="nowrap",y.style.alignItems="baseline",ka&&(y.style.position="relative",y.style.marginTop="".concat(ka/65536,"em"),y.style.marginBottom="".concat(-ka/65536,"em"),y.style.top="".concat(-ka/65536,"em"),y.verticalRaise=ka),da.push(y));if(0!=T){var za=[L.ORD,L.OP,
L.BIN,L.REL,L.OPEN,L.CLOSE,L.PUNCT,L.INNER];y=za.indexOf(X[T-1].atomType);y=~y?y:0;za=za.indexOf(D.atomType);za=~za?za:0;y=[[0,1,0,0,0,0,0,-1],[1,1,0,0,0,0,0,-1],[-2,-2,0,0,-2,0,0,-2],[-3,-3,0,0,-3,0,0,-3],[0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,-1],[0,0,0,0,0,0,0,0],[-1,1,0,0,-1,0,-1,-1]][y][za];za=document.createElement("div");0>y&&(y="script"==D.style||"scriptscript"==D.style?0:-y);switch(y){case 1:za.style.minWidth="".concat(3/18,"em");za.style.maxWidth="".concat(3/18,"em");break;case 2:za.style.width=
"".concat(4/18,"}em");za.style.maxWidth="".concat(6/18,"em");za.style.flexGrow=1;za.style.flexShrink=1;break;case 3:za.style.minWidth="".concat(5/18,"em"),za.style.maxWidth="".concat(10/18),za.style.flexGrow=1}y&&da[da.length-1].appendChild(za)}y=da[da.length-1];y.renderedHeight=Math.max(y.renderedHeight||0,D.div.renderedHeight);y.renderedDepth=Math.max(y.renderedDepth||0,D.div.renderedDepth);D.div.baseline+D.div.baselineOffset<y.baseline+y.baselineOffset?(y.baseline=y.baseline||0,y.baselineOffset=
y.baselineOffset||0):(y.baseline=D.div.baseline,y.baselineOffset=D.div.baselineOffset);D.isLineBreak?(da.push(D.div),y=document.createElement("div"),y.style.display="inline-flex",y.style.flexWrap="nowrap",y.style.alignItems="baseline",ka&&(y.style.position="relative",y.style.marginTop="".concat(ka/65536,"em"),y.style.marginBottom="".concat(-ka/65536,"em"),y.style.top="".concat(-ka/65536,"em"),y.verticalRaise=ka),da.push(y)):D.growHeight?(y=document.createElement("div"),y.style.display="inline-flex",
y.style.flexWrap="nowrap",y.style.alignItems="baseline",y.style.alignSelf="stretch",ka&&(y.style.position="relative",y.style.marginTop="".concat(ka/65536,"em"),y.style.marginBottom="".concat(-ka/65536,"em"),y.style.top="".concat(-ka/65536,"em"),y.verticalRaise=ka),y.appendChild(D.div),da.push(y),y=document.createElement("div"),y.style.display="inline-flex",y.style.flexWrap="nowrap",y.style.alignItems="baseline",ka&&(y.style.position="relative",y.style.marginTop="".concat(ka/65536,"em"),y.style.marginBottom=
"".concat(-ka/65536,"em"),y.style.top="".concat(-ka/65536,"em"),y.verticalRaise=ka),da.push(y)):y.appendChild(D.div);D.atomType==L.PUNCT&&("display"!=w&&"text"!=w||!X[T+1]||X[T+1].atomType==L.REL||(D=document.createElement("div"),D.style.minWidth="".concat(3/18,"em"),D.style.maxWidth="".concat(3/18,"em"),da.push(D)),D=document.createElement("div"),D.style.display="inline-flex",D.style.flexWrap="nowrap",D.style.alignItems="baseline",ka&&(D.style.position="relative",D.style.marginTop="".concat(ka/65536,
"em"),D.style.marginBottom="".concat(-ka/65536,"em"),D.style.top="".concat(-ka/65536,"em"),D.verticalRaise=ka),da.push(D))}}ka=0;for(G=da.length;ka<G;ka++)B.appendChild(da[ka]),B.renderedHeight=Math.max(B.renderedHeight||0,(da[ka].renderedHeight||0)+(da[ka].verticalRaise||0)/65536),B.renderedDepth=Math.max(B.renderedDepth||0,(da[ka].renderedDepth||0)-(da[ka].verticalRaise||0)/65536),da[ka].baselineOffset+da[ka].baseline<B.baselineOffset+B.baseline?(B.baseline=B.baseline||0,B.baselineOffset=B.baselineOffset||
0):(B.baseline=da[ka].baseline,B.baselineOffset=da[ka].baselineOffset);ua.appendChild(B);ua.renderedHeight=Math.max(ua.renderedHeight||0,B.renderedHeight);ua.renderedDepth=Math.max(ua.renderedDepth||0,B.renderedDepth);B.baselineOffset+B.baseline<ua.baselineOffset+ua.baseline?(ua.baseline=ua.baseline||0,ua.baselineOffset=ua.baselineOffset||0):(ua.baseline=B.baseline,ua.baselineOffset=B.baselineOffset);return Aa}da=document.createElement("div");da.style.display="inline-flex";da.displayedStyle=w;da.crampedStyle=
v;da.renderedDepth=0;da.renderedHeight=0;ua.renderedHeight=ua.renderedHeight||0;ua.renderedDepth=ua.renderedDepth||0;ua.baseline=A.fontDimen.baselineHeightOf(n);ua.baselineOffset=0;ua.appendChild(da);da.empty=!0}var z=document.createElement("div");"display"==b?z.style.textAlign="center":z.style.display="inline-block";var g=parseFloat(f.fontSize),n=f.fontFamily;l(c,b,!1,"nm",z);z.firstElementChild.empty&&1==z.children.length&&(z=document.createTextNode(""));return z}function H(a,c){this.name=a;this.type=
"primitive";this["function"]=c}function Va(a,c){this.type="macro";_instanceof(a,H)||_instanceof(a,Va)?(a.proxy&&(a=a.original),this.proxy=!0,this.isLet=!!c,this.original=a):(this.proxy=!1,this.replacement=a||[],this.parameters=c||[])}function q(a,c,b,f){this.type="integer";this.register=!0;this.message=f||"";_instanceof(a,q)?(this.value=a.value,this.parent=a,this.min=a.min,this.max=a.max):(this.min=null===c||void 0===c?Number.MIN_SAFE_INTEGER:c,this.max=null===b||void 0===b?Number.MAX_SAFE_INTEGER:
b,a=isNaN(a)?0:Math.round(a)||0,isFinite(a)||(a=0>a?this.min:this.max),this.value=Math.max(this.min,Math.min(this.max,a)))}function I(a,c,b){this.type="dimension";this.message=b||"";this.register=!0;_instanceof(a,I)?(this.sp=new q(a.sp),this.em=new q(a.em),this.parent=a):_instanceof(a,Ba)?(this.sp=new q(0),this.em=new q(a.mu/18)):(this.sp=new q(a),this.em=new q(c))}function Ba(a,c){this.type="mu dimension";this.message=c||"";this.register=!0;_instanceof(a,Ba)?(this.mu=new q(a.mu),this.parent=a):_instanceof(a,
I)?this.mu=new q(a.em/18+a.sp/65536/12*18):this.mu=new q(a)}function Ia(a,c,b,f){this.type="glue";this.message=f||"";this.register=!0;_instanceof(a,Ia)?(this.start=new I(a.start),this.stretch=new I(a.stretch),this.shrink=new I(a.shrink),this.parent=a):(this.start=new I(a),this.stretch=_instanceof(c,oa)?c:new I(c),this.shrink=_instanceof(b,oa)?b:new I(b))}function jb(a,c,b,f){this.type="mu glue";this.message=f||"";this.register=!0;_instanceof(a,jb)?(this.start=new Ba(a.start),this.stretch=new Ba(a.stretch),
this.shrink=new Ba(a.shrink),this.parent=a):(this.start=new Ba(a),this.stretch=_instanceof(c,oa)?c:new Ba(c),this.shrink=_instanceof(b,oa)?b:new Ba(b))}function oa(a,c,b){this.type="infinite dimension";this.message=b||"";this.register=!0;this.number=new q(a);this.magnitude=new q(c)}function ra(a){a.invalid=!0;return[a]}function xc(a){return a&&("command"==a.type||"character"==a.type&&a.cat==k.ACTIVE)}function Xc(a){var c=a.eat();c&&"character"==c.type&&"="==c["char"]&&c.cat==k.OTHER||a.revert()}function Xa(a,
c,b,f){function e(n){for(;;){var x=c.eat();if(!x)break;else if("command"==x.type||"character"==x.type&&x.cat===k.ACTIVE)if(x="command"==x.type?b.last().defs.primitive[x.name]||b.last().defs.macros[x.name]:b.last().defs.active[x["char"]])if(x===d.defs.primitive["if"]||x.isLet&&x.original===d.defs.primitive["if"]||x===d.defs.primitive.ifcase||x.isLet&&x.original===d.defs.primitive.ifcase||x===d.defs.primitive.ifcat||x.isLet&&x.original===d.defs.primitive.ifcat||x===d.defs.primitive.ifdim||x.isLet&&
x.original===d.defs.primitive.ifdim||x===d.defs.primitive.ifeof||x.isLet&&x.original===d.defs.primitive.ifeof||x===d.defs.primitive.iffalse||x.isLet&&x.original===d.defs.primitive.iffalse||x===d.defs.primitive.ifodd||x.isLet&&x.original===d.defs.primitive.ifodd||x===d.defs.primitive.ifnum||x.isLet&&x.original===d.defs.primitive.ifnum||x===d.defs.primitive.ifhmode||x.isLet&&x.original===d.defs.primitive.ifhmode||x===d.defs.primitive.ifinner||x.isLet&&x.original===d.defs.primitive.ifinner||x===d.defs.primitive.ifmmode||
x.isLet&&x.original===d.defs.primitive.ifmmode||x===d.defs.primitive.iftrue||x.isLet&&x.original===d.defs.primitive.iftrue||x===d.defs.primitive.ifvmode||x.isLet&&x.original===d.defs.primitive.ifvmode||x===d.defs.primitive.ifvoid||x.isLet&&x.original===d.defs.primitive.ifvoid||x===d.defs.primitive.ifx||x.isLet&&x.original===d.defs.primitive.ifx)e("fi"),c.eat();else{if("else"==n&&(x===d.defs.primitive["else"]||x.isLet&&x.original===d.defs.primitive["else"]))break;if(x===d.defs.primitive.fi||x.isLet&&
x.original===d.defs.primitive.fi){c.revert();break}}}}function l(){for(var n=[];;){var x=c.eat();if(x)if("command"==x.type||"character"==x.type&&x.cat===k.ACTIVE){var w="command"==x.type?b.last().defs.primitive[x.name]||b.last().defs.macros[x.name]:b.last().defs.active[x["char"]];if(w){if(w===d.defs.primitive["if"]||w.isLet&&w.original===d.defs.primitive["if"]||w===d.defs.primitive.ifcase||w.isLet&&w.original===d.defs.primitive.ifcase||w===d.defs.primitive.ifcat||w.isLet&&w.original===d.defs.primitive.ifcat||
w===d.defs.primitive.ifdim||w.isLet&&w.original===d.defs.primitive.ifdim||w===d.defs.primitive.ifeof||w.isLet&&w.original===d.defs.primitive.ifeof||w===d.defs.primitive.iffalse||w.isLet&&w.original===d.defs.primitive.iffalse||w===d.defs.primitive.ifodd||w.isLet&&w.original===d.defs.primitive.ifodd||w===d.defs.primitive.ifnum||w.isLet&&w.original===d.defs.primitive.ifnum||w===d.defs.primitive.ifhmode||w.isLet&&w.original===d.defs.primitive.ifhmode||w===d.defs.primitive.ifinner||w.isLet&&w.original===
d.defs.primitive.ifinner||w===d.defs.primitive.ifmmode||w.isLet&&w.original===d.defs.primitive.ifmmode||w===d.defs.primitive.iftrue||w.isLet&&w.original===d.defs.primitive.iftrue||w===d.defs.primitive.ifvmode||w.isLet&&w.original===d.defs.primitive.ifvmode||w===d.defs.primitive.ifvoid||w.isLet&&w.original===d.defs.primitive.ifvoid||w===d.defs.primitive.ifx||w.isLet&&w.original===d.defs.primitive.ifx)if(w=l()){n.push(x);n.push.apply(n,w);continue}else return null;n.push(x);if(w===d.defs.primitive.fi||
w.isLet&&w.original===d.defs.primitive.fi)return n}else n.push(x)}else n.push(x);else return null}}var z=[];if(a)for(;;)if(a=c.eat())if("command"==a.type||"character"==a.type&&a.cat==k.ACTIVE){var g="command"==a.type?b.last().defs.primitive[a.name]||b.last().defs.macros[a.name]:b.last().defs.active[a["char"]];if(g)if(g===d.defs.primitive["if"]||g.isLet&&g.original===d.defs.primitive["if"]||g===d.defs.primitive.ifcase||g.isLet&&g.original===d.defs.primitive.ifcase||g===d.defs.primitive.ifcat||g.isLet&&
g.original===d.defs.primitive.ifcat||g===d.defs.primitive.ifdim||g.isLet&&g.original===d.defs.primitive.ifdim||g===d.defs.primitive.ifeof||g.isLet&&g.original===d.defs.primitive.ifeof||g===d.defs.primitive.iffalse||g.isLet&&g.original===d.defs.primitive.iffalse||g===d.defs.primitive.ifodd||g.isLet&&g.original===d.defs.primitive.ifodd||g===d.defs.primitive.ifnum||g.isLet&&g.original===d.defs.primitive.ifnum||g===d.defs.primitive.ifhmode||g.isLet&&g.original===d.defs.primitive.ifhmode||g===d.defs.primitive.ifinner||
g.isLet&&g.original===d.defs.primitive.ifinner||g===d.defs.primitive.ifmmode||g.isLet&&g.original===d.defs.primitive.ifmmode||g===d.defs.primitive.iftrue||g.isLet&&g.original===d.defs.primitive.iftrue||g===d.defs.primitive.ifvmode||g.isLet&&g.original===d.defs.primitive.ifvmode||g===d.defs.primitive.ifvoid||g.isLet&&g.original===d.defs.primitive.ifvoid||g===d.defs.primitive.ifx||g.isLet&&g.original===d.defs.primitive.ifx)if(g=l())z.push(a),z.push.apply(z,g);else return this.invalid=!0,c.loadState(f),
[this];else if(g===d.defs.primitive["else"]||g.proxy&&g.original===d.defs.primitive["else"])e("fi");else if(g===d.defs.primitive.fi||g.proxy&&g.original===d.defs.primitive.fi)break;else z.push(a);else z.push(a)}else z.push(a);else return this.invalid=!0,c.loadState(f),[this];else for(e("else");;)if(a=c.eat())if("command"==a.type||"character"==a.type&&a.cat==k.ACTIVE)if(g="command"==a.type?b.last().defs.primitive[a.name]||b.last().defs.macros[a.name]:b.last().defs.active[a["char"]])if(g===d.defs.primitive["if"]||
g.isLet&&g.original===d.defs.primitive["if"]||g===d.defs.primitive.ifcase||g.isLet&&g.original===d.defs.primitive.ifcase||g===d.defs.primitive.ifcat||g.isLet&&g.original===d.defs.primitive.ifcat||g===d.defs.primitive.ifdim||g.isLet&&g.original===d.defs.primitive.ifdim||g===d.defs.primitive.ifeof||g.isLet&&g.original===d.defs.primitive.ifeof||g===d.defs.primitive.iffalse||g.isLet&&g.original===d.defs.primitive.iffalse||g===d.defs.primitive.ifodd||g.isLet&&g.original===d.defs.primitive.ifodd||g===d.defs.primitive.ifnum||
g.isLet&&g.original===d.defs.primitive.ifnum||g===d.defs.primitive.ifhmode||g.isLet&&g.original===d.defs.primitive.ifhmode||g===d.defs.primitive.ifinner||g.isLet&&g.original===d.defs.primitive.ifinner||g===d.defs.primitive.ifmmode||g.isLet&&g.original===d.defs.primitive.ifmmode||g===d.defs.primitive.iftrue||g.isLet&&g.original===d.defs.primitive.iftrue||g===d.defs.primitive.ifvmode||g.isLet&&g.original===d.defs.primitive.ifvmode||g===d.defs.primitive.ifvoid||g.isLet&&g.original===d.defs.primitive.ifvoid||
g===d.defs.primitive.ifx||g.isLet&&g.original===d.defs.primitive.ifx)if(g=l())z.push(a),z.push.apply(z,g);else return this.invalid=!0,c.loadState(f),[this];else if(g&&(g===d.defs.primitive.fi||g.proxy&&g.original===d.defs.primitive.fi))break;else z.push(a);else z.push(a);else z.push(a);else return this.invalid=!0,c.loadState(f),[this];return z}function Id(a,c){for(var b=a.split(", ").map(function(z){return'"'==z[0]?z.substring(1,z.length-1):z}),f=Infinity,e=0,l=b.length;e<l;e++)Jd.then(function(z){function g(n){requestAnimationFrame(function(){Yc.includes(b[n])?
n<f&&(f=n):(z.style.fontFamily="".concat(b[n],", serif"),z.offsetWidth!=qd?(Yc.push(b[n]),n<f&&(f=n,c(b[n]))):(z.style.fontFamily="".concat(b[n],", sans-serif"),z.offsetWidth!=rd?(Yc.push(b[n]),n<f&&(f=n,c(b[n]))):g(n)))})}g(this)}.bind(e))}function sd(a,c){if(a&&!c)delete A.fontDimen.cache[a];else if(c&&!a){if(c=c.split(",").filter(function(e){return/^\\?(?:normalfont|nm|rm|it|sl|bf)$/.test(e.trim())}).map(function(e){return"\\normalfont"==e.trim()||"normalfont"==e.trim()?"nm":"\\"==e.trim()[0]?
e.trim().substring(1):e.trim()}),c.length)for(var b in A.fontDimen.cache)for(var f=c.length-1;0<=f;f--)delete A.fontDimen.cache[b][f]}else if(a&&c){if(c=c.split(",").filter(function(e){return/^\\?(?:normalfont|nm|rm|it|sl|bf)$/.test(e.trim())}).map(function(e){return"\\normalfont"==e.trim()||"normalfont"==e.trim()?"nm":"\\"==e.trim()[0]?e.trim().substring(1):e.trim()}),c.length&&A.fontDimen.cache[a])for(b=c.length-1;0<=b;b--)delete A.fontDimen.cache[a][b]}else A.fontDimen.cache={}}var k={ESCAPE:0,
OPEN:1,CLOSE:2,MATHSHIFT:3,ALIGN:4,ENDOFLINE:5,PARAMETER:6,SUPERSCRIPT:7,SUBSCRIPT:8,IGNORE:9,WHITESPACE:10,LETTER:11,OTHER:12,ACTIVE:13,COMMENT:14,INVALID:15},L={ORD:0,OP:1,BIN:2,REL:3,OPEN:4,CLOSE:5,PUNCT:6,VARIABLE:7,ACTIVE:8,INNER:"inner",OVER:"over",UNDER:"under",VCENT:"vcent",RAD:"rad",ACC:"acc"},gc=Math.SQRT2,ia=Math.SQRT1_2,Qb="".concat(ia,"em"),A={version:"0.5.1",config:function(a,c){var b=Object.keys(Ta);if("string"==typeof a)return a=a.toLowerCase(),b.includes(a)?(1<arguments.length&&(c=
Ta[a][1](c),"number"!=typeof c||isFinite(c)||(c=0),Ta[a][0]=c),Ta[a][0]):null;for(var f={},e=b.length-1;0<=e;e--){var l=b[e];if(a&&l in a){var z=Ta[l][1](a[l]);"number"!=typeof z||isFinite(z)||(z=0);Ta[l][0]=z}f[l]=Ta[l][0]}return f}},Ta={autoupdate:[!0,Boolean],parsehtml:[!0,Boolean],"invalid.color":["red",String],"radical.build":[!0,Boolean],"radical.w":[.5,Number],"radical.t":[.15,Number],"radical.h":[1.25,Number],"radical.verticalthreshold":[2.75,Number],"operator.growamount":[1.75,Number],"operator.growchars":["\u2140\u220f\u2210\u2211\u222b\u222e\u22c0\u22c1\u22c2\u22c3\u2a00\u2a01\u2a02\u2a03\u2a04\u2a05\u2a06\u2a09\u2aff",
String]};A.rerender=function(a){var c=ha(a);c=ob.filter(function(b){return c.includes(b.parsedTeXInstance)});for(a=c.length-1;0<=a;a--)c[a].parsedTeXInstance.renderIn(c[a].elem)};A.updateStyles=function(a){var c=ha(a);c=ob.filter(function(f){return c.includes(f.parsedTeXInstance)});a=0;for(var b=c.length-1;0<=b;b--)if(c[b].oldFontFamily!=c[b].styles.fontFamily||c[b].oldFontSize!=c[b].styles.fontSize||c[b].oldColor!=c[b].styles.color)c[b].oldFontFamily=c[b].styles.fontFamily,c[b].oldFontSize=c[b].styles.fontSize,
c[b].oldColor=c[b].styles.color,c[b].parsedTeXInstance.renderIn(c[b].elem),a++;return a};var ob=[];(new MutationObserver(function(){Ta.autoupdate[0]&&A.updateStyles()})).observe(document,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","style"]});var $a=console.log.bind(console);A.parse=function(a){function c(g){var n=a[g]||"",x=d.cats[n.codePointAt(0)];if(!x)return[{},0];x=x.value;if(x!=k.ESCAPE&&x!=k.MATHSHIFT&&x!=k.ACTIVE)return[{},0];if(x==k.ESCAPE){var w=a[g+1],v=a.codePointAt(g+
1);x="";if(v in d.cats&&d.cats[v].value==k.LETTER){g+=1;for(w=a.codePointAt(g);w&&w in d.cats&&d.cats[w].value==k.LETTER;w=a.codePointAt(++g))x+=a[g];if(d.defs.macros[x])g=d.defs.macros[x];else return[{},0]}else if(w&&(d.defs.primitive[w]||d.defs.macros[w]))x=w,g=d.defs.primitive[w]||d.defs.macros[w];else return[{},0];w=!1;g.isLet&&(g=g.original,w=!0);return g===d.defs.primitive["["]?[{type:"command",name:"[",cat:-1},x.length+1]:g===d.defs.primitive["("]?[{type:"command",name:"(",cat:-1},x.length+
1]:w&&g.replacement&&1==g.replacement.length&&g.replacement[0].cat==k.MATHSHIFT?[{"char":n,cat:k.MATHSHIFT},x.length+1]:[{},0]}if(x==k.MATHSHIFT)return[{"char":n,cat:k.MATHSHIFT},1];if(x==k.ACTIVE&&d.defs.active[n]){if(d.defs.active[n].isLet){x=d.defs.active[n].original;if(x===d.defs.primitive["["])return[{type:"command",name:"[",cat:-1},1];if(x===d.defs.primitive["("])return[{type:"command",name:"(",cat:-1},1];if(x.replacement&&1==x.replacement.length&&x.replacement[0].cat==k.MATHSHIFT)return[{"char":n,
cat:k.MATHSHIFT},1]}return[{},0]}}for(var b=[],f=a;a;)if(a.codePointAt(0)in d.cats){var e=c(0),l=null,z=0;e[0].cat==k.MATHSHIFT?(z+=e[1],e=c(e[1]),e[0].cat==k.MATHSHIFT?(l="display",z+=e[1]):l="inline"):"command"==e[0].type&&"["==e[0].name?(l="display",z+=e[1]):"command"==e[0].type&&"("==e[0].name&&(l="inline",z+=e[1]);if("display"==l||"inline"==l)if(z=va(a.substring(z),l),z[2])a=z[1],b.push([z[0],"display"==l?"display":"text"]);else{b.push(a);a="";break}else"string"==typeof b[b.length-1]?b[b.length-
1]+=a[0]:b.push(a[0]),a=a.substring(1)}else"string"==typeof b[b.length-1]?b[b.length-1]+=a[0]:b.push(a[0]),a=a.substring(1);return new A.ParsedFontTeX(f,b)};A.render=function(a){a=ba(a);for(var c=a.length-1;0<=c;c--){var b=a[c].getAttribute("data-fontTeX-input");null===b&&(b=a[c].getAttribute("use")||a[c].getAttribute("data-use")||a[c].innerHTML);A.parse(b).renderIn(a[c]);a[c].setAttribute("data-fontTeX-input",b)}};var yc=document.getElementsByTagName("font-tex");(new MutationObserver(Ga)).observe(document,
{childList:!0,subtree:!0});Ga();A.ParsedFontTeX=function(a,c){this.texString=a;this.parsedTokens=c};A.ParsedFontTeX.prototype={renderIn:function(a){Zc.then(function(){for(var c=this,b=this,f=ba(a),e=b.parsedTokens.slice(),l=function(g){f[g].innerHTML="";var n=void 0;if(f[g].hasAttribute("data-fontTeX-container-id")){var x=+f[g].getAttribute("data-fontTeX-container-id");n=ob[x].styles;ob[x].oldFontFamily=n.fontFamily;ob[x].oldFontSize=n.fontSize;ob[x].oldColor=n.color;ob[x].parsedTeXInstance=b}else x=
ob.length,n=getComputedStyle(f[g]),f[g].setAttribute("data-fontTeX-container-id",x),ob[x]={elem:f[g],styles:n,parsedTeXInstance:b,oldFontFamily:n.fontFamily,oldFontSize:n.fontSize,oldColor:n.oldColor};var w=n.fontFamily;Id(w,function(){sd(w);A.rerender(this)}.bind(f[g]));if(Ta.parsehtml[0]){var v="";x=[];for(var W=0,ua=e.length;W<ua;W++)if("string"==typeof e[W])v+=e[W];else{var Aa=uuidv4();x.push([Aa,Na(f[g],e[W][0],e[W][1],n)]);v+="<span data-fontTeX-uuid-".concat(Aa,"></span>")}n=document.createElement("div");
n.innerHTML=v;v=!1;W=0;for(ua=x.length;W<ua;W++)(Aa=n.querySelector("[data-fontTeX-uuid-".concat(x[W][0],"]")))?(Aa.parentNode.insertBefore(x[W][1],Aa),Aa.parentNode.removeChild(Aa)):v=!0;v&&console.warn("Malformed HTML was passed into `renderIn`. Some TeX couldn't be rendered.\nPassed in value: ".concat(c.texString));x=0;for(v=n.childNodes.length;x<v;x++)f[g].appendChild(n.firstChild)}else{x=document.createDocumentFragment();v=0;for(W=e.length;v<W;v++)"string"==typeof e[v]?x.appendChild(document.createTextNode(e[v])):
x.appendChild(Na(f[g],e[v][0],e[v][1],n));f[g].appendChild(x)}f[g].setAttribute("data-fontTeX-input",b.texString);f[g].setAttribute("data-fontTeX-is-parsed","true")},z=f.length-1;0<=z;z--)l(z)}.bind(this))},again:function(){this.parsedTokens=A.parse(this.texString).parsedTokens;return this},reparse:function(){this.parsedTokens=A.parse(this.texString).parsedTokens;return this},texString:"",parsedTokens:null};A.global=function(a){a=va(a,"standalone",!0);for(var c in a.defs.macros)d.defs.macros[c]=a.defs.macros[c];
for(var b in a.defs.active)d.defs.active[b]=a.defs.active[b];c=[];for(var f in a.registers.count)b=new q(a.registers.count[f]),d.registers.count[f]=b,c.push(b);for(var e in a.registers.dimen)f=new I(a.registers.dimen[e]),d.registers.dimen[e]=f,c.push(f);for(var l in a.registers.skip)e=new Ia(a.registers.skip[l]),d.registers.skip[l]=e,c.push(e);for(var z in a.registers.muskip)l=new jb(a.registers.muskip[z]),d.registers.muskip[z]=l,c.push(l);for(var g in a.registers.named)c.includes(a.registers.named[g])?
d.registers.named[g]=a.registers.named[g]:"integer"==a.registers.named[g].type?d.registers.named[g]=new q(a.registers.named[g]):"dimension"==a.registers.named[g].type?d.registers.named[g]=new I(a.registers.named[g]):"mu dimension"==a.registers.named[g].type?d.registers.named[g]=new Ba(a.registers.named[g]):"glue"==a.registers.named[g].type?d.registers.named[g]=new Ia(a.registers.named[g]):"mu glue"==a.registers.named[g].type&&(d.registers.named[g]=new jb(a.registers.named[g]));for(var n in a.cats)d.cats[n].value=
a.cats[n].value;for(var x in a.mathcodes)d.mathcodes[x].value=a.mathcodes[x].value;for(var w in a.uc)d.uc[w].value=a.uc[w].value;for(var v in a.lc)d.lc[v].value=a.lc[v].value};var d={defs:{primitive:{"(":new H("(",function(a){return ra(this)}),")":new H(")",function(a){return"inline"==a.style?[{type:"character","char":"$",code:"$".codePointAt(0),cat:k.MATHSHIFT}]:ra(this)}),"/":new H("/",function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);a.tokens.push({type:"kern",
dimen:new I(0),italicCorrection:!0});return[]}),"[":new H("[",function(a){return ra(this)}),"]":new H("]",function(a){return"display"==a.style?[{type:"character","char":"$",code:"$".codePointAt(0),cat:k.MATHSHIFT},{type:"character","char":"$",code:"$".codePointAt(0),cat:k.MATHSHIFT}]:ra(this)}),above:new H("above",function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);var c=a.mouth.eat("dimension");if(!c)return ra(this);a.lastScope.isFrac=!0;a.lastScope.fracRightDelim=
".";a.lastScope.barWidth=c;a.lastScope.root&&(a.lastScope.root.invalid=!0,a.lastScope.root=!1);a.lastScope.fracNumerator=a.lastScope.tokens;a.lastScope.tokens=[];return[]}),abovewithdelims:new H("abovewithdelims",function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);var c=Symbol();for(a.mouth.saveState(c);;){var b=a.mouth.eat();if(xc(b))b=a.mouth.expand(b,a.mouth),a.mouth.queue.unshift.apply(a.mouth.queue,b);else if(b&&"character"==b.type&&d.delims.includes(b.code)&&
(b.cat==k.OTHER||b.cat==k.LETTER))if(a.lastScope.fracLeftDelim){a.lastScope.fracRightDelim=b["char"];break}else a.lastScope.fracLeftDelim=b["char"];else return a.mouth.loadState(c),delete a.lastScope.fracLeftDelim,ra(this)}c=a.mouth.eat("dimension");if(!c)return ra(this);a.lastScope.isFrac=!0;a.lastScope.barWidth=c;a.lastScope.root&&(a.lastScope.root.invalid=!0,a.lastScope.root=!1);a.lastScope.fracNumerator=a.lastScope.tokens;a.lastScope.tokens=[];return[]}),accent:new H("accent",function(a){if("superscript"==
a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat("integer");if(!b||0>b.value)return a.mouth.loadState(c),ra(this);a.tokens.push({type:"accent modifier","char":String.fromCodePoint(b.value),code:b.value,token:this});return[]}),advance:new H("advance",function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);var c=Symbol();for(a.mouth.saveState(c);;){var b=a.mouth.eat();if(xc(b))b=a.mouth.expand(b,
a.mouth),a.mouth.queue.unshift.apply(a.mouth.queue,b);else if(b&&b.register){var f=a.mouth.eat();if(!f||"character"!=f.type||"b"!=f["char"]&&"B"!=f["char"]||f.cat==k.ACTIVE)if(f)a.mouth.revert();else return a.mouth.loadState(c),ra(this);else f=a.mouth.eat(),(!f||"character"!=f.type||"y"!=f["char"]&&"Y"!=f["char"]||f.cat==k.ACTIVE)&&a.mouth.revert(2);if("integer"==b.type)if(f=a.mouth.eat("integer")){b.value+=f.value;c=b;if(a.toggles.global&&0<=a.lastScope.registers.named.globaldefs.value||0<a.lastScope.registers.named.globaldefs.value)for(;b.parent;)b=
b.parent,b.value=c.value;a.toggles.global=!1}else return a.mouth.loadState(c),ra(this);else if("dimension"==b.type)if(f=a.mouth.eat("dimension")){b.sp.value+=f.sp.value;b.em.value+=f.em.value;c=b;if(a.toggles.global&&0<=a.lastScope.registers.named.globaldefs.value||0<a.lastScope.registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.sp.value=c.sp.value,b.em.value=c.em.value;a.toggles.global=!1}else return a.mouth.loadState(c),ra(this);else if("mu dimension"==b.type)if(f=a.mouth.eat("mu dimension")){b.mu.value+=
f.mu.value;c=b;if(a.toggles.global&&0<=a.lastScope.registers.named.globaldefs.value||0<a.lastScope.registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.mu.value=c.mu.value;a.toggles.global=!1}else return a.mouth.loadState(c),ra(this);else if("glue"==b.type)if(f=a.mouth.eat("glue")){b.start.sp.value+=f.start.sp.value;b.start.em.value+=f.start.em.value;if("infinite dimension"==f.stretch.type)if("infinite dimension"==b.stretch.type&&b.stretch.magnitude.value==f.stretch.magnitude.value)b.stretch.number.value+=
f.stretch.number.value;else{if("infinite dimension"!=b.stretch.type||b.stretch.magnitude.value<f.stretch.magnitude.value)b.stretch=new oa(f.stretch.number.value,f.stretch.magnitude.value)}else"infinite dimension"!=b.stretch.type&&(b.stretch.sp.value+=f.stretch.sp.value,b.stretch.em.value+=f.stretch.em.value);if("infinite dimension"==f.shrink.type)if("infinite dimension"==b.shrink.type&&b.shrink.magnitude.value==f.shrink.magnitude.value)b.shrink.number.value+=f.shrink.number.value;else{if("infinite dimension"!=
b.shrink.type||b.shrink.magnitude.value<f.shrink.magnitude.value)b.shrink=new oa(f.shrink.number.value,f.shrink.magnitude.value)}else"infinite dimension"!=b.shrink.type&&(b.shrink.sp.value+=f.shrink.sp.value,b.shrink.em.value+=f.shrink.em.value);c=b;if(a.toggles.global&&0<=a.lastScope.registers.named.globaldefs.value||0<a.lastScope.registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.start.sp.value+=f.start.sp.value,b.start.em.value+=f.start.em.value,b.stretch="infinite dimension"==c.stretch.type?
new oa(c.stretch.number.value,c.stretch.magnitude.value):new I(c.stretch.sp.value,c.stretch.em.value),b.shrink="infinite dimension"==c.shrink.type?new oa(c.shrink.number.value,c.shrink.magnitude.value):new I(c.shrink.sp.value,c.shrink.em.value);a.toggles.global=!1}else return a.mouth.loadState(c),ra(this);else if("mu glue"==b.type)if(f=a.mouth.eat("mu glue")){b.start.mu.value+=f.start.mu.value;if("infinite dimension"==f.stretch.type)if("infinite dimension"==b.stretch.type&&b.stretch.magnitude.value==
f.stretch.magnitude.value)b.stretch.value+=f.stretch.value;else{if("infinite dimension"!=b.stretch.type||b.stretch.magnitude.value<f.stretch.magnitude.value)b.stretch=new oa(f.stretch.number.value,f.stretch.magnitude.value)}else"infinite dimension"!=b.stretch.type&&(b.stretch.mu.value+=f.stretch.mu.value);if("infinite dimension"==f.shrink.type)if("infinite dimension"==b.shrink.type&&b.shrink.magnitude.value==f.shrink.magnitude.value)b.shrink.value+=f.shrink.value;else{if("infinite dimension"!=b.shrink.type||
b.shrink.magnitude.value<f.shrink.magnitude.value)b.shrink=new oa(f.shrink.number.value,f.shrink.magnitude.value)}else"infinite dimension"!=b.shrink.type&&(b.shrink.mu.value+=f.shrink.mu.value);c=b;if(a.toggles.global&&0<=a.lastScope.registers.named.globaldefs.value||0<a.lastScope.registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.start.mu.value=c.start.mu.value,b.stretch="infinite dimension"==c.stretch.type?new oa(c.stretch.number.value,c.stretch.magnitude.value):new Ba(c.stretch.mu.value),
"infinite dimension"==c.shrink.type?b.shrink=new oa(c.shrink.number.value,c.shrink.magnitude.value):b.stretch=new Ba(c.shrink.mu.value);a.toggles.global=!1}else return a.mouth.loadState(c),ra(this);break}else return a.mouth.loadState(c),ra(this)}return[]}),atop:new H("atop",function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);a.lastScope.isFrac=!0;a.lastScope.fracLeftDelim=a.lastScope.fracRightDelim=".";a.lastScope.barWidth=new I(0);a.lastScope.root&&(a.lastScope.root.invalid=
!0,a.lastScope.root=!1);a.lastScope.fracNumerator=a.lastScope.tokens;a.lastScope.tokens=[];return[]}),atopwithdelims:new H("atopwithdelims",function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);var c=Symbol();for(a.mouth.saveState(c);;){var b=a.mouth.eat();if(xc(b))b=a.mouth.expand(b,a.mouth),a.mouth.queue.unshift.apply(a.mouth.queue,b);else if(b&&"character"==b.type&&d.delims.includes(b.code)&&(b.cat==k.OTHER||b.cat==k.LETTER))if(a.lastScope.fracLeftDelim){a.lastScope.fracRightDelim=
b["char"];break}else a.lastScope.fracLeftDelim=b["char"];else return a.mouth.loadState(c),delete a.scopes.last().fracLeftDelim,ra(this)}a.lastScope.isFrac=!0;a.lastScope.barWidth=new I(0);a.lastScope.root&&(a.lastScope.root.invalid=!0,a.lastScope.root=!1);a.lastScope.fracNumerator=a.lastScope.tokens;a.lastScope.tokens=[];return[]}),begingroup:new H("begingroup",function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);var c=Symbol();a.mouth.saveState(c);new a.Scope;
c=a.scopes[a.scopes.length-1];c.semisimple=!0;a.openGroups.push(this);a.contexts.push({toString:function(){return"scope"},type:"scope"});this.ignore=!0;c.tokens.push(this);return[]}),bf:new H("bf",function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);a.tokens.push({type:"font modifier",value:"bf"});return[]}),catcode:new H("catcode",function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);var c=a.mouth.eat("integer");
if(c){if(0>c.value)return a.mouth.revert(),ra(this);if(!(c.value in d.cats)){d.cats[c.value]=new q(k.OTHER,0,15);for(var b=0,f=a.scopes.length;b<f;b++)a.scopes[b].cats[c.value]=new q((0==b?d:a.scopes[b-1]).cats[c.value])}return[a.lastScope.cats[c.value]]}return ra(this)}),"char":new H("char",function(a){var c=a.mouth.eat("integer");if(!c||0>c.value)return ra(this);a.mouth.queue.unshift({type:"character",cat:k.OTHER,"char":String.fromCodePoint(c.value),code:c.value});return[]}),chardef:new H("chardef",
function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(b&&"command"==b.type){if(b.name in d.defs.primitive||b.name in d.parameters)return a.mouth.loadState(c),ra(this);Xc(a.mouth);var f=a.mouth.eat("integer");if(!f||0>f.value)return a.mouth.loadState(c),ra(this);c=new Va([{type:"character",cat:k.OTHER,"char":String.fromCodePoint(f.value),code:f.value}],[]);if(a.toggles.global&&0<=a.lastScope.registers.named.globaldefs.value||
0<a.lastScope.registers.named.globaldefs.value){d.defs.macros[b.name]=c;delete d.registers.named[b.name];f=0;for(var e=a.scopes.length;f<e;f++)a.scopes[f].defs.macros[b.name]=c,delete a.scopes[f].registers.named[b.name]}else a.lastScope.defs.macros[b.name]=c,delete a.lastScope.registers.named[b.name];a.toggles.global=!1}else return a.mouth.loadState(c),ra(this)}),count:new H("count",function(a){var c=a.mouth.eat("integer");if(!c||0>c.value)return ra(this);if(!d.registers.count[c.value]){d.registers.count[c.value]=
new q(0);for(var b=0,f=a.scopes.length;b<f;b++)a.scopes[b].registers.count[c.value]=new q((b?a.scopes[b-1]:d).registers.count[c.value])}return[a.lastScope.registers.count[c.value]]}),countdef:new H("countdef",function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if("command"==b.type){if(b.name in d.defs.primitive||b.name in d.parameters)return a.mouth.loadState(c),ra(this);Xc(a.mouth);var f=a.mouth.eat("integer");
if(!f||0>f.value)return a.mouth.loadState(c),ra(this);b=b.name;f=f.value;if(!d.registers.count[f]){d.registers.count[f]=new q(0);c=0;for(var e=a.scopes.length;c<e;c++)a.scopes[c].registers.count[f]=new q((c?a.scopes[c-1]:d).registers.count[f])}if(a.toggles.global&&0<=a.lastScope.registers.named.globaldefs.value||0<a.lastScope.registers.named.globaldefs.value)for(d.registers.named[b]=d.registers.count[f],delete d.defs.macros[b],c=0,e=a.scopes.length;c<e;c++)a.scopes[c].registers.named[b]=a.scopes[c].registers.count[f],
delete a.scopes[c].defs.macros[b];else a.lastScope.registers.named[b]=a.lastScope.registers.count[f],delete a.lastScope.defs.macros[b]}else return a.mouth.loadState(c),ra(this)}),cr:new H("cr",function(a){if("scope"!=a.lastContext.type)return ra(this);for(var c=!1,b=a.scopes.length-1;0<=b;b--)if(a.scopes[b].isHalign||a.scopes[b].isHalignCell){c=a.scopes[b];break}if(!c)return ra(this);b=c.isHalign?c:c.parentScope;var f=c.isHalign?null:b.cellData[b.cellData.length-1];f&&f[f.length-1].omit&&(this.postPreamble=
!0);if(this.postPreamble&&!a.lastScope.isHalign&&!a.lastScope.isHalignCell)return this.invalid=!0,[this];if(c.isHalignCell){if(!this.postPreamble){var e=-1;a=0;for(c=f.length;a<c;a++)e+=f[a].span;if(b.preamble[e])e=b.preamble[e][1];else if(~b.repeatPreambleAt)a=b.preamble.slice(b.repeatPreambleAt,b.preamble.length),e=a[(e-b.repeatPreambleAt)%a.length][1];else return this.invalid=!0,[this];f=[];a=0;for(c=e.length;a<c;a++){b={};for(var l in e[a])b[l]=e[a][l];f.push(b)}this.postPreamble=!0;return f.concat(this)}a.scopes.last().root&&
(a.scopes.last().root.invalid=!0);a.contexts.pop();e=a.scopes.last().tokens;a.scopes.last().isFrac?(f[f.length-1].content.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:a.scopes.last().fracNumerator,denominator:e,barWidth:a.scopes.last().barWidth,delims:[a.scopes.last().fracLeftDelim,a.scopes.last().fracRightDelim],nullDelimiterSpace:new I(a.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),a.scopes.pop()):(a.scopes.pop(),f=a.scopes.last().cellData[a.scopes.last().cellData.length-
1],f[f.length-1].content=f[f.length-1].content.concat(e))}e=Symbol();f=!1;for(a.mouth.saveState(e);;)if(b=a.mouth.eat(),!b){a.mouth.loadState(e);a.scopes.last().noAligns.push(null);break}else if("character"==b.type&&b.cat!=k.ACTIVE){a.mouth.loadState(e);a.scopes.last().noAligns.push(null);break}else if("command"==b.type||"character"==b.type&&b.cat==k.ACTIVE){if(b.name in a.scopes.last().registers.named){a.mouth.loadState(e);a.scopes.last().noAligns.push(null);break}c="command"==b.type?a.scopes.last().defs.primitive[b.name]||
a.scopes.last().defs.macros[b.name]:a.scopes.last().defs.active[b["char"]];if(!c){a.mouth.loadState(e);a.scopes.last().noAligns.push(null);break}if(c===d.defs.primitive.the||c.proxy&&c.original===d.defs.primitive.the||c===d.defs.primitive.expandafter||c.proxy&&c.original===d.defs.primitive.expandafter||c===d.defs.primitive.number||c.proxy&&c.original===d.defs.primitive.number||c===d.defs.primitive.romannumeral||c.proxy&&c.original===d.defs.primitive.romannumeral||c===d.defs.primitive.csname||c.proxy&&
c.original===d.defs.primitive.csname||c===d.defs.primitive.string||c.proxy&&c.original===d.defs.primitive.string||c===d.defs.primitive["if"]||c.isLet&&c.original===d.defs.primitive["if"]||c===d.defs.primitive.ifcase||c.isLet&&c.original===d.defs.primitive.ifcase||c===d.defs.primitive.ifcat||c.isLet&&c.original===d.defs.primitive.ifcat||c===d.defs.primitive.ifdim||c.isLet&&c.original===d.defs.primitive.ifdim||c===d.defs.primitive.ifeof||c.isLet&&c.original===d.defs.primitive.ifeof||c===d.defs.primitive.iffalse||
c.isLet&&c.original===d.defs.primitive.iffalse||c===d.defs.primitive.ifodd||c.isLet&&c.original===d.defs.primitive.ifodd||c===d.defs.primitive.ifnum||c.isLet&&c.original===d.defs.primitive.ifnum||c===d.defs.primitive.ifhmode||c.isLet&&c.original===d.defs.primitive.ifhmode||c===d.defs.primitive.ifinner||c.isLet&&c.original===d.defs.primitive.ifinner||c===d.defs.primitive.ifmmode||c.isLet&&c.original===d.defs.primitive.ifmmode||c===d.defs.primitive.iftrue||c.isLet&&c.original===d.defs.primitive.iftrue||
c===d.defs.primitive.ifvmode||c.isLet&&c.original===d.defs.primitive.ifvmode||c===d.defs.primitive.ifvoid||c.isLet&&c.original===d.defs.primitive.ifvoid||c===d.defs.primitive.ifx||c.isLet&&c.original===d.defs.primitive.ifx){if(c=a.mouth.expand(b,a.mouth),1==c.length&&c[0]===b&&b.invalid){a.mouth.loadState(e);a.scopes.last().noAligns.push(null);break}}else{if(c===d.defs.primitive.noalign||c.proxy&&c.original===d.defs.primitive.noalign){a.mouth.preview().cat!=k.OPEN?(a.mouth.loadState(e),a.scopes.last().noAligns.push(null)):
f=!0;break}if("primitive"==c.type||c.proxy&&"primitive"==c.original.type){a.mouth.loadState(e);a.scopes.last().noAligns.push(null);break}c=a.mouth.expand(b,a.mouth);if(1==c.length&&c[0]==-b&&b.invalid){a.mouth.loadState(e);a.scopes.last().noAligns.push(null);break}}a.mouth.queue.unshift.apply(a.mouth.queue,c)}e=Symbol();for(a.mouth.saveState(e);;)if(b=a.mouth.eat(),!b){a.mouth.loadState(e);break}else if("character"==b.type&&b.cat!=k.ACTIVE){a.mouth.loadState(e);break}else if("command"==b.type||"character"==
b.type&&b.cat==k.ACTIVE){if(b.name in a.scopes.last().registers.named){a.mouth.loadState(e);break}c="command"==b.type?a.scopes.last().defs.primitive[b.name]||a.scopes.last().defs.macros[b.name]:a.scopes.last().defs.active[b["char"]];if(!c){a.mouth.loadState(e);break}if(c===d.defs.primitive.the||c.proxy&&c.original===d.defs.primitive.the||c===d.defs.primitive.expandafter||c.proxy&&c.original===d.defs.primitive.expandafter||c===d.defs.primitive.number||c.proxy&&c.original===d.defs.primitive.number||
c===d.defs.primitive.romannumeral||c.proxy&&c.original===d.defs.primitive.romannumeral||c===d.defs.primitive.csname||c.proxy&&c.original===d.defs.primitive.csname||c===d.defs.primitive.string||c.proxy&&c.original===d.defs.primitive.string||c===d.defs.primitive["if"]||c.isLet&&c.original===d.defs.primitive["if"]||c===d.defs.primitive.ifcase||c.isLet&&c.original===d.defs.primitive.ifcase||c===d.defs.primitive.ifcat||c.isLet&&c.original===d.defs.primitive.ifcat||c===d.defs.primitive.ifdim||c.isLet&&
c.original===d.defs.primitive.ifdim||c===d.defs.primitive.ifeof||c.isLet&&c.original===d.defs.primitive.ifeof||c===d.defs.primitive.iffalse||c.isLet&&c.original===d.defs.primitive.iffalse||c===d.defs.primitive.ifodd||c.isLet&&c.original===d.defs.primitive.ifodd||c===d.defs.primitive.ifnum||c.isLet&&c.original===d.defs.primitive.ifnum||c===d.defs.primitive.ifhmode||c.isLet&&c.original===d.defs.primitive.ifhmode||c===d.defs.primitive.ifinner||c.isLet&&c.original===d.defs.primitive.ifinner||c===d.defs.primitive.ifmmode||
c.isLet&&c.original===d.defs.primitive.ifmmode||c===d.defs.primitive.iftrue||c.isLet&&c.original===d.defs.primitive.iftrue||c===d.defs.primitive.ifvmode||c.isLet&&c.original===d.defs.primitive.ifvmode||c===d.defs.primitive.ifvoid||c.isLet&&c.original===d.defs.primitive.ifvoid||c===d.defs.primitive.ifx||c.isLet&&c.original===d.defs.primitive.ifx){if(c=a.mouth.expand(b,a.mouth),1==c.length&&c[0]===b&&b.invalid){a.mouth.loadState(e);break}}else{if(c===d.defs.primitive.crcr||c.proxy&&c.original===d.defs.primitive.crcr)break;
if("primitive"==c.type||c.proxy&&"primitive"==c.original.type){a.mouth.loadState(e);break}c=a.mouth.expand(b,a.mouth);if(1==c.length&&c[0]==-b&&b.invalid){a.mouth.loadState(e);break}}a.mouth.queue.unshift.apply(a.mouth.queue,c)}e=Symbol();for(a.mouth.saveState(e);;)if(b=a.mouth.eat()){if("character"==b.type&&b.cat==k.CLOSE){b=a.scopes.last();if(~b.repeatPreambleAt)for(l=Math.max.apply(Math,b.cellData.map(function(z){for(var g=0,n=0,x=z.length;n<x;n++)g+=z[n].span;return g})),f=b.tabSkips.slice(b.repeatPreambleAt+
1,b.tabSkips.length),c=0;b.tabSkips.length<l+1;)b.tabSkips.push(f[c]),c=(c+1)%f.length;a.scopes.pop();a.scopes.last().tokens.push({type:"atom",atomType:"inner",nucleus:[{type:"table",cellData:b.cellData,tabSkips:b.tabSkips,noAligns:b.noAligns}],superscript:null,subscript:null});return[]}if("character"==b.type&&b.cat!=k.ACTIVE){a.mouth.loadState(e);break}else if("command"==b.type||"character"==b.type&&b.cat==k.ACTIVE){if(b.name in a.scopes.last().registers.named){a.mouth.loadState(e);break}c="command"==
b.type?a.scopes.last().defs.primitive[b.name]||a.scopes.last().defs.macros[b.name]:a.scopes.last().defs.active[b["char"]];if(!c){a.mouth.loadState(e);break}if(c===d.defs.primitive.the||c.proxy&&c.original===d.defs.primitive.the||c===d.defs.primitive.expandafter||c.proxy&&c.original===d.defs.primitive.expandafter||c===d.defs.primitive.number||c.proxy&&c.original===d.defs.primitive.number||c===d.defs.primitive.romannumeral||c.proxy&&c.original===d.defs.primitive.romannumeral||c===d.defs.primitive.csname||
c.proxy&&c.original===d.defs.primitive.csname||c===d.defs.primitive.string||c.proxy&&c.original===d.defs.primitive.string||c===d.defs.primitive["if"]||c.isLet&&c.original===d.defs.primitive["if"]||c===d.defs.primitive.ifcase||c.isLet&&c.original===d.defs.primitive.ifcase||c===d.defs.primitive.ifcat||c.isLet&&c.original===d.defs.primitive.ifcat||c===d.defs.primitive.ifdim||c.isLet&&c.original===d.defs.primitive.ifdim||c===d.defs.primitive.ifeof||c.isLet&&c.original===d.defs.primitive.ifeof||c===d.defs.primitive.iffalse||
c.isLet&&c.original===d.defs.primitive.iffalse||c===d.defs.primitive.ifodd||c.isLet&&c.original===d.defs.primitive.ifodd||c===d.defs.primitive.ifnum||c.isLet&&c.original===d.defs.primitive.ifnum||c===d.defs.primitive.ifhmode||c.isLet&&c.original===d.defs.primitive.ifhmode||c===d.defs.primitive.ifinner||c.isLet&&c.original===d.defs.primitive.ifinner||c===d.defs.primitive.ifmmode||c.isLet&&c.original===d.defs.primitive.ifmmode||c===d.defs.primitive.iftrue||c.isLet&&c.original===d.defs.primitive.iftrue||
c===d.defs.primitive.ifvmode||c.isLet&&c.original===d.defs.primitive.ifvmode||c===d.defs.primitive.ifvoid||c.isLet&&c.original===d.defs.primitive.ifvoid||c===d.defs.primitive.ifx||c.isLet&&c.original===d.defs.primitive.ifx){if(c=a.mouth.expand(b,a.mouth),1==c.length&&c[0]===b&&b.invalid){a.mouth.loadState(e);break}}else{if("primitive"==c.type||c.proxy&&"primitive"==c.original.type){a.mouth.loadState(e);break}c=a.mouth.expand(b,a.mouth);if(1==c.length&&c[0]==-b&&b.invalid){a.mouth.loadState(e);break}}a.mouth.queue.unshift.apply(a.mouth.queue,
c)}}else{a.mouth.loadState(e);break}e=Symbol();a.mouth.saveState(e);for(a.scopes.last().cellData.push([{type:"cell",content:[],omit:!1,span:1}]);;)if(b=a.mouth.eat(),!b){a.mouth.loadState(e);break}else if("character"==b.type&&b.cat!=k.ACTIVE){a.mouth.loadState(e);break}else if("command"==b.type||"character"==b.type&&b.cat==k.ACTIVE){if(b.name in a.scopes.last().registers.named){a.mouth.loadState(e);break}c="command"==b.type?a.scopes.last().defs.primitive[b.name]||a.scopes.last().defs.macros[b.name]:
a.scopes.last().defs.active[b["char"]];if(!c){a.mouth.loadState(e);break}if(c===d.defs.primitive.the||c.proxy&&c.original===d.defs.primitive.the||c===d.defs.primitive.expandafter||c.proxy&&c.original===d.defs.primitive.expandafter||c===d.defs.primitive.number||c.proxy&&c.original===d.defs.primitive.number||c===d.defs.primitive.romannumeral||c.proxy&&c.original===d.defs.primitive.romannumeral||c===d.defs.primitive.csname||c.proxy&&c.original===d.defs.primitive.csname||c===d.defs.primitive.string||
c.proxy&&c.original===d.defs.primitive.string||c===d.defs.primitive["if"]||c.isLet&&c.original===d.defs.primitive["if"]||c===d.defs.primitive.ifcase||c.isLet&&c.original===d.defs.primitive.ifcase||c===d.defs.primitive.ifcat||c.isLet&&c.original===d.defs.primitive.ifcat||c===d.defs.primitive.ifdim||c.isLet&&c.original===d.defs.primitive.ifdim||c===d.defs.primitive.ifeof||c.isLet&&c.original===d.defs.primitive.ifeof||c===d.defs.primitive.iffalse||c.isLet&&c.original===d.defs.primitive.iffalse||c===
d.defs.primitive.ifodd||c.isLet&&c.original===d.defs.primitive.ifodd||c===d.defs.primitive.ifnum||c.isLet&&c.original===d.defs.primitive.ifnum||c===d.defs.primitive.ifhmode||c.isLet&&c.original===d.defs.primitive.ifhmode||c===d.defs.primitive.ifinner||c.isLet&&c.original===d.defs.primitive.ifinner||c===d.defs.primitive.ifmmode||c.isLet&&c.original===d.defs.primitive.ifmmode||c===d.defs.primitive.iftrue||c.isLet&&c.original===d.defs.primitive.iftrue||c===d.defs.primitive.ifvmode||c.isLet&&c.original===
d.defs.primitive.ifvmode||c===d.defs.primitive.ifvoid||c.isLet&&c.original===d.defs.primitive.ifvoid||c===d.defs.primitive.ifx||c.isLet&&c.original===d.defs.primitive.ifx){if(c=a.mouth.expand(b,a.mouth),1==c.length&&c[0]===b&&b.invalid){a.mouth.loadState(e);break}}else{if(c===d.defs.primitive.omit||c.proxy&&c.original===d.defs.primitive.omit){a.scopes.last().cellData[a.scopes.last().cellData.length-1][0].omit=!0;break}if("primitive"==c.type||c.proxy&&"primitive"==c.original.type){a.mouth.loadState(e);
break}c=a.mouth.expand(b,a.mouth);if(1==c.length&&c[0]==-b&&b.invalid){a.mouth.loadState(e);break}}a.mouth.queue.unshift.apply(a.mouth.queue,c)}b=a.scopes.last();a.contexts.push({toString:function(){return"scope"},type:"scope"});new a.Scope;a.scopes.last().isHalignCell=!0;a.scopes.last().noAligned=f;if(b.cellData[b.cellData.length-1][0].omit)return[];e=b.preamble[0][0];f=[];a=0;for(c=e.length;a<c;a++){b={};for(l in e[a])b[l]=e[a][l];f.push(b)}return f}),crcr:new H("crcr",null),csname:new H("csname",
function(a){var c=Symbol();a.mouth.saveState(c);for(var b=[];;){var f=a.mouth.eat("pre space");if(f){if(0!=b.length||f.cat!=k.WHITESPACE)if("command"==f.type||"character"==f.type&&f.cat==k.ACTIVE){if(f.name in a.scopes.last().registers.named)return this.invalid=!0,a.mouth.loadState(c),[this];var e="command"==f.type?a.scopes.last().defs.primitive[f.name]||a.scopes.last().defs.macros[f.name]:a.scopes.last().defs.active[f["char"]];if(!e)return this.invalid=!0,a.mouth.loadState(c),[this];e.proxy&&(e=
e.original);if(e===d.defs.primitive.endcsname)break;else if(e===d.defs.primitive.the||e===d.defs.primitive.expandafter||e===d.defs.primitive.number||e===d.defs.primitive.romannumeral||e===d.defs.primitive.csname||e===d.defs.primitive.string||e===d.defs.primitive["if"]||e===d.defs.primitive.ifcase||e===d.defs.primitive.ifcat||e===d.defs.primitive.ifdim||e===d.defs.primitive.ifeof||e===d.defs.primitive.iffalse||e===d.defs.primitive.ifodd||e===d.defs.primitive.ifnum||e===d.defs.primitive.ifhmode||e===
d.defs.primitive.ifinner||e===d.defs.primitive.ifmmode||e===d.defs.primitive.iftrue||e===d.defs.primitive.ifvmode||e===d.defs.primitive.ifvoid||e===d.defs.primitive.ifx){e=a.mouth.expand(f,a.mouth);if(1==e.length&&e[0]===f&&e[0].invalid)return this.invalid=!0,a.mouth.loadState(c),[this];a.mouth.queue.unshift.apply(a.mouth.queue,e);continue}else if(_instanceof(e,H))return this.invalid=!0,a.mouth.loadState(c),[this];e=a.mouth.expand(f,a.mouth);if(1==e.length&&e[0]===f&&e[0].invalid)return this.invalid=
!0,a.mouth.loadState(c),[this];a.mouth.queue.unshift.apply(a.mouth.queue,e)}else b.push(f)}else return this.invalid=!0,a.mouth.loadState(c),[this]}return[{type:"command",nameType:"command",escapeChar:String.fromCharCode(a.scopes.last().registers.named.escapechar.value),name:b.map(function(l){return l["char"]}).join("")}]}),day:new H("day",function(a){return[new q((new Date).getDate())]}),def:new H("def",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=
!0,[this];var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(!b)return this.invalid=!0,[this];if("character"==b.type)if(a.catOf(b["char"])==k.ACTIVE){var f="active";b=b["char"]}else return this.invalid=!0,a.mouth.loadState(c),[this];else if("command"==b.type&&(f="macro",b=b.name,b in a.scopes.last().defs.primitive||d.parameters.includes(b)))return this.invalid=!0,a.mouth.loadState(c),[this];for(var e=[],l=0,z=!1;;){var g=a.mouth.eat();if(g)if(g.cat==k.OPEN){a.mouth.revert();break}else if(g.cat==
k.PARAMETER){var n=a.mouth.eat("pre space");if(n)if(n.cat==k.OPEN)z=!0,a.mouth.revert(),e.push({type:"character",cat:k.OPEN,"char":n["char"],code:n.code});else if(48<n.code&&58>n.code&&n.cat==k.OTHER&&+n["char"]==l+1)e.push(g),l++;else return this.invalid=!0,a.mouth.loadState(c),[this];else return this.invalid=!0,a.mouth.loadState(c),[this]}else e.push(g);else return this.invalid=!0,a.mouth.loadState(c),[this]}l=0;n=[];for(var x=!1;;){if(g=a.mouth.eat("pre space"))if("character"!=g.type||g.cat!=k.PARAMETER||
x)if("character"==g.type&&g.cat==k.OPEN)l++;else if("character"==g.type&&g.cat==k.CLOSE){if(l--,0==l)break}else x&&(x=!1);else{var w=a.mouth.eat("pre space");if(w&&(w.cat==k.PARAMETER||w.cat==k.OTHER&&w["char"]<=e.length&&1<=w["char"]))a.mouth.revert(),w.cat==k.PARAMETER&&(x=!0);else return this.invalid=!0,a.mouth.loadState(c),[this]}else return this.invalid=!0,a.mouth.loadState(c),[this];n.push(g)}n.shift();z&&n.push(e[e.length-1]);c=new Va(n,e);if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||
0<a.scopes.last().registers.named.globaldefs.value)if("macro"==f)for(d.defs.macros[b]=c,delete d.registers.named[b],f=0,e=a.scopes.length;f<e;f++)a.scopes[f].defs.macros[b]=c,delete a.scopes[f].registers[b];else for(d.defs.active[b]=c,delete d.registers.named[b],f=0,e=a.scopes.length;f<e;f++)a.scopes[f].defs.ative[b]=c,delete a.scopes[f].registers[b];else a.scopes.last().defs["macro"==f?"macros":"active"][b]=c,delete a.scopes.last().registers.named[b];a.toggles.global=!1;return[]}),dimen:new H("dimen",
function(a){var c=a.mouth.eat("integer");if(!c||0>c.value)return this.invalid=!0,[this];if(!d.registers.dimen[c.value]){d.registers.dimen[c.value]=new I(0,0);for(var b=0,f=a.scopes.length;b<f;b++)a.scopes[b].registers.dimen[c.value]=new I((b?a.scopes[b-1]:d).registers.dimen[c.value])}return[a.scopes.last().registers.dimen[c.value]]}),dimendef:new H("dimendef",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);
var b=a.mouth.eat();if("command"==b.type){if(b.name in d.defs.primitive||b.name in d.parameters)return this.invalid=!0,a.mouth.loadState(c),[!0];var f=a.mouth.eat();f&&"character"==f.type&&"="==f["char"]&&f.cat==k.OTHER||f&&a.mouth.revert();f=a.mouth.eat("integer");if(!f||0>f.value)return this.invalid=!0,a.mouth.loadState(c),[!0];b=b.name;f=f.value;if(!d.registers.dimen[f]){d.registers.dimen[f]=new I(0,0);c=0;for(var e=a.scopes.length;c<e;c++)a.scopes[c].registers.dimen[f]=new I((c?a.scopes[c-1]:
d).registers.dimen[f])}if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(d.registers.named[b]=d.registers.dimen[f],delete d.defs.macros[b],c=0,e=a.scopes.length;c<e;c++)a.scopes[c].registers.named[b]=a.scopes[c].registers.dimen[f],delete a.scopes[c].defs.macros[b];else a.scopes.last().registers.named[b]=a.scopes.last().registers.dimen[f],delete a.scopes.last().defs.macros[b]}else return this.invalid=!0,a.mouth.loadState(countDefSym),
[!0]}),displaylimits:new H("displaylimits",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"limit modifier",value:"display",token:this});return[]}),displaystyle:new H("displaystyle",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"font modifier",value:"displaystyle"});return[]}),divide:new H("divide",function(a){if("superscript"==a.contexts.last||
"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();for(a.mouth.saveState(c);;){var b=a.mouth.eat();if(b&&("command"==b.type||"character"==b.type&&b.cat==k.ACTIVE))b=a.mouth.expand(b,a.mouth),a.mouth.queue.unshift.apply(a.mouth.queue,b);else if(b&&b.register)if(b&&b.register){var f=a.mouth.eat();if(!f||"character"!=f.type||"b"!=f["char"]&&"B"!=f["char"]||f.cat==k.ACTIVE)if(f)a.mouth.revert();else return this.invalid=!0,a.mouth.loadState(c),[this];else f=a.mouth.eat(),(!f||"character"!=
f.type||"y"!=f["char"]&&"Y"!=f["char"]||f.cat==k.ACTIVE)&&a.mouth.revert(2);if(f=a.mouth.eat("integer"))if("integer"==b.type){b.value=~~(b.value/f.value);c=b;if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.value=c.value;a.toggles.global=!1}else if("dimension"==b.type){b.sp.value=~~(b.sp.value/f.value);b.em.value=~~(b.em.value/f.value);c=b;if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||
0<a.scopes.last().registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.sp.value=c.sp.value,b.em.value=c.em.value;a.toggles.global=!1}else if("mu dimension"==b.type){b.mu.value=~~(b.mu.value/f.value);c=b;if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.mu.value=c.mu.value;a.toggles.global=!1}else if("glue"==b.type){b.start.sp.value=~~(b.start.sp.value/f.value);b.start.em.value=~~(b.start.em.value/
f.value);"infinite dimension"==b.stretch.type?b.stretch.number.value=~~(b.stretch.number.value/f.value):(b.stretch.sp.value=~~(b.stretch.sp.value/f.value),b.stretch.em.value=~~(b.stretch.em.value/f.value));"infinite dimension"==b.shrink.type?b.shrink.number.value=~~(b.shrink.number.value/f.value):(b.shrink.sp.value=~~(b.shrink.sp.value/f.value),b.shrink.em.value=~~(b.shrink.em.value/f.value));c=b;if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(;b.parent;)b=
b.parent,b.start.sp.value=c.start.sp.value,b.start.em.value=c.start.em.value,b.stretch="infinite dimension"==c.stretch.type?new oa(c.stretch.number.value,c.stretch.magnitude.value):new I(c.stretch.sp.value,c.stretch.em.value),b.shrink="infinite dimension"==c.shrink.type?new oa(c.shrink.number.value,c.shrink.magnitude.value):new I(c.shrink.sp.value,c.shrink.em.value);a.toggles.global=!1}else{if("mu glue"==b.type){b.start.mu.value=~~(b.start.mu.value/f.value);"infinite dimension"==b.stretch.type?b.stretch.number.value=
~~(b.stretch.number.value/f.value):b.stretch.mu.value=~~(b.stretch.mu.value/f.value);"infinite dimension"==b.shrink.type?b.shrink.number.value=~~(b.shrink.number.value/f.value):b.shrink.mu.value=~~(b.shrink.mu.value/f.value);c=b;if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.start.mu.value=c.start.mu.value,b.stretch="infinite dimension"==c.stretch.type?new oa(c.stretch.number.value,c.stretch.magnitude.value):
new Ba(c.stretch.mu.value),b.shrink="infinite dimension"==c.shrink.type?new oa(c.shrink.number.value,c.shrink.magnitude.value):new Ba(c.shrink.mu.value);a.toggles.global=!1}}else return this.invalid=!0,a.mouth.loadState(c),[this];break}else return this.invalid=!0,a.mouth.loadState(c),[this];else return this.invalid=!0,a.mouth.loadState(c),[this]}return[]}),edef:new H("edef",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);
var b=a.mouth.eat();if(!b)return this.invalid=!0,[this];if("character"==b.type)if(a.catOf(b["char"])==k.ACTIVE){var f="active";b=b["char"]}else return this.invalid=!0,a.mouth.loadState(c),[this];else if("command"==b.type&&(f="macro",b=b.name,b in a.scopes.last().defs.primitive||b in d.parameters))return this.invalid=!0,a.mouth.loadState(c),[this];for(var e=[],l=0,z=!1;;){var g=a.mouth.eat();if(g)if(g.cat==k.OPEN){a.mouth.revert();break}else if(g.cat==k.PARAMETER){var n=a.mouth.eat("pre space");if(n)if(n.cat==
k.OPEN)z=!0,a.mouth.revert(),e.push({type:"character",cat:k.OPEN,"char":n["char"],code:n.code});else if(48<n.code&&58>n.code&&n.cat==k.OTHER&&+n["char"]==l+1)e.push(g),l++;else return this.invalid=!0,a.mouth.loadState(c),[this];else return this.invalid=!0,a.mouth.loadState(c),[this]}else e.push(g);else return this.invalid=!0,a.mouth.loadState(c),[this]}l=0;n=[];for(var x=!1,w=!1;;)if(g=a.mouth.eat())if("character"!=g.type||g.cat!=k.PARAMETER||w)if("character"==g.type&&g.cat==k.OPEN)l++,n.push(g),
x=!1;else if("character"==g.type&&g.cat==k.CLOSE){l--;if(0==l)break;n.push(g);x=!1}else if(x)n.push(g),x=!1;else if("command"==g.type||"character"==g.type&&g.cat==k.ACTIVE)if(g.name in a.scopes.last().registers.named)n.push(g);else{var v="command"==g.type?a.scopes.last().defs.primitive[g.name]||a.scopes.last().defs.macros[g.name]:a.scopes.last().defs.active[g["char"]];if(!v)return this.invalid=!0,a.mouth.loadState(c),[this];if(v===d.defs.primitive.the||v.proxy&&v.original===d.defs.primitive.the||
v===d.defs.primitive.expandafter||v.proxy&&v.original===d.defs.primitive.expandafter||v===d.defs.primitive.number||v.proxy&&v.original===d.defs.primitive.number||v===d.defs.primitive.romannumeral||v.proxy&&v.original===d.defs.primitive.romannumeral||v===d.defs.primitive.csname||v.proxy&&v.original===d.defs.primitive.csname||v===d.defs.primitive.string||v.proxy&&v.original===d.defs.primitive.string||v===d.defs.primitive["if"]||v.isLet&&v.original===d.defs.primitive["if"]||v===d.defs.primitive.ifcase||
v.isLet&&v.original===d.defs.primitive.ifcase||v===d.defs.primitive.ifcat||v.isLet&&v.original===d.defs.primitive.ifcat||v===d.defs.primitive.ifdim||v.isLet&&v.original===d.defs.primitive.ifdim||v===d.defs.primitive.ifeof||v.isLet&&v.original===d.defs.primitive.ifeof||v===d.defs.primitive.iffalse||v.isLet&&v.original===d.defs.primitive.iffalse||v===d.defs.primitive.ifodd||v.isLet&&v.original===d.defs.primitive.ifodd||v===d.defs.primitive.ifnum||v.isLet&&v.original===d.defs.primitive.ifnum||v===d.defs.primitive.ifhmode||
v.isLet&&v.original===d.defs.primitive.ifhmode||v===d.defs.primitive.ifinner||v.isLet&&v.original===d.defs.primitive.ifinner||v===d.defs.primitive.ifmmode||v.isLet&&v.original===d.defs.primitive.ifmmode||v===d.defs.primitive.iftrue||v.isLet&&v.original===d.defs.primitive.iftrue||v===d.defs.primitive.ifvmode||v.isLet&&v.original===d.defs.primitive.ifvmode||v===d.defs.primitive.ifvoid||v.isLet&&v.original===d.defs.primitive.ifvoid||v===d.defs.primitive.ifx||v.isLet&&v.original===d.defs.primitive.ifx){v=
a.mouth.expand(g,a.mouth);if(1==v.length&&v[0]===g&&g.invalid)return this.invalid=!0,a.mouth.loadState(c),[this];a.mouth.queue.unshift.apply(a.mouth.queue,v)}else v===d.defs.primitive.noexpand||v.proxy&&v.original===d.defs.primitive.noexpand?x=!0:_instanceof(v,H)||v.proxy&&_instanceof(v.original,H)?n.push(g):a.mouth.queue.unshift.apply(a.mouth.queue,a.mouth.expand(g,a.mouth))}else n.push(g);else{if((v=a.mouth.eat("pre space"))&&(v.cat==k.PARAMETER||v.cat==k.OTHER&&v["char"]<=e.length&&1<=v["char"]))a.mouth.revert(),
v.cat==k.PARAMETER&&(w=!0);else return this.invalid=!0,a.mouth.loadState(c),[this];n.push(g);x=!1}else return this.invalid=!0,a.mouth.loadState(c),[this];n.shift();z&&n.push(e[e.length-1]);v=new Va(n,e);if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)if("macro"==f)for(d.defs.macros[b]=v,delete d.registers.named[b],c=0,f=a.scopes.length;c<f;c++)a.scopes[c].defs.macros[b]=v,delete a.scopes[c].registers.named[b];else for(d.defs.active[b]=
v,delete d.registers.named[b],c=0,f=a.scopes.length;c<f;c++)a.scopes[c].defs.ative[b]=v,delete a.scopes[c].registers.named[b];else a.scopes.last().defs["macro"==f?"macros":"active"][b]=v,delete a.scopes.last().registers.named[b];a.toggles.global=!1;return[]}),"else":new H("else",function(a){return ra(this)}),endcsname:new H("endcsname",function(a){return ra(this)}),endgroup:new H("endgroup",function(a){if(!a.openGroups.length||a.scopes.last().delimited||a.scopes.last().isHalign||a.scopes.last().isHalignCell||
!a.scopes.last().semisimple||"scope"!=a.contexts.last)return this.invalid=!0,[this];a.scopes.last().root&&(a.scopes.last().root.invalid=!0);a.openGroups.pop();a.contexts.pop();var c=a.scopes.last().tokens;a.scopes.last().isFrac?(a.scopes[a.scopes.length-2].tokens.push({type:"atom",atomType:0,nucleus:[{type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:a.scopes.last().fracNumerator,denominator:c,barWidth:a.scopes.last().barWidth,delims:[a.scopes.last().fracLeftDelim,a.scopes.last().fracRightDelim],
nullDelimiterSpace:new I(a.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}],superscript:null,subscript:null}),a.scopes.pop()):(a.scopes.pop(),a.scopes.last().tokens.push({type:"atom",atomType:0,nucleus:c,superscript:null,subscript:null}))}),Error:new H("Error",function(a){var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(b&&"character"==b.type&&b.cat==k.OPEN){for(var f=0,e=[];;)if(b=a.mouth.eat("pre space"))if("character"==b.type&&b.cat==k.OPEN)f++,e.push(b["char"]);
else if("character"==b.type&&b.cat==k.CLOSE){if(!f)break;f--;e.push(b["char"])}else"command"==b.type?(e.push(b.escapeChar),e.push.apply(e,b.name.split(""))):e.push(b["char"]);else return this.invalid=!0,a.mouth.loadState(c),[this];return e.map(function(l){return{type:"character","char":l,code:l.charCodeAt(0),cat:12,invalid:!0,recognized:!0}})}this.invalid=!0;return[this]}),expandafter:new H("expandafter",function(a){var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(!b)return this.invalid=
!0,[this];var f=a.mouth.eat(),e=a.mouth.expand(f,a.mouth);return 1==e.length&&e[0]===f&&f.invalid?(this.invalid=!0,a.mouth.loadState(c),[this]):[b].concat(e)}),ExpandedError:new H("ExpandedError",function(a){var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(b&&"character"==b.type&&b.cat==k.OPEN){for(var f=0,e=[],l=!1;;)if(b=a.mouth.eat("pre space")){if("character"==b.type&&b.cat==k.OPEN)f++,e.push(b["char"]);else if("character"==b.type&&b.cat==k.CLOSE){if(!f)break;f--;e.push(b["char"])}else if("command"==
b.type||"character"==b.type&&b.cat==k.ACTIVE){var z="command"==b.type?a.scopes.last().defs.primitive[b.name]||a.scopes.last().defs.macros[b.name]:a.scopes.last().defs.active[b["char"]];if(!z)return this.invalid=!0,a.mouth.loadState(c),[this];z.proxy&&(z=z.original);if(z===d.defs.primitive.noexpand){l=!0;continue}else if(!l&&(z===d.defs.primitive.the||z===d.defs.primitive.expandafter||z===d.defs.primitive.number||z===d.defs.primitive.romannumeral||z===d.defs.primitive.csname||z===d.defs.primitive.string||
z===d.defs.primitive["if"]||z===d.defs.primitive.ifcase||z===d.defs.primitive.ifcat||z===d.defs.primitive.ifdim||z===d.defs.primitive.ifeof||z===d.defs.primitive.iffalse||z===d.defs.primitive.ifodd||z===d.defs.primitive.ifnum||z===d.defs.primitive.ifhmode||z===d.defs.primitive.ifinner||z===d.defs.primitive.ifmmode||z===d.defs.primitive.iftrue||z===d.defs.primitive.ifvmode||z===d.defs.primitive.ifvoid||z===d.defs.primitive.ifx)){l=a.mouth.expand(b,a.mouth);if(1==l.length&&l[0]===b&&l[0].invalid)return this.invalid=
!0,a.mouth.loadState(c),[this];a.mouth.queue.unshift.apply(a.mouth.queue,l);l=!1;continue}else if(_instanceof(z,H)){e.push(String.fromCharCode(a.scopes.last().registers.named.escapechar.value));e.push.apply(e,z.name.split(""));l=!1;continue}if(l)e.push(String.fromCharCode(a.scopes.last().registers.named.escapechar.value)),e.push.apply(e,b.name.split(""));else{l=a.mouth.expand(b,a.mouth);if(1==l.length&&l[0]===b&&l[0].invalid)return this.invalid=!0,a.mouth.loadState(c),[this];a.mouth.queue.unshift.apply(a.mouth.queue,
l)}}else e.push(b["char"]);l=!1}else return this.invalid=!0,a.mouth.loadState(c),[this];return e.map(function(g){return{type:"character","char":g,code:g.charCodeAt(0),cat:12,invalid:!0,recognized:!0}})}this.invalid=!0;return[this]}),fi:new H("fi",function(a){return ra(this)}),futurelet:new H("futurelet",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(!b)return this.invalid=!0,[this];
if("character"==b.type)if(a.catOf(b["char"])==k.ACTIVE){var f="active";b=b["char"]}else return this.invalid=!0,a.mouth.loadState(c),[this];else if("command"==b.type&&(f="macro",b=b.name,b in a.scopes.last().defs.primitive||b in d.parameters))return this.invalid=!0,a.mouth.loadState(c),[this];var e=a.mouth.eat();e&&"character"==e.type&&"="==e["char"]&&e.cat==k.OTHER||e&&a.mouth.revert();e=a.mouth.eat();if(!e)return this.invalid=!0,a.mouth.loadState(c),[this];var l=a.mouth.eat();if(l)if("command"==
l.type||"character"==l.type&&l.cat==k.ACTIVE)if(c="command"==l.type?a.scopes.last().defs.primitive[l.name]||a.scopes.last().defs.macros[l.name]:a.scopes.last().defs.active[l.name])c=new Va(c,"primitive"==c.type||c.isLet);else{if("command"==l.type&&"macro"==f){var z=a.scopes.last().registers.named[l.name];if(z){if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value){d.registers.named[b]=z;delete d.defs.macros[b];var g=0;for(f=a.scopes.length;g<
f;g++)a.scopes[g].registers.named[b]=z,delete a.scopes[g].defs.macros[b]}else a.scopes.last().registers.named[b]=z,delete a.scopes.last().defs.macros[b];a.toggles.global=!1;return[]}}}else c=new Va(new Va([l]),!0);else return this.invalid=!0,a.mouth.loadState(c),[this];if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)if("macro"==f)for(c?d.defs.macros[b]=c:delete d.defs.macros[b],delete d.registers.named[b],g=0,f=a.scopes.length;g<
f;g++)c?a.scopes[g].defs.macros[b]=c:delete a.scopes[g].defs.macros[b],delete a.scopes[g].registers.named[b];else for(c?d.defs.active[b]=c:delete a.scopes[g].defs.macros[b],delete d.registers.named[b],g=0,f=a.scopes.length;g<f;g++)c?a.scopes[g].defs.ative[b]=c:delete a.scopes[g].defs.macros[b],delete a.scopes[g].registers.named[b];else c?a.scopes.last().defs["macro"==f?"macros":"active"][b]=c:delete a.scopes.last().defs["macro"==f?"macros":"active"][b],delete a.scopes.last().registers.named[b];a.toggles.global=
!1;return[e,l]}),gdef:new H("gdef",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(!b)return this.invalid=!0,[this];if("character"==b.type)if(a.catOf(b["char"])==k.ACTIVE){var f="active";b=b["char"]}else return this.invalid=!0,a.mouth.loadState(c),[this];else if("command"==b.type&&(f="macro",b=b.name,b in a.scopes.last().defs.primitive||b in d.parameters))return this.invalid=!0,a.mouth.loadState(c),
[this];for(var e=[],l=0,z=!1;;){var g=a.mouth.eat();if(g)if(g.cat==k.OPEN){a.mouth.revert();break}else if(g.cat==k.PARAMETER){var n=a.mouth.eat("pre space");if(n)if(n.cat==k.OPEN)z=!0,a.mouth.revert(),e.push({type:"character",cat:k.OPEN,"char":n["char"],code:n.code});else if(48<n.code&&58>n.code&&n.cat==k.OTHER&&+n["char"]==l+1)e.push(g),l++;else return this.invalid=!0,a.mouth.loadState(c),[this];else return this.invalid=!0,a.mouth.loadState(c),[this]}else e.push(g);else return this.invalid=!0,a.mouth.loadState(c),
[this]}l=0;n=[];for(var x=!1;;){g=a.mouth.eat();if(!g)return this.invalid=!0,a.mouth.loadState(c),[this];if("character"==g.type&&g.cat==k.PARAMETER&&!x){var w=a.mouth.eat("pre space");if(w&&(w.cat==k.PARAMETER||w.cat==k.OTHER&&w["char"]<=e.length&&1<=w["char"]))a.mouth.revert(),w.cat==k.PARAMETER&&(x=!0);else return this.invalid=!0,a.mouth.loadState(c),[this]}else if("character"==g.type&&g.cat==k.OPEN)l++;else if("character"==g.type&&g.cat==k.CLOSE&&(l--,0==l))break;n.push(g)}n.shift();z&&n.push(e[e.length-
1]);c=new Va(n,e);if(0>a.scopes.last().registers.named.globaldefs.value)a.scopes.last().defs["macro"==f?"macros":"active"][b]=c,delete a.scopes.last().registers.named[b];else if("macro"==f)for(d.defs.macros[b]=c,delete d.registers.named[b],f=0,e=a.scopes.length;f<e;f++)a.scopes[f].defs.macros[b]=c,delete a.scopes[f].registers.named[b];else for(d.defs.active[b]=c,delete d.registers.named[b],f=0,e=a.scopes.length;f<e;f++)a.scopes[f].defs.ative[b]=c,delete a.scopes[f].registers.named[b];a.toggles.global=
!1;return[]}),global:new H("global",function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);a.toggles.global=this;this.ignore=!0;return[this]}),halign:new H("halign",function(a){var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(!b||b.cat!=k.OPEN)return a.mouth.loadState(c),ra(this);b=[[[]]];for(var f=-1,e=[new Ia(a.lastScope.registers.named.tabskip)],l=!1;;){var z=a.mouth.eat("pre space");if(!z)return a.mouth.loadState(c),ra(this);if(xc(z)){var g=
"command"==z.type?a.lastScope.defs.primitive[z.name]||a.lastScope.defs.macros[z.name]||a.lastScope.registers.named[z.name]:a.lastScope.defs.active[z["char"]];g&&g.proxy&&(g=g.original);if(!g){(b[b.length-1][1]||b[b.length-1][0]).push(z);continue}else if(g===d.defs.primitive.cr)if(b[b.length-1][1]){e.push(new Ia(a.lastScope.registers.named.tabskip));c=l||e[0];l=a.lastScope.registers.named.tabskip;l.start.sp.value=c.start.sp.value;l.start.em.value=c.start.em.value;l.stretch="infinite dimension"==c.stretch.type?
new oa(c.stretch.number.value,c.stretch.magnitude.value):new I(c.stretch.sp.value,c.stretch.em.value);l.shrink="infinite dimension"==c.shrink.type?new oa(c.shrink.number.value,c.shrink.magnitude.value):new I(c.shrink.sp.value,c.shrink.em.value);break}else return a.mouth.loadState(c),ra(this);else if(g===a.lastScope.registers.named.tabskip){var n=Symbol();a.mouth.saveState(n);Xc();g=a.mouth.eat("glue");if(!g){a.mouth.loadState(n);(b[b.length-1][1]||b[b.length-1][0]).push(z);continue}z=a.lastScope.registers.named.tabskip;
z.start.sp.value=g.start.sp.value;z.start.em.value=g.start.em.value;z.stretch="infinite dimension"==g.stretch.type?new oa(g.stretch.number.value,g.stretch.magnitude.value):new I(g.stretch.sp.value,g.stretch.em.value);z.shrink="infinite dimension"==g.shrink.type?new oa(g.shrink.number.value,g.shrink.magnitude.value):new I(g.shrink.sp.value,g.shrink.em.value);if(0<a.lastScope.registers.named.globaldefs.value)for(l=new Ia(z);z.parent;)z=z.parent,z.start.sp.value=g.start.sp.value,z.start.em.value=g.start.em.value,
z.stretch="infinite dimension"==g.stretch.type?new oa(g.stretch.number.value,g.stretch.magnitude.value):new I(g.stretch.sp.value,g.stretch.em.value),"infinite dimension"==g.shrink.type?e.shrink=new oa(g.shrink.number.value,g.shrink.magnitude.value):z.shrink=new I(g.shrink.sp.value,g.shrink.em.value);continue}else if(g===d.defs.primitive.span){z=a.mouth.eat();if(!z)return a.mouth.loadState(c),ra(this);g=a.mouth.expand(z,a.mouth);if(1==g.length&&g[0]===z&&z.invalid)return a.mouth.loadState(c),ra(this);
a.mouth.queue.unshift.apply(a.mouth.queue,g);continue}else if(g.replacement&&g.replacement[0]&&g.replacement[0].cat==k.PARAMETER){if(b[b.length-1][1])return a.mouth.loadState(c),ra(this);b[b.length-1][1]=[];continue}else if(g.replacement&&g.replacement[0]&&g.replacement[0].cat==k.ALIGN){if(~f||b[b.length-1][0].length||b[b.length-1][1])if(b[b.length-1][1])b.push([[]]),e.push(new Ia(a.lastScope.registers.named.tabskip));else return a.mouth.loadState(c),ra(this);else f=b.length-1;continue}}else if(z.cat==
k.PARAMETER){if(b[b.length-1][1])return a.mouth.loadState(c),ra(this);b[b.length-1][1]=[];continue}else if(z.cat==k.ALIGN){if(~f||b[b.length-1][0].length||b[b.length-1][1])if(b[b.length-1][1])b.push([[]]),e.push(new Ia(a.lastScope.registers.named.tabskip));else return a.mouth.loadState(c),ra(this);else f=b.length-1;continue}else if(z.cat==k.WHITESPACE&&!b[b.length-1][0].length&&!b[b.length-1][1])continue;(b[b.length-1][1]||b[b.length-1][0]).push(z)}c={type:"atom",atomType:L.ORD,nucleus:("command"==
this.type?this.escapeChar+this.name:this["char"]).split("").map(function(x){return{type:"atom",atomType:L.ORD,nucleus:{type:"symbol","char":x,code:x.codePointAt(0)},superscript:null,subscript:null}}),superscript:null,subscript:null,ignore:!0};a.openGroups.push(c);a.contexts.push({toString:function(){return"scope"},type:"scope"});new a.Scope;l=a.scopes[a.scopes.length-1];l.tokens.push(c);l.isHalign=!0;l.cellData=[];l.preamble=b;l.repeatPreambleAt=f;l.tabSkips=e;l.noAligns=[];a.mouth.revert();return[]}),
hbox:new H("hbox",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);for(var b,f;;){var e=a.mouth.eat();if(!e)return this.invalid=!0,[this];if("command"==e.type||"character"==e.type&&e.cat==k.ACTIVE){var l="command"==e.type?a.scopes.last().defs.primitive[e.name]||a.scopes.last().defs.macros[e.name]:a.scopes.last().defs.active[e["char"]];if(l&&(l===d.defs.primitive.relax||l.proxy&&l.original===d.defs.primitive.relax))break;
e=a.mouth.expand(e,a.mouth);a.mouth.queue.unshift.apply(a.mouth.queue,e)}else if("character"!=e.type||"t"!=e["char"]&&"T"!=e["char"])if("character"!=e.type||"s"!=e["char"]&&"S"!=e["char"])if("character"==e.type&&e.cat==k.OPEN){a.mouth.revert();break}else return this.invalid=!0,a.mouth.loadState(c),[this];else{b=a.mouth.eat();e=a.mouth.eat();l=a.mouth.eat();var z=a.mouth.eat(),g=a.mouth.eat();if(!b||"character"!=b.type||"p"!=b["char"]&&"P"!=b["char"]||b.cat==k.ACTIVE||!e||"character"!=e.type||"r"!=
e["char"]&&"R"!=e["char"]||e.cat==k.ACTIVE||!l||"character"!=l.type||"e"!=l["char"]&&"E"!=l["char"]||l.cat==k.ACTIVE||!z||"character"!=z.type||"a"!=z["char"]&&"A"!=z["char"]||z.cat==k.ACTIVE||!g||"character"!=g.type||"d"!=g["char"]&&"D"!=g["char"]||g.cat==k.ACTIVE||!(e=a.mouth.eat("dimension")))return this.invalid=!0,a.mouth.loadState(c),[this];b=e;break}else if(f=a.mouth.eat("pre space"),f&&"character"==f.type&&("o"==f["char"]||"O"==e["char"])&&e.cat!=k.ACTIVE&&(e=a.mouth.eat("dimension"))){f=e;
break}else return this.invalid=!0,a.mouth.loadState(c),[this]}e=a.mouth.preview();if(!e||"character"!=e.type||e.cat!=k.OPEN)return this.invalid=!0,a.mouth.loadState(c),[this];f||b||(b=new I(0,0));a.tokens.push({type:"box wrapper",value:"horizontal",to:f,spread:b,token:this});return[]}),hfil:new H("hfil",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"glue",glue:new Ia(new I(0),new oa(65536,1),new I(0))});return[]}),hfill:new H("hfill",
function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"glue",glue:new Ia(new I(0),new oa(65536,2),new I(0))});return[]}),hrule:new H("hrule",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);for(var b=c=!1,f=!1;;){var e=a.mouth.eat();if(!e)break;if("h"!=e["char"]&&"H"!=e["char"]||e.cat==k.ACTIVE)if("d"!=e["char"]&&"D"!=e["char"]||e.cat==
k.ACTIVE)if("w"!=e["char"]&&"W"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert();else if(e=a.mouth.eat("pre space"),!e||"i"!=e["char"]&&"I"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?2:1);else if(e=a.mouth.eat("pre space"),!e||"d"!=e["char"]&&"D"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?3:2);else if(e=a.mouth.eat("pre space"),!e||"t"!=e["char"]&&"T"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?4:3);else if(e=a.mouth.eat("pre space"),!e||"h"!=e["char"]&&"H"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?
5:4);else if(e=a.mouth.eat("dimension")){f=e;continue}else a.mouth.revert(5);else if(e=a.mouth.eat("pre space"),!e||"e"!=e["char"]&&"E"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?2:1);else if(e=a.mouth.eat("pre space"),!e||"p"!=e["char"]&&"P"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?3:2);else if(e=a.mouth.eat("pre space"),!e||"t"!=e["char"]&&"T"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?4:3);else if(e=a.mouth.eat("pre space"),!e||"h"!=e["char"]&&"H"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?
5:4);else if(e=a.mouth.eat("dimension")){b=e;continue}else a.mouth.revert(5);else if(e=a.mouth.eat("pre space"),!e||"e"!=e["char"]&&"E"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?2:1);else if(e=a.mouth.eat("pre space"),!e||"i"!=e["char"]&&"I"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?3:2);else if(e=a.mouth.eat("pre space"),!e||"g"!=e["char"]&&"G"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?4:3);else if(e=a.mouth.eat("pre space"),!e||"h"!=e["char"]&&"H"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?
5:4);else if(e=a.mouth.eat("pre space"),!e||"t"!=e["char"]&&"T"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?6:5);else if(e=a.mouth.eat("dimension")){c=e;continue}else a.mouth.revert(6);break}c=c||new I(0,65536/30);b=b||new I(0,0);a.tokens.push({type:"rule",ruleType:"h",height:c,depth:b,width:f});return[]}),hskip:new H("hskip",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=a.mouth.eat("glue");if(!c)return this.invalid=!0,[this];a.tokens.push({type:"glue",
glue:c});return[]}),"if":new H("if",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);for(var b=[],f=!1;2>b.length;){var e=a.mouth.eat("pre space");if(e){if("character"!=e.type||e.cat!=k.WHITESPACE||0!=b.length)if("character"==e.type&&b.cat!=k.ACTIVE)b.push(e),f=!1;else if(f)b.push(e),f=!1;else if("command"==e.type||"character"==e.type&&e.cat==k.ACTIVE)if(e.name in a.scopes.last().registers.named)b.push(e);
else{var l="command"==e.type?a.scopes.last().defs.primitive[e.name]||a.scopes.last().defs.macros[e.name]:a.scopes.last().defs.active[e["char"]];if(!l)return this.invalid=!0,a.mouth.loadState(c),[this];if(l===d.defs.primitive.the||l.proxy&&l.original===d.defs.primitive.the||l===d.defs.primitive.expandafter||l.proxy&&l.original===d.defs.primitive.expandafter||l===d.defs.primitive.number||l.proxy&&l.original===d.defs.primitive.number||l===d.defs.primitive.romannumeral||l.proxy&&l.original===d.defs.primitive.romannumeral||
l===d.defs.primitive.csname||l.proxy&&l.original===d.defs.primitive.csname||l===d.defs.primitive.string||l.proxy&&l.original===d.defs.primitive.string||l===d.defs.primitive["if"]||l.isLet&&l.original===d.defs.primitive["if"]||l===d.defs.primitive.ifcase||l.isLet&&l.original===d.defs.primitive.ifcase||l===d.defs.primitive.ifcat||l.isLet&&l.original===d.defs.primitive.ifcat||l===d.defs.primitive.ifdim||l.isLet&&l.original===d.defs.primitive.ifdim||l===d.defs.primitive.ifeof||l.isLet&&l.original===d.defs.primitive.ifeof||
l===d.defs.primitive.iffalse||l.isLet&&l.original===d.defs.primitive.iffalse||l===d.defs.primitive.ifodd||l.isLet&&l.original===d.defs.primitive.ifodd||l===d.defs.primitive.ifnum||l.isLet&&l.original===d.defs.primitive.ifnum||l===d.defs.primitive.ifhmode||l.isLet&&l.original===d.defs.primitive.ifhmode||l===d.defs.primitive.ifinner||l.isLet&&l.original===d.defs.primitive.ifinner||l===d.defs.primitive.ifmmode||l.isLet&&l.original===d.defs.primitive.ifmmode||l===d.defs.primitive.iftrue||l.isLet&&l.original===
d.defs.primitive.iftrue||l===d.defs.primitive.ifvmode||l.isLet&&l.original===d.defs.primitive.ifvmode||l===d.defs.primitive.ifvoid||l.isLet&&l.original===d.defs.primitive.ifvoid||l===d.defs.primitive.ifx||l.isLet&&l.original===d.defs.primitive.ifx){l=a.mouth.expand(e,a.mouth);if(1==l.length&&l[0]===e&&e.invalid)return this.invalid=!0,a.mouth.loadState(c),[this];a.mouth.queue.unshift.apply(a.mouth.queue,l)}else if(l===d.defs.primitive.noexpand||l.proxy&&l.original===d.defs.primitive.noexpand)f=!0;
else if(_instanceof(l,H)||l.proxy&&_instanceof(l.original,H))b.push(e);else{l=a.mouth.expand(e,a.mouth);if(1==l.length&&l[0]==-e&&e.invalid)return this.invalid=!0,a.mouth.loadState(c),[this];a.mouth.queue.unshift.apply(a.mouth.queue,l)}}else b.push(e)}else return this.invalid=!0,a.mouth.loadState(c),[this]}return Xa.call(this,"command"==b[0].type&&"command"==b[1].type||"character"==b[0].type&&b[0]["char"]==b[1]["char"],a.mouth,a.scopes,c)}),ifcase:new H("ifcase",function(a){function c(z){for(;;){var g=
a.mouth.eat();if(!g)break;else if("command"==g.type||"character"==g.type&&g.cat===k.ACTIVE)if(g="command"==g.type?a.scopes.last().defs.primitive[g.name]||a.scopes.last().defs.macros[g.name]:a.scopes.last().defs.active[g["char"]])if(g===d.defs.primitive["if"]||g.isLet&&g.original===d.defs.primitive["if"]||g===d.defs.primitive.ifcase||g.isLet&&g.original===d.defs.primitive.ifcase||g===d.defs.primitive.ifcat||g.isLet&&g.original===d.defs.primitive.ifcat||g===d.defs.primitive.ifdim||g.isLet&&g.original===
d.defs.primitive.ifdim||g===d.defs.primitive.ifeof||g.isLet&&g.original===d.defs.primitive.ifeof||g===d.defs.primitive.iffalse||g.isLet&&g.original===d.defs.primitive.iffalse||g===d.defs.primitive.ifodd||g.isLet&&g.original===d.defs.primitive.ifodd||g===d.defs.primitive.ifnum||g.isLet&&g.original===d.defs.primitive.ifnum||g===d.defs.primitive.ifhmode||g.isLet&&g.original===d.defs.primitive.ifhmode||g===d.defs.primitive.ifinner||g.isLet&&g.original===d.defs.primitive.ifinner||g===d.defs.primitive.ifmmode||
g.isLet&&g.original===d.defs.primitive.ifmmode||g===d.defs.primitive.iftrue||g.isLet&&g.original===d.defs.primitive.iftrue||g===d.defs.primitive.ifvmode||g.isLet&&g.original===d.defs.primitive.ifvmode||g===d.defs.primitive.ifvoid||g.isLet&&g.original===d.defs.primitive.ifvoid||g===d.defs.primitive.ifx||g.isLet&&g.original===d.defs.primitive.ifx)c("fi"),a.mouth.eat();else{if("or"==z&&(g===d.defs.primitive.or||g.isLet&&g.original===d.defs.primitive.or))break;if(("or"==z||"else"==z)&&(g===d.defs.primitive["else"]||
g.isLet&&g.original===d.defs.primitive["else"])){e=!0;break}if(g===d.defs.primitive.fi||g.isLet&&g.original===d.defs.primitive.fi){a.mouth.revert();break}}}}if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var b=Symbol();a.mouth.saveState(b);var f=a.mouth.eat("integer");if(!f)return this.invalid=!0,[this];b=[];var e=!1;f=f.value;if(0>f)c("else");else for(;0<f&&!e;f--)c("or");for(;;)if(f=a.mouth.eat())if("command"==f.type||"character"==f.type&&f.cat==k.ACTIVE){var l=
"command"==f.type?a.scopes.last().defs.primitive[f.name]||a.scopes.last().defs.macros[f.name]:a.scopes.last().defs.active[f["char"]];if(l&&(l===d.defs.primitive.fi||l.isLet&&l.original===d.defs.primitive.fi))return b;!e&&l&&(l===d.defs.primitive.or||l.isLet&&l.original===d.defs.primitive.or||l===d.defs.primitive["else"]||l.isLet&&l.original===d.defs.primitive["else"])?c("fi"):(f=a.mouth.expand(f,a.mouth),a.mouth.queue.unshift.apply(a.mouth.queue,f))}else b.push(f);else return this.invalid=!0,a.mouth.loadState(stateSymbol),
[this]}),ifcat:new H("ifcat",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);for(var b=[],f=!1;2>b.length;){var e=a.mouth.eat("pre space");if(e){if("character"!=e.type||e.cat!=k.WHITESPACE||0!=b.length)if("character"==e.type&&b.cat!=k.ACTIVE)b.push(e),f=!1;else if(f)b.push(e),f=!1;else if("command"==e.type||"character"==e.type&&e.cat==k.ACTIVE)if(e.name in a.scopes.last().registers.named)b.push(e);else{var l=
"command"==e.type?a.scopes.last().defs.primitive[e.name]||a.scopes.last().defs.macros[e.name]:a.scopes.last().defs.active[e["char"]];if(!l)return this.invalid=!0,a.mouth.loadState(c),[this];if(l===d.defs.primitive.the||l.proxy&&l.original===d.defs.primitive.the||l===d.defs.primitive.expandafter||l.proxy&&l.original===d.defs.primitive.expandafter||l===d.defs.primitive.number||l.proxy&&l.original===d.defs.primitive.number||l===d.defs.primitive.romannumeral||l.proxy&&l.original===d.defs.primitive.romannumeral||
l===d.defs.primitive.csname||l.proxy&&l.original===d.defs.primitive.csname||l===d.defs.primitive.string||l.proxy&&l.original===d.defs.primitive.string||l===d.defs.primitive["if"]||l.isLet&&l.original===d.defs.primitive["if"]||l===d.defs.primitive.ifcase||l.isLet&&l.original===d.defs.primitive.ifcase||l===d.defs.primitive.ifcat||l.isLet&&l.original===d.defs.primitive.ifcat||l===d.defs.primitive.ifdim||l.isLet&&l.original===d.defs.primitive.ifdim||l===d.defs.primitive.ifeof||l.isLet&&l.original===d.defs.primitive.ifeof||
l===d.defs.primitive.iffalse||l.isLet&&l.original===d.defs.primitive.iffalse||l===d.defs.primitive.ifodd||l.isLet&&l.original===d.defs.primitive.ifodd||l===d.defs.primitive.ifnum||l.isLet&&l.original===d.defs.primitive.ifnum||l===d.defs.primitive.ifhmode||l.isLet&&l.original===d.defs.primitive.ifhmode||l===d.defs.primitive.ifinner||l.isLet&&l.original===d.defs.primitive.ifinner||l===d.defs.primitive.ifmmode||l.isLet&&l.original===d.defs.primitive.ifmmode||l===d.defs.primitive.iftrue||l.isLet&&l.original===
d.defs.primitive.iftrue||l===d.defs.primitive.ifvmode||l.isLet&&l.original===d.defs.primitive.ifvmode||l===d.defs.primitive.ifvoid||l.isLet&&l.original===d.defs.primitive.ifvoid||l===d.defs.primitive.ifx||l.isLet&&l.original===d.defs.primitive.ifx){l=a.mouth.expand(e,a.mouth);if(1==l.length&&l[0]===e&&e.invalid)return this.invalid=!0,a.mouth.loadState(c),[this];a.mouth.queue.unshift.apply(a.mouth.queue,l)}else if(l===d.defs.primitive.noexpand||l.proxy&&l.original===d.defs.primitive.noexpand)f=!0;
else if(_instanceof(l,H)||l.proxy&&_instanceof(l.original,H))b.push(e);else{l=a.mouth.expand(e,a.mouth);if(1==l.length&&l[0]==-e&&e.invalid)return this.invalid=!0,a.mouth.loadState(c),[this];a.mouth.queue.unshift.apply(a.mouth.queue,l)}}else b.push(e)}else return this.invalid=!0,a.mouth.loadState(c),[this]}return Xa.call(this,"command"==b[0].type&&"command"==b[1].type||"character"==b[0].type&&b[0].cat==b[1].cat,a.mouth,a.scopes,c)}),ifdim:new H("ifdim",function(a){if("superscript"==a.contexts.last||
"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat("dimension");if(!b)return this.invalid=!0,[this];b=b.sp.value+12*b.em.value;var f=a.mouth.eat();if(!f||f.cat==k.ACTIVE&&("<"==f["char"]||"="==f["char"]||">"==f["char"]))return this.invalid=!0,a.mouth.loadState(c),[this];var e=a.mouth.eat("dimension");if(!e)return this.invalid=!0,a.mouth.loadState(c),[this];e=e.sp.value+12*e.em.value;return Xa.call(this,"<"==f["char"]?b<e:"="==f["char"]?
b==e:b>e,a.mouth,a.scopes,c)}),ifeof:new H("ifeof",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);return Xa.call(this,!0,a.mouth,a.scopes,c)}),iffalse:new H("iffalse",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);return Xa.call(this,!1,a.mouth,a.scopes,c)}),ifodd:new H("ifodd",function(a){if("superscript"==a.contexts.last||
"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat("integer");return b?Xa.call(this,1==b.value%2,a.mouth,a.scopes,c):(this.invalid=!0,[this])}),ifnum:new H("ifnum",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat("integer");if(!b)return this.invalid=!0,[this];var f=a.mouth.eat();if(!f||f.cat==k.ACTIVE&&("<"==f["char"]||"="==f["char"]||
">"==f["char"]))return this.invalid=!0,a.mouth.loadState(c),[this];var e=a.mouth.eat("integer");return e?Xa.call(this,"<"==f["char"]?b.value<e.value:"="==f["char"]?b.value==e.value:b.value>e.value,a.mouth,a.scopes,c):(this.invalid=!0,a.mouth.loadState(c),[this])}),ifhmode:new H("ifhmode",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);return Xa.call(this,!1,a.mouth,a.scopes,c)}),ifinner:new H("ifinner",function(a){if("superscript"==
a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);return Xa.call(this,"inline"==a.style,a.mouth,a.scopes,c)}),ifmmode:new H("ifmmode",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);return Xa.call(this,!0,a.mouth,a.scopes,c)}),iftrue:new H("iftrue",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=
!0,[this];var c=Symbol();a.mouth.saveState(c);return Xa.call(this,!0,a.mouth,a.scopes,c)}),ifvmode:new H("ifvmode",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);return Xa.call(this,!1,a.mouth,a.scopes,c)}),ifvoid:new H("ifvoid",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);return Xa.call(this,!0,a.mouth,a.scopes,
c)}),ifx:new H("ifx",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(!b)return this.invalid=!0,[this];var f=a.mouth.eat("pre space");if(!f)return this.invalid=!0,a.mouth.loadState(c),[this];(b="command"==b.type?a.scopes.last().defs.primitive[b.name]||a.scopes.last().defs.macros[b.name]:"character"==b.type&&b.cat==k.ACTIVE?a.scopes.last().defs.active[b["char"]]:b)&&b.proxy&&(b=b.original);
(f="command"==f.type?a.scopes.last().defs.primitive[f.name]||a.scopes.last().defs.macros[f.name]:"character"==f.type&&f.cat==k.ACTIVE?a.scopes.last().defs.active[f["char"]]:f)&&f.proxy&&(f=f.original);if(!b&&!f)return Xa.call(this,!0,a.mouth,a.scopes,c);if(!b||!f||b.type!=f.type)return Xa.call(this,!1,a.mouth,a.scopes,c);if("character"==b.type)return Xa.call(this,b["char"]==f["char"]&&b.cat==f.cat,a.mouth,a.scopes,c);if("primitive"==b.type)return Xa.call(this,b===f,a.mouth,a.scopes,c);if(b.parameters.length!=
f.parameters.length||b.replacement.length!=f.replacement.length)return Xa.call(this,!1,a.mouth,a.scopes,c);for(var e=0,l=b.parameters.length;e<l;e++)if("character"!=b.parameters[e].type||b.parameters[e]["char"]!=f.parameters[e]["char"]||b.parameters[e].cat!=f.parameters[e].cat)if("command"!=b.parameters[e].type||b.parameters[e].name!=f.parameters[e].name)return Xa.call(this,!1,a.mouth,a.scopes,c);e=0;for(l=b.replacement.length;e<l;e++)if("character"!=b.replacement[e].type||b.replacement[e]["char"]!=
f.replacement[e]["char"]||b.replacement[e].cat!=f.replacement[e].cat)if("command"!=b.replacement[e].type||b.replacement[e].name!=f.replacement[e].name)return Xa.call(this,!1,a.mouth,a.scopes,c);return Xa.call(this,!0,a.mouth,a.scopes,c)}),it:new H("it",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"font modifier",value:"it"});return[]}),kern:new H("kern",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=
!0,[this];var c=a.mouth.eat("dimension");if(!c)return this.invalid=!0,[this];a.tokens.push({type:"kern",dimen:c});return[]}),lccode:new H("lccode",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=a.mouth.eat("integer");if(c&&0<c.value)return[a.scopes.last().lc[c.value]=a.scopes.last().lc[c.value]||new q(0)];this.invalid=!0;return[this]}),left:new H("left",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=
!0,[this];var c=Symbol();for(a.mouth.saveState(c);;){var b=a.mouth.eat();if(b&&("command"==b.type||"character"==b.type&&b.cat==k.ACTIVE))b=a.mouth.expand(b,a.mouth),a.mouth.queue.unshift.apply(a.mouth.queue,b);else if(b&&"character"==b.type&&d.delims.includes(b.code)&&(b.cat==k.OTHER||b.cat==k.LETTER)){new a.Scope;a.scopes.last().delimited=!0;a.scopes.last().leftDelimiter=b["char"];a.scopes.last().nullDelimiterSpace=new I(a.scopes.last().registers.named.nulldelimiterspace);a.openGroups.push(this);
a.contexts.push({toString:function(){return"scope"},type:"scope"});a.scopes.last().tokens.push(this);a.scopes.last().tokens.push({type:"atom",atomType:0,nucleus:{type:"symbol","char":b["char"],code:b.code},subscript:null,superscript:null});this.ignore=!0;break}else return this.invalid=!0,a.mouth.loadState(c),[this]}}),let:new H("let",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(!b)return this.invalid=
!0,[this];if("character"==b.type)if(a.catOf(b["char"])==k.ACTIVE){var f="active";b=b["char"]}else return this.invalid=!0,a.mouth.loadState(c),[this];else if("command"==b.type&&(f="macro",b=b.name,b in a.scopes.last().defs.primitive||b in d.parameters))return this.invalid=!0,a.mouth.loadState(c),[this];var e=a.mouth.eat();e&&"character"==e.type&&"="==e["char"]&&e.cat==k.OTHER||e&&a.mouth.revert();if(e=a.mouth.eat())if("command"==e.type||"character"==e.type&&e.cat==k.ACTIVE)if(c="command"==e.type?a.scopes.last().defs.primitive[e.name]||
a.scopes.last().defs.macros[e.name]:a.scopes.last().defs.active[e.name])c=new Va(c,"primitive"==c.type||c.isLet);else{if("command"==e.type&&"macro"==f&&(e=a.scopes.last().registers.named[e.name])){if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value){d.registers.named[b]=e;delete d.defs.macros[b];f=0;for(var l=a.scopes.length;f<l;f++)a.scopes[f].registers.named[b]=e,delete a.scopes[f].defs.macros[b]}else a.scopes.last().registers.named[b]=
e,delete a.scopes.last().defs.macros[b];a.toggles.global=!1;return[]}}else c=new Va(new Va([e]),!0);else return this.invalid=!0,a.mouth.loadState(c),[this];if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)if("macro"==f)for(c?d.defs.macros[b]=c:delete d.defs.macros[b],delete d.registers.named[b],f=0,l=a.scopes.length;f<l;f++)c?a.scopes[f].defs.macros[b]=c:delete a.scopes[f].defs.macros[b],delete a.scopes[f].registers.named[b];
else for(c?d.defs.active[b]=c:delete d.defs.active[b],delete d.registers.named[b],f=0,l=a.scopes.length;f<l;f++)c?a.scopes[f].defs.active[b]=c:delete a.scopes[f].defs.active[b],delete a.scopes[f].registers[b];else c?a.scopes.last().defs["macro"==f?"macros":"active"][b]=c:delete a.scopes.last().defs["macro"==f?"macros":"active"][b],delete a.scopes.last().registers.named[b];a.toggles.global=!1;return[]}),limits:new H("limits",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=
!0,[this];a.tokens.push({type:"limit modifier",value:!0,token:this});return[]}),lower:new H("lower",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=a.mouth.eat("dimension");if(!c)return this.invalid=!0,[this];c.sp.value*=-1;c.em.value*=-1;a.tokens.push({type:"vkern",dimen:c});return[]}),lowercase:new H("lowercase",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();
a.mouth.saveState(c);var b=a.mouth.eat("pre space");if(!b||b.cat!=k.OPEN)return this.invalid=!0,a.mouth.loadState(c),[this];b=[];for(var f=1;;){var e=a.mouth.eat("pre space");if(e)if("character"==e.type&&e.cat==k.OPEN)f++,b.push(e);else if("character"==e.type&&e.cat==k.CLOSE)if(f--,0<f)b.push(e);else break;else b.push(e);else return this.invalid=!0,a.mouth.loadState(c),[this]}c=0;for(f=b.length;c<f;c++)"character"==b[c].type&&a.scopes.last().lc[b[c].code]&&0<a.scopes.last().lc[b[c].code].value&&(b[c].code=
a.scopes.last().lc[b[c].code].value,b[c]["char"]=String.fromCharCode(b[c].code));return b}),mathbin:new H("mathbin",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"family modifier",value:2,token:this});return[]}),mathchar:new H("mathchar",function(a){var c=a.mouth.eat("integer");if(!c||0>c.value)return this.invalid=!0,[this];if(65536>c.value)var b=0;else if(524288>c.value){var f=c.value%65536;b=(c.value-f)/65536;c.value=
f}else b=0;a.mouth.queue.unshift({type:"character",cat:k.OTHER,"char":String.fromCharCode(c.value),code:c.value,forcedMathCode:b});return[]}),mathchardef:new H("mathchardef",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(b&&"command"==b.type){if(b.name in d.defs.primitive||b.name in d.parameters)return this.invalid=!0,a.mouth.loadState(c),[!0];var f=a.mouth.eat();f&&"character"==f.type&&
"="==f["char"]&&f.cat==k.OTHER||f&&a.mouth.revert();f=a.mouth.eat("integer");if(!f||0>f.value)return this.invalid=!0,a.mouth.loadState(c),[!0];if(65536>f.value)c=0;else if(524288>f.value){var e=f.value%65536;c=(f.value-e)/65536;f.value=e}else c=0;f=new Va([{type:"character",cat:k.OTHER,"char":String.fromCharCode(f.value),code:f.value,forcedMathCode:c}],[]);if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(d.defs.macros[b.name]=
f,delete d.registers.named[b.name],c=0,e=a.scopes.length;c<e;c++)a.scopes[c].defs.macros[b.name]=f,delete a.scopes[c].registers.named[b.name];else a.scopes.last().defs.macros[b.name]=f,delete a.scopes.last().registers.named[b.name];a.toggles.global=!1}else return this.invalid=!0,a.mouth.loadState(c),[!0]}),mathchoice:new H("mathchoice",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c={type:"command",nameType:"command",escapeChar:this.escapeChar,
name:"mathchoice",recognized:!0};a.contexts.push({toString:function(){return"mathchoice"},type:"mathchoice",token:c,current:0,failed:function(){this.token.invalid=!0;a.contexts.pop()},succeeded:function(){a.contexts.pop();this.token.type="mathchoice";this.token.groups=a.scopes.last().tokens.splice(a.scopes.last().tokens.length-4,4);this.token.ignore=!1}});a.tokens.push(c);c.ignore=!0}),mathclose:new H("mathclose",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=
!0,[this];a.tokens.push({type:"family modifier",value:5,token:this});return[]}),mathcode:new H("mathcode",function(a){if("superscript"==a.lastContext.type||"subscript"==a.lastContext.type)return ra(this);var c=a.mouth.eat("integer");if(c&&0<=c.value){if(!(c.value in d.mathcodes)){d.mathcodes[c.value]=new q(L.ORD,0,8);for(var b=0,f=a.scopes.length;b<f;b++)a.scopes[b].mathcodes[c.value]=new q((0==b?d:a.scopes[b-1]).mathcodes[c.value])}return[a.lastScope.mathcodes[c.value]]}return ra(this)}),mathinner:new H("mathinner",
function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"family modifier",value:"inner",token:this});return[]}),mathop:new H("mathop",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"family modifier",value:1,token:this});return[]}),mathopen:new H("mathopen",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=
!0,[this];a.tokens.push({type:"family modifier",value:4,token:this});return[]}),mathord:new H("mathord",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"family modifier",value:0,token:this});return[]}),mathpunct:new H("mathpunct",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"family modifier",value:6,token:this});return[]}),mathrel:new H("mathrel",
function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"family modifier",value:3,token:this});return[]}),meaning:new H("meaning",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=a.mouth.eat();if(!c)return this.invalid=!0,[this];var b="",f=!1;if("command"==c.type||"character"==c.type&&c.cat==k.ACTIVE){var e="command"==c.type?a.scopes[a.scopes.length-1].defs.primitive[c.name]||
a.scopes[a.scopes.length-1].defs.macros[c.name]:a.scopes[a.scopes.length-1].defs.active[c["char"]];if(e)if("primitive"==e.type||e.isLet&&"primitive"==e.original.type)b+="".concat(c.escapeChar).concat(c.name,"=").concat(String.fromCodePoint(a.scopes[a.scopes.length-1].registers.named.escapechar.value)).concat((e.original||e).name),f=!0;else if(e.isLet)b+="".concat(c.escapeChar+c.name||c["char"],"="),c=e.original.replacement[0];else{e.proxy&&(e=e.original);b+="".concat(c.escapeChar+c.name||c["char"],
"=macro:\n");f=a=0;for(var l=e.parameters.length;f<l;f++)"character"==e.parameters[f].type&&e.parameters[f].cat!=k.PARAMETER?b+=e.parameters[f]["char"]:"character"==e.parameters[f].type?(a++,b+=e.parameters[f]["char"]+a):b+=e.parameters[f].escapeChar+e.parameters[f].name;b+="->";a=0;for(f=e.replacement.length;a<f;a++)b+="character"==e.replacement[a].type?e.replacement[a]["char"]:e.replacement[a].escapeChar+e.replacement[a].name;f=!0}else b+="".concat(c.escapeChar).concat(c.name,"=undefined."),f=!0}if(!f)switch(c.cat){case k.OPEN:b+=
"begin-group character ".concat(c["char"],".");break;case k.CLOSE:b+="end-group character ".concat(c["char"],".");break;case k.MATHSHIFT:b+="math shift character ".concat(c["char"],".");break;case k.ALIGN:b+="alignment tab character ".concat(c["char"],".");break;case k.PARAMETER:b+="macro parameter character ".concat(c["char"],".");break;case k.SUPERSCRIPT:b+="superscript character ".concat(c["char"],".");break;case k.SUBSCRIPT:b+="subscript character ".concat(c["char"],".");break;case k.WHITESPACE:b+=
"blank space ".concat(c["char"],".");break;case k.LETTER:b+="the letter ".concat(c["char"],".");break;default:b+="the character ".concat(c["char"],".")}return b.replace(/\n/g," ").split("").map(function(z){return{type:"character",cat:k.OTHER,"char":z,code:z.codePointAt(0)}})}),message:new H("message",function(a){var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(b&&"character"==b.type&&b.cat==k.OPEN){for(var f=0,e=[];;)if(b=a.mouth.eat("pre space"))if("character"==b.type&&b.cat==k.OPEN)f++,
e.push(b["char"]);else if("character"==b.type&&b.cat==k.CLOSE){if(!f)break;f--;e.push(b["char"])}else"command"==b.type?(e.push(b.escapeChar),e.push.apply(e,b.name.split(""))):e.push(b["char"]);else return this.invalid=!0,a.mouth.loadState(c),[this];$a(e.join(""))}else return this.invalid=!0,[this]}),mkern:new H("mkern",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=a.mouth.eat("mu dimension");if(!c)return this.invalid=!0,[this];a.tokens.push({type:"kern",
dimen:c});return[]}),month:new H("month",function(a){return[new q((new Date).getMonth()+1)]}),mskip:new H("mskip",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=a.mouth.eat("mu glue");if(!c)return this.invalid=!0,[this];a.tokens.push({type:"glue",glue:c});return[]}),multiply:new H("multiply",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();for(a.mouth.saveState(c);;){var b=
a.mouth.eat();if(b&&("command"==b.type||"character"==b.type&&b.cat==k.ACTIVE))b=a.mouth.expand(b,a.mouth),a.mouth.queue.unshift.apply(a.mouth.queue,b);else if(b&&b.register)if(b&&b.register){var f=a.mouth.eat();if(!f||"character"!=f.type||"b"!=f["char"]&&"B"!=f["char"]||f.cat==k.ACTIVE)if(f)a.mouth.revert();else return this.invalid=!0,a.mouth.loadState(c),[this];else f=a.mouth.eat(),(!f||"character"!=f.type||"y"!=f["char"]&&"Y"!=f["char"]||f.cat==k.ACTIVE)&&a.mouth.revert(2);if(f=a.mouth.eat("integer"))if("integer"==
b.type){b.value*=f.value;c=b;if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.value=c.value;a.toggles.global=!1}else if("dimension"==b.type){b.sp.value*=f.value;b.em.value*=f.value;c=b;if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.sp.value=c.sp.value,b.em.value=c.em.value;a.toggles.global=
!1}else if("mu dimension"==b.type){b.mu.value*=f.value;c=b;if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.mu.value=c.mu.value;a.toggles.global=!1}else if("glue"==b.type){b.start.sp.value*=f.value;b.start.em.value*=f.value;"infinite dimension"==b.stretch.type?b.stretch.number.value*=f.value:(b.stretch.sp.value*=f.value,b.stretch.em.value*=f.value);"infinite dimension"==b.shrink.type?b.shrink.number.value*=
f.value:(b.shrink.sp.value*=f.value,b.shrink.em.value*=f.value);c=b;if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.start.sp.value=c.start.sp.value,b.start.em.value=c.start.em.value,b.stretch="infinite dimension"==c.stretch.type?new oa(c.stretch.number.value,c.stretch.magnitude.value):new I(c.stretch.sp.value,c.stretch.em.value),b.shrink="infinite dimension"==c.shrink.type?new oa(c.shrink.number.value,
c.shrink.magnitude.value):new I(c.shrink.sp.value,c.shrink.em.value);a.toggles.global=!1}else{if("mu glue"==b.type){b.start.mu.value*=f.value;"infinite dimension"==b.stretch.type?b.stretch.number.value*=f.value:b.stretch.mu.value*=f.value;"infinite dimension"==b.shrink.type?b.shrink.number.value*=f.value:b.shrink.mu.value*=f.value;c=b;if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(;b.parent;)b=b.parent,b.start.mu.value=
c.start.mu.value,b.stretch="infinite dimension"==c.stretch.type?new oa(c.stretch.number.value,c.stretch.magnitude.value):new Ba(c.stretch.mu.value),b.shrink="infinite dimension"==c.shrink.type?new oa(c.shrink.number.value,c.shrink.magnitude.value):new Ba(c.shrink.mu.value);a.toggles.global=!1}}else return this.invalid=!0,a.mouth.loadState(c),[this];break}else return this.invalid=!0,a.mouth.loadState(c),[this];else return this.invalid=!0,a.mouth.loadState(c),[this]}return[]}),muskip:new H("muskip",
function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=a.mouth.eat("integer");if(!c||0>c.value)return this.invalid=!0,[this];if(!d.registers.muskip[c.value]){d.registers.muskip[c.value]=new jb(new Ba(0,0),new Ba(0,0),new Ba(0,0));for(var b=0,f=a.scopes.length;b<f;b++)a.scopes[b].registers.muskip[c.value]=new jb((b?a.scopes[b-1]:d).registers.muskip[c.value])}return[a.scopes.last().registers.muskip[c.value]]}),muskipdef:new H("muskipdef",function(a){if("superscript"==
a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if("command"==b.type){if(b.name in d.defs.primitive||b.name in d.parameters)return this.invalid=!0,a.mouth.loadState(c),[!0];var f=a.mouth.eat();f&&"character"==f.type&&"="==f["char"]&&f.cat==k.OTHER||f&&a.mouth.revert();f=a.mouth.eat("integer");if(!f||0>f.value)return this.invalid=!0,a.mouth.loadState(c),[!0];b=b.name;f=f.value;if(!d.registers.muskip[f]){d.registers.muskip[f]=
new jb(new Ba(0),new Ba(0),new Ba(0));c=0;for(var e=a.scopes.length;c<e;c++)a.scopes[c].registers.muskip[f]=new jb((c?a.scopes[c-1]:d).registers.muskip[f])}if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(d.registers.named[b]=d.registers.muskip[f],delete d.defs.macros[b],c=0,e=a.scopes.length;c<e;c++)a.scopes[c].registers.named[b]=a.scopes[c].registers.muskip[f],delete a.scopes[c].defs.macros[b];else a.scopes.last().registers.named[b]=
a.scopes.last().registers.muskip[f],delete a.scopes.last().defs.macros[b]}else return this.invalid=!0,a.mouth.loadState(countDefSym),[!0]}),noalign:new H("noalign",function(a){this.invalid=!0;return[this]}),noexpand:new H("noexpand",function(a){var c=a.mouth.eat();if(!c)return this.invalid=!0,[this];a.mouth.revert();return"command"==c.type||"character"==c.type&&c.cat==k.ACTIVE?(this.invalid=!0,[this]):[]}),nolimits:new H("nolimits",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=
!0,[this];a.tokens.push({type:"limit modifier",value:!1,token:this});return[]}),nonscript:new H("nonscript",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"glue",isNonScript:!0});return[]}),normalfont:new H("normalfont",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"font modifier",value:"nm"});return[]}),number:new H("number",function(a){a=
a.mouth.eat("integer");return a?a.value.toString().split("").map(function(c){return{type:"character",cat:k.OTHER,"char":c,code:c.charCodeAt(0)}}):(this.invalid=!0,[this])}),of:new H("of",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];if(a.scopes.last().root){var c=a.scopes.last().tokens.indexOf(a.scopes.last().root);a.tokens.push({type:"family modifier",value:"rad",index:a.scopes.last().tokens.splice(c,a.scopes.last().tokens.length-c+1).slice(1),
token:this});a.scopes.last().root=!1;return[]}this.invalid=!0;return[this]}),omit:new H("omit",function(a){this.invalid=!0;return[this]}),or:new H("or",function(a){this.invalid=!0;return[this]}),over:new H("over",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.scopes.last().isFrac=!0;a.scopes.last().fracLeftDelim=a.scopes.last().fracRightDelim=".";a.scopes.last().barWidth="from font";a.scopes.last().root&&(a.scopes.last().root.invalid=!0,
a.scopes.last().root=!1);a.scopes.last().fracNumerator=a.scopes.last().tokens;a.scopes.last().tokens=[];return[]}),overline:new H("overline",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"family modifier",value:"over",token:this});return[]}),overwithdelims:new H("overwithdelims",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();for(a.mouth.saveState(c);;){var b=
a.mouth.eat();if(b&&("command"==b.type||"character"==b.type&&b.cat==k.ACTIVE))b=a.mouth.expand(b,a.mouth),a.mouth.queue.unshift.apply(a.mouth.queue,b);else if(b&&"character"==b.type&&d.delims.includes(b.code)&&(b.cat==k.OTHER||b.cat==k.LETTER))if(a.scopes.last().fracLeftDelim){a.scopes.last().fracRightDelim=b["char"];break}else a.scopes.last().fracLeftDelim=b["char"];else return this.invalid=!0,a.mouth.loadState(c),delete a.scopes.last().fracLeftDelim,[this]}a.scopes.last().isFrac=!0;a.scopes.last().barWidth=
"from font";a.scopes.last().root&&(a.scopes.last().root.invalid=!0,a.scopes.last().root=!1);a.scopes.last().fracNumerator=a.scopes.last().tokens;a.scopes.last().tokens=[];return[]}),phantom:new H("phantom",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"family modifier",value:"phantom",index:[],token:this});return[]}),raise:new H("raise",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=
!0,[this];var c=a.mouth.eat("dimension");if(!c)return this.invalid=!0,[this];a.tokens.push({type:"vkern",dimen:c});return[]}),relax:new H("relax",function(a){return"superscript"==a.contexts.last||"subscript"==a.contexts.last?(this.invalid=!0,[this]):[]}),right:new H("right",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last||!a.openGroups.length||!a.scopes.last().delimited||a.scopes.last().isHalign||a.scopes.last().isHalignCell||a.scopes.last().semisimple)return this.invalid=
!0,[this];var c=Symbol();for(a.mouth.saveState(c);;){var b=a.mouth.eat();if(b&&("command"==b.type||"character"==b.type&&b.cat==k.ACTIVE))b=a.mouth.expand(b,a.mouth),a.mouth.queue.unshift.apply(a.mouth.queue,b);else if(b&&"character"==b.type&&d.delims.includes(b.code)&&(b.cat==k.OTHER||b.cat==k.LETTER)){if("scope"!=a.contexts.last)return this.invalid=!0,a.mouth.loadState(c),[this];a.openGroups.pop();a.contexts.pop();c=a.scopes.last().tokens;a.scopes.last().root&&(a.scopes.last().root.invalid=!0);if(a.scopes.last().isFrac)a.scopes.last().fracNumerator.shift(),
a.scopes.last().fracNumerator.shift(),a.scopes[a.scopes.length-2].tokens.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:a.scopes.last().fracNumerator,denominator:c,barWidth:a.scopes.last().barWidth,delims:[a.scopes.last().fracLeftDelim,a.scopes.last().fracRightDelim],nullDelimiterSpace:new I(a.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null,delimited:!0,nullDelimiterSpace:new I(a.scopes.last().registers.named.nulldelimiterspace),delims:[a.scopes.last().leftDelimiter,
b["char"]]}),a.scopes.pop();else{c.shift();c.shift();var f=a.scopes.last().leftDelimiter;a.scopes.pop();a.scopes.last().tokens.push({type:"atom",atomType:"inner",nucleus:c,superscript:null,subscript:null,delimited:!0,nullDelimiterSpace:new I(a.scopes.last().registers.named.nulldelimiterspace),delims:[f,b["char"]]})}break}else return this.invalid=!0,a.mouth.loadState(c),[this]}}),rm:new H("rm",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];
a.tokens.push({type:"font modifier",value:"rm"});return[]}),romannumeral:new H("romannumeral",function(a){var c=a.mouth.eat("integer");if(!c)return this.invalid=!0,[this];if(0>=c.value)return this.invalid=!0,a.mouth.revert(),[this];var b="";c=c.value;b=~~(c/1E3);c%=1E3;a=~~(c/100);c%=100;var f=~~(c/10);c%=10;b=Array(b+1).join("m");b=3>a?b+Array(a+1).join("c"):4==a?b+"cd":9>a?b+("d"+Array(a%5+1).join("c")):b+"cm";b=3>f?b+Array(f+1).join("x"):4==f?b+"xl":9>f?b+("l"+Array(f%5+1).join("x")):b+"xc";b=
3>c?b+Array(c+1).join("i"):4==c?b+"iv":9>c?b+("v"+Array(c%5+1).join("i")):b+"ix";return b.split("").map(function(e){return{type:"character",cat:k.OTHER,"char":e,code:e.charCodeAt(0)}})}),scriptscriptstyle:new H("scriptscriptstyle",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"font modifier",value:"scriptscriptstyle"});return[]}),scriptstyle:new H("scriptstyle",function(a){if("superscript"==a.contexts.last||"subscript"==
a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"font modifier",value:"scriptstyle"});return[]}),show:new H("show",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=a.mouth.string,b=a.mouth.eat();if(!b)return this.invalid=!0,[this];c='"'.concat(this.escapeChar).concat(this.name).concat(c.substring(0,c.length-a.mouth.string.length),'":\n');if("command"==b.type||"character"==b.type&&b.cat==k.ACTIVE){var f="command"==b.type?
a.scopes[a.scopes.length-1].defs.primitive[b.name]||a.scopes[a.scopes.length-1].defs.macros[b.name]:a.scopes[a.scopes.length-1].defs.active[b["char"]];if(f){if("primitive"==f.type||f.isLet&&"primitive"==f.original.type)return $a("".concat(c).concat(b.escapeChar).concat(b.name,"=").concat(String.fromCodePoint(a.scopes[a.scopes.length-1].registers.named.escapechar.value)).concat((f.original||f).name)),[];if(f.isLet)c+="".concat(b.escapeChar+b.name||b["char"],"="),b=f.original.replacement[0];else{f.proxy&&
(f=f.original);c+="".concat(b.escapeChar+b.name||b["char"],"=macro:\n");b=a=0;for(var e=f.parameters.length;b<e;b++)"character"==f.parameters[b].type&&f.parameters[b].cat!=k.PARAMETER?c+=f.parameters[b]["char"]:"character"==f.parameters[b].type?(a++,c+=f.parameters[b]["char"]+a):c+=f.parameters[b].escapeChar+f.parameters[b].name;c+="->";a=0;for(b=f.replacement.length;a<b;a++)c+="character"==f.replacement[a].type?f.replacement[a]["char"]:f.replacement[a].escapeChar+f.replacement[a].name;$a(c);return[]}}else return $a("".concat(c).concat(b.escapeChar).concat(b.name,
"=undefined.")),[]}switch(b.cat){case k.OPEN:$a("".concat(c,"begin-group character ").concat(b["char"],"."));break;case k.CLOSE:$a("".concat(c,"end-group character ").concat(b["char"],"."));break;case k.MATHSHIFT:$a("".concat(c,"math shift character ").concat(b["char"],"."));break;case k.ALIGN:$a("".concat(c,"alignment tab character ").concat(b["char"],"."));break;case k.PARAMETER:$a("".concat(c,"macro parameter character ").concat(b["char"],"."));break;case k.SUPERSCRIPT:$a("".concat(c,"superscript character ").concat(b["char"],
"."));break;case k.SUBSCRIPT:$a("".concat(c,"subscript character ").concat(b["char"],"."));break;case k.WHITESPACE:$a("".concat(c,"blank space ").concat(b["char"],"."));break;case k.LETTER:$a("".concat(c,"the letter ").concat(b["char"],"."));break;default:$a("".concat(c,"the character ").concat(b["char"],"."))}return[]}),showthe:new H("showthe",function(a){var c=Symbol();for(a.mouth.saveState(c);;){var b=a.mouth.eat();if(b&&("command"==b.type||"character"==b.type&&b.cat==k.ACTIVE))b=a.mouth.expand(b,
a.mouth),a.mouth.queue.unshift.apply(a.mouth.queue,b);else{if(b&&b.register)return"integer"==b.type?$a(b.value+"."):"dimension"==b.type?(c=Math.round(b.sp.value/65536*1E5)/1E5,c+=Math.round(b.em.value/65536*1E5)/1E5*12,$a(c+(Number.isInteger(c)?".0pt.":"pt."))):"mu dimension"==b.type?(c=Math.round(b.mu.value/65536*1E5)/1E5,$a(c+(Number.isInteger(c)?".0mu.":"mu."))):"glue"==b.type?(c=Math.round(b.start.sp.value/65536*1E5)/1E5,c+=Math.round(b.start.em.value/65536*1E5)/1E5*12,a=c+(Number.isInteger(c)?
".0pt":"pt"),_instanceof(b.stretch,I)&&(b.stretch.sp.value||b.stretch.em.value)?(c=Math.round(b.stretch.sp.value/65536*1E5)/1E5,c+=Math.round(b.stretch.em.value/65536*1E5)/1E5*12,a+=" plus "+c+(Number.isInteger(c)?".0pt":"pt")):_instanceof(b.stretch,oa)&&b.stretch.number.value&&(c=Math.round(b.stretch.number.value/65536*1E5)/1E5,a+=" plus "+c+(Number.isInteger(c)?".0":"")+"fil"+Array(b.stretch.magnitude.value).join("l")),_instanceof(b.shrink,I)&&(b.shrink.sp.value||b.shrink.em.value)?(c=Math.round(b.shrink.sp.value/
65536*1E5)/1E5,c+=Math.round(b.shrink.em.value/65536*1E5)/1E5*12,a+=" minus "+c+(Number.isInteger(c)?".0pt":"pt")):_instanceof(b.shrink,oa)&&b.shrink.number.value&&(c=Math.round(b.shrink.number.value/65536*1E5)/1E5,a+=" minus "+c+(Number.isInteger(c)?".0":"")+"fil"+Array(b.shrink.magnitude.value).join("l")),$a(a+".")):"mu glue"==b.type&&(c=Math.round(b.start.mu.value/65536*1E5)/1E5,a=c+(Number.isInteger(c)?".0mu":"mu"),_instanceof(b.stretch,Ba)&&b.stretch.mu.value?(c=Math.round(b.stretch.mu.value/
65536*1E5)/1E5,a+=" plus "+c+(Number.isInteger(c)?".0mu":"mu")):_instanceof(b.stretch,oa)&&b.stretch.number.value&&(c=Math.round(b.stretch.number.value/65536*1E5)/1E5,a+=" plus "+c+(Number.isInteger(c)?".0":"")+"fil"+Array(b.stretch.magnitude.value).join("l")),_instanceof(b.shrink,Ba)&&b.shrink.mu.value?(c=Math.round(b.shrink.mu.value/65536*1E5)/1E5,a+=" minus "+c+(Number.isInteger(c)?".0mu":"mu")):_instanceof(b.shrink,oa)&&b.shrink.number.value&&(c=Math.round(b.shrink.number.value/65536*1E5)/1E5,
a+=" minus "+c+(Number.isInteger(c)?".0":"")+"fil"+Array(b.shrink.magnitude.value).join("l")),$a(a+".")),[];this.invalid=!0;a.mouth.loadState(c);return[this]}}}),skip:new H("skip",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=a.mouth.eat("integer");if(!c||0>c.value)return this.invalid=!0,[this];if(!d.registers.skip[c.value]){d.registers.skip[c.value]=new Ia(new I(0,0),new I(0,0),new I(0,0));for(var b=0,f=a.scopes.length;b<f;b++)a.scopes[b].registers.skip[c.value]=
new Ia((b?a.scopes[b-1]:d).registers.skip[c.value])}return[a.scopes.last().registers.skip[c.value]]}),skipdef:new H("skipdef",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if("command"==b.type){if(b.name in d.defs.primitive||b.name in d.parameters)return this.invalid=!0,a.mouth.loadState(c),[!0];var f=a.mouth.eat();f&&"character"==f.type&&"="==f["char"]&&f.cat==k.OTHER||f&&a.mouth.revert();
f=a.mouth.eat("integer");if(!f||0>f.value)return this.invalid=!0,a.mouth.loadState(c),[!0];b=b.name;f=f.value;if(!d.registers.skip[f]){d.registers.skip[f]=new Ia(new I(0,0),new I(0,0),new I(0,0));c=0;for(var e=a.scopes.length;c<e;c++)a.scopes[c].registers.skip[f]=new Ia((c?a.scopes[c-1]:d).registers.skip[f])}if(a.toggles.global&&0<=a.scopes.last().registers.named.globaldefs.value||0<a.scopes.last().registers.named.globaldefs.value)for(d.registers.named[b]=d.registers.skip[f],delete d.defs.macros[b],
c=0,e=a.scopes.length;c<e;c++)a.scopes[c].registers.named[b]=a.scopes[c].registers.skip[f],delete a.scopes[c].defs.macros[b];else a.scopes.last().registers.named[b]=a.scopes.last().registers.skip[f],delete a.scopes.last().defs.macros[b]}else return this.invalid=!0,a.mouth.loadState(countDefSym),[!0]}),sl:new H("sl",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"font modifier",value:"sl"});return[]}),span:new H("span",
function(a){"mathchoice"==a.contexts.last&&a.contexts.last.failed();for(var c=!1,b=a.scopes.length-1;0<=b;b--)if(a.scopes[b].isHalignCell){c=a.scopes[b];break}if(!c)return this.invalid=!0,[this];c=c.parentScope;var f=c.cellData[c.cellData.length-1];f[f.length-1].omit&&(this.postPreamble=!0);if(this.postPreamble&&!a.scopes.last().isHalignCell||"scope"!=a.contexts.last)return this.invalid=!0,[this];if(!this.postPreamble){var e=-1;b=0;for(a=f.length;b<a;b++)e+=f[b].span;if(c.preamble[e])var l=c.preamble[e][1];
else if(~c.repeatPreambleAt)l=c.preamble.slice(c.repeatPreambleAt,c.preamble.length),l=l[(e-c.repeatPreambleAt)%l.length][1];else return this.invalid=!0,[this];if(!c.preamble[++e]&&!~c.repeatPreambleAt)return this.invalid=!0,[this];c=[];b=0;for(a=l.length;b<a;b++){e={};for(var z in l[b])e[z]=l[b][z];c.push(e)}this.postPreamble=!0;return c.concat(this)}a.scopes.last().root&&(a.scopes.last().root.invalid=!0);a.contexts.pop();l=a.scopes.last().tokens;a.scopes.last().isFrac?(f[f.length-1].content.push({type:"atom",
atomType:"inner",nucleus:[{type:"fraction",numerator:a.scopes.last().fracNumerator,denominator:l,barWidth:a.scopes.last().barWidth,delims:[a.scopes.last().fracLeftDelim,a.scopes.last().fracRightDelim],nullDelimiterSpace:new I(a.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),a.scopes.pop()):(a.scopes.pop(),f[f.length-1].content=f[f.length-1].content.concat(l));b=Symbol();a.mouth.saveState(b);f[f.length-1].omit=!1;for(f[f.length-1].span++;;)if(e=a.mouth.eat(),
!e){a.mouth.loadState(b);break}else if("character"==e.type&&e.cat!=k.ACTIVE){a.mouth.loadState(b);break}else if("command"==e.type||"character"==e.type&&e.cat==k.ACTIVE){if(e.name in a.scopes.last().registers.named){a.mouth.loadState(b);break}var g="command"==e.type?a.scopes.last().defs.primitive[e.name]||a.scopes.last().defs.macros[e.name]:a.scopes.last().defs.active[e["char"]];if(!g){a.mouth.loadState(b);break}if(g===d.defs.primitive.the||g.proxy&&g.original===d.defs.primitive.the||g===d.defs.primitive.expandafter||
g.proxy&&g.original===d.defs.primitive.expandafter||g===d.defs.primitive.number||g.proxy&&g.original===d.defs.primitive.number||g===d.defs.primitive.romannumeral||g.proxy&&g.original===d.defs.primitive.romannumeral||g===d.defs.primitive.csname||g.proxy&&g.original===d.defs.primitive.csname||g===d.defs.primitive.string||g.proxy&&g.original===d.defs.primitive.string||g===d.defs.primitive["if"]||g.isLet&&g.original===d.defs.primitive["if"]||g===d.defs.primitive.ifcase||g.isLet&&g.original===d.defs.primitive.ifcase||
g===d.defs.primitive.ifcat||g.isLet&&g.original===d.defs.primitive.ifcat||g===d.defs.primitive.ifdim||g.isLet&&g.original===d.defs.primitive.ifdim||g===d.defs.primitive.ifeof||g.isLet&&g.original===d.defs.primitive.ifeof||g===d.defs.primitive.iffalse||g.isLet&&g.original===d.defs.primitive.iffalse||g===d.defs.primitive.ifodd||g.isLet&&g.original===d.defs.primitive.ifodd||g===d.defs.primitive.ifnum||g.isLet&&g.original===d.defs.primitive.ifnum||g===d.defs.primitive.ifhmode||g.isLet&&g.original===d.defs.primitive.ifhmode||
g===d.defs.primitive.ifinner||g.isLet&&g.original===d.defs.primitive.ifinner||g===d.defs.primitive.ifmmode||g.isLet&&g.original===d.defs.primitive.ifmmode||g===d.defs.primitive.iftrue||g.isLet&&g.original===d.defs.primitive.iftrue||g===d.defs.primitive.ifvmode||g.isLet&&g.original===d.defs.primitive.ifvmode||g===d.defs.primitive.ifvoid||g.isLet&&g.original===d.defs.primitive.ifvoid||g===d.defs.primitive.ifx||g.isLet&&g.original===d.defs.primitive.ifx){if(g=a.mouth.expand(e,a.mouth),1==g.length&&g[0]===
e&&e.invalid){a.mouth.loadState(b);break}}else{if(g===d.defs.primitive.omit||g.proxy&&g.original===d.defs.primitive.omit){f[f.length-1].omit=!0;break}if("primitive"==g.type||g.proxy&&"primitive"==g.original.type){a.mouth.loadState(b);break}g=a.mouth.expand(e,a.mouth);if(1==g.length&&g[0]==-e&&e.invalid){a.mouth.loadState(b);break}}a.mouth.queue.unshift.apply(a.mouth.queue,g)}a.contexts.push({toString:function(){return"scope"},type:"scope"});new a.Scope;a.scopes.last().isHalignCell=!0;if(!f[f.length-
1].omit){e=-1;b=0;for(a=f.length;b<a;b++)e+=f[b].span;c.preamble[e]?l=c.preamble[e][0]:~c.repeatPreambleAt&&(l=c.preamble.slice(c.repeatPreambleAt,c.preamble.length),l=l[(e-c.repeatPreambleAt)%l.length][0]);c=[];b=0;for(a=l.length;b<a;b++){e={};for(z in l[b])e[z]=l[b][z];c.push(e)}return c}}),radical:new H("radical",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"family modifier",value:"rad",index:[],token:this});return[]}),
root:new H("root",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last||a.scopes.last().root)return this.invalid=!0,[this];this.ignore=!0;a.scopes.last().root=this;return[this]}),string:new H("string",function(a){var c=a.mouth.eat();if(!c)return this.invalid=!0,[this];if("character"==c.type)return[{type:"character",cat:k.OTHER,"char":c["char"],code:c.code}];if("command"==c.type)return(String.fromCharCode(a.scopes.last().registers.named.escapechar.value)+c.name).split("").map(function(b){return{type:"character",
cat:k.OTHER,"char":b,code:b.charCodeAt(0)}});this.invalid=!0;a.mouth.revert();return[this]}),textstyle:new H("textstyle",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"font modifier",value:"textstyle"});return[]}),the:new H("the",function(a){var c=Symbol();for(a.mouth.saveState(c);;){var b=a.mouth.eat();if(b&&("command"==b.type||"character"==b.type&&b.cat==k.ACTIVE))b=a.mouth.expand(b,a.mouth),a.mouth.queue.unshift.apply(a.mouth.queue,
b);else if(b&&b.register){if("integer"==b.type)return b.value.toString().split("").map(function(f){return{type:"character",cat:k.OTHER,"char":f,code:f.charCodeAt(0)}});if("dimension"==b.type)return c=Math.round(b.sp.value/65536*1E5)/1E5,c+=Math.round(b.em.value/65536*1E5)/1E5*12,(c+(Number.isInteger(c)?".0pt":"pt")).split("").map(function(f){return{type:"character",cat:k.OTHER,"char":f,code:f.charCodeAt(0)}});if("mu dimension"==b.type)return c=Math.round(b.mu.value/65536*1E5)/1E5,(c+(Number.isInteger(c)?
".0mu":"mu")).split("").map(function(f){return{type:"character",cat:k.OTHER,"char":f,code:f.charCodeAt(0)}});if("glue"==b.type)return a="",c=Math.round(b.start.sp.value/65536*1E5)/1E5,c+=Math.round(b.start.em.value/65536*1E5)/1E5*12,a=c+(Number.isInteger(c)?".0pt":"pt"),_instanceof(b.stretch,I)&&(b.stretch.sp.value||b.stretch.em.value)?(c=Math.round(b.stretch.sp.value/65536*1E5)/1E5,c+=Math.round(b.stretch.em.value/65536*1E5)/1E5*12,a+=" plus "+c+(Number.isInteger(c)?".0pt":"pt")):_instanceof(b.stretch,
oa)&&b.stretch.number.value&&(c=Math.round(b.stretch.number.value/65536*1E5)/1E5,a+=" plus "+c+(Number.isInteger(c)?".0":"")+"fil"+Array(b.stretch.magnitude.value).join("l")),_instanceof(b.shrink,I)&&(b.shrink.sp.value||b.shrink.em.value)?(c=Math.round(b.shrink.sp.value/65536*1E5)/1E5,c+=Math.round(b.shrink.em.value/65536*1E5)/1E5*12,a+=" minus "+c+(Number.isInteger(c)?".0pt":"pt")):_instanceof(b.shrink,oa)&&b.shrink.number.value&&(c=Math.round(b.shrink.number.value/65536*1E5)/1E5,a+=" minus "+c+
(Number.isInteger(c)?".0":"")+"fil"+Array(b.shrink.magnitude.value).join("l")),a.split("").map(function(f){return{type:"character",cat:k.OTHER,"char":f,code:f.charCodeAt(0)}});if("mu glue"==b.type)return a="",c=Math.round(b.start.mu.value/65536*1E5)/1E5,a=c+(Number.isInteger(c)?".0mu":"mu"),_instanceof(b.stretch,Ba)&&b.stretch.mu.value?(c=Math.round(b.stretch.mu.value/65536*1E5)/1E5,a+=" plus "+c+(Number.isInteger(c)?".0mu":"mu")):_instanceof(b.stretch,oa)&&b.stretch.number.value&&(c=Math.round(b.stretch.number.value/
65536*1E5)/1E5,a+=" plus "+c+(Number.isInteger(c)?".0":"")+"fil"+Array(b.stretch.magnitude.value).join("l")),_instanceof(b.shrink,Ba)&&b.shrink.mu.value?(c=Math.round(b.shrink.mu.value/65536*1E5)/1E5,a+=" minus "+c+(Number.isInteger(c)?".0mu":"mu")):_instanceof(b.shrink,oa)&&b.shrink.number.value&&(c=Math.round(b.shrink.number.value/65536*1E5)/1E5,a+=" minus "+c+(Number.isInteger(c)?".0":"")+"fil"+Array(b.shrink.magnitude.value).join("l")),a.split("").map(function(f){return{type:"character",cat:k.OTHER,
"char":f,code:f.charCodeAt(0)}})}else return this.invalid=!0,a.mouth.loadState(c),[this]}}),time:new H("time",function(a){a=new Date;return[new q(60*a.getHours()+a.getMinutes())]}),uccode:new H("uccode",function(a){var c=a.mouth.eat("integer");if(c&&0<c.value)return[a.scopes.last().uc[c.value]=a.scopes.last().uc[c.value]||new q(0)];this.invalid=!0;return[this]}),underline:new H("underline",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"family modifier",
value:"under",token:this});return[]}),uppercase:new H("uppercase",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(!b||b.cat!=k.OPEN)return this.invalid=!0,a.mouth.loadState(c),[this];b=[];for(var f=1;;){var e=a.mouth.eat("pre space");if(e)if("character"==e.type&&e.cat==k.OPEN)f++,b.push(e);else if("character"==e.type&&e.cat==k.CLOSE)if(f--,0<f)b.push(e);else break;else b.push(e);else return this.invalid=
!0,a.mouth.loadState(c),[this]}c=0;for(f=b.length;c<f;c++)"character"==b[c].type&&a.scopes.last().uc[b[c].code]&&0<a.scopes.last().uc[b[c].code].value&&(b[c].code=a.scopes.last().uc[b[c].code].value,b[c]["char"]=String.fromCharCode(b[c].code));return b}),vbox:new H("vbox",function(a){var c=Symbol();a.mouth.saveState(c);for(var b,f;;){var e=a.mouth.eat();if(!e)return this.invalid=!0,[this];if("command"==e.type||"character"==e.type&&e.cat==k.ACTIVE){var l="command"==e.type?a.scopes.last().defs.primitive[e.name]||
a.scopes.last().defs.macros[e.name]:a.scopes.last().defs.active[e["char"]];if(l&&(l===d.defs.primitive.relax||l.proxy&&l.original===d.defs.primitive.relax))break;e=a.mouth.expand(e,a.mouth);a.mouth.queue.unshift.apply(a.mouth.queue,e)}else if("character"!=e.type||"t"!=e["char"]&&"T"!=e["char"])if("character"!=e.type||"s"!=e["char"]&&"S"!=e["char"])if("character"==e.type&&e.cat==k.OPEN){a.mouth.revert();break}else return this.invalid=!0,a.mouth.loadState(c),[this];else{b=a.mouth.eat();e=a.mouth.eat();
l=a.mouth.eat();var z=a.mouth.eat(),g=a.mouth.eat();if(!b||"character"!=b.type||"p"!=b["char"]&&"P"!=b["char"]||b.cat==k.ACTIVE||!e||"character"!=e.type||"r"!=e["char"]&&"R"!=e["char"]||e.cat==k.ACTIVE||!l||"character"!=l.type||"e"!=l["char"]&&"E"!=l["char"]||l.cat==k.ACTIVE||!z||"character"!=z.type||"a"!=z["char"]&&"A"!=z["char"]||z.cat==k.ACTIVE||!g||"character"!=g.type||"d"!=g["char"]&&"D"!=g["char"]||g.cat==k.ACTIVE||!(e=a.mouth.eat("dimension")))return this.invalid=!0,a.mouth.loadState(c),[this];
b=e;break}else if(f=a.mouth.eat("pre space"),f&&"character"==f.type&&("o"==f["char"]||"O"==e["char"])&&e.cat!=k.ACTIVE&&(e=a.mouth.eat("dimension"))){f=e;break}else return this.invalid=!0,a.mouth.loadState(c),[this]}e=a.mouth.preview();if(!e||"character"!=e.type||e.cat!=k.OPEN)return this.invalid=!0,a.mouth.loadState(c),[this];f||b||(b=new I(0,0));a.tokens.push({type:"box wrapper",value:"vertical",to:f,spread:b,token:this});return[]}),vcenter:new H("vcenter",function(a){if("superscript"==a.contexts.last||
"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"family modifier",value:"vcent",token:this});return[]}),vfil:new H("vfil",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"vglue",glue:new Ia(new I(0),new oa(1,1),new I(0))});return[]}),vfill:new H("vfill",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];a.tokens.push({type:"vglue",glue:new Ia(new I(0),
new oa(1,2),new I(0))});return[]}),vrule:new H("vrule",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=Symbol();a.mouth.saveState(c);for(var b=c=!1,f=!1;;){var e=a.mouth.eat();if(!e){a.mouth.revert();break}if("h"!=e["char"]&&"H"!=e["char"]||e.cat==k.ACTIVE)if("d"!=e["char"]&&"D"!=e["char"]||e.cat==k.ACTIVE)if("w"!=e["char"]&&"W"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert();else if(e=a.mouth.eat("pre space"),!e||"i"!=e["char"]&&"I"!=e["char"]||
e.cat==k.ACTIVE)a.mouth.revert(e?2:1);else if(e=a.mouth.eat("pre space"),!e||"d"!=e["char"]&&"D"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?3:2);else if(e=a.mouth.eat("pre space"),!e||"t"!=e["char"]&&"T"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?4:3);else if(e=a.mouth.eat("pre space"),!e||"h"!=e["char"]&&"H"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?5:4);else if(e=a.mouth.eat("dimension")){f=e;continue}else a.mouth.revert(5);else if(e=a.mouth.eat("pre space"),!e||"e"!=e["char"]&&"E"!=e["char"]||
e.cat==k.ACTIVE)a.mouth.revert(e?2:1);else if(e=a.mouth.eat("pre space"),!e||"p"!=e["char"]&&"P"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?3:2);else if(e=a.mouth.eat("pre space"),!e||"t"!=e["char"]&&"T"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?4:3);else if(e=a.mouth.eat("pre space"),!e||"h"!=e["char"]&&"H"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?5:4);else if(e=a.mouth.eat("dimension")){b=e;continue}else a.mouth.revert(5);else if(e=a.mouth.eat("pre space"),!e||"e"!=e["char"]&&"E"!=e["char"]||
e.cat==k.ACTIVE)a.mouth.revert(e?2:1);else if(e=a.mouth.eat("pre space"),!e||"i"!=e["char"]&&"I"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?3:2);else if(e=a.mouth.eat("pre space"),!e||"g"!=e["char"]&&"G"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?4:3);else if(e=a.mouth.eat("pre space"),!e||"h"!=e["char"]&&"H"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?5:4);else if(e=a.mouth.eat("pre space"),!e||"t"!=e["char"]&&"T"!=e["char"]||e.cat==k.ACTIVE)a.mouth.revert(e?6:5);else if(e=a.mouth.eat("dimension")){c=
e;continue}else a.mouth.revert(6);break}f=f||new I(0,65536/30);a.tokens.push({type:"rule",ruleType:"v",height:c,depth:b,width:f});return[]}),vskip:new H("vskip",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];var c=a.mouth.eat("glue");if(!c)return this.invalid=!0,[this];a.tokens.push({type:"vglue",glue:c});return[]}),xdef:new H("xdef",function(a){if("superscript"==a.contexts.last||"subscript"==a.contexts.last)return this.invalid=!0,[this];
var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat();if(!b)return this.invalid=!0,[this];if("character"==b.type)if(a.catOf(b["char"])==k.ACTIVE){var f="active";b=b["char"]}else return this.invalid=!0,a.mouth.loadState(c),[this];else if("command"==b.type&&(f="macro",b=b.name,b in a.scopes.last().defs.primitive||b in d.parameters))return this.invalid=!0,a.mouth.loadState(c),[this];for(var e=[],l=0,z=!1;;){var g=a.mouth.eat();if(g)if(g.cat==k.OPEN){a.mouth.revert();break}else if(g.cat==k.PARAMETER){var n=
a.mouth.eat("pre space");if(n)if(n.cat==k.OPEN)z=!0,a.mouth.revert(),e.push({type:"character",cat:k.OPEN,"char":n["char"],code:n.code});else if(48<n.code&&58>n.code&&n.cat==k.OTHER&&+n["char"]==l+1)e.push(g),l++;else return this.invalid=!0,a.mouth.loadState(c),[this];else return this.invalid=!0,a.mouth.loadState(c),[this]}else e.push(g);else return this.invalid=!0,a.mouth.loadState(c),[this]}l=0;n=[];for(var x=!1,w=!1;;)if(g=a.mouth.eat())if("character"!=g.type||g.cat!=k.PARAMETER||w)if("character"==
g.type&&g.cat==k.OPEN)l++,n.push(g),x=!1;else if("character"==g.type&&g.cat==k.CLOSE){l--;if(0==l)break;n.push(g);x=!1}else if(x)n.push(g),x=!1;else if("command"==g.type||"character"==g.type&&g.cat==k.ACTIVE)if(g.name in a.scopes.last().registers.named)n.push(g);else{var v="command"==g.type?a.scopes.last().defs.primitive[g.name]||a.scopes.last().defs.macros[g.name]:a.scopes.last().defs.active[g["char"]];if(!v)return this.invalid=!0,a.mouth.loadState(c),[this];if(v===d.defs.primitive.the||v.proxy&&
v.original===d.defs.primitive.the||v===d.defs.primitive.expandafter||v.proxy&&v.original===d.defs.primitive.expandafter||v===d.defs.primitive.number||v.proxy&&v.original===d.defs.primitive.number||v===d.defs.primitive.romannumeral||v.proxy&&v.original===d.defs.primitive.romannumeral||v===d.defs.primitive.csname||v.proxy&&v.original===d.defs.primitive.csname||v===d.defs.primitive.string||v.proxy&&v.original===d.defs.primitive.string||v===d.defs.primitive["if"]||v.isLet&&v.original===d.defs.primitive["if"]||
v===d.defs.primitive.ifcase||v.isLet&&v.original===d.defs.primitive.ifcase||v===d.defs.primitive.ifcat||v.isLet&&v.original===d.defs.primitive.ifcat||v===d.defs.primitive.ifdim||v.isLet&&v.original===d.defs.primitive.ifdim||v===d.defs.primitive.ifeof||v.isLet&&v.original===d.defs.primitive.ifeof||v===d.defs.primitive.iffalse||v.isLet&&v.original===d.defs.primitive.iffalse||v===d.defs.primitive.ifodd||v.isLet&&v.original===d.defs.primitive.ifodd||v===d.defs.primitive.ifnum||v.isLet&&v.original===d.defs.primitive.ifnum||
v===d.defs.primitive.ifhmode||v.isLet&&v.original===d.defs.primitive.ifhmode||v===d.defs.primitive.ifinner||v.isLet&&v.original===d.defs.primitive.ifinner||v===d.defs.primitive.ifmmode||v.isLet&&v.original===d.defs.primitive.ifmmode||v===d.defs.primitive.iftrue||v.isLet&&v.original===d.defs.primitive.iftrue||v===d.defs.primitive.ifvmode||v.isLet&&v.original===d.defs.primitive.ifvmode||v===d.defs.primitive.ifvoid||v.isLet&&v.original===d.defs.primitive.ifvoid||v===d.defs.primitive.ifx||v.isLet&&v.original===
d.defs.primitive.ifx){v=a.mouth.expand(g,a.mouth);if(1==v.length&&v[0]===g&&g.invalid)return this.invalid=!0,a.mouth.loadState(c),[this];a.mouth.queue.unshift.apply(a.mouth.queue,v)}else v===d.defs.primitive.noexpand||v.proxy&&v.original===d.defs.primitive.noexpand?x=!0:_instanceof(v,H)||v.proxy&&_instanceof(v.original,H)?n.push(g):a.mouth.queue.unshift.apply(a.mouth.queue,a.mouth.expand(g,a.mouth))}else n.push(g);else{if((v=a.mouth.eat("pre space"))&&(v.cat==k.PARAMETER||v.cat==k.OTHER&&v["char"]<=
e.length&&1<=v["char"]))a.mouth.revert(),v.cat==k.PARAMETER&&(w=!0);else return this.invalid=!0,a.mouth.loadState(c),[this];n.push(g);x=!1}else return this.invalid=!0,a.mouth.loadState(c),[this];n.shift();z&&n.push(e[e.length-1]);v=new Va(n,e);if(0>a.scopes.last().registers.named.globaldefs.value)a.scopes.last().defs["macro"==f?"macros":"active"][b]=v,delete a.scopes.last().registers.named[b];else if("macro"==f)for(d.defs.macros[b]=v,delete d.registers.named[b],c=0,f=a.scopes.length;c<f;c++)a.scopes[c].defs.macros[b]=
v,delete a.scopes.last().registers.named[b];else for(d.defs.active[b]=v,delete d.registers.named[b],c=0,f=a.scopes.length;c<f;c++)a.scopes[c].defs.ative[b]=v,delete a.scopes.last().registers.named[b];a.toggles.global=!1;return[]}),year:new H("year",function(a){return[new q((new Date).getFullYear())]}),"@debug":new H("@debug",function(a){debugger;return[]}),"js@function":new H("js@function",function(a){var c=Symbol();a.mouth.saveState(c);var b=a.mouth.eat(),f=null;if(b){if(xc(b)){b="command"==b.type?
a.lastScope.defs.primitive[b.name]||a.lastScope.defs.macros[b.name]:a.lastScope.defs.active[b["char"]];if(!b)return ra(this);b.proxy&&(b=b.original);b==d.defs.primitive.begingroup?f="semisimple":"character"==b.replacement[0].type&&b.replacement[0].cat==k.OPEN&&(f="simple")}else"character"==b.type&&b.cat==k.OPEN&&(f="simple");if(!f)return a.mouth.loadState(c),ra(this)}else return a.mouth.loadState(c),ra(this);c=[];for(var e=b=a.mouth.string;b;){if(c.length){var l=c[c.length-1],z='"'==l||"'"==l||"`"==
l;if("raw"==l)"`"==b[0]?c.pop():"${"==b.substring(0,2)&&(c.push("}"),b=b.substring(1));else if(z)"\\"==b[0]?b=b.substring(1):b[0]==l?c.pop():"${"==b.substring(0,2)&&"`"==l&&(c.push("}"),b=b.substring(1));else if("String.raw`"==b.substring(0,11)){l.push("raw");b=b.substring(11);continue}else if("("==b[0]){c.push(")");b=b.substring(1);continue}else if("["==b[0]){c.push("]");b=b.substring(1);continue}else if("{"==b[0]){c.push("}");b=b.substring(1);continue}else if('"'==b[0]){c.push('"');b=b.substring(1);
continue}else if("'"==b[0]){c.push("'");b=b.substring(1);continue}else if("`"==b[0]){c.push("`");b=b.substring(1);continue}else b[0]==l&&c.pop()}else{if("String.raw`"==b.substring(0,11)){c.push("raw");b=b.substring(11);continue}else if("("==b[0]){c.push(")");b=b.substring(1);continue}else if("["==b[0]){c.push("]");b=b.substring(1);continue}else if("{"==b[0]){c.push("}");b=b.substring(1);continue}else if('"'==b[0]){c.push('"');b=b.substring(1);continue}else if("'"==b[0]){c.push("'");b=b.substring(1);
continue}else if("`"==b[0]){c.push("`");b=b.substring(1);continue}if(a.catOf(b[0])==k.CLOSE&&"simple"==f){e=e.substring(0,e.length-b.length);b=b.substring(1);break}}b=b.substring(1)}a.mouth.history.push({queue:a.mouth.queue.slice(),string:a.mouth.string,history:a.mouth.history.slice()});a.mouth.string=b;try{var g=(new Function(e))()}catch(n){return"".concat(n.name,": ").concat(n.message).split("").map(function(x){return{type:"character","char":x,code:x.codePointAt(0),cat:k.OTHER,invalid:!0,recognized:!0}})}void 0!=
g&&null!=g&&(f=(new String(g)).valueOf(),a.mouth.string=f+a.mouth.string);return[]})},macros:{},active:{}},registers:{count:{},dimen:{},skip:{},muskip:{},named:{pretolerance:new q(100),tolerance:new q(200),hbadness:new q(1E3),vbadness:new q(1E3),linepenalty:new q(10),hypenpenalty:new q(50),exhyphenpenalty:new q(50),binoppenalty:new q(700),relpenalty:new q(500),clubpenalty:new q(150),widowpenalty:new q(150),displaywidowpenalty:new q(50),brokenpenalty:new q(100),predisplaypenalty:new q(1E4),postdisplaypenalty:new q(0),
floatingpenalty:new q(0),interlinepenalty:new q(0),outputpenalty:new q(-10001),doublehyphendemerits:new q(1E4),finalhyphendemerits:new q(5E3),adjdemerits:new q(1E4),looseness:new q(0),pausing:new q(0),holdinginserts:new q(0),tracingonline:new q(0),tracingmacros:new q(0),tracingstats:new q(0),tracingparagraphs:new q(0),tracingpages:new q(0),tracingoutput:new q(0),tracinglostchars:new q(0),tracingcommands:new q(0),tracingrestores:new q(0),language:new q(0),uchyph:new q(1),lefthyphenmin:new q(2),righthyphenmin:new q(3),
globaldefs:new q(0),defaulthyphenchar:new q(45),defaultskewchar:new q(-1),escapechar:new q(92),endlinechar:new q(13),newlinechar:new q(10),maxdeadcycles:new q(100),hangafter:new q(1),fam:new q(0),mag:new q(1E3),delimiterfactor:new q(901),showboxbreadth:new q(-1),showboxdepth:new q(-1),errorcontextlines:new q(-1),hfuzz:new I(6553.6,0),vfuzz:new I(6553.6,0),overfullrule:new I(0,0),emergencystetch:new I(0,0),hsize:new I(22609920,0),vsize:new I(36044800,0),maxdepth:new I(327680,0),splitmaxdepth:new I(1074397184,
-65536),boxmaxdepth:new I(1074397184,-65536),lineskiplimit:new I(0,0),delimitershortfall:new I(327680,0),nulldelimiterspace:new I(0,6553.6),scriptspace:new I(32768,0),mathsurround:new I(0,0),predisplaystyle:new I(0,0),displaywidth:new I(0,0),displayindent:new I(0,0),parindent:new I(983040,0),hangindent:new I(0,0),hoffset:new I(0,0),voffset:new I(0,0),baselineskip:new Ia(new I(786432,0)),lineskip:new Ia(new I(65536,0)),parskip:new Ia(new I(0,0),new I(65536,0)),abovedisplayskip:new Ia(new I(655360,
0),new I(131072,0),new I(327680,0)),abovedisplayshortskip:new Ia(new I(0,0),new I(196608,0)),belowdisplayskip:new Ia(new I(0,0),new I(196608,0)),belowdisplayshortskip:new Ia(new I(393216,0),new I(196608,0),new I(196608,0)),leftskip:new Ia(new I(0,0)),rightskip:new Ia(new I(0,0)),topskip:new Ia(new I(655360,0)),splittopskip:new Ia(new I(655360,0)),tabskip:new Ia(new I(0,0)),spaceskip:new Ia(new I(0,0)),xspaceskip:new Ia(new I(0,0)),parfillskip:new Ia(new I(0,0),new oa(65536,1)),thinmuskip:new jb(new Ba(196608)),
medmuskip:new jb(new Ba(262144),new Ba(131072),new Ba(262144)),thickmuskip:new jb(new Ba(327680),new Ba(327680))}},cats:function(){for(var a={92:new q(k.ESCAPE,0,15),123:new q(k.OPEN,0,15),125:new q(k.CLOSE,0,15),36:new q(k.MATHSHIFT,0,15),38:new q(k.ALIGN,0,15),10:new q(k.ENDOFLINE,0,15),35:new q(k.PARAMETER,0,15),94:new q(k.SUPERSCRIPT,0,15),95:new q(k.SUBSCRIPT,0,15),0:new q(k.IGNORE,0,15),9:new q(k.WHITESPACE,0,15),32:new q(k.WHITESPACE,0,15),126:new q(k.ACTIVE,0,15),37:new q(k.COMMENT,0,15),
127:new q(k.INVALID,0,15)},c="a".codePointAt(0),b="z".codePointAt(0);c<b;c++)a[c]=new q(k.LETTER,0,15);c="A".codePointAt(0);for(b="Z".codePointAt(0);c<b;c++)a[c]=new q(k.LETTER,0,15);return a}(),mathcodes:function(){for(var a={},c=0;0>c;c++)a["".codePointAt(c)]=new q(L.OP,0,8);for(c=0;34>c;c++)a["+-*\u00b1\u2213\u2216\u00d7\u2217\u22c6\u22c4\u2218\u2219\u00f7\u2229\u222a\u228e\u2293\u2294\u25c3\u25b9\u2240\u25ef\u25b3\u25bd\u2228\u2227\u2295\u2296\u2297\u2298\u2299\u2020\u2021\u2a3f".codePointAt(c)]=
new q(L.BIN,0,8);for(c=0;56>c;c++)a['<>=:"\u2264\u227a\u2aaf\u226a\u2282\u2286\u228f\u2291\u2208\u22a2\u2323\u2322\u2265\u227b\u2ab0\u226b\u2283\u2287\u2290\u2292\u220b\u22a3\u2261\u223c\u2243\u224d\u2248\u2245\u22c8\u221d\u22a8\u2250\u22a5\u226e\u2270\u2280\u2284\u2288\u22e2\u226f\u2271\u2281\u2285\u2289\u22e3\u2260\u2262\u2241\u2244\u2246\u226d'.codePointAt(c)]=new q(L.REL,0,8);for(c=0;4>c;c++)a["([{`".codePointAt(c)]=new q(L.OPEN,0,8);for(c=0;5>c;c++)a["}])!?".codePointAt(c)]=new q(L.CLOSE,0,8);
for(c=0;2>c;c++)a[",;".codePointAt(c)]=new q(L.PUNCT,0,8);for(c=0;82>c;c++)a["abcdefgh\u0127ijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\u03b1\u03b2\u03b3\u03b4\u03f5\u03b5\u03b6\u03b7\u03b8\u03d1\u03b9\u03ba\u03bb\u03bc\u03bd\u03be\u03c0\u03d6\u03c1\u03f1\u03c3\u03c2\u03c4\u03c5\u03d5\u03c6\u03c7\u03c8\u03c9".codePointAt(c)]=new q(L.VARIABLE,0,8);return a}(),delims:[40,41,46,60,62,47,91,92,93,123,124,125,8214,8593,8595,8597,8657,8659,8661,8741,8968,8969,8970,8971,9130,9136,9137,9168,10216,10217,
10222,10223],parameters:"pretolerance tolerance hbadness vbadness linepenalty hypenpenalty exhyphenpenalty binoppenalty relpenalty clubpenalty widowpenalty displaywidowpenalty brokenpenalty predisplaypenalty postdisplaypenalty floatingpenalty interlinepenalty outputpenalty doublehyphendemerits finalhyphendemerits adjdemerits looseness pausing holdinginserts tracingonline tracingmacros tracingstats tracingparagraphs tracingpages tracingoutput tracinglostchars tracingcommands tracingrestores language uchyph lefthyphenmin righthyphenmin globaldefs defaulthyphenchar defaultskewchar escapechar endlinechar newlinechar maxdeadcycles hangafter fam mag delimiterfactor showboxbreadth showboxdepth errorcontextlines hfuzz vfuzz overfullrule emergencystetch hsize vsize maxdepth splitmaxdepth boxmaxdepth lineskiplimit delimitershortfall nulldelimiterfall scriptspace mathsurround predisplaystyle displaywidth displayindent parindent hangindent hoffset voffset baselineskip lineskip parskip abovedisplayskip abovedisplayshortskip belowdisplayskip belowdisplayshortskip leftskip rightskip topskip splittopskip tabskip spaceskip xspaceskip parfillskip thinmuskip medmuskip thickmuskip".split(" "),
lc:{65:new q(97),66:new q(98),67:new q(99),68:new q(100),69:new q(101),70:new q(102),71:new q(103),72:new q(104),73:new q(105),74:new q(106),75:new q(107),76:new q(108),77:new q(109),78:new q(110),79:new q(111),80:new q(112),81:new q(113),82:new q(114),83:new q(115),84:new q(116),85:new q(117),86:new q(118),87:new q(119),88:new q(120),89:new q(121),90:new q(122),97:new q(97),98:new q(98),99:new q(99),100:new q(100),101:new q(101),102:new q(102),103:new q(103),104:new q(104),105:new q(105),106:new q(106),
107:new q(107),108:new q(108),109:new q(109),110:new q(110),111:new q(111),112:new q(112),113:new q(113),114:new q(114),115:new q(115),116:new q(116),117:new q(117),118:new q(118),119:new q(119),120:new q(120),121:new q(121),122:new q(122),913:new q(945),914:new q(946),915:new q(947),916:new q(948),917:new q(949),918:new q(950),919:new q(951),920:new q(952),921:new q(953),922:new q(954),923:new q(955),924:new q(956),925:new q(957),926:new q(958),927:new q(959),928:new q(960),929:new q(961),931:new q(963),
932:new q(964),933:new q(965),934:new q(966),935:new q(967),936:new q(968),937:new q(969),945:new q(945),946:new q(946),947:new q(947),948:new q(948),949:new q(949),950:new q(950),951:new q(951),952:new q(952),953:new q(953),954:new q(954),955:new q(955),956:new q(956),957:new q(957),958:new q(958),959:new q(959),960:new q(960),961:new q(961),963:new q(963),964:new q(964),965:new q(965),966:new q(966),967:new q(967),968:new q(968),969:new q(969)},uc:{65:new q(65),66:new q(66),67:new q(67),68:new q(68),
69:new q(69),70:new q(70),71:new q(71),72:new q(72),73:new q(73),74:new q(74),75:new q(75),76:new q(76),77:new q(77),78:new q(78),79:new q(79),80:new q(80),81:new q(81),82:new q(82),83:new q(83),84:new q(84),85:new q(85),86:new q(86),87:new q(87),88:new q(88),89:new q(89),90:new q(90),97:new q(65),98:new q(66),99:new q(67),100:new q(68),101:new q(69),102:new q(70),103:new q(71),104:new q(72),105:new q(73),106:new q(74),107:new q(75),108:new q(76),109:new q(77),110:new q(78),111:new q(79),112:new q(80),
113:new q(81),114:new q(82),115:new q(83),116:new q(84),117:new q(85),118:new q(86),119:new q(87),120:new q(88),121:new q(89),122:new q(90),913:new q(913),914:new q(914),915:new q(915),916:new q(916),917:new q(917),918:new q(918),919:new q(919),920:new q(920),921:new q(921),922:new q(922),923:new q(923),924:new q(924),925:new q(925),926:new q(926),927:new q(927),928:new q(928),929:new q(929),931:new q(931),932:new q(932),933:new q(933),934:new q(934),935:new q(935),936:new q(936),937:new q(937),945:new q(913),
946:new q(914),947:new q(915),948:new q(916),949:new q(917),950:new q(918),951:new q(919),952:new q(920),953:new q(921),954:new q(922),955:new q(923),956:new q(924),957:new q(925),958:new q(926),959:new q(927),960:new q(928),961:new q(929),963:new q(931),964:new q(932),965:new q(933),966:new q(934),967:new q(935),968:new q(936),969:new q(937)}},Ob=[d.defs.primitive.catcode,d.defs.primitive.count,d.defs.primitive.day,d.defs.primitive.dimen,d.defs.primitive.lccode,d.defs.primitive.mathcode,d.defs.primitive.meaning,
d.defs.primitive.month,d.defs.primitive.muskip,d.defs.primitive.skip,d.defs.primitive.time,d.defs.primitive.uccode,d.defs.primitive.year],td=[d.defs.primitive.the,d.defs.primitive.expandafter,d.defs.primitive.number,d.defs.primitive.romannumeral,d.defs.primitive.csname,d.defs.primitive.string,d.defs.primitive["if"],d.defs.primitive.ifcase,d.defs.primitive.ifcat,d.defs.primitive.ifdim,d.defs.primitive.ifeof,d.defs.primitive.iffalse,d.defs.primitive.ifodd,d.defs.primitive.ifnum,d.defs.primitive.ifhmode,
d.defs.primitive.ifinner,d.defs.primitive.ifmmode,d.defs.primitive.iftrue,d.defs.primitive.ifvmode,d.defs.primitive.ifvoid,d.defs.primitive.ifx];d.defs.primitive.crcr["function"]=d.defs.primitive.cr["function"];A.global(String.raw(_templateObject(),"`","`","`","`","`","`","`","`","`","`","`","`","`","`","`","`","`","`","`","`","`"));A.fontDimen={widthOf:function(a,c,b){b={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[b||"nm"];if(this.cache[c]&&this.cache[c][b]&&this.cache[c][b][a]&&!isNaN(this.cache[c][b][a].width))return this.cache[c][b][a].width;
this.context.font="".concat(b||""," 500px ").concat(c);this.cache[c]=this.cache[c]||{};this.cache[c][b]=this.cache[c][b]||{};this.cache[c][b][a]=this.cache[c][b][a]||{};return this.cache[c][b][a].width=this.context.measureText(a).width/500},visibleWidthOf:function(a,c,b){function f(g,n,x){if(7==x)return g;this.context.clearRect(0,0,150,150);var w=Math.pow(2,x);this.context.font="".concat(b||""," ").concat(100*w,"px ").concat(c);this.context.fillText(a,75+150*w*(.5-g),75+150*w*(.5-n));w=this.context.getImageData(0,
0,150,150).data;var v=!1,W=0,ua;for(ua=0;150>ua;ua++){for(var Aa=0;150>Aa;Aa++){var B=w[4*ua+600*Aa+3];B>v&&(v=B,W=Aa)}if(v)break}return!1===v&&0==x?-1:250<B?g+(ua/150-.5)/Math.pow(2,x):f.call(this,g+(ua/150-.5)/Math.pow(2,x),n+(W/150-.5)/Math.pow(2,x),x+1)}function e(g,n,x){if(7==x)return g;this.context.clearRect(0,0,150,150);var w=Math.pow(2,x);this.context.font="".concat(b||""," ").concat(100*w,"px ").concat(c);this.context.fillText(a,75+150*w*(.5-g),75+150*w*(.5-n));w=this.context.getImageData(0,
0,150,150).data;var v=!1,W=0,ua;for(ua=149;0<=ua;ua--){for(var Aa=0;150>Aa;Aa++){var B=w[4*ua+600*Aa+3];B>v&&(v=B,W=Aa)}if(v)break}return 250<B?g+(ua/150-.5)/Math.pow(2,x):e.call(this,g+(ua/150-.5)/Math.pow(2,x),n+(W/150-.5)/Math.pow(2,x),x+1)}b={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[b||"nm"];if(this.cache[c]&&this.cache[c][b]&&this.cache[c][b][a]&&!isNaN(this.cache[c][b][a].vWidth))return this.cache[c][b][a].vWidth;this.context.textBaseline="middle";this.context.textAlign="center";var l=
f.call(this,.5,.5,0);if(-1==l)return this.cache[c]=this.cache[c]||{},this.cache[c][b]=this.cache[c][b]||{},this.cache[c][b][a]=this.cache[c][b][a]||{},this.cache[c][b][a].vWidth=0;var z=e.call(this,.5,.5,0);this.cache[c]=this.cache[c]||{};this.cache[c][b]=this.cache[c][b]||{};this.cache[c][b][a]=this.cache[c][b][a]||{};return this.cache[c][b][a].vWidth=1.5*(z-l)+.01},heightOf:function(a,c,b){function f(e,l,z){if(7==z)return l;this.context.clearRect(0,0,150,150);var g=Math.pow(2,z);this.context.font=
"".concat(b||""," ").concat(100*g,"px ").concat(c);this.context.fillText(a,75+150*g*(.5-e),75+150*g*(1-l));g=this.context.getImageData(0,0,150,150).data;var n=!1,x=0,w;for(w=0;150>w;w++){for(var v=0;150>v;v++){var W=g[600*w+4*v+3];W>n&&(n=W,x=v)}if(n)break}return!1===n&&0==z?1:250<W?l+(w/150-.5)/Math.pow(2,z):f.call(this,e+(x/150-.5)/Math.pow(2,z),l+(w/150-.5)/Math.pow(2,z),z+1)}b={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[b||"nm"];if(this.cache[c]&&this.cache[c][b]&&this.cache[c][b][a]&&!isNaN(this.cache[c][b][a].height))return this.cache[c][b][a].height;
this.context.textBaseline="alphabetic";this.context.textAlign="center";this.cache[c]=this.cache[c]||{};this.cache[c][b]=this.cache[c][b]||{};this.cache[c][b][a]=this.cache[c][b][a]||{};return this.cache[c][b][a].height=1.5*(1-f.call(this,.5,.5,0))},depthOf:function(a,c,b){function f(e,l,z){if(7==z)return l;this.context.clearRect(0,0,150,150);var g=Math.pow(2,z);this.context.font="".concat(b||""," ").concat(100*g,"px ").concat(c);this.context.fillText(a,75+150*g*(.5-e),75+150*g*(.5-l));g=this.context.getImageData(0,
0,150,150).data;var n=!1,x=0,w;for(w=149;0<=w;w--){for(var v=0;150>v;v++){var W=g[600*w+4*v+3];W>n&&(n=W,x=v)}if(n)break}return!1===n&&0==z?.5:250<W?l+(w/150-.5)/Math.pow(2,z):f.call(this,e+(x/150-.5)/Math.pow(2,z),l+(w/150-.5)/Math.pow(2,z),z+1)}b={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[b||"nm"];if(this.cache[c]&&this.cache[c][b]&&this.cache[c][b][a]&&!isNaN(this.cache[c][b][a].depth))return Math.max(0,this.cache[c][b][a].depth);this.context.textBaseline="alphabetic";this.context.textAlign=
"center";this.cache[c]=this.cache[c]||{};this.cache[c][b]=this.cache[c][b]||{};this.cache[c][b][a]=this.cache[c][b][a]||{};return Math.max(0,this.cache[c][b][a].depth=1.5*(f.call(this,.5,.5,0)-.5))},trueDepthOf:function(a,c,b){this.depthOf(a,c,b);return this.cache[c][{nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[b||"nm"]][a].depth},italCorrOf:function(a,c){function b(f,e,l){if(7==l)return f;this.context.clearRect(0,0,150,150);var z=Math.pow(2,l);this.context.font="italic ".concat(100*z,"px ").concat(c);
this.context.fillText(a,75+150*z*-f,75+150*z*(.5-e));z=this.context.getImageData(0,0,150,150).data;var g=!1,n=0,x;for(x=149;0<=x;x--){for(var w=0;150>w;w++){var v=z[4*x+600*w+3];v>g&&(g=v,n=w)}if(g)break}return!1===g&&0==l?0:250<v?f+(x/150-.5)/Math.pow(2,l):b.call(this,f+(x/150-.5)/Math.pow(2,l),e+(n/150-.5)/Math.pow(2,l),l+1)}if(this.cache[c]&&this.cache[c].italic&&this.cache[c].italic[a]&&!isNaN(this.cache[c].italic[a].italCorr))return this.cache[c].italic[a].italCorr;this.context.textBaseline=
"middle";this.context.textAlign="left";this.cache[c]=this.cache[c]||{};this.cache[c].italic=this.cache[c].italic||{};this.cache[c].italic[a]=this.cache[c].italic[a]||{};return this.cache[c].italic[a].italCorr=Math.max(0,1.5*b.call(this,.5,.5,0)-A.fontDimen.widthOf(a,c,"it"))},scriptOffsetOf:function(a,c,b){function f(g,n,x){if(7==x)return g;this.context.clearRect(0,0,150,150);var w=Math.pow(2,x);this.context.font="".concat(b||""," ").concat(100*w,"px ").concat(c);this.context.fillText(a,75+150*w*
(.5-g),75+150*w*(.5-n));var v=this.context.getImageData(0,0,150,150).data,W=!1,ua=0,Aa;for(Aa=149;0<=Aa;Aa--){for(var B=0;B<Math.max(150,Math.min(0,B<75+150*w*(.5-n)));B++){var da=v[4*Aa+600*B+3];da>W&&(W=da,ua=B)}if(W)break}return!1===W&&0==x?0:250<da?g+(Aa/150-.5)/Math.pow(2,x):f.call(this,g+(Aa/150-.5)/Math.pow(2,x),n+(ua/150-.5)/Math.pow(2,x),x+1)}function e(g,n,x){if(7==x)return g;this.context.clearRect(0,0,150,150);var w=Math.pow(2,x);this.context.font="".concat(b||""," ").concat(100*w,"px ").concat(c);
this.context.fillText(a,75+150*w*(.5-g),75+150*w*(.5-n));var v=this.context.getImageData(0,0,150,150).data,W=!1,ua=0,Aa;for(Aa=149;0<=Aa;Aa--){for(var B=75;B<Math.max(150,B<75+150*w*(1-g));B++){var da=v[4*Aa+600*B+3];da>W&&(W=da,ua=B)}if(W)break}return!1===W&&0==x?1:250<da?g+(Aa/150-.5)/Math.pow(2,x):e.call(this,g+(Aa/150-.5)/Math.pow(2,x),n+(ua/150-.5)/Math.pow(2,x),x+1)}b={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[b||"nm"];if(this.cache[c]&&this.cache[c][b]&&this.cache[c][b][a]&&!isNaN(this.cache[c][b][a].scriptOffset))return this.cache[c][b][a].scriptOffset;
this.context.textBaseline="middle";this.context.textAlign="left";var l=f.call(this,.5,.5,0),z=e.call(this,.5,.5,0);this.cache[c]=this.cache[c]||{};this.cache[c][b]=this.cache[c][b]||{};this.cache[c][b][a]=this.cache[c][b][a]||{};return this.cache[c][b][a].scriptOffset=1.5*Math.max(l-z,0)},leftOffsetOf:function(a,c,b){function f(e,l,z){if(7==z)return e;this.context.clearRect(0,0,150,150);var g=Math.pow(2,z);this.context.font="".concat(b||""," ").concat(100*g,"px ").concat(c);this.context.fillText(a,
75+150*g*(.5-e),75+150*g*(.5-l));g=this.context.getImageData(0,0,150,150).data;var n=!1,x=0,w;for(w=0;150>w;w++){for(var v=0;150>v;v++){var W=g[4*w+600*v+3];W>n&&(n=W,x=v)}if(n)break}return!1===n&&0==z?-1:250<W?e+(w/150-.5)/Math.pow(2,z):f.call(this,e+(w/150-.5)/Math.pow(2,z),l+(x/150-.5)/Math.pow(2,z),z+1)}b={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[b||"nm"];if(this.cache[c]&&this.cache[c][b]&&this.cache[c][b][a]&&!isNaN(this.cache[c][b][a].leftOffset))return this.cache[c][b][a].leftOffset;
this.context.textBaseline="middle";this.context.textAlign="start";this.cache[c]=this.cache[c]||{};this.cache[c][b]=this.cache[c][b]||{};this.cache[c][b][a]=this.cache[c][b][a]||{};return this.cache[c][b][a].leftOffset=-1.5*(f.call(this,.5,.5,0)-.5)},baselineHeightOf:function(a){function c(f,e,l){this.context.textBaseline="bottom";if(7==l)return e;this.context.clearRect(0,0,150,150);var z=Math.pow(2,l);this.context.font="".concat(100*z,"px ").concat(a);this.context.fillText("A",75+150*z*(.5-f),75+
150*z*(1-e));z=this.context.getImageData(0,0,150,150).data;var g=!1,n=0,x;for(x=0;150>x;x++){for(var w=0;150>w;w++){var v=z[600*x+4*w+3];v>g&&(g=v,n=w)}if(g)break}return!1===g&&0==l?1:250<v?e+(x/150-.5)/Math.pow(2,l):c.call(this,f+(n/150-.5)/Math.pow(2,l),e+(x/150-.5)/Math.pow(2,l),l+1)}function b(f,e,l){this.context.textBaseline="alphabetic";if(7==l)return e;this.context.clearRect(0,0,150,150);var z=Math.pow(2,l);this.context.font="".concat(100*z,"px ").concat(a);this.context.fillText("A",75+150*
z*(.5-f),75+150*z*(1-e));z=this.context.getImageData(0,0,150,150).data;var g=!1,n=0,x;for(x=0;150>x;x++){for(var w=0;150>w;w++){var v=z[600*x+4*w+3];v>g&&(g=v,n=w)}if(g)break}return!1===g&&0==l?1:250<v?e+(x/150-.5)/Math.pow(2,l):b.call(this,f+(n/150-.5)/Math.pow(2,l),e+(x/150-.5)/Math.pow(2,l),l+1)}if(this.cache[a]&&!isNaN(this.cache[a].baseline))return this.cache[a].baseline;this.context.textAlign="center";this.cache[a]=this.cache[a]||{};return this.cache[a].baseline=1.5*(b.call(this,.5,.5,0)-c.call(this,
.5,.5,0))},cache:{}};var Zc=new Promise(function(a,c){function b(){requestAnimationFrame(function(){document.body?a(document.body):b()})}b()});Zc.then(function(a){var c=document.createElement("canvas");c.style.position="fixed";c.style.top="100vh";c.style.left="100vw";c.style.pointerEvents="none";c.style.opacity=0;c.width=150;c.height=150;A.fontDimen.canvas=c;A.fontDimen.context=c.getContext("2d");a.appendChild(c)});var Yc=[],qd,rd,Jd=new Promise(function(a,c){Zc.then(function(b){var f=document.createElement("div");
f.style.visibility="hidden";f.style.fontSize="300px";f.style.position="fixed";f.style.top="100vh";f.style.left="100vw";f.textContent="This is a string that changes font.";b.appendChild(f);f.style.fontFamily="serif";qd=f.offsetWidth;f.style.fontFamily="sans-serif";rd=f.offsetWidth;a(f)})});A._debug={data:d,clearFontCache:sd,reset:function(){d.defs.macros={};d.defs.active={};d.registers.count={};d.registers.dimen={};d.registers.skip={};d.registers.muskip={};d.registers.named={}}};return A}();